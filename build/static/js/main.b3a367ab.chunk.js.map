{"version":3,"sources":["assets/icon_note_blue.png","assets/icon_note_red.png","assets/icon_riseabove_blue.png","assets/icon_riseabove_red.png","assets/icon_attachment.gif","assets/icon_view.png","assets/sample_view.gif","assets/appstore.svg","assets/googleplaystore.png","store/api.js","store/userReducer.js","store/scaffoldReducer.js","store/dialogReducer.js","store/kftag.service.js","store/notifier.js","store/noteActions.js","store/async_actions.js","store/noteReducer.js","store/globalsReducer.js","api/user.js","config.js","helper/Login_helper.js","LoginForm.jsx","SignUpForm.jsx","api/object.js","helper/Graph_helper.js","GraphView.jsx","Login.jsx","helper/Dashboard_helper.js","api/community.js","Dashboard.jsx","TopNavBar/TopNavbar.js","components/attachmentCollapse/AttachPanel.js","store/access.js","components/NoteContent/NoteContent.js","store/riseAboveReducer.js","View/ListOfNotes/Notes/Notes.js","View/ListOfNotes/ListOfNotes.js","View/LightView.js","components/dialog/Dialog.js","components/drawDialog/DrawTool.js","components/editor/MCEditor.js","components/scaffold/scaffold.service.js","components/scaffold/ScaffoldSelect.js","components/attachmentArea/AttachArea.js","components/writeTab/WriteTab.js","components/historyTab/History.js","components/propertiesTab/Properties.js","components/authorSelect/AuthorSelect.js","components/authorsTab/AuthorTab.js","components/annotator/annotator.service.js","store/store.js","components/annotator/Annotator.js","components/note/Note.js","components/dialog/NoteDialog.js","components/attachment/Attachment.js","components/dialog/AttachmentDialog.js","components/drawDialog/DrawDialog.js","components/dialogHandler/DialogHandler.js","components/modals/NewRiseAboveModal.js","WebSocket.js","components/View.js","ProtectedRoute.jsx","App.js","index.js"],"names":["module","exports","url","localStorage","getItem","apiUrl","setServer","server","endsWith","substring","length","setItem","setToken","token","axios","defaults","headers","common","sessionStorage","getUser","a","get","data","postContribution","communityId","obj","post","getCommunity","putCommunity","object","put","getGroups","getCommunityViews","getLinks","objectId","direction","type","links","filter","each","putLink","linkId","link","postLink","fromId","toId","from","to","deleteLink","delete","linksSearch","query","getObject","putObject","postAttachment","authorId","newobj","title","authors","status","permission","version","postContribObject","getCommunityAuthors","getRecords","contribId","uploadFile","file","onProgress","formData","FormData","append","onUploadProgress","getViews","postView","getApiLinksReadStatus","viewId","then","result","body","results","i","push","catch","error","addUser","createAction","addAuthors","resetAuthors","userReducer","createReducer","state","action","payload","_id","forEach","author","fetchAuthors","dispatch","api","requestScaffold","receiveScaffold","scaffoldReducer","isFetching","items","fetched","fetchScaffolds","contextId","scaffold_promise","res","Promise","all","scaffolds","map","scaffoldId","el","includes","supports","scaffold","openDialog","closeDialog","focusDialog","openAttachPanel","closeAttachPanel","dialogCounter","dialogReducer","dialogs","drawTool","focused","attachPanel","dlgs","dlg","id","zIndex","createScaffoldStartTag","isTemplate","tag","createScaffoldEndTag","createReferenceTag","contId","text","preProcess","toConnections","fromConnections","doc","jq","$","supportStart","find","addClass","elem","startsWith","hasClass","ref","conn","innerHTML","_from","supportEnd","references","_to","html","postProcess","contributionId","handler","endtags","supportLinksIds","supportStarts","supportEnds","toCreate","supportStartsIds","supportId","split","oldId","newId","toDeleteSupports","referenceLinksIds","kfReferences","kfreferenceIds","referenceId","toDeleteReferences","notifConfig","insert","container","animationIn","animationOut","dismiss","duration","addNotification","notif","store","addRAView","removeRAView","addToRAView","createView","options","registerToCommunity","newView","community","views","makeRiseabove","note","riseabove","noteModified","loadRiseAboveData","viewLinks","readLinks","addNote","removeNote","editNote","addAttachment","removeAttachment","setAttachments","setWordCount","setLinks","setRecords","removeContribAuthor","addContribAuthor","setAnnotation","setAnnotationsLoaded","removeAnnotation","setViewNotes","addViewNote","setCheckedNotes","updateCheckedNotes","setViewLinks","addViewLink","setBuildsOn","setSupports","setRiseAboveViewNotes","setRiseAboveNotes","setReadLinks","removeViewLink","removeViewNote","noteReducer","attachments","viewNotes","checkedNotes","buildsOn","riseAboveNotes","riseAboveViewNotes","raViews","notes","Object","assign","noteId","attachment","att","attId","wordCount","wc","contrib","fromLinks","toLinks","records","auth","annos","annotation","value","annoId","checked","createNote","contextMode","content","mode","group","_groupMembers","undefined","buildson","langInNote","docId","myself","coauthors","ca","createdBy","docShared","text4search","window","alert","newNote","view","newN","x","y","confirmButton","editable","buildOnNote","getState","globals","fetchAttachments","link_atts","attach","dialogId","message","wasActive","prev_text","fetchBuildsOn","fetchLinks","viewLink","fetchRecords","users","formatter","Intl","DateTimeFormat","dateFormatOptions","record","firstName","lastName","format","Date","timestamp","openContribution","noteBody","role","buildOn","annoLinks","annLink","anno","modelId","annot","console","log","fetchViewNotes","noteLinks","filteredObj","riseAboveNoteIds","lnk","buildOnResult","reverse","filteredBuildOn","fetchSupports","fetchReadLinks","setGlobalToken","setCurrentLoginForm","setCommunity","setCommunityId","setCurrentServer","setViewId","setLoggedUser","setView","setAuthor","setViews","editCommunity","setUserId","setIsAuthenticated","setCommunities","setUserCommunities","setSearchQuery","setSearchFilter","setSocketStatus","year","month","day","hour","minute","second","hour12","initState","currentLoginForm","currentServer","user","userId","isAuthenticated","communities","userCommunities","searchQuery","searchFilter","servers","key","socketStatus","globalsReducer","rootContextId","fetchAuthor","getAuthor","fetchCommGroups","groups","fetchLoggedUser","clear","location","replace","fetchCommunityViews","fetchViewCommunityData","commId","getUserTokenServerPair","username","password","fetch","method","JSON","stringify","response","json","SERVERS","name","getServerName","getServerURL","extractTokenFromStorage","uname","parse","executePromises","pwd","login_form_component","promises","document","getElementById","userStorage","successfulLogin","errorMessage","serverTokenPair","viewPreference","label","removeItem","style","display","setState","responseHandler","getLoginData","server_data","LoginForm","props","inputChangeHandler","event","target","val","formSubmitHandler","preventDefault","history","openSignUpForm","tooltip","popover","width","setAttribute","className","onSubmit","this","autoComplete","placeholder","required","onChange","htmlFor","tabIndex","data-toggle","data-trigger","data-content","color","onClick","Component","mapDispatchToProps","compose","withRouter","connect","SignUpForm","serverSelectHandler","singaporeSelected","test","confirmPassword","firstname","lastname","email","registrationKey","postNewUser","resultErrorMessage","errorCode","openLoginForm","verifyRecaptcha","recaptchaVerified","userAuthenticationMethod","signUpButton","sitekey","disabled","s","classNamePrefix","minLength","maxLength","getApiObjectsObjectId","handleNote","nodeData","authorData","readStatus","authorName","matchAuthorId","date","parseDate","created","kfId","classes","position","handleAttachment","nodes","createCytoscapeId","String","imageUrl","slice","bounds","height","locked","download","handleDrawing","DOMParser","parseFromString","svg","aspect_ratio","childNodes","attributes","node_height","parseInt","encodeURIComponent","handleView","authorsInfo","has","set","Cytoscape","use","CytoscapePanZoom","CytoscapeNodeHtmlLabel","CytoscapeSupportImages","GraphView","elements","edges","kfToCyMap","removedElements","currViewLinksLength","loadElements","bind","supportImageIsDuplicate","compareSupportImages","findCyIdsFromKfId","updateReadLinks","focusRecentAddition","filterNodes","prevViewLinksLength","forceRender","keys","si","cy","supportimages","Map","_private","supportImages","graph_nodes","addNodesToGraph","graph_edges","edgeData","fromCount","toCount","j","k","source","addEdgesToGraph","self","concat","graph_results","cy_elements","images","addSupportImage","renderer","redraw","imgs","b","cytoscapeIds","countInstances","batch","cy_elems","isRiseAbove","classToRemove","classToAdd","removeClass","cyIds","newestCyElem","center","flashClass","q","restore","setImageVisible","nodesToHide","collection","values","elem_type","elem_title","toLowerCase","English","cy_ids","union","elem_author","noteIds","support","remove","zoomFactor","zoomDelay","minZoom","maxZoom","fitPadding","panSpeed","panDistance","panDragAreaSize","panMinPercentSpeed","panInactiveArea","panIndicatorMinOpacity","zoomOnly","fitSelector","animateOnFit","fitAnimationDuration","sliderHandleIcon","zoomInIcon","zoomOutIcon","resetIcon","panzoom","nodeHtmlLabel","halign","valign","halignBox","valignBox","cssClass","tpl","on","onNoteClick","onViewClick","evt","newViewLink","updateViewLink","img","b1","b2","prevProps","prevState","cases","anyPropUpdated","nodePositionUpdated","switchedToEmptyView","searchTriggered","CytoscapeComponent","normalizeElements","stylesheet","selector","unread_note_icon","read_note_icon","unread_riseabove_icon","read_riseabove_icon","attachment_icon","view_icon","layout","hideEdgesonViewport","autolock","wheelSensitivity","ownProps","Login","demoToken","demoServer","demoCommunityId","demoViewId","showModal","handleShow","handleClose","getUserToken","formToRender","src","sample_view","alt","href","app_store","marginLeft","googleplay_store","Modal","dialogClassName","onHide","Header","closeButton","Title","Body","Footer","Button","variant","loadServer","dashboard_component","getUserCommunities","sort","compareStrings","_community","userCommunityData","currentServerURL","updateUserCommunities","getUserInfo","logout","getCommunities","serverCommunityData","community_options","c","updateCommunities","joinCommunity","postCommunityRegistration","joinCommunityErrorMessage","userinfo","toggleSidebar","div","Dashboard","domElement","serverName","innerText","serverURL","serverTokenPairs","currentServerName","siblings","activeServerURL","viewType","handleViewChange","selectedViewType","newServerTokenPair","handleCommunityDropDownChange","selectedCommunityToJoin","serverList","communityRegistrationKey","enterCommunity","welcomeViewId","aTag","createElement","appendChild","click","pathname","currentView","communityTitle","class","appendUserServers","isSearchable","data-target","aria-controls","aria-expanded","aria-label","TopNavbar","handleFilter","e","handleInputChange","handleSearchSubmit","signUp","handleChange","Authorization","reset","searchInput","isLoggedIn","userName","isViewUrl","Input","Navbar","Brand","Text","Nav","Form","FormGroup","InputGroup","InputGroupAddon","addonType","InputGroupText","cursor","Link","AttachPanel","useSelector","useDispatch","useState","progress","setProgress","onClose","onFileSelect","fileList","files","Array","upload_promises","indexOf","_URL","URL","webkitURL","addImageProcess","createObjectURL","naturalWidth","naturalHeight","createAttachment","resolve","reject","onload","onerror","attachRes","uploadRes","filename","tmpFilename","newAttachment","linkToNote","linkToView","inlineAttach","data_mce_src","serverUrl","onNewInlineAttach","attach_type","newX","newY","w","h","showInPlace","progressEvent","percentCompleted","Math","round","loaded","total","show","File","FileDrop","onFrameDragEnter","onFrameDragLeave","onFrameDrop","onDragOver","onDragLeave","onDrop","ProgressBar","now","authorRequirementTable","private","r","protected","public","isAuthorOrGroupMember","isAuthor","isGroupMember","isEditable","requiredPermission","fullfillRequirement","NoteContent","noteList","handleSubmit","addView","viewError","setTimeout","topleft","config","min","Axios","visible","handleRiseAbove","noOfNotes","confirm","createRiseAbove","getRiseAboveNotes","riseAboveId","openNote","persist","Row","Col","md","Alert","isOpen","RiseAboveNotes","EditNoteButton","index","access","dangerouslySetInnerHTML","__html","riseAboveNoteId","noteResponse","putResponse","objId","linkRes","Notes","authorObj","setOpen","open","checkNote","updateNoteMobile","isCheckedMobile","showNote","riseAboveData","NoteMobile","hasChildren","children","icon","medium","up","isChecked","Collapse","in","hierarchy","small","down","ListOfNotes","getNotes","LightView","showView","showRiseAbove","filteredData","getBuildOnHierarchy","onCloseDialog","onConfirmDrawDialog","filterResults","parent","child","final_h","entries","showModel","drawing","addDrawing","closeDrawDialog","filteredResults","some","sm","clearSearch","dialog_style","Dialog","default","pageXOffset","pageYOffset","onMouseDown","dragHandleClassName","Card","alignItems","size","onConfirm","buildon","onBuildOnClick","DrawTool","onLoad","getIframeRef","wnd1","iframe_ref","contentWindow","bg","svgCanvas","current_drawing_","all_layers","wnd2","widd","getBBox","heig","svgElem_","selectAllInCurrentLayer","groupSelectedElements","alignSelectedElements","ungroupSelectedElement","clearSelection","setResolution","getSvgString","canvas","ctx","getContext","btoa","drawImage","p","toDataURL","frame","setSvgString","React","MCEditor","apiKey","init","setup","editor","onEditorSetup","content_css","menubar","statusbar","media_live_embeds","plugins","external_plugins","toolbar","onEditorChange","addHyphen","initText","supportContentId","getTime","toString","ScaffoldSelect","scaffoldSelected","returnSupport","onScaffoldSelected","addhyphen","initialText","scaffold_text","tagCreator","scaffoldService","selected","initVal","onSelectChange","Container","Group","controlId","Control","as","AttachArea","atts","selectedImgs","setSelectedImgs","onNewAttachClick","getElementsByClassName","tagName","getAttribute","classList","cls_name","downloadUrl","onAttachDelete","WriteTab","onNewAttachmentClick","inline","attachId","deleteAttach","History","reduce","acc","read","edit","Properties","onPermissionChange","contribution","AuthorSelect","select_options","selectedOption","setSelectedOption","isClearable","onAuthorSelected","AuthorTab","communityAuthors","group_options","g","contribGroup","idx","removeAuthor","setKFPlugin","annotatorHandler","scaffoldElement","Annotator","Plugin","KFPlugin","pluginInit","annotator","subscribe","annotationCreated","annotationUpdated","annotationDeleted","displayEditor","viewer","annotations","displayViewer","editorHidden","annotatorInitialized","__hasProp","hasOwnProperty","RichText","_super","call","ctor","constructor","prototype","__super__","__extends","editorId","element","apply","arguments","tinymce","toolbar_items_size","extended_valid_elements","supported","addField","load","updateEditor","updateViewer","ed","mceditor","activeEditor","getContent","css","ReactDOM","unmountComponentAtNode","scaffoldSidebar","ui","registry","addSidebar","onSetup","sidebar","overflow","fontSize","render","onShow","field","count","editors","setContent","textDiv","parentNode","permissions","update","admin","showEditPermissionsCheckbox","vm2m","isPublic","loc","ranges","start","end","configureStore","reducer","devTools","contentRef","createRef","fixPopupLocation","loadAnnotations","annotatedElem","current","scaffoldElem","annotPlugins","onDelete","containerId","annotsFetched","off","annots","highlights","onAnnotsLoaded","$element","attr","adder","observer","MutationObserver","mutationsList","takeRecords","observe","attributeOldValue","onCreate","onUpdate","invert","popup","dlgOffset","offset","ppOffset","top","left","selection","insertContent","contentTag","dom","setCursorLocation","Note","selectedTab","onNoteChange","onTabSelected","onAnnotationCreated","onAnnotationDeleted","onAnnotationUpdated","snapshot","onDrawingInserted","addSupport","deleteAttachment","select","wordcount","getCount","labels","numwords","scaffoldWordCount","onDrawButton","onDrawToolOpen","tab","createAnnotation","noteAuthor","deleteAnnotation","model","modifyAnnotation","modified","Tabs","activeKey","onSelect","Tab","eventKey","mountOnEnter","dlgId","raViewLinks","raReadLinks","ann","anno_updated","att_link","currentAuthor","NoteDialog","dialog","reduxNote","setNote","setDrawTool","setSvg","setDrawing","useEffect","prevNote","noteChanged","Attachment","attachAuthor","setSelectedTab","transition","AttachmentDialog","attachmentChanged","DrawDialog","drawingAuthor","onDialogClose","drawingChanged","wnd","point","fill","newDrawing","svgCanvasToString","onDialogConfirm","DialogHandler","onFocusDialog","useCallback","elt","NewRiseAboveModal","setTitle","riseAboveTitle","WebSocketContext","createContext","socket","ws","syncUpdates","modelName","item","subscribeToView","emit","openConnection","sync","io","path","unsyncUpdates","removeAllListeners","unsubscribeToView","disconnect","Provider","View","handleNewViewInput","goToDashboard","clearGraphViewProps","switchView","nextView","renderTooltip","Tooltip","showAttachPanel","showRiseAboveModal","handleNewViewSubmit","match","params","context","fetchNewViewDifference","clearAuthors","addViewUrl","newViewId","viewsObj","linkObj","reload","viewToRender","DropdownButton","drop","Dropdown","Item","OverlayTrigger","placement","delay","hide","overlay","Label","varient","myViews","contextType","ProtectedRoute","component","rest","loggedIn","App","exact","WebSocket"],"mappings":"+HAAAA,EAAOC,QAAU,0mF,kBCAjBD,EAAOC,QAAU,shI,kBCAjBD,EAAOC,QAAU,sgN,kBCAjBD,EAAOC,QAAU,kkN,kBCAjBD,EAAOC,QAAU,87J,kBCAjBD,EAAOC,QAAU,0rG,oBCAjBD,EAAOC,QAAU,IAA0B,yC,oBCA3CD,EAAOC,QAAU,IAA0B,sC,oBCA3CD,EAAOC,QAAU,IAA0B,6C,unBCIhCC,EAAMC,aAAaC,QAAQ,UAC3BC,EAAM,UAAMH,EAAN,QAEV,SAASI,EAAUC,GAQtB,OANIA,EAAOC,SAAS,OAChBD,EAASA,EAAOE,UAAU,EAAGF,EAAOG,OAAQ,IAEhDP,aAAaQ,QAAQ,SAAUJ,GAE/BF,EAAM,UADNH,EAAMK,EACA,QACCL,EAGJ,SAASU,EAASC,GACrBC,IAAMC,SAASC,QAAQC,OAAvB,+BACcJ,GAGX,IAKDA,EAAQK,eAAed,QAAQ,SACjCS,GACAD,EAASC,GAIN,I,EAAMM,EAAO,uCAAG,sBAAAC,EAAA,sEACLN,IAAMO,IAAN,UAAahB,EAAb,cADK,uCAC4BiB,MAD5B,2CAAH,qDAKPC,EAAmB,SAACC,EAAaC,GAC1C,OAAOX,IAAMY,KAAN,UAAcrB,EAAd,0BAAsCmB,GAAeC,IAInDE,EAAe,SAACH,GACzB,OAAOV,IAAMO,IAAN,UAAahB,EAAb,wBAAmCmB,KAGjCI,EAAY,uCAAG,WAAOC,EAAQL,GAAf,SAAAJ,EAAA,sEACVN,IAAMgB,IAAN,UAAazB,EAAb,wBAAmCmB,GAAeK,GADxC,uCACiDP,MADjD,2CAAH,wDAYZS,EAAS,uCAAG,WAAOP,GAAP,SAAAJ,EAAA,sEACPN,IAAMO,IAAN,UAAahB,EAAb,wBAAmCmB,EAAnC,YADO,uCACmDF,MADnD,2CAAH,sDAITU,EAAiB,uCAAG,WAAOR,GAAP,SAAAJ,EAAA,sEACfN,IAAMO,IAAN,UAAahB,EAAb,wBAAmCmB,EAAnC,WADe,uCAC0CF,MAD1C,2CAAH,sDAKjBW,EAAQ,uCAAG,WAAOC,EAAUC,EAAWC,GAA5B,eAAAhB,EAAA,sEACFN,IAAMO,IAAN,UAAahB,EAAb,kBAA6B8B,EAA7B,YAA0CD,IADxC,cAEpBG,GADIA,EADgB,QAENf,KACVc,IACAC,EAAQA,EAAMC,QAAO,SAAUC,GAC3B,OAAOA,EAAKH,OAASA,MALT,kBAQbC,GARa,2CAAH,0DAWRG,EAAO,uCAAG,WAAOC,EAAQC,GAAf,SAAAtB,EAAA,sEACLN,IAAMgB,IAAN,UAAazB,EAAb,kBAA6BoC,GAAUC,GADlC,uCACyCpB,MADzC,2CAAH,wDAGPqB,EAAQ,uCAAG,WAAOC,EAAQC,EAAMT,EAAMd,GAA3B,SAAAF,EAAA,sEACNN,IAAMY,KAAN,UAAcrB,EAAd,UAA8B,CAAEyC,KAAMF,EAAQG,GAAIF,EAAMT,KAAMA,EAAMd,KAAMA,IADpE,uCAC6EA,MAD7E,2CAAH,4DAIR0B,EAAU,uCAAG,WAAOP,GAAP,SAAArB,EAAA,sEACRN,IAAMmC,OAAN,UAAgB5C,EAAhB,kBAAgCoC,IADxB,uCACmCnB,MADnC,2CAAH,sDAIV4B,EAAW,uCAAG,WAAO1B,EAAa2B,GAApB,SAAA/B,EAAA,sEACTN,IAAMY,KAAN,UAAcrB,EAAd,kBAA8BmB,EAA9B,WAAoD,CAAE,MAAS2B,IADtD,uCACgE7B,MADhE,2CAAH,wDAKX8B,EAAS,uCAAG,WAAOlB,GAAP,SAAAd,EAAA,sEACPN,IAAMO,IAAN,UAAahB,EAAb,oBAA+B6B,IADxB,uCACqCZ,MADrC,2CAAH,sDAIT+B,EAAS,uCAAG,WAAOxB,EAAQL,EAAaU,GAA5B,SAAAd,EAAA,sEACPN,IAAMgB,IAAN,UAAazB,EAAb,oBAA+BmB,EAA/B,YAA8CU,GAAYL,GADnD,uCAC4DP,MAD5D,2CAAH,0DASTgC,EAAiB,SAAC9B,EAAa+B,GACxC,IAAIC,EAAS,CACThC,YAAaA,EACbY,KAAM,aACNqB,MAAO,gBACPC,QAAS,CAACH,GACVI,OAAQ,UACRC,WAAY,YACZtC,KAAM,CACFuC,QAAS,IAGjB,OAAO/C,IAAMY,KAAN,UAAcrB,EAAd,0BAAsCmB,GAAegC,IAGnDM,EAAiB,uCAAG,WAAOtC,EAAaC,GAApB,SAAAL,EAAA,sEACfN,IAAMY,KAAN,UAAcrB,EAAd,0BAAsCmB,GAAeC,GADtC,uCAC4CH,MAD5C,2CAAH,wDAQjByC,EAAmB,uCAAG,WAAOvC,GAAP,SAAAJ,EAAA,sEACjBN,IAAMO,IAAN,UAAahB,EAAb,wBAAmCmB,EAAnC,aADiB,uCAC0CF,MAD1C,2CAAH,sDAKnB0C,EAAU,uCAAG,WAAOC,GAAP,SAAA7C,EAAA,sEACRN,IAAMO,IAAN,UAAahB,EAAb,2BAAsC4D,IAD9B,uCAC4C3C,MAD5C,2CAAH,sDAIV4C,EAAa,SAACC,EAAMC,GAC7B,IAAIC,EAAW,IAAIC,SAEnB,OADAD,EAASE,OAAO,OAAQJ,GACjBrD,IAAMY,KAAN,UAAcrB,EAAd,WAA+BgE,EAAU,CAC5CrD,QAAS,CACL,eAAgB,uBAGpBwD,iBAAkBJ,KAQbK,GAAQ,uCAAG,WAAOjD,GAAP,SAAAJ,EAAA,sEACNN,IAAMO,IAAN,UAAahB,EAAb,wBAAmCmB,EAAnC,WADM,uCACmDF,MADnD,2CAAH,sDAIRoD,GAAW,SAACvB,EAAM3B,GAC3B,OAAOV,IAAMY,KAAN,UAAcrB,EAAd,0BAAsCmB,GAAc2B,IAIxD,SAASwB,GAAsBnD,EAAaoD,GAC/C,OAAO9D,IAAMO,IAAN,UAAahB,EAAb,qCAAgDmB,EAAhD,YAA+DoD,IAAUC,MAAK,SAASC,GAC1F,IAAMC,EAAOD,EAAOxD,KAChB0D,EAAU,GACd,IAAI,IAAIC,KAAKF,EACW,SAAjBA,EAAKE,GAAG7C,MAAkB4C,EAAQE,KAAKH,EAAKE,GAAGlC,IAEtD,OAAQiC,KACTG,OAAM,SAASC,GACd,OAAkBA,KC5KnB,I,YAAMC,GAAUC,YAAa,YACvBC,GAAaD,YAAa,eAC1BE,GAAeF,YAAa,eAE5BG,GAAcC,YADT,IACsB,mBACnCL,IAAU,SAACM,EAAOC,GACfD,EAAMC,EAAOC,QAAQC,KAAOF,EAAOC,WAFH,cAInCN,IAAa,SAACI,EAAOC,GAClBA,EAAOC,QAAQE,SAAQ,SAACC,GAAD,OAAYL,EAAMK,EAAOF,KAAOE,QALvB,cAOnCR,IAAe,SAACG,EAAOC,GACpB,MAAO,MARyB,IAY3BK,GAAe,SAACzE,GAAD,8CAAiB,WAAO0E,GAAP,eAAA9E,EAAA,sEACnB+E,EAAwB3E,GADL,OACnCkC,EADmC,OAEzCwC,EAASX,GAAW7B,IAFqB,2CAAjB,uDChBf0C,GAAkBd,YAAa,oBAC/Be,GAAiBf,YAAa,oBAO9BgB,GAAkBZ,YALb,CAACa,YAAY,EACZC,MAAO,GACPC,SAAS,IAGgB,kBAAC,GACxCJ,IAAkB,SAACV,EAAOC,GACvBD,EAAMa,MAAQZ,EAAOC,QACrBF,EAAMY,YAAa,EACnBZ,EAAMc,SAAU,KAJoB,YAAC,GAMxCL,IAAkB,SAACT,EAAOC,GACvBD,EAAMY,YAAa,KAPiB,KAW/BG,GAAiB,SAAClF,EAAamF,GACxC,OAAO,SAAAT,GACHA,EAASE,IAET,IAAIQ,EAAmBT,EAAiB3E,GAAaqD,MAAM,SAAAgC,GACvD,OAAOC,QAAQC,IAAIF,EAAIvF,KAAK0F,UAAUC,KAAI,SAACC,GACvC,OAAOf,EAAce,UAI7B,OAAOJ,QAAQC,IAAI,CAACH,EAAkBT,EAAaQ,EAAW,OAAQ,UAAU9B,KAAzE,uCAA8E,WAAMgC,GAAN,mBAAAzF,EAAA,6DAC7EiB,EAAQwE,EAAI,GAAGI,KAAI,SAACvE,GAAD,OAAUA,EAAKK,MAClCiE,EAAYH,EAAI,GAAGvE,QAAO,SAAC6E,GAAD,OAAQ9E,EAAM+E,SAASD,EAAGrB,QAFyB,SAI5DgB,QAAQC,IAAIC,EAAUC,KAAI,SAACE,GAAD,OAAQhB,EAAagB,EAAGrB,IAAK,YAJK,OAI7EuB,EAJ6E,OAKjFL,EAAYA,EAAUC,KAAI,SAACK,EAAUrC,GAEjC,OADAqC,EAASD,SAAWA,EAASpC,GACtBqC,KAGXpB,EAASG,GAAgBW,IAVwD,2CAA9E,yD,SC9BFO,GAAajC,YAAa,eAC1BkC,GAAclC,YAAa,gBAC3BmC,GAAcnC,YAAa,gBAC3BoC,GAAkBpC,YAAa,qBAC/BqC,GAAmBrC,YAAa,sBAEzCsC,GAAe,EAMNC,GAAgBnC,YADX,CAAEoC,QAAS,GAAIC,SAAU,KAAMC,QAAS,KAAMC,YAAa,KACnC,kBAAC,GAEtCV,IAAc,SAAC5B,EAAOC,GAEnB,IAAMsC,EAAOvC,EAAMmC,QAAQb,KAAI,SAAAkB,GAG3B,OAFIA,EAAIC,KAAOzC,EAAMqC,UACjBG,EAAIE,OAXE,KAYHF,KAGXxC,EAAMqC,QAAUJ,GAChBjC,EAAMmC,QAAN,uBAAoBI,GAApB,cAA2BE,GAAIR,KAAiBS,OAflC,KAe4DzC,EAAOC,cAX/C,YAAC,GAiBtC2B,IAAe,SAAC7B,EAAOC,GACpBD,EAAMmC,QAAUnC,EAAMmC,QAAQxF,QAAO,SAAC6F,GAAD,OAASA,EAAIC,KAAOxC,EAAOC,cAlB9B,YAAC,GAqBtC6B,IAAkB,SAAC/B,EAAOC,GACvBD,EAAMsC,YAAcrC,EAAOC,WAtBO,YAAC,GAyBtC8B,IAAmB,SAAChC,EAAOC,GACxBD,EAAMsC,YAAc,MA1Bc,YAAC,GA6BtCR,IAAc,SAAC9B,EAAOC,GACfD,EAAMqC,UAAYpC,EAAOC,UACzBF,EAAMmC,QAAUnC,EAAMmC,QAAQb,KAAK,SAAAkB,GAK/B,OAJIA,EAAIC,KAAOzC,EAAMqC,QACjBG,EAAIE,OAtCF,IAuCGF,EAAIC,KAAOxC,EAAOC,UACvBsC,EAAIE,OAvCF,KAwCCF,KAEXxC,EAAMqC,QAAUpC,EAAOC,YAtCO,K,oBCCpCyC,GAAyB,SAAC7E,EAAO8E,GACnC,IAAIC,EAAM,GAcV,OAbAA,GAAY,IAIRA,GAHCD,EAGW,uEAFA,mDAIhBC,GAAY,IAIRA,EAHCD,EAGKC,EAAM,0DAA4D/E,EAAQ,UAF1E+E,EAAM,qCAAuC/E,EAAQ,UAI/D+E,GAAY,KAIVC,GAAuB,SAACF,GAC1B,IAAIC,EAAM,GAQV,OAPAA,GAAY,IAIRA,GAHCD,EAGW,mEAFA,iDAIhBC,GAAY,KAIVE,GAAqB,SAACC,EAAQlF,EAAOC,EAASkF,GAChD,IACIJ,EAAM,GAQV,OAPII,GAAQA,EAAKlI,OAAS,IACtB8H,EAAMA,EAAM,8EAAgFI,EAAO,gCAGvGJ,GADAA,EAAMA,EAAM,iCAAmCG,EAAS,aAAeA,EAAS,MACpE,mEAAqElF,EAAQ,QACzF+E,GAAMA,uEACNA,GAAY,WAIHK,GAAa,SAAC9D,EAAM+D,EAAeC,GAC5C,IAAMC,EAAM,QAAUjE,EAAO,SACvBkE,EAAKC,KAAEF,GAEPG,EAAeF,EAAGG,KAAK,mBAC7BD,EAAaE,SAAS,kBACtB,IANgE,eAMvDpE,GACL,IAAMqE,EAAOH,EAAalE,GAC1B,IAAKqE,EAAKlB,GAAGmB,WAAW,cAAe,CACnC,IAAMhB,EAAaW,KAAEI,GAAME,SAAS,mBAC9BC,EAAMX,EAAcxG,QAAO,SAACoH,GAAD,OAAUA,EAAK5D,MAAQwD,EAAKlB,MACzDqB,EAAI/I,OACJ4I,EAAKK,UAAWrB,GAAuBmB,EAAI,GAAGG,MAAMnG,MAAO8E,GAEtC,eAAlBO,IACCQ,EAAKK,UAAYrB,GAAuB,iBAAkBC,MATjEtD,EAAI,EAAGA,EAAIkE,EAAazI,OAAQuE,IAAM,EAAtCA,GAcT,IAAM4E,EAAaZ,EAAGG,KAAK,iBAC3BS,EAAWR,SAAS,kBACpB,IAAK,IAAIpE,EAAI,EAAGA,EAAI4E,EAAWnJ,OAAQuE,IAAK,CACxC,IAAMqE,EAAOO,EAAW5E,GAClBsD,EAAaW,KAAEI,GAAME,SAAS,iBACpCF,EAAKK,UAAYlB,GAAqBF,GAG1C,IAAMuB,EAAab,EAAGG,KAAK,gBAC3BU,EAAWT,SAAS,kBACpB,IA9BgE,eA8BvDpE,GACL,IAAMqE,EAAOO,EAAW5E,GACpBwE,EAAMV,EAAgBzG,QAAO,SAACoH,GAAD,OAAUA,EAAK5D,MAAQwD,EAAKlB,MAC7D,GAAIqB,EAAI/I,OAAQ,CAEZ,IAAIkI,EAAO,IADXa,EAAMA,EAAI,IAEFnI,OACJsH,EAAOa,EAAInI,KAAKsH,MAEpBU,EAAKK,UAAYjB,GAAmBe,EAAI1G,GAAI0G,EAAIM,IAAItG,MAAOgG,EAAIM,IAAIrG,QAASkF,QAE5EU,EAAKK,UAAYjB,GAAmB,GAAI,iBAAkB,EAAI,KAX7DzD,EAAI,EAAGA,EAAI6E,EAAWpJ,OAAQuE,IAAM,EAApCA,GAcT,OAAOgE,EAAGe,QAGDC,GAAW,uCAAG,WAAOrB,EAAMsB,EAAgBpB,EAAeC,EAAiBoB,GAA7D,qDAAA/I,EAAA,sDAWvB,IAVM4H,EAAM,QAAUJ,EAAO,SACvBK,EAAKC,KAAEF,GACPoB,EAAU,GACVC,EAAkBvB,EAAcxG,QAAO,SAACC,GAAD,MAAwB,aAAdA,EAAKH,QACrD6E,KAAI,SAAC1E,GAAD,OAAUA,EAAKuD,OACtBwE,EAAgBrB,EAAGG,KAAK,mBACtBmB,EAActB,EAAGG,KAAK,iBACtBoB,EAAW,GACXC,EAAmB,GAEhBxF,EAAI,EAAGA,EAAIsF,EAAY7J,OAAQuE,KAC9BqE,EAAOiB,EAAYtF,IACpB0E,UAAY,GACbvB,EAAKkB,EAAKlB,GACdgC,EAAQhC,GAAMkB,EAElB,IAjBuB,WAiBdrE,GACL,IAAMqE,EAAOgB,EAAcrF,GACvByF,EAAYpB,EAAKlB,GACrBkB,EAAKK,UAAY,GACbe,EAAUnB,WAAW,gBACrBmB,EAAYA,EAAUC,MAAM,KAAK,IAErCF,EAAiBvF,KAAKwF,GACjBL,EAAgBjD,SAASsD,IAE1BF,EAAStF,KAAKvC,EAAS+H,EAAWR,EAAgB,YAAYrF,MAAK,SAACnC,GAEhE,IAAMkI,EAAQtB,EAAKlB,GACbyC,EAAQnI,EAAKoD,IACnBwD,EAAKlB,GAAKyC,EACNT,EAAQQ,KACRR,EAAQQ,GAAOxC,GAAKyC,QAhB3B5F,EAAI,EAAGA,EAAIqF,EAAc5J,OAAQuE,IAAM,EAAvCA,GA6BT,IARM6F,EAAmBT,EAAgB/H,QAAO,SAACC,GAAD,OAAWkI,EAAiBrD,SAAS7E,MAC9E0E,KAAI,SAAC1E,GAAD,OAAUS,EAAWT,MAG1BwI,EAAoBhC,EAAgBzG,QAAO,SAACC,GAAD,MAAwB,eAAdA,EAAKH,QAAuB6E,KAAI,SAAC1E,GAAD,OAAUA,EAAKuD,OACpGkF,EAAe/B,EAAGG,KAAK,oBACvB6B,EAAiB,GA5CA,aA+CnB,IAAM3B,EAAO0B,EAAa/F,GACpB3D,EAAO,CAACsH,KAAKM,KAAEI,GAAMF,KAAK,oBAAoBY,QACpDV,EAAKK,UAAY,GACjB,IAAMuB,EAAc5B,EAAKlB,GACzB6C,EAAe/F,KAAKgG,GACfH,EAAkB3D,SAAS8D,IAE5BV,EAAStF,KAAKvC,EAASuH,EAAgBgB,EAAa,aAAc5J,GAAMuD,MAAK,SAACnC,GAE1E,IAAMkI,EAAQtB,EAAKlB,GACbyC,EAAQnI,EAAKoD,IACnBwD,EAAKlB,GAAKyC,EACNT,EAAQQ,KACRR,EAAQQ,GAAOxC,GAAKyC,QAd3B5F,EAAI,EAAGA,EAAI+F,EAAatK,OAAQuE,IAAM,IA9CxB,OAkEjBkG,EAAqBJ,EAAkBzI,QAAO,SAACC,GAAD,OAAW0I,EAAe7D,SAAS7E,MAAO0E,KAAI,SAAC1E,GAAD,OAAUS,EAAWT,MAlEhG,UAoEjBuE,QAAQC,IAAI+D,GApEK,yBAqEjBhE,QAAQC,IAAIoE,GArEK,yBAsEjBrE,QAAQC,IAAIyD,GAtEK,iCAuEhBvB,GAvEgB,4CAAH,8DCvGlBmC,GAAc,CAChBhJ,KAAM,UACNiJ,OAAQ,MACRC,UAAW,YACXC,YAAa,CAAC,WAAY,UAC1BC,aAAc,CAAC,WAAY,WAC3BC,QAAS,CACLC,SAAU,MAILC,GAAkB,SAAEC,GAC7B,OAAOC,QAAMF,gBAAN,2BAA0BP,IAAgBQ,KCbxCE,GAAYxG,YAAa,eACzByG,GAAezG,YAAa,kBAC5B0G,GAAc1G,YAAa,kBCiB3B2G,GAAU,uCAAG,WAAOxI,EAAOF,EAAU/B,EAAa0K,EAASC,GAA9C,mBAAA/K,EAAA,6DAChBoC,EADgB,aAElBhC,YAAaA,EACbY,KAAM,OACNqB,MAAOA,EACPC,QAAS,CAACH,GACVI,OAAQ,SACRC,WAAY,UACTsI,GARe,SAWC/F,GAAa3C,EAAQhC,GAXtB,UAWhB4K,EAXgB,OAWoC9K,MAEtD6K,EAbkB,iCAcOhG,EAAiB3E,GAdxB,QAcZ6K,EAdY,OAcsC/K,MAC9CgL,MAAMpH,KAAKkH,GACrBjG,EAAiBkG,EAAW7K,GAhBV,iCAkBf4K,GAlBe,4CAAH,8DAqBVG,GAAa,uCAAG,WAAOC,EAAM5H,EAAQpD,GAArB,eAAAJ,EAAA,6DACpBoL,EAAKlL,OAAOkL,EAAKlL,KAAO,IAC7BkL,EAAK7I,OAAS,SACd6I,EAAKlL,KAAKmL,UAAY,CAAC7H,UAHE,SAKEuB,EAAcqG,EAAMhL,EAAagL,EAAK1G,KALxC,cAKnB4G,EALmB,yBAMlBA,GANkB,2CAAH,0DAgCbC,GAAiB,uCAAG,WAAO/H,EAAQpD,EAAa0E,GAA5B,iBAAA9E,EAAA,sEACL+E,EAAavB,EAAQ,QADhB,cACvBgI,EADuB,gBAELzG,GAA0B3E,EAAaoD,GAFlC,OAEvBiI,EAFuB,OAG7B3G,EAAS8F,GAAY,CAACpH,SAAQtD,KAAM,CAACsL,YAAWC,gBAHnB,2CAAH,0DCjEjBC,GAAUxH,YAAa,YACvByH,GAAazH,YAAa,eAC1B0H,GAAW1H,YAAa,aACxB2H,GAAgB3H,YAAa,kBAC7B4H,GAAmB5H,YAAa,qBAChC6H,GAAiB7H,YAAa,mBAC9B8H,GAAe9H,YAAa,iBAC5B+H,GAAW/H,YAAa,mBACxBgI,GAAahI,YAAa,eAC1BiI,GAAsBjI,YAAa,yBACnCkI,GAAmBlI,YAAa,sBAChCmI,GAAgBnI,YAAa,kBAC7BoI,GAAuBpI,YAAa,0BACpCqI,GAAmBrI,YAAa,qBAChCsI,GAAetI,YAAa,kBAC5BuI,GAAcvI,YAAa,iBAC3BwI,GAAkBxI,YAAa,qBAC/ByI,GAAqBzI,YAAa,wBAClC0I,GAAe1I,YAAa,kBAC5B2I,GAAc3I,YAAa,iBAC3B4I,GAAc5I,YAAa,iBAC3B6I,GAAc7I,YAAa,gBAC3B8I,GAAwB9I,YAAa,4BACrC+I,GAAoB/I,YAAa,uBACjCgJ,GAAehJ,YAAa,kBAC5BiJ,GAAiBjJ,YAAa,qBAC9BkJ,GAAiBlJ,YAAa,oBAG9BmJ,GAAc/I,YAFT,CAACgJ,YAAa,GAAIC,UAAW,GAAIC,aAAc,GAAIhC,UAAW,GAAIiC,SAAU,GAAIxH,SAAU,GAAIyH,eAAgB,GAAIC,mBAAoB,GAAIlC,UAAW,GAAImC,QAAS,KAE5I,kBAAC,GACpClC,IAAU,SAACmC,EAAOrJ,GACfqJ,EAAMrJ,EAAOC,QAAQC,KAAOF,EAAOC,WAFH,YAAC,GAIpCkH,IAAa,SAACkC,EAAOrJ,GAAY,IAAD,EACvB4G,EAAOyC,EAAMrJ,EAAOC,gBACnBoJ,EAAMrJ,EAAOC,UACpB,OAAI2G,QAAJ,IAAIA,GAAJ,UAAIA,EAAMlL,YAAV,aAAI,EAAYmL,mBACLwC,EAAMD,QAAQxC,EAAKlL,KAAKmL,UAAU7H,WARb,YAAC,GAUpCoI,IAAW,SAACiC,EAAOrJ,GAChB,IAAI4G,EAAOyC,EAAMrJ,EAAOC,QAAQC,KAChCmJ,EAAMrJ,EAAOC,QAAQC,KAAOoJ,OAAOC,OAAO,GAAI3C,EAAM5G,EAAOC,YAZ3B,YAAC,GAcpCoH,IAAgB,SAACtH,EAAOC,GACVD,EAAMC,EAAOC,QAAQuJ,QAC3BV,YAAYxJ,KAAKU,EAAOC,QAAQwJ,WAAWvJ,KAChDH,EAAM+I,YAAY9I,EAAOC,QAAQwJ,WAAWvJ,KAAOF,EAAOC,QAAQwJ,cAjBlC,YAAC,GAmBpCnC,IAAmB,SAACvH,EAAOC,GACxB,IAAI4G,EAAO7G,EAAMC,EAAOC,QAAQuJ,QAChC5C,EAAKkC,YAAclC,EAAKkC,YAAYpM,QAAO,SAACgN,GAAD,OAASA,IAAQ1J,EAAOC,QAAQ0J,gBACpE5J,EAAM+I,YAAY9I,EAAOC,QAAQ0J,UAtBR,YAAC,GAwBpCpC,IAAiB,SAACxH,EAAOC,GACXD,EAAMC,EAAOC,QAAQ5B,WAC3ByK,YAAc9I,EAAOC,QAAQ6I,YAAYzH,KAAI,SAACqI,GAAD,OAASA,EAAIxJ,OAC/DF,EAAOC,QAAQ6I,YAAY3I,SAAQ,SAACuJ,GAChC3J,EAAM+I,YAAYY,EAAIxJ,KAAOwJ,QA5BD,YAAC,GA+BpClC,IAAe,SAACzH,EAAOC,GACTD,EAAMC,EAAOC,QAAQ5B,WAC3BuL,UAAY5J,EAAOC,QAAQ4J,MAjCA,YAAC,GAmCpCpC,IAAW,SAAC1H,EAAOC,GAChB,IAAI8J,EAAU/J,EAAMC,EAAOC,QAAQ5B,WACF,SAA7B2B,EAAOC,QAAQ1D,UACfuN,EAAQC,UAAY/J,EAAOC,QAAQxD,MAEnCqN,EAAQE,QAAUhK,EAAOC,QAAQxD,SAxCL,YAAC,GA2CpCiL,IAAa,SAAC3H,EAAOC,GACPD,EAAMC,EAAOC,QAAQ5B,WAC3B4L,QAAUjK,EAAOC,QAAQgK,WA7CE,YAAC,GA+CpCrC,IAAmB,SAAC7H,EAAOC,GACxB,IAAI8J,EAAU/J,EAAMC,EAAOC,QAAQ5B,WACnCyL,EAAQhM,QAAR,uBAAsBgM,EAAQhM,SAA9B,CAAuCkC,EAAOC,QAAQG,YAjDtB,YAAC,GAmDpCuH,IAAsB,SAAC5H,EAAOC,GAC3B,IAAI8J,EAAU/J,EAAMC,EAAOC,QAAQ5B,WACnCyL,EAAQhM,QAAUgM,EAAQhM,QAAQpB,QAAO,SAACwN,GAAD,OAAUA,IAASlK,EAAOC,QAAQG,aArD3C,YAAC,GAuDpCyH,IAAgB,SAAC9H,EAAOC,GACPD,EAAMC,EAAOC,QAAQ5B,WAC3B8L,MAAMnK,EAAOC,QAAQmK,WAAWlK,KAAOF,EAAOC,QAAQmK,cAzD9B,YAAC,GA2DpCtC,IAAuB,SAAC/H,EAAOC,GACdD,EAAMC,EAAOC,QAAQ5B,WAC5B,cAAoB2B,EAAOC,QAAQoK,SA7DV,YAAC,GA+DpCtC,IAAmB,SAAChI,EAAOC,UACVD,EAAMC,EAAOC,QAAQ5B,WACpB8L,MAAMnK,EAAOC,QAAQqK,WAjEJ,YAAC,GAmEpCtC,IAAe,SAACjI,EAAOC,GACpB,IAAM+I,EAAY,GAClB,IAAK,IAAI1J,KAAKW,EAAOC,QACjB8I,EAAU/I,EAAOC,QAAQZ,GAAGa,KAAOF,EAAOC,QAAQZ,GACtDU,EAAMgJ,UAAYA,KAvEc,YAAC,GAyEpCb,IAAkB,SAACnI,EAAOC,GACvBD,EAAMiJ,aAAehJ,EAAOC,WA1EI,YAAC,GA4EpCkI,IAAqB,SAACpI,EAAOC,GACtBA,EAAOC,QAAQsK,QACfxK,EAAMiJ,aAAa1J,KAAKU,EAAOC,QAAQuJ,QAEvCzJ,EAAMiJ,aAAejJ,EAAMiJ,aAAatM,QAAO,SAAA8F,GAAE,OAAIA,IAAOxC,EAAOC,QAAQuJ,aAhF/C,YAAC,GAmFpCvB,IAAc,SAAClI,EAAOC,GACnBD,EAAMgJ,UAAU/I,EAAOC,QAAQC,KAAOF,EAAOC,WApFb,YAAC,GAsFpC2I,IAAiB,SAAC7I,EAAOC,UACfD,EAAMgJ,UAAU/I,EAAOC,QAAQC,QAvFN,YAAC,GAyFpCkI,IAAe,SAACrI,EAAOC,GACpBD,EAAMiH,UAAYhH,EAAOC,WA1FO,YAAC,GA4FpCoI,IAAc,SAACtI,EAAOC,GAEM,IADPD,EAAMiH,UAAUtK,QAAO,SAACI,GAAD,OAAUA,EAAKoD,MAAQF,EAAOC,QAAQC,OACjEpF,OACViF,EAAMiH,UAAU1H,KAAKU,EAAOC,SAE5BF,EAAMiH,UAAYjH,EAAMiH,UAAU3F,KAAI,SAACvE,GAAD,OAAUA,EAAKoD,MAAQF,EAAOC,QAAQC,IAAMF,EAAOC,QAAUnD,QAjGvE,YAAC,GAoGpC6L,IAAiB,SAAC5I,EAAOC,GACtBD,EAAMiH,UAAYjH,EAAMiH,UAAUtK,QAAO,SAACI,GAAD,OAAUA,EAAKoD,MAAQF,EAAOC,QAAQC,UArG/C,YAAC,GAuGpCoI,IAAc,SAACvI,EAAOC,GACnBD,EAAMkJ,SAAWjJ,EAAOC,WAxGQ,YAAC,GA0GpCsI,IAAc,SAACxI,EAAOC,GACnBD,EAAM0B,SAAWzB,EAAOC,WA3GQ,YAAC,GA6GpCuI,IAAwB,SAACzI,EAAOC,GAC7BD,EAAMoJ,mBAAmBnJ,EAAOC,QAAQuJ,QAAxC,aAAsDxJ,EAAOC,QAAQoJ,UA9GrC,YAAC,GAiHpCZ,IAAoB,SAAC1I,EAAOC,GAGzBA,EAAOC,QAAQE,SAAQ,SAAAyG,GAAI,OAAI7G,EAAMmJ,eAAetC,EAAK1G,KAAO0G,QApHhC,YAAC,GAsHpC8B,IAAe,SAAC3I,EAAOC,GACpBD,EAAMkH,UAAYjH,EAAOC,WAvHO,YAAC,GAyHpCiG,IAAY,SAACnG,EAAOC,GACZD,EAAMqJ,QAAQpJ,EAAOC,WACtBF,EAAMqJ,QAAQpJ,EAAOC,SAAW,OA3HJ,YAAC,GA6HpCkG,IAAe,SAACpG,EAAOC,UACbD,EAAMqJ,QAAQpJ,EAAOC,YA9HI,YAAC,GAgIpCmG,IAAc,SAACrG,EAAOC,GACnBD,EAAMqJ,QAAQpJ,EAAOC,QAAQjB,QAA7B,2BAA2Ce,EAAMqJ,QAAQpJ,EAAOC,UAAaD,EAAOC,QAAQvE,SAjI5D,KAqI3B8O,GAAa,SAAC5O,EAAa+B,EAAU8M,EAAazN,EAAQ0N,GAEnE,GADKA,IAAWA,EAAU,KACtBD,GAAgBA,EAAYzM,WAAhC,CAIA,IAAI2M,EAAO,GACPF,GAA0C,YAA3BA,EAAYzM,YAC3B2M,EAAK3M,WAAayM,EAAYzM,WAC9B2M,EAAKC,MAAQH,EAAYG,MACzBD,EAAKE,cAAgBJ,EAAYI,gBAEjCF,EAAK3M,WAAa,YAClB2M,EAAKC,WAAQE,EACbH,EAAKE,cAAgB,IAEzB,IAGMjN,EAAS,CACXhC,YAAaA,EACbY,KAAM,OACNqB,MANQ4M,GAAeA,EAAY5M,MAAQ4M,EAAY5M,MAAQ,GAQ/DC,QAAS,CAACH,GACVI,OARS0M,GAAeA,EAAY1M,OAAS0M,EAAY1M,OAAS,UASlEC,WAAY2M,EAAK3M,WACjB4M,MAAOD,EAAKC,MACZC,cAAeF,EAAKE,cACpBnP,KAAM,CACFyD,KAAMsL,GAAeA,EAAYtL,KAAOsL,EAAYtL,KAAO,IAE/D4L,SAAU/N,EACVgO,WAAY,IAKhB,GAAIP,GAAeA,EAAYQ,MAAO,CAClCrN,EAAOqN,MAAQR,EAAYQ,MAC3B,IAAIC,EAAStN,EAAOE,QAAQ,GAC5B,GAAI2M,EAAYU,UAEZ,IADA,IAAIC,EAAKX,EAAYU,UAAUpG,MAAM,KAC5B1F,EAAI,EAAGA,EAAI+L,EAAGtQ,OAAQuE,IACvB+L,EAAG/L,KAAO6L,GACVtN,EAAOE,QAAQwB,KAAK8L,EAAG/L,IAI/BoL,EAAYY,YACZzN,EAAOyN,UAAYZ,EAAYY,WAEnCzN,EAAO0N,UAAY,CAACJ,GACpBtN,EAAO2N,YAAcd,EAAYc,YAGrC,OAAO3N,EArDH4N,OAAOC,MAAM,wBAwDRC,GAAU,SAACC,EAAM/P,EAAa+B,EAAUoN,GAA9B,OAA2C,SAAAzK,GAC9D,IAAMqK,EAAO,CAAE3M,WAAY2N,EAAK3N,WAAY4M,MAAOe,EAAKf,MAAOC,cAAec,EAAKd,eAE7Ee,EAAOpB,GAAW5O,EAAa+B,EAAUgN,EAAMI,GAErD,OAAOxK,EAAqB3E,EAAagQ,GAAM3M,MAAK,SAACgC,GACjD,IAAM2F,EAAI,aACNkC,YAAa,GACbiB,UAAW,GACXC,QAAS,GACTC,QAAS,GACTE,MAAO,GACPS,MAAO,MACJ3J,EAAIvF,MAINqP,GACDxK,EAAaoL,EAAKzL,IAAK0G,EAAK1G,IAAK,WAHzB,CAAE2L,EAAG,IAAKC,EAAG,MAOzBxL,EAAS4G,GAAQN,IAEjBtG,EAASqB,GAAW,CAChB9D,MAAO,WACPkO,cAAe,SACf1N,UAAWuI,EAAK1G,IAChB1D,KAAM,OACNwP,UAAU,UAqCTC,GAAc,SAACzC,GAAD,OAAY,SAAClJ,EAAU4L,GAC9C,IAAMnM,EAAQmM,IACd5L,EAASoL,GAAQ3L,EAAMoM,QAAQR,KAAM5L,EAAMoM,QAAQvQ,YAAamE,EAAMoM,QAAQ/L,OAAOF,IAAKsJ,MAUjF4C,GAAmB,SAAC/N,GAAD,8CAAe,WAAMiC,GAAN,iBAAA9E,EAAA,sEACnB+E,EAAalC,EAAW,OAAQ,UADb,cACrCgO,EADqC,gBAEjBnL,QAAQC,IAAIkL,EAAUhL,KAAI,SAACiL,GAAD,OAAY/L,EAAc+L,EAAOnP,QAF1C,OAErC2L,EAFqC,OAG3CxI,EAASiH,GAAe,CAAElJ,YAAWyK,iBAHM,2CAAf,uDAMnBnN,GAAmB,SAACmO,EAASyC,GAAV,8CAAuB,WAAOjM,EAAU4L,GAAjB,uBAAA1Q,EAAA,0DACnDsO,EAAUR,OAAOC,OAAO,GAAIO,IACpBpO,KAAO4N,OAAOC,OAAO,GAAIO,EAAQpO,MACpCoO,EAAQjM,MAHsC,uBAI/CkI,GAAgB,CAAElI,MAAO,qBAAsBrB,KAAM,SAAUgQ,QAAS,sBAJzB,6BAS9B,SAAjB1C,EAAQtN,KATuC,wBAYzCiQ,EAA+B,WAAnB3C,EAAQ/L,OAC1B+L,EAAQ/L,OAAS,SAb8B,UAc9BsG,GAAYyF,EAAQpO,KAAKyD,KAAM2K,EAAQ5J,IAAK4J,EAAQE,QAASF,EAAQC,WAdvC,eAczC1G,EAdyC,OAgBzCL,EAAOK,EAAGe,OACVsI,EAAY5C,EAAQpO,KAAKyD,KAC/B2K,EAAQpO,KAAKyD,KAAO6D,EAlB2B,UAmBzBzC,EAAcuJ,EAASA,EAAQlO,YAAakO,EAAQ5J,KAnB3B,SAmBzCwL,EAnByC,QAoBvChQ,KAAKyD,KAAOuN,EACpBpM,EAAS2H,GAAYyD,SAEJZ,IAAbyB,GACAjM,EAASsB,GAAY2K,IACpBE,GACDnM,EAASqM,GAAcjB,EAAQ9P,cAEnC0E,EAAS6G,GAAW2C,EAAQ5J,MA5BmB,+BA8B/C4J,EAAQ/L,OAAS,SA9B8B,UA+BxCwC,EAAcuJ,EAASA,EAAQlO,YAAakO,EAAQ5J,KA/BZ,aAgC9B4K,IAAbyB,IACAjM,EAASsB,GAAY2K,IACrBjM,EAAS6G,GAAW2C,EAAQ5J,OAlCe,QAsCnD6F,GAAgB,CAAElI,MAAO,SAAUrB,KAAM,UAAWgQ,QAAS,0BAtCV,4CAAvB,yDAyCnBI,GAAa,SAACvO,EAAW9B,GAAZ,8CAA0B,WAAO+D,GAAP,iBAAA9E,EAAA,sEAC5B+E,EAAalC,EAAW9B,GADI,OAC1CE,EAD0C,OAEhD6D,EAASmH,GAAS,CAAEpJ,YAAW9B,YAAWE,WAExB,OAAdF,IACMsQ,EAAWpQ,EAAMC,QAAO,SAACI,GAAD,MAAwB,aAAdA,EAAKN,QAAqB,GAClE8D,EAAS+H,GAAYwE,KANuB,2CAA1B,uDAUbC,GAAe,SAACzO,GAAD,8CAAe,WAAOiC,EAAU4L,GAAjB,mBAAA1Q,EAAA,6DACjCsC,EAAUoO,IAAWa,MADY,SAEjBxM,EAAelC,GAFE,OAEjC4L,EAFiC,OAGjC+C,EAAY,IAAIC,KAAKC,eAAe,UAAWC,IACrDlD,EAAQ9J,SAAQ,SAACiN,GACb,GAAItP,EAAQsP,EAAOzP,UAAW,CAC1B,IAAMyC,EAAStC,EAAQsP,EAAOzP,UAC9ByP,EAAM,OAAN,UAAsBhN,EAAOiN,UAA7B,YAA0CjN,EAAOkN,eAEjDF,EAAM,OAAa,KAEvBA,EAAM,KAAWJ,EAAUO,OAAO,IAAIC,KAAKJ,EAAOK,eAEtDnN,EAASoH,GAAW,CAAErJ,YAAW4L,aAbM,2CAAf,yDAgBfyD,GAAmB,SAACrP,GAAD,8CAAe,WAAOiC,EAAU4L,GAAjB,iCAAA1Q,EAAA,sEAErB+E,EAAclC,GAFO,UAErCyL,EAFqC,OAGrC1J,EAAS8L,IAAWC,QAAQ/L,OACb,SAAjB0J,EAAQtN,KAJ+B,iCAKJ0E,QAAQC,IAAI,CAC3CZ,EAAalC,EAAW,QACxBkC,EAAalC,EAAW,QAPW,0CAKhC0L,EALgC,KAKrBC,EALqB,KAQjCpD,EARiC,aAQxBkC,YAAa,GAAIiB,YAAWC,UAASC,QAAS,GAAIE,MAAO,IAAOL,GACzE6D,EAAW1K,GAAW2D,EAAKlL,KAAKyD,KAAM6K,EAASD,GACrDnD,EAAKlL,KAAKyD,KAAOwO,EACjBrN,EAAS4G,GAAQN,IAEbA,EAAKlL,KAAKmL,YACVvG,EAAS4F,GAAUU,EAAKlL,KAAKmL,UAAU7H,SACvC+H,GAAkBH,EAAKlL,KAAKmL,UAAU7H,OAAQ4H,EAAKhL,YAAa0E,IAEpEA,EAAS8L,GAAiB/N,IAC1BiC,EAASqB,GAAW,CAChB9D,MAAO,YACPkO,cAAe,OACf1N,UAAWuI,EAAK1G,IAChB1D,KAAM,OACNwP,SAAU5L,IAAWwG,EAAK9I,QAAQ0D,SAASpB,EAAOF,MAAwB,YAAhBE,EAAOwN,MACjEC,SAAS,KAGPC,EAAY9D,EAAQtN,QAAO,SAACI,GAAD,MAAwB,cAAdA,EAAKN,QA3BT,UA6Bb0E,QAAQC,IAC9B2M,EAAUzM,KAAI,SAAC0M,GAAD,OACVxN,EAAcwN,EAAQ7Q,MAAM+B,MAAK,SAAA+O,GAG7B,OAFAA,EAAKtS,KAAKmB,OAASkR,EAAQ7N,IAC3B8N,EAAKtS,KAAKuS,QAAUD,EAAK9N,IAClB8N,SAlCoB,eAuC3B7N,SAAQ,SAAC+N,GAAD,OAAW5N,EAASuH,GAAc,CAAEuC,WAAY8D,EAAO7P,kBAC3EiC,EAASwH,GAAqB,CAAEzJ,YAAWgM,MAAO,KAxCX,wBA0CjCZ,EA1CiC,aA0ClBQ,QAAS,IAAQH,GACtCxJ,EAAS4G,GAAQuC,IAEjBnJ,EAASqB,GAAW,CAChB9D,MAAM,QAAD,OAAUiM,EAAQtN,MACvBuP,cAAe,OACf1N,UAAWyL,EAAQ5J,IACnB1D,KAAMsN,EAAQtN,KACdwP,SAAU5L,IAAW0J,EAAQhM,QAAQ0D,SAASpB,EAAOF,MAAwB,YAAhBE,EAAOwN,MACpEC,SAAS,KAnD0B,eAsD3CM,QAAQC,IAAItE,GAEW,WAAnBA,EAAQ/L,SR3UKnC,EQ4UJkO,EAAQlO,YR5USU,EQ4UIwN,EAAQ5J,IR3UnChF,IAAMY,KAAN,UAAcrB,EAAd,yBAAqCmB,EAArC,YAAoDU,KQkRhB,qDRnR3B,IAACV,EAAaU,IQmRa,OAAf,yDA6FnB+R,GAAiB,SAACrP,GAAD,8CAAY,WAAOsB,GAAP,mBAAA9E,EAAA,sEACjB+E,EAAavB,EAAQ,QADJ,cAChCvC,EADgC,OAEhC6R,EAAY7R,EACbC,QAAO,SAAAb,GAAG,MAAsB,SAAjBA,EAAIsI,IAAI3H,MAAqC,KAAlBX,EAAIsI,IAAItG,OAAmC,WAAnBhC,EAAIsI,IAAIpG,UAE/EuC,EAAS8H,GAAa3L,IALgB,SAMlByE,QAAQC,IAAImN,EAAUjN,KAAI,SAACkN,GAAD,OAAiBhO,EAAcgO,EAAYpR,QANnD,OAMhCkM,EANgC,OAQtC/I,EAAS0H,GAAaqB,IAGtBA,EAAMlJ,QAAN,uCAAc,WAAMyG,GAAN,mBAAApL,EAAA,0DACNoL,EAAKlL,OAAQkL,EAAKlL,KAAKmL,UADjB,wBAGF7H,EAAS4H,EAAKlL,KAAKmL,UAAU7H,OAH3B,SAI0BuB,EAAavB,EAAQ,QAJ/C,cAIAwP,EAJA,OAKC9R,QAAO,SAAAb,GAAG,MAAsB,SAAjBA,EAAIsI,IAAI3H,MAAqC,KAAlBX,EAAIsI,IAAItG,OAAmC,WAAnBhC,EAAIsI,IAAIpG,UAAsBsD,KAAI,SAAAoN,GAAG,OAAIA,EAAItR,MALhH,SAMuB+D,QAAQC,IAAIqN,EAAiBnN,KAAI,SAACmI,GAAD,OAAYjJ,EAAciJ,OANlF,OAMAN,EANA,OAYN5I,EAASmI,GAAkBS,IAC3B5I,EAASkI,GAAsB,CAACgB,OAAQ5C,EAAK1G,IAAKmJ,MAAOmF,KAbnD,4CAAd,uDAXsC,4CAAZ,uDA8BjB7B,GAAgB,SAAC/Q,GAAD,8CAAiB,WAAO0E,GAAP,iBAAA9E,EAAA,sEAChB+E,EAAgB3E,EAAa,CAAE,KAAQ,aADvB,OAE1C8S,GADIA,EADsC,QAEZC,UACxBC,EAAkBF,EAAchS,QAClC,SAACb,GAAD,MACsB,SAAjBA,EAAIsI,IAAI3H,MAAsC,WAAnBX,EAAIsI,IAAIpG,QAA0C,SAAnBlC,EAAImI,MAAMxH,MAAwC,WAArBX,EAAImI,MAAMjG,UAE1GuC,EAASgI,GAAYsG,IAPqB,2CAAjB,uDAUhBC,GAAgB,SAACjT,GAAD,8CAAiB,WAAO0E,GAAP,eAAA9E,EAAA,sEACrB+E,EAAgB3E,EAAa,CAAE,KAAQ,aADlB,OACtC6F,EADsC,OAE1CnB,EAASiI,GAAY9G,IAFqB,2CAAjB,uDAchBqN,GAAiB,SAAClT,EAAaoD,GAAd,8CAAyB,WAAOsB,GAAP,eAAA9E,EAAA,sEAC3B+E,GAA0B3E,EAAaoD,GADZ,OAC7CiI,EAD6C,OAEnD3G,EAASoI,GAAazB,IAF6B,2CAAzB,uDC1gBjB8H,GAAiBrP,YAAa,aAC9BsP,GAAsBtP,YAAa,0BACnCuP,GAAevP,YAAa,iBAC5BwP,GAAiBxP,YAAa,oBAC9ByP,GAAmBzP,YAAa,sBAChC0P,GAAY1P,YAAa,eACzB2P,GAAgB3P,YAAa,cAC7B4P,GAAU5P,YAAa,YACvB6P,GAAY7P,YAAa,cACzB8P,GAAW9P,YAAa,aACxB+P,GAAgB/P,YAAa,kBAC7BgQ,GAAYhQ,YAAa,cACzBiQ,GAAqBjQ,YAAa,uBAClCkQ,GAAiBlQ,YAAa,mBAC9BmQ,GAAqBnQ,YAAa,wBAClCoQ,GAAiBpQ,YAAa,oBAC9BqQ,GAAkBrQ,YAAa,qBAC/BsQ,GAAkBtQ,YAAa,qBAC/ByN,GAAoB,CAC7B8C,KAAM,UAAWC,MAAO,UAAWC,IAAK,UACxCC,KAAM,UAAWC,OAAQ,UAAWC,OAAQ,UAC5CC,QAAQ,GAGNC,GAAY,CACdvV,MAAOK,eAAed,QAAQ,SAC9BiW,iBAAkB,QAClB7U,YAAa,KACb8U,cAAe,KACf1R,OAAQ,KACR+B,UAAW,GACX4P,KAAM,KACNhF,KAAM,KACNjF,MAAO,GACPD,UAAW,KACXmK,OAAQ,GACRC,kBAAiBvV,eAAed,QAAQ,SACxCsW,YAAa,GACbC,gBAAiB,GACjBC,YAAa,GACbC,aAAc,QACdC,QAAS,CACL,CACI1O,GAAI,EACJ2O,IAAK,eACL9G,MAAO,wBAGX,CACI7H,GAAI,EACJ2O,IAAK,qBACL9G,MAAO,8BAGX,CACI7H,GAAI,EACJ2O,IAAK,2BACL9G,MAAO,oCAGX,CACI7H,GAAI,EACJ2O,IAAK,oBACL9G,MAAO,6BAGX,CACI7H,GAAI,EACJ2O,IAAK,oBACL9G,MAAO,+BAUf+G,cAAc,GAGLC,GAAiBvR,YAAc0Q,IAAD,kBAAC,GACvCzB,IAAiB,SAAChP,EAAOC,GACtBD,EAAM9E,MAAQ+E,EAAOC,QACrBF,EAAM8Q,kBAAkB9Q,EAAM9E,SAHK,YAAC,GAKvC0U,IAAqB,SAAC5P,EAAOC,GAC1BD,EAAM8Q,kBAAkB9Q,EAAM9E,SANK,YAAC,GAQvC+T,IAAsB,SAACjP,EAAOC,GAC3BD,EAAM0Q,iBAAmBzQ,EAAOC,WATG,YAAC,GAWvCiP,IAAiB,SAACnP,EAAOC,GACtBD,EAAMnE,YAAcoE,EAAOC,WAZQ,YAAC,GAcvCkP,IAAmB,SAACpP,EAAOC,GACxBD,EAAM2Q,cAAgB1Q,EAAOC,WAfM,YAAC,GAiBvCmP,IAAY,SAACrP,EAAOC,GACjBD,EAAMf,OAASgB,EAAOC,WAlBa,YAAC,GAoBvCyP,IAAY,SAAC3P,EAAOC,GACjBD,EAAM6Q,OAAS5Q,EAAOC,WArBa,YAAC,GAuBvCoP,IAAgB,SAACtP,EAAOC,GACrBD,EAAM4Q,KAAO3Q,EAAOC,WAxBe,YAAC,GA0BvCqP,IAAU,SAACvP,EAAOC,GACfD,EAAM4L,KAAO3L,EAAOC,WA3Be,YAAC,GA6BvCuP,IAAW,SAACzP,EAAOC,GAChBD,EAAM2G,MAAQ1G,EAAOC,WA9Bc,YAAC,GAgCvCgP,IAAe,SAAClP,EAAOC,GACpBD,EAAM0G,UAAYzG,EAAOC,QACzBF,EAAMnE,YAAcoE,EAAOC,QAAQC,IACnCH,EAAMgB,UAAYf,EAAOC,QAAQqR,iBAnCE,YAAC,GAqCvC7B,IAAgB,SAAC1P,EAAOC,GACrBD,EAAM0G,UAAN,2BAAuB1G,EAAM0G,WAAczG,EAAOC,YAtCf,YAAC,GAwCvC2P,IAAiB,SAAC7P,EAAOC,GACtBD,EAAM+Q,YAAc9Q,EAAOC,WAzCQ,YAAC,GA2CvC4P,IAAqB,SAAC9P,EAAOC,GAC1BD,EAAMgR,gBAAkB/Q,EAAOC,WA5CI,YAAC,GA8CvC6P,IAAiB,SAAC/P,EAAOC,GACtBD,EAAMiR,YAAchR,EAAOC,WA/CQ,YAAC,GAiDvC8P,IAAkB,SAAChQ,EAAOC,GACvBD,EAAMkR,aAAejR,EAAOC,WAlDO,YAAC,GAoDvCsP,IAAY,SAACxP,EAAOC,GACjBD,EAAMK,OAASJ,EAAOC,WArDa,YAAC,GAuDvC+P,IAAkB,SAACjQ,EAAOC,GACvBD,EAAMqR,aAAepR,EAAOC,WAxDO,KA4D9BsR,GAAc,SAAC3V,GACxB,OAAO,SAAA0E,GACH,OTpBiB,SAAC1E,GACtB,OAAOV,IAAMO,IAAN,UAAahB,EAAb,oBAA+BmB,EAA/B,QSmBI4V,CAAU5V,GAAaqD,MAAK,SAAAgC,GAC/BX,EAASiP,GAAUtO,EAAIvF,YAoCtB+V,GAAkB,SAAC7V,GAAD,8CAAiB,WAAO0E,GAAP,eAAA9E,EAAA,sEACvBW,EAAUP,GADa,OACtC8V,EADsC,OAE5CpR,EAASmP,GAAc,CAAEiC,YAFmB,2CAAjB,uDAKlBC,GAAkB,yDAAM,WAAOrR,GAAP,eAAA9E,EAAA,+EAEVD,IAFU,OAEvBoV,EAFuB,OAG7BrQ,EAASoP,GAAUiB,EAAKzQ,MACxBI,EAAS+O,GAAcsB,IAJM,gDAM7BrV,eAAesW,QACfrX,aAAaqX,QACbpG,OAAOqG,SAASC,QAAQ,KARK,yDAAN,uDAYlBC,GAAsB,SAACnW,GAAD,8CAAiB,WAAO0E,GAAP,eAAA9E,EAAA,sEAC5BY,EAAkBR,GADU,OAC1C8K,EAD0C,OAEhDpG,EAASkP,GAAS9I,IAF8B,2CAAjB,uDAKtBsL,GAAyB,SAAChT,GAAD,8CAAY,WAAOsB,GAAP,mBAAA9E,EAAA,6DAC9C8E,EAAS4H,GAAgB,KACzB5H,EAAS8O,GAAUpQ,IAF2B,SAG3BxB,EAAUwB,GAHiB,cAGxC2M,EAHwC,OAIxCsG,EAAStG,EAAK/P,YACpB0E,EAASgP,GAAQ3D,IACjBrL,EAAS+N,GAAe1C,EAAKzL,MANiB,UAOrBnE,EAAakW,GAPQ,QAOxCxL,EAPwC,OAOC/K,KAC/C4E,EAAS2O,GAAa,aAChByC,OAAQ,IAAOjL,KAErBnG,EAASqM,GAAcsF,IACvB3R,EAASiR,GAAYU,IACrB3R,EAASyR,GAAoBE,IAC7B3R,EAASD,GAAa4R,IACtB3R,EAASwO,GAAemD,EAAQtG,EAAKzL,MACrCI,EAASQ,GAAemR,EAAQxL,EAAU6K,gBAC1ChR,EAASuO,GAAcoD,IAjBuB,4CAAZ,uD,kBCrL/B,SAASC,GAAuBC,EAAUC,EAAUzX,GACzD,IAAIwE,EAAO,CACT,SAAYgT,EACZ,SAAYC,GAGd,OAAOC,MAAM1X,EAAS,aAAc,CAClC2X,OAAQ,OACRlX,QAAS,CAAC,eAAgB,oBAC1B+D,KAAMoT,KAAKC,UAAUrT,KACpBF,MAAK,SAASwT,GAKb,OAJuB,MAApBA,EAAS1U,SACVoQ,QAAQC,IAAI,UAAYzT,EAAS,cACjCwT,QAAQC,IAAIqE,IAEPA,EAASC,UACjBzT,MAAK,SAASE,GACb,MAAO,CAACA,EAAMxE,MACf4E,OAAM,SAASC,GAGd,OAFA2O,QAAQC,IAAI,UAAYzT,EAAS,cACjCwT,QAAQC,IAAI5O,GACL,CAAC,CAACA,MAAO,6BAA8B7E,MC5C7C,IAAMgY,GAAU,CACrB,CAACC,KAAK,aAActY,IAAI,+BACxB,CAACsY,KAAK,eAAgBtY,IAAI,qCAC1B,CAACsY,KAAK,OAAQtY,IAAI,yBAClB,CAACsY,KAAK,SAAUtY,IAAI,+BACpB,CAACsY,KAAK,YAAatY,IAAI,+BAYlB,SAASuY,GAAcvY,GAC5B,IAAI,IAAI+E,KAAKsT,GACX,GAAGA,GAAQtT,GAAG/E,MAAQA,EAAM,OAAOqY,GAAQtT,GAAGuT,KAGhD,MAAO,iBAAmBtY,EAAM,kBAK3B,SAASwY,GAAaF,GAC3B,IAAI,IAAIvT,KAAKsT,GACX,GAAGA,GAAQtT,GAAGuT,OAASA,EAAO,OAAOD,GAAQtT,GAAG/E,IAGlD,MAAO,iBAAmBsY,EAAO,kBAK5B,SAASG,GAAwBpY,GACtC,IAAIqY,EAAQzY,aAAaC,QAAQ,YAC7BkB,EAAO6W,KAAKU,MAAM1Y,aAAaC,QAAQwY,IAE3C,IAAK,IAAI3T,KAAK3D,EACZ,GAAIA,EAAK2D,GAAG,KAAO1E,EACjB,OAAOe,EAAK2D,GAAG,GCvCd,SAAS6T,GAAgBF,EAAOG,EAAKC,GAC1C,IAAMC,EAAW,GAGAC,SAASC,eAAe,mBAAmBhJ,SAC5ChQ,aAAaqX,QAE7B,IAAI4B,EAAcjB,KAAKU,MAAM1Y,aAAaC,QAAQwY,IAIlD,GAAkB,MAAfQ,EACD,IAAI,IAAInU,KAAKsT,GACXU,EAAS/T,KAAK4S,GAAuBc,EAAOG,EAAKR,GAAQtT,GAAG/E,WAG9D,IAAI,IAAI+E,KAAKmU,EACXH,EAAS/T,KAAK4S,GAAuBc,EAAOG,EAAKK,EAAYnU,GAAG,KAKpE,OAAO6B,QAAQC,IAAIkS,GAAUpU,MAAK,SAASvD,GACzC,OAWG,SAAyBsX,EAAOtX,EAAM0X,GAC3C,IAAIK,GAAkB,EAClBC,EAAe,GACfC,EAAkB,GAIlBH,EAAcjB,KAAKU,MAAM1Y,aAAaC,QAAQwY,IAElD,IAAI,IAAI3T,KAAK3D,EACX,QAAwBoP,IAArBpP,EAAK2D,GAAG,GAAGpE,MAAqB,CACjC,IAAIA,EAAQS,EAAK2D,GAAG,GAAGpE,MACnBN,EAASe,EAAK2D,GAAG,GAEjBuU,EAAiC,OAAhBJ,GAAwBA,EAAYnU,GAAG,GAAKmU,EAAYnU,GAAG,GAAK,CAACgL,MAAO,UAAWwJ,MAAO,WAE3F,OAAhBL,IAA4C,IAApBC,GAA+C,OAAhBD,GAA8C,WAAtBA,EAAYnU,GAAG,GAChGsU,EAAgBrU,KAAK,CAAC3E,EAAQM,EAAO,SAAU2Y,IAE/CD,EAAgBrU,KAAK,CAAC3E,EAAQM,EAAO,WAAY2Y,IAGnDH,GAAkB,MAGb,SAA0B3I,IAAvBpP,EAAK2D,GAAG,GAAGmN,SAAyC,OAAhBgH,EAAqB,CACjE,IAAIrB,EAAWmB,SAASC,eAAe,SAASlJ,MAC5C+H,EAAWkB,SAASC,eAAe,OAAOlJ,MAE9C,OADA9P,aAAauZ,WAAW3B,GACjBe,GAAgBf,EAAUC,EAAUgB,QACZtI,IAAvBpP,EAAK2D,GAAG,GAAGmN,SAA0C,KAAjBkH,GAEnB,qCAAjBA,GAA8E,kCAAvBhY,EAAK2D,GAAG,GAAGmN,QAD1EkH,EAAehY,EAAK2D,GAAG,GAAGmN,aAGG1B,IAArBpP,EAAK2D,GAAG,GAAGG,OAAwC,KAAjBkU,IAC1CA,EAAehY,EAAK2D,GAAG,GAAGG,OAI9B,OAAIiU,GAKFlZ,aAAaQ,QAAQ,WAAYiY,GACjCzY,aAAaQ,QAAQiY,EAAOT,KAAKC,UAAUmB,IACpC,IANPL,SAASC,eAAe,gBAAgBQ,MAAMC,QAAU,UACxDZ,EAAqBa,SAAS,CAACP,aAAcA,IACtC,GArDAQ,CAAgBlB,EAAOtX,EAAM0X,MACnC7T,OAAM,SAASC,GAChB2O,QAAQC,IAAI5O,MA2DT,SAAS2U,KACZ,IAAMnB,EAAQzY,aAAaC,QAAQ,YACnC,GAAIwY,EAAM,CACN,IADM,EACA9B,EAAUqB,KAAKU,MAAM1Y,aAAaC,QAAQwY,IAD1C,eAEiB9B,GAFjB,IAEN,IAAI,EAAJ,qBAA+B,CAAC,IAAxBkD,EAAuB,QAC3B,GAAuB,WAAnBA,EAAY,IAAsC,KAAnBA,EAAY,GAC3C,OAAOA,GAJT,+BAQV,MAAO,CAAC,KAAK,KAAK,KAAK,M,WC3FrBC,G,kDACJ,WAAYC,GAAQ,IAAD,8BACjB,cAAMA,IASRC,mBAAqB,SAACC,GACpB,IAAI5B,EAAO4B,EAAMC,OAAO7B,KACpB8B,EAAMF,EAAMC,OAAOpK,MAEvB,EAAK4J,SAAL,eAAgBrB,EAAQ8B,KAdP,EAiBnBC,kBAAoB,SAACH,GACnBA,EAAMI,iBACN,IAAI5B,EAAQ,EAAKjT,MAAMiT,MACnBG,EAAM,EAAKpT,MAAMoT,IAQrB,OAPAG,SAASC,eAAe,gBAAgBQ,MAAMC,QAAU,SACxDd,GAAgBF,EAAOG,EAAR,gBAAmBlU,MAAK,SAACC,GACxB,IAAXA,IACD,EAAKoV,MAAMvF,eAAeoF,KAAe,IACzC,EAAKG,MAAMO,QAAQvV,KAAK,mBAGrB,GA5BU,EA+BnBwV,eAAiB,SAACN,GAChB,EAAKF,MAAMtF,oBAAoB,WA7B/B,EAAKjP,MAAQ,CACXiT,MAAO,KACPG,IAAK,KACLO,aAAc,MANC,E,gEAqCjBpQ,KAAE,2BAA2ByR,UAC7BzR,KAAE,2BAA2B0R,UAC1B1R,KAAEkI,QAAQyJ,SAAW,KACtB3B,SAASC,eAAe,WAAW2B,aAAa,eAAgB,W,+BAKlE,OACE,yBAAKC,UAAY,sBACf,yBAAKA,UAAa,mDAChB,kDACA,0BAAMC,SAAUC,KAAKV,kBAAmBQ,UAAY,YAAY3S,GAAK,YAAY8S,aAAa,MAE5F,yBAAKH,UAAY,uBACf,uBAAGA,UAAU,gBACb,2BAAO3Y,KAAK,OAAOgG,GAAG,QAAQoQ,KAAK,QAAQ2C,YAAY,WAAWC,UAAQ,EAACC,SAAUJ,KAAKd,sBAG5F,yBAAKY,UAAY,uBACf,uBAAGA,UAAU,gBACb,2BAAO3Y,KAAK,WAAWgG,GAAG,MAAMoQ,KAAK,MAAM2C,YAAY,WAAWC,UAAQ,EAACC,SAAUJ,KAAKd,sBAG5F,yBAAKY,UAAY,0BACf,2BAAO3Y,KAAK,WAAWgG,GAAG,kBAAkBoQ,KAAK,oBACjD,2BAAO8C,QAAQ,mBAAf,gCACA,0BAAMlT,GAAG,UAAUmT,SAAS,IAAI/H,KAAK,SAASgI,cAAY,UACxDC,eAAa,QAAQC,eAAa,oGACpC,uBAAGX,UAAU,6BAGf,6BACE,uBAAGpB,MAAO,CAACC,QAAQ,SAAS+B,MAAM,OAAQvT,GAAK,eAAeoQ,KAAK,gBAAgByC,KAAKtV,MAAM2T,eAGhG,2BAAOyB,UAAY,eAAe3Y,KAAK,SAAS6N,MAAM,WAIxD,uBAAG8K,UAAU,yBAAyBa,QAASX,KAAKP,gBAApD,kCAAmG,uBAAGK,UAAU,yC,GA9ElGc,aAsFlBC,GAAqB,CACvBnH,kBACAC,wBAGWmH,eACXC,IACAC,YAAQ,KAAMH,IAFHC,CAGb9B,I,mBC3FIiC,I,yDACJ,WAAYhC,GAAQ,IAAD,8BACjB,cAAMA,IAkBRC,mBAAqB,SAACC,GACpB,IAAI5B,EAAO4B,EAAMC,OAAO7B,KACpB8B,EAAMF,EAAMC,OAAOpK,MAEvB,EAAK4J,SAAL,eAAgBrB,EAAQ8B,KAvBP,EA0BnB6B,oBAAsB,SAAC/B,GACrBA,EAAMnK,QAAUyI,GAAa,aAAe,EAAKmB,SAAS,CAACuC,mBAAmB,IAAS,EAAKvC,SAAS,CAACuC,mBAAmB,IACzH,EAAKvC,SAAS,CAACtZ,OAAQ6Z,EAAMnK,SA5BZ,EA+BnBsK,kBAAoB,SAACH,GAuBnB,OAtBAA,EAAMI,iBACmB,OAAtB,EAAK7U,MAAMpF,OACZ,EAAKsZ,SAAS,CAACP,aAAc,6BAC4C,IAAjE,mCAAmC+C,KAAK,EAAK1W,MAAMoS,UAC3D,EAAK8B,SAAS,CAACP,aAAc,CAAC,iDAAkD,6BAAQ,yBAA0B,6BAClH,kCAAmC,6BAAQ,qDACnC,EAAK3T,MAAMqS,WAAa,EAAKrS,MAAM2W,gBAC3C,EAAKzC,SAAS,CAACP,aAAc,4BJ6C5B,SAAqB/Y,EAAQgc,EAAWC,EAAUC,EAAO1E,EAAUC,EAAU0E,GAClF,IAAI3X,EAqBJ,OAnBEA,EADqB,OAApB2X,EACM,CACL,MAASD,EACT,UAAaF,EACb,SAAYC,EACZ,SAAYxE,EACZ,SAAYD,GAGP,CACL,MAAS0E,EACT,UAAaF,EACb,SAAYC,EACZ,SAAYxE,EACZ,gBAAmB0E,EACnB,SAAY3E,GAKTE,MAAM1X,EAAS,YAAa,CACjC2X,OAAQ,OACRlX,QAAS,CACP,eAAgB,oBAElB+D,KAAMoT,KAAKC,UAAUrT,KACpBF,MAAK,SAASwT,GAKf,OAJuB,MAApBA,EAAS1U,SACVoQ,QAAQC,IAAI,UAAYzT,EAAS,aACjCwT,QAAQC,IAAIqE,IAEPA,EAASC,UACfzT,MAAK,SAASE,GACf,MAAO,CAACA,EAAMxE,MACb4E,OAAM,SAASC,GAChB,MAAO,CAAC,CAACA,MAAO,6BAA8B7E,MIhF5Coc,CAAY,EAAKhX,MAAMpF,OAAQ,EAAKoF,MAAM4W,UAAW,EAAK5W,MAAM6W,SAAU,EAAK7W,MAAM8W,MAAO,EAAK9W,MAAMoS,SAAU,EAAKpS,MAAMqS,SAAU,EAAKrS,MAAM+W,iBAAiB7X,MAAK,SAACC,GACtK,GAAGA,EAAO,SAA0B4L,IAApB5L,EAAO,GAAGjE,MACxBV,aAAaQ,QAAQ,WAAY,EAAKgF,MAAMoS,UAC5C5X,aAAaQ,QAAQ,EAAKgF,MAAMoS,SAAUI,KAAKC,UAAU,CAAC,CAACtT,EAAO,GAAIA,EAAO,GAAGjE,MAAO,aACvF,EAAKqZ,MAAMvF,eAAe7P,EAAO,GAAGjE,OACpC,EAAKqZ,MAAMO,QAAQvV,KAAK,kBACnB,CACL,IAAI0X,EAAqB9X,EAAO,GAAGsN,SAAWtN,EAAO,GAAGM,OAASN,EAAO,GAAG+X,WAAa/X,EAAO,GAC/F,EAAK+U,SAAS,CAACP,aAAcsD,SAK5B,GAtDU,EAyDnBE,cAAgB,SAAC1C,GACf,EAAKF,MAAMtF,oBAAoB,UA1Dd,EA6DnBmI,gBAAkB,SAAC3C,GACP,OAAVA,EAAiB,EAAKP,SAAS,CAACmD,mBAAmB,IAAU,EAAKnD,SAAS,CAACmD,mBAAmB,KA3D/F,EAAKrX,MAAQ,CACXpF,OAAQ,KACRgc,UAAW,KACXC,SAAU,KACVC,MAAO,KACP1E,SAAU,KACVC,SAAU,KACVsE,gBAAiB,KACjBI,gBAAiB,KACjBpD,aAAc,KACd8C,mBAAmB,EACnBY,mBAAmB,GAdJ,E,qDAkEjB,IAAIC,EAOAC,EAOJ,OAZED,EADChC,KAAKtV,MAAMyW,kBACe,yBAAKrB,UAAY,uBAAsB,uBAAGA,UAAU,gBAAkB,2BAAO3Y,KAAK,OAAOgG,GAAG,kBAAkBoQ,KAAK,kBAAkB2C,YAAY,iCAAiCC,UAAQ,EAACC,SAAUJ,KAAKd,sBAE1M,kBAAC,KAAD,CAAWgD,QHnErB,2CGmEuC9B,SAAUJ,KAAK8B,kBAKvEG,GADmC,IAAjCjC,KAAKtV,MAAMqX,oBAA+B/B,KAAKtV,MAAMyW,mBAAuBnB,KAAKtV,MAAMyW,mBAAoD,OAA/BnB,KAAKtV,MAAM+W,gBAC1G,2BAAO3B,UAAY,eAAe3Y,KAAK,SAAS6N,MAAM,mBAEtD,2BAAO8K,UAAY,8BAA8B3Y,KAAK,SAAS6N,MAAM,iBAAiBmN,UAAQ,IAI7G,yBAAKrC,UAAY,sBACf,yBAAKA,UAAa,mDAChB,kDACA,0BAAMC,SAAUC,KAAKV,kBAAmBQ,UAAY,YAAY3S,GAAK,YAAY8S,aAAa,MAE5F,yBAAKH,UAAU,4CACb,uBAAGA,UAAU,kBACb,yBAAKA,UAAU,oBACb,kBAAC,KAAD,CACEI,YAAa,kBACbjP,QAASqM,GAAQtR,KAAI,SAACoW,GAAD,MAAQ,CAACpN,MAAOoN,EAAEnd,IAAKuZ,MAAO4D,EAAE7E,SACrD6C,SAAYJ,KAAKkB,oBACjBpB,UAAU,qBACVuC,gBAAgB,YAGpB,yBAAKvC,UAAU,cAGjB,yBAAKA,UAAY,uBACf,uBAAGA,UAAU,gBACb,2BAAO3Y,KAAK,OAAOgG,GAAG,YAAYoQ,KAAK,YAAY2C,YAAY,aAAaC,UAAQ,EAACC,SAAUJ,KAAKd,sBAGtG,yBAAKY,UAAY,uBACf,uBAAGA,UAAU,gBACb,2BAAO3Y,KAAK,OAAOgG,GAAG,WAAWoQ,KAAK,WAAW2C,YAAY,YAAYC,UAAQ,EAACC,SAAUJ,KAAKd,sBAGnG,yBAAKY,UAAY,uBACf,uBAAGA,UAAU,oBACb,2BAAO3Y,KAAK,QAAQgG,GAAG,QAAQoQ,KAAK,QAAQ2C,YAAY,QAAQC,UAAQ,EAACC,SAAUJ,KAAKd,sBAG1F,yBAAKY,UAAY,uBACf,uBAAGA,UAAU,gBACb,2BAAO3Y,KAAK,OAAOgG,GAAG,WAAWoQ,KAAK,WAAW2C,YAAY,WAAWoC,UAAU,IAAIC,UAAU,KAAKpC,UAAQ,EAACC,SAAUJ,KAAKd,sBAG/H,yBAAKY,UAAY,uBACf,uBAAGA,UAAU,gBACb,2BAAO3Y,KAAK,WAAWgG,GAAG,WAAWoQ,KAAK,WAAW2C,YAAY,WAAWoC,UAAU,IAAInC,UAAQ,EAACC,SAAUJ,KAAKd,sBAGpH,yBAAKY,UAAY,uBACf,uBAAGA,UAAU,gBACb,2BAAO3Y,KAAK,WAAWgG,GAAG,kBAAkBoQ,KAAK,kBAAkB2C,YAAY,mBAAmBC,UAAQ,EAACC,SAAUJ,KAAKd,sBAG3H8C,EAED,6BACE,uBAAGtD,MAAO,CAACgC,MAAM,OAAQvT,GAAK,eAAeoQ,KAAK,gBAAgByC,KAAKtV,MAAM2T,eAG9E4D,GAIH,uBAAGnC,UAAU,yBAAyBa,QAASX,KAAK6B,eAApD,kCAAkG,uBAAG/B,UAAU,yC,GA7IhGc,cAoJnBC,GAAqB,CACvBnH,kBACAC,wBAGWmH,eACXC,IACAC,YAAQ,KAAMH,IAFHC,CAGbG,I,wGCzKK,SAASuB,GAAsB5c,EAAON,EAAQ2B,GACnD,OAAO+V,MAAM1X,EAAS,eAAiB2B,EAAU,CAC/CgW,OAAQ,MACRlX,QAAS,CACP,eAAgB,mBAChB,cAAiB,UAAYH,KAE9BgE,MAAK,SAASwT,GAKf,OAJuB,MAApBA,EAAS1U,SACVoQ,QAAQC,IAAI,UAAYzT,EAAS,eAAiB2B,GAClD6R,QAAQC,IAAIqE,IAEPA,EAASC,UACfzT,MAAK,SAASE,GACf,OAAQA,KACPI,OAAM,SAASC,GAChB,OAAkBA,KCyCtB,SAASsY,GAAWtV,EAAIuV,EAAUC,GAChC,IAEIC,EAAYzb,EAFZ0b,EAAaC,GAAcJ,EAAS5T,IAAIrG,QAAQ,GAAIka,GACpDI,EAAOC,GAAUN,EAASO,SAY9B,YARyBxN,IAAtBiN,EAAS5T,IAAIzI,MACduc,EAAa,cACbzb,EAAO,SAEPyb,EAAa,mBACbzb,EAAO,aAGF,CACHoO,MAAO,QACPlP,KAAM,CACJ8G,GAAIA,EACJoQ,KAAMmF,EAAS5T,IAAItG,MACnBuC,OAAQ8X,EACRE,KAAMA,EACNG,KAAMR,EAAS5a,GACfX,KAAMA,GAERgc,QAASP,EACTQ,SAAU,CACR5M,EAAGkM,EAASrc,KAAKmQ,EACjBC,EAAGiM,EAASrc,KAAKoQ,IAOzB,SAAS4M,GAAiB/d,EAAQM,EAAO0d,EAAOZ,EAAUC,GAExD,IAAIE,EAAaC,GAAcJ,EAAS5T,IAAIrG,QAAQ,GAAIka,GACpDI,EAAOC,GAAUN,EAASO,SAC1B9V,EAAKoW,GAAkBD,EAAOZ,EAAS5a,IAE3C,OAAO0a,GAAsB5c,EAAON,EAAQod,EAAS5a,IAAI8B,MAAK,SAASC,GACrE,GAA+C,UAA5C2Z,OAAO3Z,EAAOxD,KAAKc,MAAM3B,UAAU,EAAE,GAAe,CACrD,IAAIie,GAAane,EAASke,OAAO3Z,EAAOxD,KAAKpB,KAAKO,UAAU,IAAKiX,QAAQ,MAAM,OAErC,QAAvC+G,OAAO3Z,EAAOxD,KAAKc,MAAMuc,OAAO,KACjCD,EAAWA,EAASje,UAAU,EAAGie,EAAShe,OAAS,GAAK,OAG1D,IAAIke,EAAS,CACXnN,EAAGkM,EAASrc,KAAOqc,EAASrc,KAAKmQ,EAAI,EACrCC,EAAGiM,EAASrc,KAAOqc,EAASrc,KAAKoQ,EAAI,EACrCmJ,MAAO8C,EAASrc,KAAOqc,EAASrc,KAAKuZ,MAAQ,EAC7CgE,OAAQlB,EAASrc,KAAOqc,EAASrc,KAAKud,OAAS,GAGjD,MAAO,CACL3e,IAAKwe,EACLlG,KAAMmF,EAAS5T,IAAItG,MACnBmb,OAAQA,EACRE,QAAQ,EACRrc,OAAQkb,EAAS7X,IACjBE,OAAQ8X,EACRK,KAAMR,EAAS5a,GACfX,KAAMub,EAAS5T,IAAI3H,MAIrB,MAAO,CACLoO,MAAO,QACPlP,KAAM,CACJ8G,GAAIA,EACJoQ,KAAMmF,EAAS5T,IAAItG,MACnBuC,OAAQ8X,EACRE,KAAMA,EACNG,KAAMR,EAAS5a,GACfX,KAAMub,EAAS5T,IAAI3H,KACnB2c,SAAUxe,EAASuE,EAAOxD,KAAKpB,IAAIO,UAAU,IAE/C2d,QAAS,aACTC,SAAU,CACR5M,EAAGkM,EAASrc,KAAKmQ,EACjBC,EAAGiM,EAASrc,KAAKoQ,OAS3B,SAASsN,GAAcze,EAAQM,EAAO0d,EAAOZ,EAAUC,GACrD,IAAIE,EAAaC,GAAcJ,EAAS5T,IAAIrG,QAAQ,GAAIka,GAExD,OAAOH,GAAsB5c,EAAON,EAAQod,EAAS5a,IAAI8B,MAAK,SAASC,GACrE,IACIkE,GADS,IAAIiW,WACAC,gBAAgBpa,EAAOxD,KAAK6d,IAAK,iBAK9CC,EAFYpW,EAAIqW,WAAW,GAAGC,WAAWzE,MAAM5K,MAClCjH,EAAIqW,WAAW,GAAGC,WAAWT,OAAO5O,MAKjDsP,EADaC,SAAS7B,EAASrc,KAAKuZ,OACXuE,EAEzBR,EAAS,CACXnN,EAAGkM,EAASrc,KAAOqc,EAASrc,KAAKmQ,EAAI,EACrCC,EAAGiM,EAASrc,KAAOqc,EAASrc,KAAKoQ,EAAI,EACrCmN,OAAQlB,EAASrc,KAAOie,EAAc,EACtC1E,MAAO8C,EAASrc,KAAOke,SAAS7B,EAASrc,KAAKuZ,OAAS,GAGzD,MAAO,CACL3a,IAAK,2BAA6Buf,mBAAmB,uDAAyD3a,EAAOxD,KAAK6d,KAC1H3G,KAAMmF,EAAS5T,IAAItG,MACnBmb,OAAQA,EACRE,QAAQ,EACR9Y,OAAQ8X,EACRK,KAAMR,EAAS5a,GACfX,KAAMub,EAAS5T,IAAI3H,KACnBK,OAAQkb,EAAS7X,QAQvB,SAAS4Z,GAAWnB,EAAOZ,EAAUC,GAGnC,MAAO,CACLpN,MAAO,QACPlP,KAAM,CACJ8G,GALKoW,GAAkBD,EAAOZ,EAAS5a,IAMvCiD,OALa+X,GAAcJ,EAAS5T,IAAIrG,QAAQ,GAAIka,GAMpDpF,KAAMmF,EAAS5T,IAAItG,MACnB0a,KAAMR,EAAS5a,GACfX,KAAMub,EAAS5T,IAAI3H,KACnBZ,YAAamc,EAASnc,aAExB4c,QAAS,OACTC,SAAU,CACR5M,EAAGkM,EAASrc,KAAKmQ,EACjBC,EAAGiM,EAASrc,KAAKoQ,IAOvB,SAASqM,GAAcxa,EAAUoc,GAC7B,IAAI,IAAI1a,KAAK0a,EACX,GAAGpc,IAAaoc,EAAY1a,GAAGa,IAC7B,OAAO6Z,EAAY1a,GAAGgO,UAAY,IAAM0M,EAAY1a,GAAGiO,SAG3D,MAAO,mBAKX,SAAS+K,GAAUD,GACjB,IAAInI,EAAOmI,EAAKvd,UAAU,EAAG,GACzBqV,EAAQkI,EAAKvd,UAAU,EAAG,GAC1BsV,EAAMiI,EAAKvd,UAAU,EAAG,IACxBuV,EAAOgI,EAAKvd,UAAU,GAAI,IAC1BwV,EAAS+H,EAAKvd,UAAU,GAAI,IAC5ByV,EAAS8H,EAAKvd,UAAU,GAAI,IAChC,OAAGuV,EAAO,GACDF,EAAQ,IAAMC,EAAM,IAAMF,EAAO,KAAOG,EAAO,IAAMC,EAAS,IAAMC,EAAS,MAE7EJ,EAAQ,IAAMC,EAAM,IAAMF,EAAO,MAAQG,EAAO,IAAM,IAAMC,EAAS,IAAMC,EAAS,MAM/F,SAASsI,GAAkBD,EAAOJ,GAIhC,OAAGI,EAAMqB,IAAIzB,IACXI,EAAMsB,IAAI1B,EAAMI,EAAMld,IAAI8c,GAAQ,GAC3BA,EAAO,IAAMI,EAAMld,IAAI8c,KAE9BI,EAAMsB,IAAI1B,EAAM,GACTA,EAAO,M,gJCjOlB2B,KAAUC,IAAIC,MACdF,KAAUC,IAAIE,MACdH,KAAUC,IAAIG,M,IAERC,G,kDACJ,WAAYjG,GAAQ,IAAD,8BACjB,cAAMA,IAEDvU,MAAQ,CACXya,SAAU,CAAC7B,MAAO,GAAI8B,MAAO,IAC7BC,UAAW,KACXC,gBAAiB,KACjBC,oBAAqB,GAGvB,EAAKC,aAAe,EAAKA,aAAaC,KAAlB,gBACpB,EAAKC,wBAA0B,EAAKA,wBAAwBD,KAA7B,gBAC/B,EAAKE,qBAAuB,EAAKA,qBAAqBF,KAA1B,gBAC5B,EAAKG,kBAAoB,EAAKA,kBAAkBH,KAAvB,gBACzB,EAAKI,gBAAkB,EAAKA,gBAAgBJ,KAArB,gBACvB,EAAKK,oBAAsB,EAAKA,oBAAoBL,KAAzB,gBAC3B,EAAKM,YAAc,EAAKA,YAAYN,KAAjB,gBAhBF,E,yDAmBNO,EAAqBC,GAAc,IAAD,OAI3C,IAAKjG,KAAKf,MAAMtN,UAAUlM,SAAWua,KAAKtV,MAAM6a,qBAAuBU,IAA+C,IAA/BjG,KAAKf,MAAMrL,SAASnO,QAA2D,IAA3CwO,OAAOiS,KAAKlG,KAAKf,MAAMxW,SAAShD,OAAa,CACpKua,KAAKpB,SAAS,CAAC2G,oBAAqBvF,KAAKf,MAAMtN,UAAUlM,SACzD,IACM0gB,EADKnG,KAAKoG,GACFC,gBAIV/C,EAAQ,IAAIgD,IAGhBH,EAAGI,SAASC,cAAgB,GAE5B,IAAIC,EDzDP,SAAyBnhB,EAAQM,EAAO0d,EAAOZ,EAAUC,GAE9D,IADA,IAAI8D,EAAc,GACVzc,EAAI,EAAGA,EAAI0Y,EAASjd,OAAQuE,IAAI,CACtC,IAAImD,EAAKoW,GAAkBD,EAAOZ,EAAS1Y,GAAGlC,IAElB,SAAzB4a,EAAS1Y,GAAG8E,IAAI3H,MAA6C,KAA1Bub,EAAS1Y,GAAG8E,IAAItG,OAA2C,WAA3Bka,EAAS1Y,GAAG8E,IAAIpG,OACpF+d,EAAYxc,KAAKwY,GAAWtV,EAAIuV,EAAS1Y,GAAI2Y,IACZ,eAAzBD,EAAS1Y,GAAG8E,IAAI3H,MAAmD,KAA1Bub,EAAS1Y,GAAG8E,IAAItG,OAA2C,WAA3Bka,EAAS1Y,GAAG8E,IAAIpG,OACjG+d,EAAYxc,KAAKoZ,GAAiB/d,EAAQM,EAAO0d,EAAOZ,EAAS1Y,GAAI2Y,IACpC,YAAzBD,EAAS1Y,GAAG8E,IAAI3H,MAAgD,KAA1Bub,EAAS1Y,GAAG8E,IAAItG,OAA2C,WAA3Bka,EAAS1Y,GAAG8E,IAAIpG,OAC9F+d,EAAYxc,KAAK8Z,GAAcze,EAAQM,EAAO0d,EAAOZ,EAAS1Y,GAAI2Y,IACjC,SAAzBD,EAAS1Y,GAAG8E,IAAI3H,MAA6C,KAA1Bub,EAAS1Y,GAAG8E,IAAItG,OAA2C,WAA3Bka,EAAS1Y,GAAG8E,IAAIpG,QAC3F+d,EAAYxc,KAAKwa,GAAWnB,EAAOZ,EAAS1Y,GAAI2Y,IAIpD,OAAO8D,ECyCmBC,CAAgB1G,KAAKf,MAAM3Z,OAAQ0a,KAAKf,MAAMrZ,MAAO0d,EAAOtD,KAAKf,MAAMtN,UAAWqO,KAAKf,MAAMxW,SAC3Gke,EDpCP,SAAyBrD,EAAOsD,GAErC,IADA,IAAID,EAAc,GACV3c,EAAI,EAAGA,EAAI4c,EAASnhB,OAAQuE,IAAI,CACtC,IAAIxD,EAAMogB,EAAS5c,GAEnB,GAAoB,SAAjBxD,EAAIsI,IAAI3H,MAAsC,WAAnBX,EAAIsI,IAAIpG,QAAyC,KAAlBlC,EAAIsI,IAAItG,OAAmC,SAAnBhC,EAAImI,MAAMxH,MAAwC,WAArBX,EAAImI,MAAMjG,QAA2C,KAApBlC,EAAImI,MAAMnG,MAAa,CACtK,IAAIqe,EAAYvD,EAAMld,IAAII,EAAIqB,MAC1Bif,EAAUxD,EAAMld,IAAII,EAAIsB,IAE5B,GAAiB,cAAd+e,GAAyC,cAAZC,EAC9B,IAAI,IAAIC,EAAI,EAAGA,EAAIF,EAAWE,IAC5B,IAAI,IAAIC,EAAI,EAAGA,EAAIF,EAASE,IAC1BL,EAAY1c,KAAK,CACfsL,MAAO,QACPlP,KAAM,CACJ8G,GAAI3G,EAAIqE,IAAM,KAAO0Z,SAASwC,GAAK,IAAMxC,SAASyC,GAAK,GACvDC,OAAQzgB,EAAIqB,KAAO,KAAO0c,SAASwC,GAAK,GACxC3H,OAAQ5Y,EAAIsB,GAAK,KAAOyc,SAASyC,GAAK,WAM9ClO,QAAQC,IAAIvS,EAAIqB,KAAO,eAAiBgf,EAAY,KAAOrgB,EAAIsB,GAAK,aAAegf,IAI3F,OAAOH,ECSmBO,CAAgB5D,EAAOtD,KAAKf,MAAMrL,UAChDuT,EAAOnH,KAEXnU,QAAQC,IAAI2a,EAAYW,OAAOT,IAAc/c,MAAK,SAACyd,GAE/C,IADA,IAAIC,EAAc,CAAChE,MAAO,GAAI8B,MAAO,IAC7Bpb,EAAI,EAAGA,EAAIqd,EAAc5hB,OAAQuE,IACP,UAA3Bqd,EAAcrd,GAAGuL,MAChB+R,EAAYhE,MAAMrZ,KAAKod,EAAcrd,IACJ,UAA3Bqd,EAAcrd,GAAGuL,MACvB+R,EAAYlC,MAAMnb,KAAKod,EAAcrd,IAC/Bqd,EAAcrd,GAAG/E,MAAQ,EAAKygB,wBAAwBS,EAAGoB,SAAUF,EAAcrd,KACvFmc,EAAGqB,gBAAgBH,EAAcrd,IAIzCmd,EAAKvI,SAAS,CAACuG,SAAUmC,IACzBH,EAAKvI,SAAS,CAACyG,UAAW/B,IAEA,IAAvB6C,EAAGoB,SAAS9hB,QAAe0gB,EAAGI,SAASkB,SAASC,SAEhD,EAAKzI,MAAMtN,UAAUlM,SAAWugB,EAAsB,GAAI,EAAKF,oBAAoB,EAAK7G,MAAMtN,UAAU,EAAKsN,MAAMtN,UAAUlM,OAAS,IACzI,EAAKogB,wB,8CAMO8B,EAAMxhB,GAC5B,IAAI,IAAI6D,KAAK2d,EACX,GAAG3H,KAAK2F,qBAAqBgC,EAAK3d,GAAI7D,GAAI,OAAO,EAEnD,OAAO,I,2CAIYA,EAAGyhB,GACtB,OAAOzhB,EAAEwd,OAAOC,SAAWgE,EAAEjE,OAAOC,QAAUzd,EAAEwd,OAAO/D,QAAUgI,EAAEjE,OAAO/D,OAASzZ,EAAEwd,OAAOnN,IAAMoR,EAAEjE,OAAOnN,GAAKrQ,EAAEwd,OAAOlN,IAAMmR,EAAEjE,OAAOlN,GACjItQ,EAAEoX,OAASqK,EAAErK,MAAQpX,EAAElB,MAAQ2iB,EAAE3iB,M,wCAIxBie,GAChB,IAAIlX,EAAMgU,KAAKtV,MAAM2a,UACrB,GAAGrZ,EAAI2Y,IAAIzB,GAAM,CAGf,IAFA,IAAI2E,EAAe,GACfC,EAAiB9b,EAAI5F,IAAI8c,GACrBlZ,EAAI,EAAGA,GAAK8d,EAAgB9d,IAClC6d,EAAa5d,KAAKiZ,EAAK,IAAIlZ,GAE7B,OAAO6d,EAET,OAAO,O,wCAKP,IAAIzB,EAAKpG,KAAKoG,GACVxU,EAAYoO,KAAKf,MAAMrN,UACvBuV,EAAOnH,KAGXoG,EAAG2B,OAAM,WAEP,IAAI,IAAI/d,KAAK4H,EAAU,CACrB,IAAIoW,EAAWb,EAAKvB,kBAAkBhU,EAAU5H,IAChD,GAAgB,OAAbge,GAAyC,IAApBA,EAASviB,OAAa,CAC5C,IAAIwiB,IAAc7B,EAAGnY,EAAE,IAAI+Z,EAAS,IAAIzZ,SAAS,oBAC7C2Z,EAAgBD,EAAc,mBAAqB,cACnDE,EAAaF,EAAc,iBAAmB,YAClD,IAAI,IAAIje,KAAKge,EACX5B,EAAGnY,EAAE,IAAI+Z,EAAShe,IAAIoe,YAAYF,GAAe9Z,SAAS+Z,U,0CAQhD5W,GAClB,IAAI6U,EAAKpG,KAAKoG,GACVlD,EAAO3R,EAAKzJ,GACZugB,EAAQrI,KAAK4F,kBAAkB1C,GACnC,GAAa,OAAVmF,EAAe,CAChB,IAAIC,EAAelC,EAAGnY,EAAE,IAAIoa,EAAMA,EAAM5iB,OAAS,IACjD2gB,EAAGmC,OAAOD,GACVA,EAAaE,WAAW,iBAAkB,Q,kCAIlCC,GACV,IAAIrC,EAAKpG,KAAKoG,GACRD,EAAKC,EAAGC,gBAEoB,OAA/BrG,KAAKtV,MAAM4a,iBAA0BtF,KAAKtV,MAAM4a,gBAAgBoD,UACnE1I,KAAKpB,SAAS,CAAC0G,gBAAiB,OAChC,IAAIqC,EAAOxB,EAAGoB,SACd,IAAI,IAAIvd,KAAK2d,EACXxB,EAAGwC,gBAAgBhB,EAAK3d,IAAI,GAG9B,IAAI4e,EAAcxC,EAAGyC,aACf3gB,EAAQugB,GAAKzI,KAAKf,MAAMtD,YACxB3H,EAAQC,OAAO6U,OAAO9I,KAAKf,MAAMvL,WACnCrM,EAAS2Y,KAAKf,MAAMrD,aACpBuL,EAAOnH,KACX,OAAQ3Y,GACJ,IAAK,QAEDuhB,EAAcxC,EAAG/e,QAAO,SAASgH,EAAMrE,GACpC,IAAM+e,EAAY1a,EAAKhI,KAAK,QACtB2iB,EAAa3a,EAAKhI,KAAK,QAC7B,IAAkB,SAAd0iB,GAAsC,SAAdA,GAAsC,cAAdA,GAA2C,eAAdA,KAAgCC,EAAWC,cAAc9c,SAASjE,EAAM+gB,eACvJ,OAAO5a,KAWZ,MAEJ,IAAK,UAED2F,EAAM3M,QAAO,SAAUb,GACnB,GAAIA,EAAIH,OAAWG,EAAIH,KAAK6iB,UAAY1iB,EAAIH,KAAK6iB,QAAQ/c,SAASjE,IAAY1B,EAAIH,KAAKyD,OAAStD,EAAIH,KAAKyD,KAAKqC,SAASjE,IAAY,CACjI,IAAIihB,EAAShC,EAAKvB,kBAAkBpf,EAAIqE,KACxC,IAAI,IAAIkc,KAAKoC,EAASP,EAAcA,EAAYQ,MAAMhD,EAAGnY,EAAE,IAAIkb,EAAOpC,SAI5E,MAEJ,IAAK,SAED6B,EAAcxC,EAAG/e,QAAO,SAASgH,EAAMrE,GACpC,IAAM+e,EAAY1a,EAAKhI,KAAK,QACtBgjB,EAAchb,EAAKhI,KAAK,UAC9B,IAAkB,SAAd0iB,GAAsC,SAAdA,GAAsC,cAAdA,GAA2C,eAAdA,KAAgCM,EAAYJ,cAAc9c,SAASjE,EAAM+gB,eACxJ,OAAO5a,KAWZ,MAEJ,IAAK,WACD,IAAMib,EAAUtJ,KAAKf,MAAM7S,SAAS/E,QAAO,SAAAkiB,GAAO,OAAIA,EAAQ1hB,OAASK,KAAO8D,KAAI,SAAAud,GAAO,OAAIA,EAAQzhB,MAErGkM,EAAM3M,QAAO,SAASkK,GACpB,IAAI+X,EAAQnd,SAASoF,EAAK1G,KAAK,CAC7B,IAAIse,EAAShC,EAAKvB,kBAAkBrU,EAAK1G,KACzC,IAAI,IAAIkc,KAAKoC,EAASP,EAAcA,EAAYQ,MAAMhD,EAAGnY,EAAE,IAAIkb,EAAOpC,SASlF,GAA0B,IAAvB6B,EAAYnjB,OAAa,CAC1B,IAAI6f,EAAkBc,EAAGoD,OAAOZ,GAChC5I,KAAKpB,SAAS,CAAC0G,gBAAiBA,O,0CAIf,IAAD,OACdc,EAAKpG,KAAKoG,GAIVtgB,EAAW,CACb2jB,WAAY,IACZC,UAAW,GACXC,QNxOiB,IMyOjBC,QNxOiB,EMyOjBC,WAAY,GACZC,SAAU,GACVC,YAAa,GACbC,gBAAiB,GACjBC,mBAAoB,IACpBC,gBAAiB,EACjBC,uBAAwB,GACxBC,UAAU,EACVC,iBAAa5U,EACb6U,aAAc,WACZ,OAAO,GAETC,qBAAsB,IAGtBC,iBAAkB,cAClBC,WAAY,aACZC,YAAa,cACbC,UAAW,gBAIbvE,EAAGwE,QAAS9kB,GAGZsgB,EAAGyE,cAAc,CACf,CACE3iB,MAAO,OACP4iB,OAAQ,SACRC,OAAQ,SACRC,UAAW,QACXC,UAAW,SACXC,SAAU,kBACVC,IAAK,SAAS9kB,GAEZ,MAAiB,SAAdA,EAAKc,MAAiC,cAAdd,EAAKc,MAAsC,eAAdd,EAAKc,KACpD,QAAUd,EAAK0E,OAAS,OAAS1E,EAAK0c,KAAO,SAE7C,OAMf/C,KAAKwF,eAEL,IAAIhX,EAAMwR,KAEVoG,EAAGgF,GAAG,MAAO,QAAQ,SAASjM,GAC5B,IAAI+D,EAAOlD,KAAK3Z,KAAK,QACjBc,EAAO6Y,KAAK3Z,KAAK,QAElB2Z,KAAKzR,SAAS,SACfuK,QAAQC,IAAI,SACJiH,KAAKzR,SAAS,cACpBC,EAAIyQ,MAAMoM,YAAYnI,GAChBlD,KAAKzR,SAAS,QACpBC,EAAIyQ,MAAMqM,YAAYpI,GAEZ,cAAT/b,GACCqH,EAAIyQ,MAAMoM,YAAYnI,GACtBlD,KAAKoI,YAAY,oBACjBpI,KAAK5R,SAAS,mBACC,SAATjH,IACNqH,EAAIyQ,MAAMoM,YAAYnI,GACtBlD,KAAKoI,YAAY,eACjBpI,KAAK5R,SAAS,iBAKpBgY,EAAGgF,GAAG,WAAY,QAAQ,SAACG,GAAS,IAAD,EAChBA,EAAInM,OAAOgE,WAAnB5M,EADwB,EACxBA,EAAGC,EADqB,EACrBA,EAENyM,EAAOqI,EAAInM,OAAO/Y,OAAO6c,KAEzB1L,EAAW,EAAKyH,MAAMtN,UAAUtK,QAAO,SAACI,GAAD,OAAUA,EAAKK,KAAOob,KACjE,GAAI1L,EAAS/R,OAAQ,CACjB+R,EAAWA,EAAS,GACpB,IAAMnR,EAAO,CAACmQ,IAAGC,KACX+U,EAAW,eAAQhU,GACzBgU,EAAYnlB,KAAZ,2BAAwBmlB,EAAYnlB,MAASA,GAC7C,EAAK4Y,MAAMwM,eAAeD,OAKlCpF,EAAGgF,GAAG,8BAA8B,SAACG,EAAKG,GACtC,IAAIlU,EAAW,EAAKyH,MAAMtN,UAAUtK,QAAO,SAACI,GAAD,OAAUA,EAAKoD,MAAQ6gB,EAAIlkB,UACtE,GAAIgQ,EAAS/R,OAAQ,CACjB+R,EAAWA,EAAS,GACpB,IAAMnR,EAAO,CAACmQ,EAAGkV,EAAI/H,OAAOnN,EAAGC,EAAGiV,EAAI/H,OAAOlN,GACvC+U,EAAW,eAAQhU,GACzBgU,EAAYnlB,KAAZ,2BAAwBmlB,EAAYnlB,MAASA,GAC7C,EAAK4Y,MAAMwM,eAAeD,OAIlCpF,EAAGgF,GAAG,gCAAgC,SAACG,EAAKG,EAAKC,EAAIC,GACjD,IAAIpU,EAAW,EAAKyH,MAAMtN,UAAUtK,QAAO,SAACI,GAAD,OAAUA,EAAKoD,MAAQ6gB,EAAIlkB,UACtE,GAAIgQ,EAAS/R,OAAQ,CACjB+R,EAAWA,EAAS,GACpB,IAAMnR,EAAO,CAACuZ,MAAO8L,EAAI/H,OAAO/D,MAAOgE,OAAQ8H,EAAI/H,OAAOC,QACpD4H,EAAW,eAAQhU,GACzBgU,EAAYnlB,KAAZ,2BAAwBmlB,EAAYnlB,MAASA,GAC7C,EAAK4Y,MAAMwM,eAAeD,S,yCAKnBK,EAAWC,GAG1B,IAAIC,EAAQ,CACVC,eAAiBhM,KAAKf,MAAMtV,SAAWkiB,EAAUliB,QAAUqW,KAAKf,MAAMrL,WAAaiY,EAAUjY,UACtEoM,KAAKf,MAAMxW,UAAYojB,EAAUpjB,SAAWuX,KAAKf,MAAMtN,YAAcka,EAAUla,WAAaqO,KAAKf,MAAMrN,YAAcia,EAAUja,UAEtJqa,oBAAsBjM,KAAKf,MAAMtV,SAAWkiB,EAAUliB,QAAUqW,KAAKf,MAAMrL,WAAaiY,EAAUjY,UAAYoM,KAAKf,MAAMxW,UAAYojB,EAAUpjB,SACxHuX,KAAKf,MAAMtN,YAAcka,EAAUla,WAAaqO,KAAKf,MAAMtN,UAAUlM,SAAWomB,EAAUla,UAAUlM,QAAUua,KAAKf,MAAMrN,YAAcia,EAAUja,UAExKsa,oBAAsBlM,KAAKf,MAAMtV,SAAWkiB,EAAUliB,QAAUqW,KAAKf,MAAMrL,WAAaiY,EAAUjY,UAAYoM,KAAKf,MAAMxW,UAAYojB,EAAUpjB,SACxHuX,KAAKf,MAAMtN,YAAcka,EAAUla,WAA6C,IAAhCqO,KAAKf,MAAMtN,UAAUlM,aAA+CgQ,IAA/BoW,EAAUla,UAAUlM,OAEhI0mB,gBAAkBnM,KAAKf,MAAMtD,cAAgBkQ,EAAUlQ,aAAeqE,KAAKf,MAAMrD,eAAiBiQ,EAAUjQ,cAG1GqK,EAAe8F,EAAME,qBAAuBF,EAAMG,oBAEnDH,EAAMI,iBAAkBnM,KAAK+F,cAC7BgG,EAAMC,gBAAiBhM,KAAKwF,aAAaqG,EAAUla,UAAUlM,OAAQwgB,K,+BAGlE,IAAD,OACP,OACM,kBAAC,KAAD,CACAG,GAAI,SAACA,GAAS,EAAKA,GAAKA,GACxB1H,MAAQ,CAAEkB,MAAO,OAAQgE,OAAQ,QACjCuB,SAAUiH,KAAmBC,kBAAkBrM,KAAKtV,MAAMya,UAC1DmH,WAAa,CACX,CACEC,SAAU,OACV7N,MAAO,CACL,MAAS,aACT,YAAa,OACb,cAAe,QACf,cAAe,SACf,gBAAiB,KACjB,QAAW,IACX,qBAAsB,IACtB,kBAAmB,OACnB,mBAAoB,OACpB,oBAAqB,SAGzB,CACE6N,SAAU,OACV7N,MAAO,CACL,MAAS,EACT,aAAc,UACd,qBAAsB,UACtB,qBAAsB,WACtB,cAAe,WAInB,CAAC6N,SAAU,eAAgB7N,MAAO,CAAC,mBAAoB,CAAC8N,QACxD,CAACD,SAAU,aAAc7N,MAAO,CAAC,mBAAoB,CAAC+N,QACtD,CAACF,SAAU,oBAAqB7N,MAAO,CAAC,mBAAoB,CAACgO,QAC7D,CAACH,SAAU,kBAAmB7N,MAAO,CAAC,mBAAoB,CAACiO,QAC3D,CAACJ,SAAU,cAAe7N,MAAO,CAAC,mBAAoB,CAACkO,QACvD,CAACL,SAAU,QAAS7N,MAAO,CAAC,mBAAoB,CAACmO,QACjD,CAACN,SAAU,SAAU7N,MAAO,CAAC,MAAS,KACtC,CAAC6N,SAAU,WAAY7N,MAAO,CAAC,MAAS,KACxC,CACE6N,SAAU,kBACV7N,MAAO,CACL,eAAgB,QAChB,eAAgB,IAChB,eAAgB,SAItBoO,OAAS,CAACvP,KAAM,QAChBwP,qBAAsB,EACtBC,UAAW,EACXC,iBAAmB,IACnBtD,QNpaa,IMqabC,QNpaa,Q,GMUChJ,aAiblBC,GAAqB,CACvB4K,eVvc0B,SAAChkB,GAAD,8CAAU,WAAOwD,EAAU4L,GAAjB,SAAA1Q,EAAA,sEAC9B+E,EAAYzD,EAAKoD,IAAKpD,GADQ,2CAAV,0DU0cfuZ,gBArBS,SAACtW,EAAOwiB,GAC5B,MAAO,CACHtnB,MAAO8E,EAAMoM,QAAQlR,MACrBN,OAAQoF,EAAMoM,QAAQuE,cACtB1R,OAAQe,EAAMoM,QAAQnN,OACtBoB,OAAQL,EAAMoM,QAAQ/L,OACtBtC,QAASiC,EAAMgN,MACfhE,UAAWhJ,EAAMsJ,MAAMN,UACvB/B,UAAWjH,EAAMsJ,MAAMrC,UACvBC,UAAWlH,EAAMsJ,MAAMpC,UACvBgC,SAAUlJ,EAAMsJ,MAAMJ,SACtBxH,SAAU1B,EAAMsJ,MAAM5H,SACtBuP,YAAajR,EAAMoM,QAAQ6E,YAC3BC,aAAclR,EAAMoM,QAAQ8E,gBAUhCiF,GAFWG,CAGbkE,I,+DChcIiI,G,kDACJ,WAAYlO,GAAQ,IAAD,8BACjB,cAAMA,IACDvU,MAAQ,CACX0iB,UAAW,KACXC,WAAY,8BACZC,gBAAiB,2BACjBC,WAAY,2BACZC,WAAW,GAGb,EAAKC,WAAa,EAAKA,WAAWhI,KAAhB,gBAClB,EAAKiI,YAAc,EAAKA,YAAYjI,KAAjB,gBAXF,E,yDAejBzF,KAAKpB,SAAS,CAAC4O,WAAW,IAC1B,IAAIhf,EAAMwR,MRjCP,SAAsBlD,EAAUC,EAAUzX,GAC/C,IAAIwE,EAAO,CACT,SAAYgT,EACZ,SAAYC,GAGd,OAAOC,MAAM1X,EAAS,aAAc,CAClC2X,OAAQ,OACRlX,QAAS,CAAC,eAAgB,oBAC1B+D,KAAMoT,KAAKC,UAAUrT,KACpBF,MAAK,SAASwT,GAKb,OAJuB,MAApBA,EAAS1U,SACVoQ,QAAQC,IAAI,UAAYzT,EAAS,cACjCwT,QAAQC,IAAIqE,IAEPA,EAASC,UACjBzT,MAAK,SAASE,GACb,OAAOA,KACRI,OAAM,SAASC,GACd,OAAkBA,MQeGwjB,CAAa,QAAS,QAAS3N,KAAKtV,MAAM2iB,YAChDzjB,MAAK,SAASC,GAC7B2E,EAAIoQ,SAAS,CAACwO,UAAWvjB,EAAOjE,a,oCAKlCoa,KAAKpB,SAAS,CAAC4O,WAAW,M,0CAK1Bvf,KAAE,2BAA2ByR,UAC7BzR,KAAE,2BAA2B0R,UAC1B1R,KAAEkI,QAAQyJ,SAAW,KACtB3B,SAASC,eAAe,WAAW2B,aAAa,eAAgB,W,+BAKlE,IAAI+N,EAOJ,MANmC,UAAhC5N,KAAKf,MAAM7D,iBACZwS,EAAe,kBAAC,GAAD,MACyB,WAAhC5N,KAAKf,MAAM7D,mBACnBwS,EAAe,kBAAC,GAAD,OAIf,yBAAK9N,UAAU,8BAEb,yBAAKA,UAAY,iBAEb,yBAAKA,UAAY,2BAA2B3S,GAAK,SAC9CygB,GAIH,yBAAK9N,UAAY,wBAEf,yBAAKA,UAAY,uBACf,2DACA,wdAKE,yBAAKA,UAAU,2CAA2Ca,QAASX,KAAKyN,WAAYtgB,GAAG,wBACrF,yBAAK2S,UAAU,gBAAgB+N,IAAKC,KAAaC,IAAK,gBACtD,yBAAKjO,UAAU,iBACX,yBAAKA,UAAU,sBAAf,4BAIN,yBAAKA,UAAU,kBACb,uBAAGkO,KAAK,kDAAiD,yBAAKlO,UAAU,qBAAqB+N,IAAKI,KAAWF,IAAK,qBAClH,uBAAGrP,MAAO,CAACwP,WAAY,QAASF,KAAK,8EAA6E,yBAAKlO,UAAU,qBAAqB+N,IAAKM,KAAkBJ,IAAK,wBAMpL,kBAACK,EAAA,EAAD,CAAOC,gBAAgB,qBAAqDC,OAAQtO,KAAK0N,aACvF,kBAACU,EAAA,EAAMG,OAAP,CAAcC,aAAW,GACvB,kBAACJ,EAAA,EAAMK,MAAP,8BAEF,kBAACL,EAAA,EAAMM,KAAP,CAAY5O,UAAU,oBACpB,kBAAC,GAAD,CAAOpB,MAAO,CAACkB,MAAO,OAAQgE,OAAQ,QAAShe,MAAOoa,KAAKtV,MAAM0iB,UAAW9nB,OAAQ0a,KAAKtV,MAAM2iB,WAAY9mB,YAAayZ,KAAKtV,MAAM4iB,gBAAiB3jB,OAAQqW,KAAKtV,MAAM6iB,cAEzK,kBAACa,EAAA,EAAMO,OAAP,KACE,kBAACC,EAAA,EAAD,CAAQC,QAAQ,UAAUlO,QAASX,KAAK0N,YAAa5N,UAAU,mBAA/D,mB,GAvFFc,aA6GLE,eACXC,IACAC,aARoB,SAACtW,EAAOwiB,GAC5B,MAAO,CACH9R,iBAAkB1Q,EAAMoM,QAAQsE,oBAMX,MAFd0F,CAGbqM,IClFK,SAAS2B,GAAWxpB,EAAQypB,GACjC,IAAInpB,EAAQ8X,GAAwBpY,IT+B/B,SAA4BM,EAAON,GACxC,OAAO0X,MAAM1X,EAAS,4BAA6B,CACjD2X,OAAQ,MACRlX,QAAS,CACP,eAAgB,mBAChB,cAAiB,UAAYH,KAE9BgE,MAAK,SAASwT,GAKf,OAJuB,MAApBA,EAAS1U,SACVoQ,QAAQC,IAAI,UAAYzT,EAAS,6BACjCwT,QAAQC,IAAIqE,IAEPA,EAASC,UACfzT,MAAK,SAASE,GACb,OAAQA,KACTI,OAAM,SAASC,GACd,OAAkBA,MS5CI6kB,CAAmBppB,EAAON,GAChCsE,MAAK,SAASC,GAChCA,EAAOolB,MAAK,SAAC9oB,EAAGyhB,GAAJ,OAAUsH,GAAe/oB,EAAEgpB,WAAW3mB,MAAOof,EAAEuH,WAAW3mB,UA4C1E,SAA+BnC,EAAMf,EAAQypB,GAI3C,IAHA,IAAIK,EAAoB,GAGhBplB,EAAI,EAAGA,EAAI3D,EAAKZ,OAAQuE,IAC3B3D,EAAK2D,IAAM3D,EAAK2D,GAAGa,KACpBukB,EAAkBnlB,KAAK,CACnBzB,MAAOnC,EAAK2D,GAAGmlB,WAAW3mB,MAC1BlD,OAAQypB,EAAoBrkB,MAAM2kB,iBAClCzpB,MAAOmpB,EAAoBrkB,MAAM9E,MACjCW,YAAaF,EAAK2D,GAAGzD,cAK7BwoB,EAAoBnQ,SAAS,CAACwQ,kBAAmBA,IA1D/CE,CAAsBzlB,EAAQvE,EAAQypB,MTAnC,SAAqBnpB,EAAON,GAEjC,OAAO0X,MAAM1X,EAAS,eAAgB,CACpC2X,OAAQ,MACRlX,QAAS,CACP,eAAgB,mBAChB,cAAiB,UAAYH,KAE9BgE,MAAK,SAASwT,GACb,OAAuB,MAApBA,EAAS1U,QAAsC,MAApB0U,EAAS1U,QACrCoQ,QAAQC,IAAI,UAAYzT,EAAS,gBACjCwT,QAAQC,IAAIqE,GACL,CAACjT,OAAO,IAEViT,EAASC,UACjBzT,MAAK,SAASE,GACb,OAAQA,KACTI,OAAM,SAASC,GACd,OAAkBA,KSdPolB,CAAY3pB,EAAON,GACzBsE,MAAK,SAASC,IACD,IAAjBA,EAAOM,OA4EZiM,MAAM,oCACNoZ,OA1EIT,EAAoBnQ,SAAS,CAACrB,KAAM1T,EAAOmO,UAAY,IAAMnO,EAAOoO,WACpE8W,EAAoBnQ,SAAS,CAACrD,OAAQ1R,EAAOgB,UC/D5C,SAAwBjF,EAAON,GACpC,OAAO0X,MAAM1X,EAAS,kBAAmB,CACvC2X,OAAQ,MACRlX,QAAS,CACP,eAAgB,mBAChB,cAAiB,UAAYH,KAE9BgE,MAAK,SAASwT,GAKb,OAJuB,MAApBA,EAAS1U,SACVoQ,QAAQC,IAAI,UAAYzT,EAAS,mBACjCwT,QAAQC,IAAIqE,IAEPA,EAASC,UACjBzT,MAAK,SAASE,GACb,OAAQA,KACTI,OAAM,SAASC,GACd,OAAkBA,KDqDMslB,CAAe7pB,EAAON,GAC5BsE,MAAK,SAASC,GAClCA,EAAOolB,MAAK,SAAC9oB,EAAGyhB,GAAJ,OAAUsH,GAAe/oB,EAAEqC,MAAOof,EAAEpf,UAOpD,SAA2BqB,EAAQklB,GAEjC,IADA,IAAIW,EAAsB,GAClB1lB,EAAI,EAAGA,EAAIH,EAAOpE,OAAQuE,IAAI,CACpC,IAAIxB,EAAQqB,EAAOG,GAAGxB,MAClBjC,EAAcsD,EAAOG,GAAGa,IAC5B6kB,EAAoBzlB,KAAK,CAACzB,MAAOA,EAAOjC,YAAaA,IAGvD,IAAMopB,EAAoBD,EAAoB1jB,KAAI,SAAA4jB,GAAC,MAAK,CACtD,MAASA,EAAErpB,YACX,MAASqpB,EAAEpnB,UAGbumB,EAAoBnQ,SAAS,CAAC8Q,oBAAqBC,IAnBjDE,CAAkBhmB,EAAQklB,MA4CvB,SAASe,GAAcvU,EAAQjW,EAAQmc,EAAiBlb,EAAawoB,GAC1E,IAAInpB,EAAQ8X,GAAwBpY,GAChCkJ,EAAMugB,GC9BL,SAAmCnpB,EAAOW,EAAajB,EAAQiW,EAAQkG,GAC5E,IAAI3X,EAAO,CACT,YAAevD,EACf,gBAAmBkb,EACnB,OAAUlG,GAGZ,OAAOyB,MAAM1X,EAAS,cAAe,CACnC2X,OAAQ,OACRlX,QAAS,CACP,eAAgB,mBAChB,cAAiB,UAAYH,GAE/BkE,KAAMoT,KAAKC,UAAUrT,KACpBF,MAAK,SAASwT,GACb,OAAuB,MAApBA,EAAS1U,QACVoQ,QAAQC,IAAI,UAAYzT,EAAS,eACjCwT,QAAQC,IAAIqE,GACLA,GAEAA,EAASC,UAEnBzT,MAAK,SAASE,GACb,MAAoB,CAACA,EAAMxE,MAC5B4E,OAAM,SAASC,GACd,OAAkBA,MDMR4lB,CAA0BnqB,EAAOW,EAAajB,EAAQiW,EAAQkG,GACpE7X,MAAK,SAAAC,GACXoU,SAASC,eAAe,gBAAgBlJ,MAAQ,GACxB,MAArBnL,EAAO,GAAGnB,OACX8F,EAAIoQ,SAAS,CAACoR,0BAA2B,oEAEzCxhB,EAAIoQ,SAAS,CAACoR,0BAA2B,KACzClB,GAAWxpB,EAAQkJ,OAelB,SAASghB,GAAOT,GACrB,IAAIpR,EAAQzY,aAAaC,QAAQ,YAC7B8qB,EAAW/S,KAAKU,MAAM1Y,aAAaC,QAAQwY,IAE/C,GAAa,OAAVA,GAA+B,OAAbsS,EACnB/qB,aAAaqX,YACR,CACL,IAAI,IAAIvS,KAAKimB,EACXA,EAASjmB,GAAG,GAAK,GAEnB9E,aAAaQ,QAAQiY,EAAOT,KAAKC,UAAU8S,IAC3C/qB,aAAauZ,WAAW,YAG1BsQ,EAAoB9P,MAAMO,QAAQvV,KAAK,KAKlC,SAASimB,KACd,IAAIC,EAAMlS,SAASC,eAAe,WACZ,WAAlBiS,EAAIrQ,UACNqQ,EAAIrQ,UAAY,iBAEhBqQ,EAAIrQ,UAAY,SAOpB,SAASoP,GAAe/oB,EAAGyhB,GACvB,OAAGzhB,EAAE8iB,cAAgBrB,EAAEqB,eAAyB,EAC7C9iB,EAAE8iB,cAAgBrB,EAAEqB,cAAwB,EACxC,E,WElKLmH,G,kDACJ,WAAYnR,GAAQ,IAAD,8BACjB,cAAMA,IAoBRC,mBAAqB,SAACC,GACpB,IAAI5B,EAAO4B,EAAMC,OAAO7B,KACpBvI,EAAQmK,EAAMC,OAAOpK,MACzB,EAAK4J,SAAL,eAAgBrB,EAAOvI,KAxBN,EA2BnBkM,oBAAsB,SAAC/B,GACrB,IAAIkR,EAAalR,EAAMC,OACnBkR,EAAanR,EAAMC,OAAOmR,UAC1BC,EAAY/S,GAAa0B,EAAMC,OAAOmR,WACtCE,EAAmBvT,KAAKU,MAAM1Y,aAAaC,QAAQ,EAAKuF,MAAMoS,WAElE,EAAK8B,SAAS,CAACyQ,iBAAkB5R,GAAa6S,KAC9C,EAAK1R,SAAS,CAAC8R,kBAAmBJ,IAGlCriB,KAAEoiB,GAAYjiB,SAAS,UAAUuiB,WAAWvI,YAAY,UAGxD,IAAIwI,EAAkBnT,GAAa6S,GAC/BhS,EAAkB,GACtB,IAAI,IAAItU,KAAKymB,EAAiB,CAC5B,IAAInrB,EAASmrB,EAAiBzmB,GAAG,GAC7BpE,EAAQ6qB,EAAiBzmB,GAAG,GAC5BtB,EAAUpD,IAAWsrB,EAAmB,SAAW,WACnDC,EAAWJ,EAAiBzmB,GAAG,GAChC1E,IAAWsrB,GAAmB,EAAKhS,SAAS,CAAChZ,MAAO6qB,EAAiBzmB,GAAG,KAC3EsU,EAAgBrU,KAAK,CAAC3E,EAAQM,EAAO8C,EAAQmoB,IAE/C3rB,aAAaQ,QAAQ,EAAKgF,MAAMoS,SAAUI,KAAKC,UAAUmB,IAGzDwQ,GAAW0B,EAAD,iBArDO,EAwDnBM,iBAAmB,SAAC3R,GAClB,IAAI4R,EAAmB,CAAC/b,MAAOmK,EAAMnK,MAAOwJ,MAAOW,EAAMX,OACzD,EAAKI,SAAS,CAACiS,SAAUE,IAGzB,IAAIN,EAAmBvT,KAAKU,MAAM1Y,aAAaC,QAAQ,EAAKuF,MAAMoS,WAC9DkU,EAAqB,GACzB,IAAI,IAAIhnB,KAAKymB,EACXO,EAAmB/mB,KAAK,CAACwmB,EAAiBzmB,GAAG,GAAIymB,EAAiBzmB,GAAG,GAAIymB,EAAiBzmB,GAAG,GAAI+mB,IAEnG7rB,aAAaQ,QAAQ,EAAKgF,MAAMoS,SAAUI,KAAKC,UAAU6T,KAlExC,EAqEnBC,8BAAgC,SAAC9R,GAC/B,EAAKP,SAAS,CAACsS,wBAAyB,CAAClc,MAAOmK,EAAMnK,MAAOwJ,MAAOW,EAAMX,UApE1E,EAAK9T,MAAQ,CACX9E,MAAO,KACPkX,SAAU,KACVS,KAAM,KACNhC,OAAQ,KACR8T,iBAAkB,KAClBqB,kBAAmB,KACnBS,WAAY,GACZ/B,kBAAmB,GACnBM,oBAAqB,GACrBwB,wBAAyB,KACzBE,yBAA0B,KAC1BpB,0BAA2B,KAC3Ba,SAAU3T,KAAKU,MAAM1Y,aAAaC,QAAQD,aAAaC,QAAQ,cAAc,GAAG,IAGlF,EAAKksB,eAAiB,EAAKA,eAAe5L,KAApB,gBAlBL,E,2DAyEJmK,GACb,ID5CoChqB,EAAOW,EAAajB,EC4CpDgsB,GD5CgC1rB,EC4CQgqB,EAAEhqB,MD5CHW,EC4CUqpB,EAAErpB,YD5CCjB,EC4CYsqB,EAAEtqB,OD3CjE0X,MAAM1X,EAAS,mBAAqBiB,EAAc,SAAU,CACjE0W,OAAQ,MACRlX,QAAS,CACP,eAAgB,mBAChB,cAAiB,UAAYH,KAE9BgE,MAAK,SAASwT,GAKb,OAJuB,MAApBA,EAAS1U,SACVoQ,QAAQC,IAAI,UAAYzT,EAAS,mBAAqBiB,EAAc,UACpEuS,QAAQC,IAAIqE,IAEPA,EAASC,UACjBzT,MAAK,SAASE,GACb,OAAQA,EAAK,MACdI,OAAM,SAASC,GACd,OAAkBA,MC6BhBgd,EAAOnH,KAEXsR,EAAc1nB,MAAK,SAASwT,GAC1B,GAAiC,YAA9B+J,EAAKzc,MAAMmmB,SAAS7b,MAAqB,CAC1C,IAAIuc,EAAOtT,SAASuT,cAAc,KAClCD,EAAKvD,KAAO4B,EAAEtqB,OAAS,kBAAoBsqB,EAAEhqB,MAAQ,sBAAwBwX,EAASvS,IACtF0mB,EAAKnS,OAAS,SACdnB,SAASnU,KAAK2nB,YAAYF,GAC1BA,EAAKG,YACiC,aAA9BvK,EAAKzc,MAAMmmB,SAAS7b,OAAsD,UAA9BmS,EAAKzc,MAAMmmB,SAAS7b,QACxE3P,EAAUuqB,EAAEtqB,QACZK,EAASiqB,EAAEhqB,OACXK,eAAeP,QAAQ,QAASkqB,EAAEhqB,OAClCK,eAAeP,QAAQ,cAAekqB,EAAErpB,aACxCN,eAAeP,QAAQ,SAAU0X,EAASvS,KAC1Csc,EAAKlI,MAAMvF,eAAekW,EAAEhqB,OAC5BuhB,EAAKlI,MAAM3C,kBACX6K,EAAKlI,MAAMpF,eAAe+V,EAAErpB,aAC5B4gB,EAAKlI,MAAMlF,UAAUqD,EAASvS,KAC9Bsc,EAAKlI,MAAMnF,iBAAiB8V,EAAEtqB,QAC9B6hB,EAAKlI,MAAMO,QAAQvV,KAAK,CACtB0nB,SAAS,SAAD,OAAWvU,EAASvS,KAC5BH,MAAO,CAAEknB,YAAazK,EAAKzc,MAAMmmB,SAAS7b,MAAO6c,eAAgBjC,EAAEpnB,aAItE0B,OAAM,SAASC,GAChB2O,QAAQC,IAAI5O,Q,2CF1GX,SAA2B4kB,GAChC,IAAIpR,EAAQzY,aAAaC,QAAQ,YAC7BkB,EAAO6W,KAAKU,MAAM1Y,aAAaC,QAAQwY,IACvC9B,EAAU,GAEdkT,EAAoBnQ,SAAS,CAAC9B,SAAUa,IAExC,IAAI,IAAI3T,EAAI,EAAGA,EAAI3D,EAAKZ,OAAQuE,IAAI,CAClC,IAAIsmB,EAAa9S,GAAcnX,EAAK2D,GAAG,IAGrB,WAAf3D,EAAK2D,GAAG,IACT+kB,EAAoBnQ,SAAS,CAACyQ,iBAAkBhpB,EAAK2D,GAAG,KACxD+kB,EAAoBnQ,SAAS,CAAC8R,kBAAmBlT,GAAcnX,EAAK2D,GAAG,MACvE+kB,EAAoBnQ,SAAS,CAAChZ,MAAOS,EAAK2D,GAAG,KAC7C6R,EAAQ5R,KAAK,CACXsT,KAAM+S,EACNwB,MAAO,SACP7sB,IAAKoB,EAAK2D,GAAG,KAEf8kB,GAAWzoB,EAAK2D,GAAG,GAAI+kB,IAEvBlT,EAAQ5R,KAAK,CACXsT,KAAM+S,EACNwB,MAAO,GACP7sB,IAAKoB,EAAK2D,GAAG,KAKnB+kB,EAAoBnQ,SAAS,CAACuS,WAAYtV,IEiFxCkW,CAAkB/R,Q,+BAGX,IAAD,OACN,OACE,yBAAKF,UAAU,SAAS3S,GAAG,WAEzB,yBAAK2S,UAAU,0CAA0C3S,GAAG,mBAC1D,wBAAI2S,UAAU,6CAAd,iBACA,yBAAKA,UAAU,+BACb,wBAAIA,UAAY,wBAAwB3S,GAAK,eAAe6S,KAAKtV,MAAMymB,WAAWnlB,KAAI,SAACoW,GAAD,OAC9E,wBAAItG,IAAKsG,EAAE7E,KAAMoD,QAAS,EAAKO,oBAAqBpB,UAAWsC,EAAE0P,OAAQ1P,EAAE7E,UACnF,yBAAKuC,UAAU,mCACb,yCACA,kBAAC,KAAD,CAAQkS,cAAc,EACdhd,MAASgL,KAAKtV,MAAMmmB,SACpBzQ,SAAYJ,KAAK8Q,iBACjB7f,QAAS,CACP,CAAE+D,MAAO,UAAWwJ,MAAO,WAC3B,CAAExJ,MAAO,WAAYwJ,MAAO,YAC5B,CAAExJ,MAAO,QAASwJ,MAAO,eAMzC,yBAAKrR,GAAG,wBAEN,yBAAK2S,UAAU,gFACb,4BAAQA,UAAU,4DAA4D3S,GAAG,cAAcwT,QAASuP,IAAxG,iBACA,4BAAQpQ,UAAU,oDAAoD3S,GAAG,cAAcwT,QAASuP,IAAe,uBAAGpQ,UAAU,mBAC5H,yBAAKA,UAAU,wBAAwB3S,GAAG,eAAe6S,KAAKtV,MAAM6S,KAAK,8BAAYyC,KAAKtV,MAAMgmB,mBAEhG,4BAAQ5Q,UAAU,iBAAiB3Y,KAAK,SAASoZ,cAAY,WAAW0R,cAAY,0BAA0BC,gBAAc,yBAAyBC,gBAAc,QAAQC,aAAW,qBACpL,0BAAMtS,UAAU,yBAGlB,yBAAKA,UAAU,2BAA2B3S,GAAG,0BAC3C,wBAAI2S,UAAU,mCACZ,wBAAIA,UAAU,YACZ,4BAAQA,UAAU,2CAA2CkO,KAAK,GAAG7gB,GAAG,SAASwT,QAAS,kBAAM6O,GAAO,KAAvG,cAMR,yBAAK1P,UAAU,kBAAkB3S,GAAG,kCAClC,yBAAK2S,UAAY,OAEf,yBAAKA,UAAY,6DACf,iEACA,2BAAOA,UAAU,kCAAkC3S,GAAK,mBACtD,+BACG6S,KAAKtV,MAAM0kB,kBAAkBpjB,KAAI,SAAC4jB,GAC/B,OACE,wBAAI9T,IAAK8T,EAAErpB,YAAaoa,QAAS,kBAAM,EAAK0Q,eAAezB,KACzD,wBAAI9P,UAAU,iCACX8P,EAAEpnB,MAAM,4BAAQsX,UAAU,wBAAwB3Y,KAAK,UAAS,uBAAG2Y,UAAU,8BAQ9F,yBAAKA,UAAY,qCACf,8CACA,0BAAMA,UAAU,2DAA2D3S,GAAK,oBAAoB8S,aAAa,OAE/G,2BAAOI,QAAQ,UAAf,cAA0C,6BAC1C,kBAAC,KAAD,CAAQrL,MAAOgL,KAAKtV,MAAMwmB,wBAClBpR,UAAU,oCACV3S,GAAG,0BACH8D,QAAS+O,KAAKtV,MAAMglB,oBACpBtP,SAAUJ,KAAKiR,8BACf9Q,UAAQ,IACP,6BAET,2BAAOE,QAAQ,gBAAf,+BAAiE,6BACjE,2BAAOP,UAAU,8BAA8B3Y,KAAK,OAAOgG,GAAG,eAAeoQ,KAAK,2BAA2B4C,UAAQ,EAACC,SAAUJ,KAAKd,qBAA4B,6BAEjK,6BACE,uBAAGR,MAAO,CAACgC,MAAO,OAAQvT,GAAK,gBAAgB6S,KAAKtV,MAAMslB,4BAG5D,2BAAOlQ,UAAY,uBAAuB3Y,KAAK,SAAS6N,MAAM,OAC1D2L,QAAS,kBAAMmP,GAAc,EAAKplB,MAAM6Q,OAAQ,EAAK7Q,MAAM2kB,iBAAkB,EAAK3kB,MAAM0mB,yBAA0B,EAAK1mB,MAAMwmB,wBAAwBlc,MAAO,IAAO7H,GAAG,kC,GAlMpKyT,aAkNlBC,GAAqB,CACvBnH,kBACAI,oBACAD,kBACAE,aACAuC,oBAGW0E,eACX,KACAH,GAFWG,CAGboP,I,0KClOIiC,G,kDAEJ,WAAYpT,GAAQ,IAAD,8BACjB,cAAMA,IAQRqT,aAAe,SAACC,GACZ,IAAIvd,EAAQud,EAAEnT,OAAOpK,MACrB,GAAa,aAAVA,EAAqB,CACtB,IAAI9M,EAAQ,EAAK+W,MAAMlT,UAAU,GAAGK,SAAS,GAAGtE,GAChD,EAAK8W,SAAS,CAAC1W,MAAOA,IACtB,EAAK+W,MAAMxE,eAAevS,QAE1B,EAAK0W,SAAS,CAAC1W,MAAO,KACtB,EAAK+W,MAAMxE,eAAe,IAE5B,EAAKwE,MAAMvE,gBAAgB1F,IAnBZ,EAsBnBwd,kBAAoB,SAACrT,GACjB,IAAMjX,EAAQiX,EAAMC,OAAOpK,MAC3B,EAAK4J,SAAS,CAAC1W,MAAOA,IACT,KAAVA,GAAsC,aAAtB,EAAK+W,MAAM5X,QAAuB,EAAK4X,MAAMxE,eAAevS,IAzBhE,EA4BnBuqB,mBAAqB,SAACF,GACpB,EAAKtT,MAAMxE,eAAe,EAAK/P,MAAMxC,OACrCqqB,EAAEhT,kBA9Be,EA4CnBmT,OAAS,SAACH,GACR,EAAKtT,MAAMO,QAAQvV,KAAK,MA3CxB,EAAKS,MAAQ,CACXxC,MAAO,IAGT,EAAKyqB,aAAe,EAAKA,aAAalN,KAAlB,gBANH,E,qDAkCjBxf,eAAesW,etBrBR1W,IAAMC,SAASC,QAAQC,OAAO4sB,csBuBrClZ,GAAe,Q,mCAGJ6Y,GACX,IAAM5oB,EAAS4oB,EAAEnT,OAAOpK,MACxBgL,KAAKf,MAAMqM,YAAY3hB,K,yCAONkiB,EAAWC,GACzB9L,KAAKf,MAAM2S,cAAgB/F,EAAU+F,aAAe5R,KAAKf,MAAMtV,SAAWkiB,EAAUliB,SACrFqW,KAAKpB,SAAS,CAAC1W,MAAO,KACtB8X,KAAKf,MAAMxE,eAAe,IAC1BuF,KAAKf,MAAMvE,gBAAgB,SAC3BuD,SAASC,eAAe,aAAa2U,W,+BAKvC,IAIIC,EAJEC,EAAa/S,KAAKf,MAAMzD,gBACxBwX,EAAWhT,KAAKf,MAAM3D,KAAX,UAAqB0E,KAAKf,MAAM3D,KAAKtD,UAArC,YAAkDgI,KAAKf,MAAM3D,KAAKrD,UAAa,KAC1Fgb,EAAYjT,KAAKf,MAAMzC,SAASmV,SAASrjB,WAAW,UAsB1D,OAlBEwkB,EADuB,aAAtB9S,KAAKf,MAAM5X,OACE,kBAAC6rB,GAAA,EAAD,CAAO/rB,KAAK,SAASiZ,SAAUJ,KAAKwS,mBAC/BxS,KAAKf,MAAMlT,UAAUC,KAAI,SAACK,EAAUrC,GACnC,OAAO,8BAAU8R,IAAK9R,EAAGwU,MAAOnS,EAAS7D,OACpC6D,EAASD,SAASJ,KAAI,SAACud,EAASxC,GAC7B,OAAO,4BAAQjL,IAAKiL,EAAG/R,MAAOuU,EAAQzhB,IAAKyhB,EAAQza,IAAItG,eAMrE,kBAAC0qB,GAAA,EAAD,CACVpT,UAAU,eACV9K,MAAOgL,KAAKtV,MAAMxC,MAClBgY,YAAY,SACZE,SAAUJ,KAAKwS,oBAKnB,kBAACW,GAAA,EAAD,CAAQrT,UAAU,cAChB,kBAACqT,GAAA,EAAOC,MAAR,CAActT,UAAU,sCAAsCE,KAAKf,MAAM4S,gBAEzE,kBAACsB,GAAA,EAAOE,KAAR,CAAavT,UAAU,6BAAvB,SACCmT,EAEG,kBAACK,GAAA,EAAD,CAAKxT,UAAU,uBACZE,KAAKf,MAAM3I,KACV,kBAACid,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CAAW1T,UAAU,iCACnB,kBAACoT,GAAA,EAAD,CAAO/rB,KAAK,SAASoW,KAAK,SAASvI,MAAOgL,KAAKf,MAAM3I,KAAKzL,IAAKuV,SAAUJ,KAAK2S,cAE1E3S,KAAKf,MAAM5N,MAAMrF,KAAI,SAACxF,GACpB,OAAO,4BAAQsV,IAAKtV,EAAIqE,IAAKmK,MAAOxO,EAAIqE,KAAjC,IAAwCrE,EAAIgC,MAA5C,WAMjB,MAGN,KAEF,kBAAC2qB,GAAA,EAAOE,KAAR,CAAavT,UAAU,6BAAvB,WACA,kBAACyT,GAAA,EAAD,CAAMpmB,GAAI,YAAa4S,SAAUC,KAAKyS,oBAClC,kBAAC,KAAD,KACI,kBAAC,KAAD,KACI,kBAACgB,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CAAiBC,UAAU,WACvB,kBAACT,GAAA,EAAD,CAAO/rB,KAAK,SAASoW,KAAK,SAASpQ,GAAG,SAASiT,SAAUJ,KAAKsS,cAC1D,4BAAQxW,IAAI,QAAQ9G,MAAM,SAA1B,SACA,4BAAQ8G,IAAI,WAAW9G,MAAM,YAA7B,YACA,4BAAQ8G,IAAI,UAAU9G,MAAM,WAA5B,WACA,4BAAQ8G,IAAI,SAAS9G,MAAM,UAA3B,YAGP8d,EAEA,kBAACY,GAAA,EAAD,CAAiBC,UAAU,UACxB,kBAACC,GAAA,EAAD,CAAgBlV,MAAO,CAAEmV,OAAQ,WAAalT,QAASX,KAAKyS,oBACxD,uBAAG3S,UAAU,uBAQtCiT,EACC,oCACE,kBAACO,GAAA,EAAD,CAAKxT,UAAU,WACb,kBAACwT,GAAA,EAAIQ,KAAL,CAAUhU,UAAU,mCAApB,IAAwDkT,EAAxD,KACA,kBAACpE,EAAA,EAAD,CAAQ9O,UAAU,6BAA6BkO,KAAK,IAAIrN,QAASX,KAAKwP,QAAtE,YAIJ,oCACE,kBAAC8D,GAAA,EAAD,CAAKxT,UAAU,WACb,kBAACwT,GAAA,EAAIQ,KAAL,CAAUnT,QAASX,KAAK0S,QAAxB,UACA,kBAACY,GAAA,EAAIQ,KAAL,CAAU9F,KAAK,KAAf,gB,GAjJUpN,aA2KlBC,GAAqB,CACzB9G,aACAL,kBACAe,kBACAC,oBAGaqG,eAAWC,aAvBF,SAACtW,EAAOwiB,GAC9B,MAAO,CACL3mB,YAAamE,EAAMoM,QAAQvQ,YAC3BoD,OAAQe,EAAMoM,QAAQnN,OACtB6R,gBAAiB9Q,EAAMoM,QAAQ0E,gBAC/BF,KAAM5Q,EAAMoM,QAAQ/L,OACpBsG,MAAO3G,EAAMoM,QAAQzF,MACrBiF,KAAM5L,EAAMoM,QAAQR,KACpB5C,UAAWhJ,EAAMsJ,MAAMN,UACvBjL,QAASiC,EAAMgN,MACf3L,UAAWrB,EAAMqB,UAAUR,MAC3Ba,SAAU1B,EAAMsJ,MAAM5H,SACtBlE,MAAOwC,EAAMoM,QAAQ6E,YACrBtU,OAAQqD,EAAMoM,QAAQ8E,gBAYxBiF,GAFwBG,CAGxBqR,K,8BCba0B,I,OArKK,SAAA9U,GAChB,IAAMlU,EAASipB,aAAY,SAAAtpB,GAAK,OAAIA,EAAMoM,QAAQ/L,UAC5CE,EAAWgpB,cAFQ,EAGOC,mBAAS,GAHhB,mBAGlBC,EAHkB,KAGRC,EAHQ,KAKlB1G,EAAa,SAAC6E,GACjBtT,EAAMoV,WAQJC,EAAY,uCAAG,WAAOC,GAAP,iBAAApuB,EAAA,6DACXquB,EAAQC,MAAM5sB,KAAK0sB,GACzBH,EAAY,GAENM,EAAkB,GACxBF,EAAM1pB,QAAN,uCAAc,WAAO5B,GAAP,qBAAA/C,EAAA,2DACN+C,EAAK/B,KAAKwtB,QAAQ,WAAa,GADzB,wBAEAC,EAAOze,OAAO0e,KAAO1e,OAAO2e,UAF5B,SAGYC,EAAgBH,EAAKI,gBAAgB9rB,IAHjD,OAGAwiB,EAHA,OAIF9L,EAAS8L,EAAIuJ,cAAiBvJ,EAAI9L,MAClCgE,EAAS8H,EAAIwJ,eAAiBxJ,EAAI9H,OACtC1a,EAAK0W,MAAQA,EACb1W,EAAK0a,OAASA,EACd8Q,EAAgBzqB,KAAKkrB,EAAiBjsB,EAAM,UARtC,wBASAA,EAAK/B,KAAKmH,WAAW,SAC3BomB,EAAgBzqB,KAAKkrB,EAAiBjsB,EAAM,UAE5CwrB,EAAgBzqB,KAAKkrB,EAAiBjsB,EAAM,SAZtC,4CAAd,uDALiB,SAqBX2C,QAAQC,IAAI4oB,GArBD,OAsBjBhH,IACAhd,GAAgB,CAAClI,MAAO,YAAarB,KAAK,UAAWgQ,QAAQ,0BAvB5C,2CAAH,sDAyBZ4d,EAAkB,SAAClH,GACrB,OAAO,IAAIhiB,SAAQ,SAACupB,EAASC,GACzB,IAAI3J,EAAMzN,SAASuT,cAAc,OACjC9F,EAAI4J,OAAS,kBAAMF,EAAQ1J,IAC3BA,EAAI6J,QAAUF,EACd3J,EAAImC,IAAMA,MAGZsH,EAAgB,uCAAG,WAAOjsB,EAAM/B,EAAMqP,EAAGC,GAAtB,uBAAAtQ,EAAA,+EAEOkC,EAAe0C,EAAOxE,YAAawE,EAAOF,KAFjD,cAEX2qB,EAFW,gBAGOvsB,EAAWC,EAAMK,GAHxB,cAGXksB,EAHW,OAIXrhB,EAAaohB,EAAUnvB,KACvBA,EAAOovB,EAAUpvB,KACvB+N,EAAW5L,MAAQnC,EAAKqvB,SACxBthB,EAAW1L,OAAS,SACpBrC,EAAKuC,QAAUwL,EAAW/N,KAAKuC,QAAU,EACzCwL,EAAW/N,KAAOA,EAClB+N,EAAWuhB,YAActvB,EAAKsvB,YAVb,UAWWvtB,EAAUgM,EAAYrJ,EAAOxE,YAAa6N,EAAWvJ,KAXhE,SAWX+qB,EAXW,QAaHvvB,KAAKuZ,MAAQ1W,EAAK0W,MAChCgW,EAAcvvB,KAAKud,OAAS1a,EAAK0a,OAE7B3E,EAAM9K,OACN0hB,EAAWD,EAAezuB,GACpB8X,EAAMtV,QACZmsB,EAAWF,EAAepf,EAAGC,EAAGtP,GAnBnB,kDAsBjB2R,QAAQC,IAAR,MAtBiB,sGAAH,4DA6BhB8c,EAAU,uCAAG,WAAOzhB,EAAYjN,GAAnB,mBAAAhB,EAAA,sEACLuB,EAASuX,EAAM9K,OAAQC,EAAWvJ,IAAK,UADlC,OAGXI,EAASsM,GAAW0H,EAAM9K,OAAQ,SAC9B8K,EAAM8W,eACAC,EADa,UACKC,GADL,OACiB7hB,EAAW/N,KAAKpB,KAC9CuD,EAAQ4L,EAAW5L,MACrBuG,EAAO,GACA,UAAP5H,EACA4H,EAAO,iCAAmCqF,EAAWvJ,IAAM,UAAYmrB,EAAc,wBAA0BxtB,EAAQ,mBAAqBwtB,EAAe,KAC7I,UAAP7uB,EACP4H,EAAI,4EAAwEinB,EAAxE,kCAEJjnB,EAAM,+BAAiCqF,EAAWvJ,IAAM,WAAamrB,EAAe,8BACpFjnB,GAAQ,oBAAaknB,EAAb,6DAAoFztB,EAAQ,KAAOA,EAAQ,QAEvHyW,EAAMiX,kBAAkBnnB,IAE5B9D,EAAS8L,GAAiBkI,EAAM9K,SAlBrB,2CAAH,wDAyBV2hB,EAAU,uCAAG,WAAO1hB,EAAYoC,EAAGC,EAAG0f,GAAzB,yBAAAhwB,EAAA,6DACTiwB,EAAO5f,GAAO,IACd6f,EAAO5f,GAAO,IAChB6f,EAAI,IACJC,EAAI,IACJC,GAAc,EACC,UAAfL,IACAG,EAAIliB,EAAW/N,KAAKuZ,MACpB2W,EAAIniB,EAAW/N,KAAKud,OAChB0S,EAAI,MAAMA,EAAI,KAClBC,EAAKD,EAAEC,EAAKniB,EAAW/N,KAAKuZ,MAC5B4W,GAAc,GAXH,SAaI9uB,EACfuX,EAAMtV,OACNyK,EAAWvJ,IACX,WACA,CAAC2L,EAAG4f,EAAM3f,EAAG4f,EAAMzW,MAAO0W,EAAG1S,OAAQ2S,IAjB1B,UAaT9uB,EAbS,QAmBX+uB,EAnBW,wBAoBX/uB,EAAKpB,KAAKmwB,aAAc,EApBb,UAqBLjvB,EAAQE,EAAKoD,IAAKpD,GArBb,4CAAH,4DAyBV8B,EAAmB,SAACktB,GACtB,IAAMC,EAAmBC,KAAKC,MAA8B,IAAvBH,EAAcI,OAAgBJ,EAAcK,OACjF1C,EAAYsC,IAIhB,OACI,kBAACtI,EAAA,EAAD,CAAO2I,KAAM9X,EAAMjS,YAAashB,OAAQZ,GACpC,kBAACU,EAAA,EAAMG,OAAP,CAAcC,aAAW,GACrB,kBAACJ,EAAA,EAAMK,MAAP,gCAEJ,kBAACL,EAAA,EAAMM,KAAP,KACI,kBAAC,KAAKsI,KAAN,CAAW7pB,GAAG,eACV,kBAAC,KAAK6pB,KAAK9D,MAAX,CAAiB9S,SAnIZ,SAACmS,GAClB+B,EAAa/B,EAAEnT,OAAOoV,WAoId,yBAAK9V,MAVF,CAAEkB,MAAO,OAAQc,MAAO,UAWvB,kBAACuW,GAAA,SAAD,CACIC,iBAAkB,SAAC/X,GAAD,OAAWrG,QAAQC,IAAI,mBAAoBoG,IAC7DgY,iBAAkB,SAAChY,GAAD,OAAWrG,QAAQC,IAAI,mBAAoBoG,IAC7DiY,YAAa,SAACjY,GAAD,OAAWrG,QAAQC,IAAI,cAAeoG,IACnDkY,WAAY,SAAClY,GAAD,OAAWrG,QAAQC,IAAI,aAAcoG,IACjDmY,YAAa,SAACnY,GAAD,OAAWrG,QAAQC,IAAI,cAAeoG,IACnDoY,OAAQ,SAAC/C,EAAOrV,GAAR,OAAkBmV,EAAaE,KAN3C,6BAWJ,kBAACgD,GAAA,EAAD,CAAaC,IAAKtD,KAEtB,kBAAC/F,EAAA,EAAMO,OAAP,KACI,kBAACC,EAAA,EAAD,CAAQC,QAAQ,UAAUlO,QAAS+M,GAAnC,a,UCxKZgK,I,OAAyB,CACzBC,QAAS,CACLC,GAAG,EACHtB,GAAG,GAEPuB,UAAW,CACPD,GAAG,EACHtB,GAAG,GAEPwB,OAAQ,CACJF,GAAG,EACHtB,GAAG,KAqBAyB,GAAwB,SAACnxB,EAAQmE,GACxC,OAAOitB,GAASpxB,EAAQmE,IAAWktB,GAAcrxB,EAAQmE,IAGlDitB,GAAW,SAACpxB,EAAQmE,GAC3B,OAAOnE,EAAO6B,QAAQ0D,SAASpB,EAAOF,MAG/BotB,GAAgB,SAACrxB,EAAQmE,GAChC,QAAKnE,EAAO4O,eAGL5O,EAAO4O,cAAcrJ,SAASpB,EAAOF,MAUrCqtB,GAAa,SAACtxB,EAAQmE,GAC7B,OAxC6B,SAACnE,EAAQmE,EAAQotB,GAC9C,SAAKvxB,IAAWmE,KAII,YAAhBA,EAAOwN,QAI2D,IAAlEmf,GAAuB9wB,EAAO+B,YAAYwvB,IAKvCJ,GAAsBnxB,EAAQmE,KA0B9BqtB,CAAoBxxB,EAAQmE,EAAQ,MCzCzCstB,ICXiBhuB,YAAa,YAKJI,YAJd,GAIuC,I,kDDQrD,WAAYwU,GAAQ,IAAD,8BACf,cAAMA,IAFVqZ,SAAW,GACQ,EAmCnBC,aAAe,SAAChG,GACZ,GAAI,EAAKtT,MAAMtV,SAAW,EAAKe,MAAM8tB,QACjC,EAAK5Z,SAAS,CACV6Z,WAAW,IAEftiB,OAAOuiB,YAAW,WACd,EAAK9Z,SAAS,CAAE6Z,WAAW,MAC5B,UAEF,CACD,IAAME,EAAU,CAAEniB,EAAG,IAAMC,EAAG,KAC1BxR,EAAG,UAAMG,EAAN,UACHwzB,EAAS,CACT7yB,QAAS,CAAE6sB,cAAc,UAAD,OAAY,EAAKloB,MAAM9E,SAEnD,EAAKqZ,MAAMtL,aAAa7I,SAAQ,SAAAyG,GAC5B,IAAM/C,EAAM,EAAKyQ,MAAMtN,UAAUtK,QAAO,SAAC+R,GAAD,OAASA,EAAItR,KAAOyJ,EAAK1G,OAAK,GACtE8tB,EAAQniB,EAAImgB,KAAKkC,IAAIF,EAAQniB,EAAGhI,EAAInI,KAAKmQ,GACzCmiB,EAAQliB,EAAIkgB,KAAKkC,IAAIF,EAAQliB,EAAGjI,EAAInI,KAAKoQ,MAE7C,EAAKwI,MAAMtL,aAAa7I,SAAQ,SAAAyG,GAC5B,IAAI4C,EAAS5C,EAAK1G,IACd3C,EAAQ,CACR,KAAQ,EAAKwC,MAAM8tB,QACnB,GAAMrkB,EACN,KAAQ,WACR,KAAQwkB,GAEZG,IAAMryB,KAAKxB,EAAKiD,EAAO0wB,GAAQhvB,MAC3B,SAAAgC,GACI,EAAKgT,SAAS,CAAEma,SAAS,IAAQ,WAC7B5iB,OAAOuiB,YAAW,WACd,EAAK9Z,SAAS,CAAEma,SAAS,MAC1B,gBApER,EA+EnBC,gBA/EmB,uCA+ED,WAAOzG,GAAP,uBAAApsB,EAAA,4DACV8yB,EAAY,EAAKha,MAAMtL,aAAalO,QAExB,GAHF,oBAIS0Q,OAAO+iB,QAAQ,uDAAyDD,EAAY,eAJ7F,wDASN3iB,EAAO,EAAK2I,MAAM3I,KAClB/P,EAAc,EAAK0Y,MAAM1Y,YACzBwE,EAAS,EAAKkU,MAAMlU,OAAOF,IAC3BmJ,EAAQ,EAAKiL,MAAMtL,aAZb,UAaJ,EAAKsL,MAAMka,gBAAgB7iB,EAAM/P,EAAawE,EAAQiJ,GAblD,QAcV,EAAKiL,MAAMtC,uBAAuB,EAAKsC,MAAMtV,QAdnC,wBAkBVyM,MAAM,qDAlBI,4CA/EC,wDAqGnBrE,SAAW,SAAC/I,EAAWsM,GACnB,EAAK2J,MAAM5G,iBAAiBrP,EAAWsM,IAtGxB,EAyGnB8jB,kBAAoB,SAACC,GACjB,OAAI,EAAKpa,MAAMnL,mBAAmBulB,GACT,EAAKpa,MAAMnL,mBAAmBulB,GAAartB,KAAI,SAACmI,GAAD,OAAY,EAAK8K,MAAMpL,eAAeM,MAGvG,MA9GQ,EAiHnBmlB,SAAW,SAACnlB,GACR,EAAK8K,MAAM5G,iBAAiBlE,EAAQ,SAhHpC,EAAKzJ,MAAQ,CACT9E,MAAOK,eAAed,QAAQ,SAC9BqzB,QAAS,EAAKvZ,MAAMtV,OACpBpD,YAAaN,eAAed,QAAQ,eACpC4zB,SAAS,EACTN,WAAW,GAGf,EAAK9F,aAAe,EAAKA,aAAalN,KAAlB,gBACpB,EAAK8S,aAAe,EAAKA,aAAa9S,KAAlB,gBAEpB,EAAKuT,gBAAkB,EAAKA,gBAAgBvT,KAArB,gBACvB,EAAK2T,kBAAoB,EAAKA,kBAAkB3T,KAAvB,gBACzB,EAAK6T,SAAW,EAAKA,SAAS7T,KAAd,gBAChB,EAAK1T,SAAW,EAAKA,SAAS0T,KAAd,gBAhBD,E,sGAuBN8M,GACTA,EAAEgH,UACF,IACIpsB,EADSolB,EAAEnT,OACCpK,MAEhBgL,KAAKpB,SAAS,CACV4Z,QAASrrB,M,+BAwFP,IAAD,OACCwK,EAAY,IAAIC,KAAKC,eAAe,UAAWC,IACrD,OACI,oCACI,kBAACyb,GAAA,EAAD,CAAMzT,UAAU,aACZ,kBAAC0Z,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CAAKC,GAAG,KACJ,kBAAClG,GAAA,EAAD,KACI,kBAACN,GAAA,EAAD,CAAO/rB,KAAK,SAASoW,KAAK,SAAS6C,SAAUJ,KAAK2S,cAC9C3S,KAAKf,MAAM5N,MAAMrF,KAAI,SAACxF,EAAKwD,GACvB,OAAO,4BAAQ8R,IAAK9R,EAAGgL,MAAOxO,EAAIqE,KAA3B,IAAkCrE,EAAIgC,MAAtC,WAMvB,kBAACixB,GAAA,EAAD,CAAKC,GAAG,KACJ,kBAAC9K,EAAA,EAAD,CAAQjO,QAASX,KAAKuY,cAAtB,gBAGJ,kBAACkB,GAAA,EAAD,CAAKC,GAAG,KACJ,kBAAC9K,EAAA,EAAD,CAAQjO,QAASX,KAAKgZ,iBAAtB,sBAGR,kBAACQ,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,kBAACE,GAAA,EAAD,CAAOjZ,MAAM,SAASkZ,OAAQ5Z,KAAKtV,MAAM+tB,WAAzC,mCAGA,kBAACkB,GAAA,EAAD,CAAOjZ,MAAM,OAAOkZ,OAAQ5Z,KAAKtV,MAAMquB,SAAvC,2BAMX/Y,KAAKf,MAAMtL,aAAa3H,KACrB,SAACxF,EAAKwD,GACF,IACI6vB,EAaAxzB,EAwBAyzB,EAtCAjmB,EAAiB,EAAKulB,kBAAkB5yB,EAAIqE,KAehD,GAbIgJ,IACAgmB,EAAiB,kBAACL,GAAA,EAAD,KACb,kBAACC,GAAA,EAAD,CAAK3Z,UAAU,aACX,kBAAC0Z,GAAA,EAAD,CAAK1Z,UAAU,qCAAf,mBACCjM,EAAe7H,KAAI,SAACuF,EAAMvH,GACvB,OAAO,kBAACwvB,GAAA,EAAD,CAAK1d,IAAK9R,GACb,kBAAC4kB,EAAA,EAAD,CAAQC,QAAQ,QAAQ/O,UAAU,kCAAkCa,QAAS,kBAAM,EAAK2Y,SAAS/nB,EAAK1G,OAAO0G,EAAK/I,cAOlI,EAAKyW,MAAM/W,OAAS1B,EAAIH,KAAK6iB,QAAS,CACtC,IAAIxa,EAAYlI,EAAIH,KAAK6iB,QACrB6Q,EAAQrrB,EAAUimB,QAAQ,EAAK1V,MAAM/W,OACrC6xB,GAAS,IACT1zB,EAAOqI,EAAUlJ,UAAU,EAAGu0B,GAAS,2BAA6BrrB,EAAUlJ,UAAUu0B,EAAOA,EAAQ,EAAK9a,MAAM/W,MAAMzC,QAAU,UAAYiJ,EAAUlJ,UAAUu0B,EAAQ,EAAK9a,MAAM/W,MAAMzC,cAE5L,GAAI,EAAKwZ,MAAM/W,OAAS1B,EAAIH,KAAKyD,KAAM,CAC1C,IAAI4E,EAAYlI,EAAIH,KAAKyD,KACrBiwB,EAAQrrB,EAAUimB,QAAQ,EAAK1V,MAAM/W,OACrC6xB,GAAS,IACT1zB,EAAOqI,EAAUlJ,UAAU,EAAGu0B,GAAS,2BAA6BrrB,EAAUlJ,UAAUu0B,EAAOA,EAAQ,EAAK9a,MAAM/W,MAAMzC,QAAU,UAAYiJ,EAAUlJ,UAAUu0B,EAAQ,EAAK9a,MAAM/W,MAAMzC,cAG/LY,EAAOG,EAAIH,KAAK6iB,QAAU1iB,EAAIH,KAAK6iB,QAAU1iB,EAAIH,KAAKyD,KAI1D,KAAOzD,GAAQA,EAAK8F,SAAS,sBAEzB9F,EAAOA,EAAKoW,QAAQ,oBAAuB,QAAWxX,EAAM,gBAWhE,OALI60B,GAD8C,IAA9CE,GAAkBxzB,EAAK,EAAKyY,MAAMlU,QACjB,kBAAC6jB,EAAA,EAAD,CAAQ9O,UAAU,cAAc+O,QAAQ,eAAelO,QAAS,kBAAM,EAAK5O,SAASvL,EAAIqE,IAAK,WAA7F,aAEA,kBAAC+jB,EAAA,EAAD,CAAQ9O,UAAU,cAAc+O,QAAQ,eAAelO,QAAS,kBAAM,EAAK5O,SAASvL,EAAIqE,IAAK,UAA7F,aAIjB,kBAAC2uB,GAAA,EAAD,CAAK1Z,UAAU,oDAAoDhE,IAAK9R,GACpE,kBAACyvB,GAAA,EAAD,KACI,kBAACD,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CAAKC,GAAG,KAAK5Z,UAAU,qCAAqCtZ,EAAIgC,OAChE,kBAACixB,GAAA,EAAD,CAAKC,GAAG,KACJ,kBAAC9K,EAAA,EAAD,CAAQC,QAAQ,oBAAoB/O,UAAU,8BAC1Ca,QAAS,kBAAM,EAAK1B,MAAMnM,mBAAmB,CAAEoC,SAAS,EAAOf,OAAQ3N,EAAIqE,QAC3E,uBAAGiV,UAAU,oBAIzB,kBAAC0Z,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,0BAAM3Z,UAAU,OAAOma,wBAAyB,CAAEC,OAAQ7zB,IAAiBG,EAAIH,KAAK6iB,QAAU1iB,EAAIH,KAAK6iB,QAAU1iB,EAAIH,KAAKyD,WAGjI+vB,EACD,kBAACL,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,kBAACA,GAAA,EAAD,KAAK,yBAAK3Z,UAAU,uCAAuC,EAAKb,MAAMvH,MAAMlR,EAAIiC,QAAQ,IAAIuP,UAAY,IAAK,EAAKiH,MAAMvH,MAAMlR,EAAIiC,QAAQ,IAAIwP,SAAzI,SAA4JN,EAAUO,OAAO,IAAIC,KAAK3R,EAAIyc,YAC/L,kBAACwW,GAAA,EAAD,KAAK,kBAAC7K,EAAA,EAAD,CAAQ9O,UAAU,yBAAyB+O,QAAQ,eAAelO,QAAS,kBAAM,EAAK1B,MAAMzG,QAAQhS,EAAIqE,OAAxG,YACL,kBAAC4uB,GAAA,EAAD,KAAMK,e,GA/NxBlZ,cAiQpBC,GAAqB,CACvBxI,oBACAvF,sBACAqmB,gBCxQ2B,SAAC7iB,EAAM/P,EAAawE,EAAQiJ,GAA5B,OAAsC,SAAA/I,GACjE,IACIouB,EACAc,EAFAvzB,EAAS,GAGT+C,EAAS2M,EAAKzL,IAClBjE,EAAO6B,QAAUsC,EAAO2E,MAAM,KAC9B9I,EAAOL,YAAcA,EACrBK,EAAO+B,WAAa2N,EAAK3N,WAAa2N,EAAK3N,WAAa,SACxD/B,EAAO8B,OAAS,SAChB9B,EAAO4B,MAAQ,aACf5B,EAAOO,KAAO,OACdP,EAAO4O,cAAgBc,EAAKd,cAC5BsD,QAAQC,IAAI,SAAUnS,GAEtBsE,EAAsB3E,EAAaK,GAAQgD,MAAK,SAAAwT,GAC5Cic,EAAcjc,EAASvS,IACvBiO,QAAQC,IAAI,WAAYqE,GACxB,IAAI7L,EAAO,GACXA,EAAK9I,QAAU7B,EAAO6B,QACtB8I,EAAKmE,SAAW,KAChBnE,EAAKhL,YAAcA,EACnBgL,EAAKlL,KAAO,CAAEyD,KAAM,IACpByH,EAAKoE,WAAa,GAClBpE,EAAK5I,WAAa,YAClB4I,EAAK7I,OAAS,UACd6I,EAAK/I,MAAQ,GACb+I,EAAKpK,KAAO,OACZoK,EAAKiE,cAAgBc,EAAKd,cAC1BsD,QAAQC,IAAI,OAAQxH,GAEpBrG,EAAsB3E,EAAagL,GAAM3H,MAAK,SAAAwwB,GAC1CthB,QAAQC,IAAI,eAAgBqhB,GAC5BD,EAAkBC,EAAavvB,IAC/BuvB,EAAa/zB,KAAO,CAChByD,KAAM,GACN0H,UAAW,CAAE7H,OAAO,GAAD,OAAK0vB,KAE5Be,EAAa1xB,OAAS,SACtB0xB,EAAa5xB,MAAQ,YACrBsQ,QAAQC,IAAI,4BAA6BqhB,GACzClvB,EAAckvB,EAAc7zB,EAAa4zB,GAAiBvwB,MAAK,SAAAywB,GAG3DnvB,EAAavB,EAAQwwB,EAAiB,WAD5B,CAAE3jB,EAAG,IAAKC,EAAG,MACgC7M,MAAK,SAAAgC,GACxDoI,EAAMlJ,SAAQ,SAAAyG,GAEVrG,EAAamuB,EAAa9nB,EAAK1G,IAAK,WAD1B,CAAE2L,EAAG,GAAIC,EAAG,KAC+B7M,MAAK,SAAAgC,G1BiGrD,IAAC0uB,K0B/FgB/oB,EAAK1G,I1BgGxChF,IAAMO,IAAN,UAAahB,EAAb,yBAAoCk1B,K0BhGS1wB,MAAK,SAAA2wB,GAC7B,IACI9yB,EADQ8yB,EAAQl0B,KACHgB,QAAO,SAAAb,GACpB,OAAOA,EAAIqB,KAAKsE,SAASxC,MAE7BuB,EAAezD,EAAK,GAAGoD,uBAM5CX,OAAM,SAAAC,GACL2O,QAAQC,IAAI,QAAS5O,SAG1BD,OAAM,SAAAC,GACL2O,QAAQC,IAAI,QAAS5O,QDyMzBwS,2BAGWqE,gBA3BS,SAACtW,EAAOwiB,GAC5B,IAAMxZ,EAAYhJ,EAAMsJ,MAAMN,UACxBgE,EAAQhN,EAAMgN,MACpB,MAAO,CACH/N,OAAQe,EAAMoM,QAAQnN,OACtB0H,MAAO3G,EAAMoM,QAAQzF,MACrBiF,KAAM5L,EAAMoM,QAAQR,KACpB3C,aAAcjJ,EAAMsJ,MAAML,aAAa3H,KACnC,SAAAmI,GAAM,OAAIA,KAAUT,EAChBA,EAAUS,GAAUzJ,EAAMsJ,MAAMH,eAAeM,MAEvDxC,UAAWjH,EAAMsJ,MAAMrC,UACvB5G,OAAQL,EAAMoM,QAAQ/L,OACtBxE,YAAamE,EAAMoM,QAAQvQ,YAC3BuN,mBAAoBpJ,EAAMsJ,MAAMF,mBAChCD,eAAgBnJ,EAAMsJ,MAAMH,eAC5B6D,MAAOA,KAaXmJ,GAFWG,CAGbqX,I,mBE7QImC,G,kDACF,WAAYvb,GAAQ,IAAD,8BACf,cAAMA,IAgBVzG,QAAU,SAACA,GACP,EAAKyG,MAAM5I,QAAQ,EAAK4I,MAAM3I,KAAM,EAAK2I,MAAM1Y,YAAa,EAAK0Y,MAAMwb,UAAU5vB,IAAK2N,IAlBvE,EAqBnBzG,SAAW,SAAC/I,EAAWsM,GACnB,EAAK2J,MAAM5G,iBAAiBrP,EAAWsM,IAtBxB,EAyBnBolB,QAAU,SAAC1lB,GACP,EAAK4J,UAAS,SAACkN,GACX,MAAO,CAAE6O,MAAO7O,EAAU6O,UA3Bf,EA+BnBC,UAAY,SAACrP,EAAKpX,GACd,EAAK8K,MAAMnM,mBAAmB,CAAEqB,SAAQe,QAASqW,EAAInM,OAAOlK,WAhC7C,EAmCnB2lB,iBAAmB,SAACtI,EAAGhhB,GACnB,EAAKqN,SAAS,CACVkc,gBAAiBvI,EAAEnT,OAAOlK,WAnC9B,EAAKxK,MAAQ,CACT6G,KAAM,GACNwpB,UAAU,EACVJ,MAAM,EACNK,cAAe,GACfF,iBAAiB,GAErB,EAAKF,UAAY,EAAKA,UAAUnV,KAAf,gBACjB,EAAK1T,SAAW,EAAKA,SAAS0T,KAAd,gBAChB,EAAKjN,QAAU,EAAKA,QAAQiN,KAAb,gBAXA,E,kGAgDf,IAPM,IAIFwV,EAQAnB,EAZC,OACCoB,EAAclb,KAAKf,MAAMkc,UAAwD,IAA5ClnB,OAAOiS,KAAKlG,KAAKf,MAAMkc,UAAU11B,OACtE21B,EAAOpb,KAAKtV,MAAMiwB,KAAO,kBAAoB,mBAC7ChjB,EAAY,IAAIC,KAAKC,eAAe,UAAWC,IAEjDzR,EAAO2Z,KAAKf,MAAM1N,KAAKlL,KAAKyD,KAEzBzD,EAAK8F,SAAS,sBAEjB9F,EAAOA,EAAKoW,QAAQ,oBAAuB,QAAWxX,EAAM,gBAwBhE,OAnBI60B,GAD6D,IAA7DE,GAAkBha,KAAKf,MAAM1N,KAAMyO,KAAKf,MAAMwb,WAC7B,kBAAC7L,EAAA,EAAD,CAAQ9O,UAAU,cAAc+O,QAAQ,eAAelO,QAAS,kBAAM,EAAK5O,SAAS,EAAKkN,MAAM1N,KAAK1G,IAAK,WAAzG,aAEA,kBAAC+jB,EAAA,EAAD,CAAQ9O,UAAU,cAAc+O,QAAQ,eAAelO,QAAS,kBAAM,EAAK5O,SAAS,EAAKkN,MAAM1N,KAAK1G,IAAK,UAAzG,aAGjBmV,KAAKtV,MAAMowB,kBACXG,EAAa,6BACT,kBAACzB,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,kBAACD,GAAA,EAAD,CAAKS,wBAAyB,CAAEC,OAAQ7zB,KACxC,kBAACmzB,GAAA,EAAD,KACI,kBAAC5K,EAAA,EAAD,CAAQ9O,UAAU,qCAAqC+O,QAAQ,eAAelO,QAAS,kBAAM,EAAKnI,QAAQ,EAAKyG,MAAM1N,KAAK1G,OAA1H,WACCivB,OAQjB,oCACI,kBAAC,cAAD,CAAYuB,QAAM,EAACC,IAAE,GACjB,6BACI,kBAAC9B,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CAAK3Z,UAAU,mBACX,kBAAC0Z,GAAA,EAAD,CAAK1Z,UAAU,SACX,kBAAC2Z,GAAA,EAAD,CAAKC,GAAG,KAAK5Z,UAAU,gCAClBob,EACG,kBAACtM,EAAA,EAAD,CAAQC,QAAQ,OAAOlO,QAAS,kBAAM,EAAK+Z,SAAS,EAAKC,OAAOzI,gBAAc,wBAAwBC,gBAAenS,KAAKtV,MAAMiwB,MAC5H,uBAAG7a,UAAS,aAAQsb,MAEtB,KACLpb,KAAKf,MAAM1N,KAAK/I,OACrB,kBAACixB,GAAA,EAAD,CAAKC,GAAG,KACJ,kBAACnG,GAAA,EAAD,CAAMzT,UAAU,wBACZ,kBAAC0T,GAAA,EAAD,KACI,kBAACN,GAAA,EAAD,CAAO/rB,KAAK,WAAW+N,QAAS8K,KAAKf,MAAMsc,UAAW/sB,IAAKwR,KAAKf,MAAM1N,KAAK1G,IAAKuV,SAAU,SAAAmS,GAAC,OAAI,EAAKqI,UAAUrI,EAAG,EAAKtT,MAAM1N,KAAK1G,YAKjJ,kBAAC2uB,GAAA,EAAD,CAAK1Z,UAAU,4BACX,kBAAC2Z,GAAA,EAAD,KAAK,kCAAQzZ,KAAKf,MAAMlU,OAAnB,KAAL,QAA+C4M,EAAUO,OAAO,IAAIC,KAAK6H,KAAKf,MAAM1N,KAAK0R,WACzF,kBAACwW,GAAA,EAAD,CAAKC,GAAG,OAIX1Z,KAAKf,MAAMkc,SACR,kBAACK,GAAA,EAAD,CAAUC,GAAIzb,KAAKtV,MAAMiwB,MACrB,kBAACnB,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CAAKC,GAAG,MACR,kBAACD,GAAA,EAAD,CAAKC,GAAG,MACJ,kBAAC,GAAD,CAAagC,UAAW1b,KAAKf,MAAMkc,cAI7C,SAOtB,kBAAC,cAAD,CAAYQ,OAAK,EAACC,MAAI,GAClB,6BACI,kBAACpC,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CAAK3Z,UAAU,mBACX,kBAAC0Z,GAAA,EAAD,CAAK1Z,UAAU,SACX,kBAAC2Z,GAAA,EAAD,CAAKC,GAAG,KAAK5Z,UAAU,gCAClBob,EACG,kBAACtM,EAAA,EAAD,CAAQC,QAAQ,OAAOlO,QAAS,kBAAM,EAAK+Z,SAAS,EAAKC,OAAOzI,gBAAc,wBAAwBC,gBAAenS,KAAKtV,MAAMiwB,MAC5H,uBAAG7a,UAAS,aAAQsb,MAEtB,KACLpb,KAAKf,MAAM1N,KAAK/I,OACrB,kBAACixB,GAAA,EAAD,CAAKC,GAAG,KACJ,kBAACnG,GAAA,EAAD,CAAMzT,UAAU,wBACZ,kBAAC0T,GAAA,EAAD,KACI,kBAACN,GAAA,EAAD,CAAO/rB,KAAK,WAAW+N,QAAS8K,KAAKtV,MAAMowB,gBAAiBtsB,IAAKwR,KAAKf,MAAM1N,KAAK1G,IAAKuV,SAAU,SAAAmS,GAAC,OAAI,EAAKsI,iBAAiBtI,EAAG,EAAKtT,MAAM1N,aAKzJ,kBAACioB,GAAA,EAAD,CAAK1Z,UAAU,4BACX,kBAAC2Z,GAAA,EAAD,KAAK,kCAAQzZ,KAAKf,MAAMlU,OAAnB,KAAL,QAA+C4M,EAAUO,OAAO,IAAIC,KAAK6H,KAAKf,MAAM1N,KAAK0R,WACzF,kBAACwW,GAAA,EAAD,CAAKC,GAAG,OAIX1Z,KAAKf,MAAMkc,SACR,kBAACK,GAAA,EAAD,CAAUC,GAAIzb,KAAKtV,MAAMiwB,MACrB,kBAACnB,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CAAKC,GAAG,MACR,kBAACD,GAAA,EAAD,CAAKC,GAAG,MACJ,kBAAC,GAAD,CAAagC,UAAW1b,KAAKf,MAAMkc,cAI7C,OAGbF,S,GA7JLra,aAmLdC,GAAqB,CACvB/N,sBACAuF,oBACAhC,YAGW2K,gBAnBS,SAACtW,EAAOwiB,GAC5B,IAAMniB,EAASL,EAAMgN,MAAMwV,EAAS3b,KAAK9I,QAAQ,IACjD,MAAO,CACHsC,OAASA,GAAM,UAAOA,EAAOiN,UAAd,YAA2BjN,EAAOkN,WAAe,KAChEsjB,UAAW7wB,EAAMsJ,MAAML,aAAaxH,SAAS+gB,EAAS3b,KAAK1G,KAC3DiJ,mBAAoBpJ,EAAMsJ,MAAMF,mBAChCD,eAAgBnJ,EAAMsJ,MAAMH,eAC5ByC,KAAM5L,EAAMoM,QAAQR,KACpB/P,YAAamE,EAAMoM,QAAQvQ,YAC3Bk0B,UAAW/vB,EAAMoM,QAAQ/L,UAY7B8V,GAFWG,CAGbwZ,ICrMIqB,G,kDAEF,WAAY5c,GAAQ,IAAD,8BACf,cAAMA,IACD6c,SAAW,EAAKA,SAASrW,KAAd,gBAFD,E,oGASf,IAAMzR,EAAQ,GACd,IAAK,IAAIG,KAAU6L,KAAKf,MAAMyc,UACtBvnB,KAAU6L,KAAKf,MAAMjL,OACrBA,EAAM/J,KAAK+V,KAAKf,MAAMjL,MAAMG,IAGpC,OAAOH,EAAMib,MAAK,SAAC9oB,EAAGyhB,GAAQ,OAAO,IAAIzP,KAAKyP,EAAE3E,SAAW,IAAI9K,KAAKhS,EAAE8c,c,+BAIhE,IAAD,OACCjP,EAAQgM,KAAKf,MAAMhG,WAAa+G,KAAK8b,WAC3C,OAAQ,oCAEA9nB,EAAMhI,KAAI,SAACuF,EAAMvH,GACb,IAAMmxB,EAAW,EAAKlc,MAAMyc,WAAa,EAAKzc,MAAMyc,UAAUnqB,EAAK1G,KAAKswB,SACxE,OAAO,yBAAKrf,IAAK9R,EAAG8V,UAAU,2BAC1B,kBAAC,GAAD,CAAOvO,KAAMA,EAAM4pB,SAAUA,EAAUnnB,MAAO,EAAKiL,MAAMjL,iB,GA5BvD4M,aA+CXI,gBAVS,SAACtW,EAAOwiB,GAC5B,MAAO,CACHlZ,MAAOtJ,EAAMsJ,MAAMN,UACnBG,eAAgBnJ,EAAMsJ,MAAMH,kBAIT,GAGZmN,CAGb6a,IC1CIE,I,gEAEF,WAAY9c,GAAQ,IAAD,8BACf,cAAMA,IAiHVzG,QAAU,SAACA,GACP,EAAKyG,MAAM5I,QAAQ,EAAK4I,MAAM3I,KAAM,EAAK2I,MAAM1Y,YAAa,EAAK0Y,MAAMlU,OAAOF,IAAK2N,IAhHnF,EAAK9N,MAAQ,CACTsxB,UAAU,EACVC,eAAe,EACfC,aAAc,IAGlB,EAAKC,oBAAsB,EAAKA,oBAAoB1W,KAAzB,gBAC3B,EAAK2W,cAAgB,EAAKA,cAAc3W,KAAnB,gBACrB,EAAK4W,oBAAsB,EAAKA,oBAAoB5W,KAAzB,gBAC3B,EAAK6W,cAAgB,EAAKA,cAAc7W,KAAnB,gBAZN,E,kEAiBf,IAAMiW,EAAY,GAClB,IAAK,IAAIvnB,KAAU6L,KAAKf,MAAMvL,UAC1BgoB,EAAUvnB,GAAU,CAAEgnB,SAAU,IAEpCnb,KAAKf,MAAMrL,SAAS9I,SAAQ,SAAAyG,GACxB,IAAMgrB,EAAShrB,EAAKzJ,GACd00B,EAAQjrB,EAAK1J,KACb00B,KAAUb,IACZA,EAAUa,GAAU,CAAEpB,SAAU,KAC9BqB,KAASd,EAGXA,EAAUc,GAAV,OAA6BD,EAF7Bb,EAAUc,GAAS,CAAED,OAAQA,EAAQpB,SAAU,IAGnDO,EAAUa,GAAV,SAA8BC,GAASd,EAAUc,MAGrD,IADA,IAAMC,EAAU,GAChB,MAAyBxoB,OAAOyoB,QAAQhB,GAAxC,eAAoD,CAAC,IAAD,sBAA1C5f,EAA0C,KAArC9G,EAAqC,KAC1C,WAAYA,IACdynB,EAAQ3gB,GAAO9G,GAEvB,OAAOynB,I,sFAQQ5Q,EAAWC,GACzB9L,KAAKf,MAAMtD,cAAgBkQ,EAAUlQ,aAAeqE,KAAKf,MAAMrD,eAAiBiQ,EAAUjQ,cAC3FoE,KAAKsc,cAActc,KAAKf,MAAMtD,e,qCAK9BqE,KAAKpB,SAAS,CACVod,UAAU,EACVW,WAAW,M,0CAICC,GAChB5c,KAAKf,MAAM4d,WAAWD,GACtB5c,KAAKf,MAAM6d,oB,oCAGD5vB,GACV8S,KAAKf,MAAMnN,WAAW5E,EAAIiH,QAC1B6L,KAAKf,MAAM1S,YAAYW,EAAIC,M,oCAGjBsb,GACV,IAAMvgB,EAAQugB,GAAKzI,KAAKf,MAAMtD,YAC1BohB,EAAkB,GAChB/oB,EAAQC,OAAO6U,OAAO9I,KAAKf,MAAMvL,WACvC,GAAIxL,GAAS8X,KAAKf,MAAMrD,aACpB,OAAQoE,KAAKf,MAAMrD,cACf,IAAK,QACDmhB,EAAkB/oB,EAAM3M,QAAO,SAAAkK,GAAI,OAAIA,EAAK/I,MAAMygB,cAAc9c,SAASjE,EAAM+gB,kBAC/E,MAEJ,IAAK,UACD8T,EAAkB/oB,EAAM3M,QAAO,SAAUb,GACrC,OAAIA,EAAIH,MAAQG,EAAIH,KAAK6iB,QACd1iB,EAAIH,KAAK6iB,QAAQ/c,SAASjE,MAE5B1B,EAAIH,OAAQG,EAAIH,KAAKyD,OACnBtD,EAAIH,KAAKyD,KAAKqC,SAASjE,MAKtC,MAEJ,IAAK,SACD,IAAMO,EAAU,GAChBwL,OAAO6U,OAAO9I,KAAKf,MAAMxW,SAASqC,SAAQ,SAAAtE,GACrB,UAAGA,EAAIwR,UAAP,YAAoBxR,EAAIyR,UAAWgR,cACvC9c,SAASjE,EAAM+gB,gBACxBxgB,EAAQwB,KAAKzD,EAAIqE,QAGzBkyB,EAAkB/oB,EAAM3M,QAAO,SAAAkK,GAAI,OAAIA,EAAK9I,QAAQu0B,MAAK,SAAAjyB,GAAM,OAAItC,EAAQ0D,SAASpB,SAEpF,MACJ,IAAK,WACD,IAAMue,EAAUtJ,KAAKf,MAAM7S,SAAS/E,QAAO,SAAAkiB,GAAO,OAAIA,EAAQ1hB,OAASK,KAAO8D,KAAI,SAAAud,GAAO,OAAIA,EAAQzhB,MACrGi1B,EAAkB/oB,EAAM3M,QAAO,SAAAkK,GAAI,OAAI+X,EAAQnd,SAASoF,EAAK1G,QAOzEmV,KAAKpB,SAAS,CAACsd,aAAca,M,+BAS7B,IAAMrB,EAAY1b,KAAKmc,sBACvB,OACI,oCAEI,kBAAC,cAAD,CAAYd,QAAM,EAACC,IAAE,GAEjB,yBAAKxb,UAAU,iBAGX,kBAAC2Z,GAAA,EAAD,CAAKC,GAAG,IAAIuD,GAAG,KAAKnd,UAAU,iCACE,KAA3BE,KAAKf,MAAMtD,YACP,kBAAC,GAAD,CAAa+f,UAAWA,IAExB,kBAAC,GAAD,CAAaziB,UAAW+G,KAAKtV,MAAMwxB,gBAK3Clc,KAAKf,MAAMtL,aAAalO,OACpB,oCACG,kBAACg0B,GAAA,EAAD,CAAKC,GAAG,IAAIuD,GAAG,KAAKnd,UAAU,sBAC1B,kBAAC,GAAD,CAAa5X,MAAO8X,KAAKf,MAAMtD,YAAanD,QAASwH,KAAKxH,YAGhE,OASd,kBAAC,cAAD,CAAYmjB,OAAK,EAACC,MAAI,GAElB,yBAAK9b,UAAU,iBAGX,kBAAC2Z,GAAA,EAAD,CAAKC,GAAG,IAAIuD,GAAG,KAAKnd,UAAU,uCAC1B,kBAACyT,GAAA,EAAD,CAAMzT,UAAU,aACZ,kBAAC0Z,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,kBAAChG,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CAAiBC,UAAU,WACvB,kBAACT,GAAA,EAAD,CAAO/rB,KAAK,SAASoW,KAAK,SAASpQ,GAAG,SAASiT,SAAUJ,KAAKsS,cAC1D,4BAAQxW,IAAI,QAAQ9G,MAAM,SAA1B,mBACA,4BAAQ8G,IAAI,WAAW9G,MAAM,YAA7B,sBACA,4BAAQ8G,IAAI,UAAU9G,MAAM,WAA5B,qBACA,4BAAQ8G,IAAI,SAAS9G,MAAM,UAA3B,sBAGR,kBAACke,GAAA,EAAD,CACIpT,UAAU,eACV9K,MAAOgL,KAAKf,MAAMtD,YAClBuE,YAAY,mBACZE,SAAUJ,KAAKwS,oBAGnB,kBAACkB,GAAA,EAAD,CAAiBC,UAAU,UACvB,kBAACC,GAAA,EAAD,KACI,uBAAG9T,UAAU,mBAIrB,kBAAC4T,GAAA,EAAD,CAAiBC,UAAU,UACvB,kBAACC,GAAA,EAAD,CAAgBlV,MAAO,CAAEmV,OAAQ,WAAalT,QAASX,KAAKkd,aACxD,uBAAGpd,UAAU,wBAOT,KAA3BE,KAAKf,MAAMtD,YACP,kBAAC,GAAD,CAAa+f,UAAWA,IAExB,kBAAC,GAAD,CAAaziB,UAAW+G,KAAKtV,MAAMwxB,uB,GAtM5Ctb,cAgOlBC,GAAqB,CACvBxK,YAGW2K,gBApBS,SAACtW,EAAOwiB,GAC5B,MAAO,CACH3mB,YAAamE,EAAMoM,QAAQvQ,YAC3BoD,OAAQe,EAAMoM,QAAQnN,OACtB2M,KAAM5L,EAAMoM,QAAQR,KACpBvL,OAAQL,EAAMoM,QAAQ/L,OACtBtC,QAASiC,EAAMgN,MACfhE,UAAWhJ,EAAMsJ,MAAMN,UACvBC,aAAcjJ,EAAMsJ,MAAML,aAC1BC,SAAUlJ,EAAMsJ,MAAMJ,SACtBxH,SAAU1B,EAAMsJ,MAAM5H,SACtBuP,YAAajR,EAAMoM,QAAQ6E,YAC3BC,aAAclR,EAAMoM,QAAQ8E,gBAUhCiF,GAFWG,CAGb+a,I,6BC9OIoB,I,OAAe,CACjB/vB,OAAQ,IACRuR,QAAS,SA+CEye,GA5CA,SAAAne,GACX,OACQ,kBAAC,KAAD,CACI9R,GAAE,yBAAoB8R,EAAM9R,IAC5B2S,UAAW,iBACXpB,MAAK,2BAAMye,IAAiBle,EAAMP,OAClC2e,QAAS,CACL7mB,EAAG,IAAML,OAAOmnB,YAChB7mB,EAAG,GAAKN,OAAOonB,YACf3d,MAAO,IACPgE,OAAQ,KAEZjD,QAAS1B,EAAM0B,QACf6c,YAAave,EAAMue,YACnBC,oBAAoB,kBACpB9Z,OAAO,UAEP,kBAAC+Z,GAAA,EAAD,CAAM5d,UAAU,YACZ,kBAAC4d,GAAA,EAAKnP,OAAN,CAAazO,UAAU,uBAAuBpB,MAAO,CAACif,WAAY,SAAUhf,QAAS,SACjF,8BAAOM,EAAMzW,OACb,kBAAComB,EAAA,EAAD,CAAQjO,QAAS1B,EAAMoV,QAASxF,QAAQ,OAAO+O,KAAK,KAAKlf,MAAO,CAACwP,WAAW,SAA5E,MAEJ,kBAACwP,GAAA,EAAKhP,KAAN,CAAW5O,UAAU,gBAAgBpB,MAAO,CAAC0E,SAAU,aAClDnE,EAAMkc,UAEX,kBAACuC,GAAA,EAAK/O,OAAN,CAAa7O,UAAU,wBACnB,kBAAC8O,EAAA,EAAD,CAAQgP,KAAK,KAAK9d,UAAU,aACxBa,QAAS1B,EAAM4e,UACf1b,UAAmBlD,EAAMtI,UAF7B,cAMCsI,EAAM6e,QACN,kBAAClP,EAAA,EAAD,CAAQgP,KAAK,KAAK9d,UAAU,aACpBa,QAAS1B,EAAM8e,gBADvB,YAIC,OC0CXC,G,kDAnFX,WAAY/e,GAAQ,IAAD,8BACf,cAAMA,IACD4e,UAAY,EAAKA,UAAUpY,KAAf,gBACjB,EAAKwY,OAAS,EAAKA,OAAOxY,KAAZ,gBACd,EAAKyY,aAAe,EAAKA,aAAazY,KAAlB,gBAJL,E,wDAQf,IAAI0Y,EAAOne,KAAKoe,WAAWC,cACvBC,EAAKH,EAAKI,UAAUC,iBAAiBC,WAAW,GAChDC,EAAOP,EAAKI,UAAUC,iBAAiBC,WAAW,GAElDE,EAAOD,EAAK,GAAGE,UAAUhf,MACzBif,EAAOH,EAAK,GAAGE,UAAUhb,OAC7B,GAAa,IAAT+a,GAAuB,IAATE,EAAlB,CAKAV,EAAKI,UAAUC,iBAAiBM,SAASjf,aAAa,QAAS8e,GAC/DR,EAAKI,UAAUC,iBAAiBM,SAASjf,aAAa,SAAUgf,GAChEP,EAAG,GAAGla,WAAW,GAAGvE,aAAa,QAAS8e,GAC1CL,EAAG,GAAGla,WAAW,GAAGvE,aAAa,SAAUgf,GAC3CV,EAAKI,UAAUQ,0BACfZ,EAAKI,UAAUS,wBACfb,EAAKI,UAAUU,sBAAsB,IAAK,QAC1Cd,EAAKI,UAAUU,sBAAsB,IAAK,QAC1Cd,EAAKI,UAAUW,yBACff,EAAKI,UAAUY,iBACfhB,EAAKI,UAAUC,iBAAiBM,SAASjf,aAAa,UAAW,OACjEse,EAAKI,UAAUa,cAAc,MAAO,KACpC,IAAIlb,EAAMia,EAAKI,UAAUc,eAErBC,EAASrhB,SAASuT,cAAc,UAEpC8N,EAAO1f,MAAQ+e,EAAO,EACtBW,EAAO1b,OAASib,EAAO,EAEvB,IAAIU,EAAMD,EAAOE,WAAW,MAExB9T,EAAMzN,SAASuT,cAAc,OAEjC9F,EAAI7L,aAAa,MAAO,6BAA+B4f,KAAKvb,IAE5DwH,EAAI4J,OAAS,WACTiK,EAAIG,UAAUhU,EAAK,EAAG,GACtB,IAAIiU,EAAIL,EAAOM,UAAU,aACnBhD,EAAU,aAAe1Y,EAAM,UAAYyb,EAAI,MAErD3f,KAAKf,MAAM4e,UAAUjB,IACvBnX,KAAKzF,WAnCHA,KAAKf,MAAMoV,Y,mCAsCNwL,GACLA,IAGJ7f,KAAKoe,WAAayB,K,6BAGftN,GACH,IAAMrO,EAAMlE,KAAKf,MAAMiF,IACnBA,GACAqO,EAAEnT,OAAOif,cAAcE,UAAUuB,aAAa5b,K,+BAKlD,OACI,kBAAC,GAAD,CACI1b,MAAM,WACNkW,MAAO,CAACtR,OAAQ,KAChBinB,QAASrU,KAAKf,MAAMoV,QACpBwJ,UAAW7d,KAAK6d,UAChBlnB,UAAU,EACVD,cAAc,OAEd,4BAAQunB,OAAQje,KAAKie,OAAQz1B,MAAM,cAAcqlB,IAAI,+BAA+Brf,IAAKwR,KAAKke,aAActe,MAAM,OAAOgE,OAAO,c,GA/EzHmc,IAAMnf,W,8BCiCdof,G,uKA9BD,IAAD,OACL,OACI,6BACI,kBAAC,KAAD,CACIhrB,MAAOgL,KAAKf,MAAMjK,MAClBirB,OAAO,mDACPC,KAAM,CACFC,MAAO,SAACC,GAAY,EAAKnhB,MAAMohB,cAAcD,IAC7CE,YAAa,cACb1c,OAAQ,IACR2c,SAAS,EACTC,WAAW,EACXC,mBAAmB,EACnBC,QAAS,CACL,iEACA,6CACA,8DAEJC,iBAAkB,CACd,YAAe,+BAEnBC,QAAS,+IAEbC,eAAgB7gB,KAAKf,MAAM4hB,sB,GAzBxBd,IAAMnf,W,UCoEvBvT,GAAyB,SAAS7E,EAAO8E,GAC3C,IAAIC,EAAM,GAcV,OAbAA,GAAY,IAIRA,GAHCD,EAGW,uEAFA,mDAIhBC,GAAY,IAIRA,EAHCD,EAGKC,EAAM,0DAA4D/E,EAAQ,UAF1E+E,EAAM,qCAAuC/E,EAAQ,UAI/D+E,GAAY,KAIVC,GAAuB,SAASF,GAClC,IAAIC,EAAM,GAQV,OAPAA,GAAY,IAIRA,GAHCD,EAGW,mEAFA,iDAIhBC,GAAY,KAID,GArGQ,SAACkC,EAAWjH,EAAO8E,EAAYwzB,GAA/B,OAA6C,SAACC,GAEjE,IAAIC,GAAmB,IAAI7oB,MAAO8oB,UAAUC,WAExCvzB,EADgB,aAAeqzB,EAAmB,YAC3BD,EACvBD,IACAnzB,EAAO,WAAaA,EAAO,YAG/B,IAAIJ,EAAM,GA2BV,OA1BAA,GAAY,OACZA,GAAY,eAIRA,EAHCD,EAGKC,EAAM,aAAekC,EAAY,2DAFjClC,EAAM,aAAekC,EAAY,2CAI3ClC,GAAYF,GAAuB7E,EAAO8E,GAC1CC,GAAY,UACRD,IACAC,GAAY,gCACZA,GAAY,oBAEhBA,GAAYI,EACRL,IACAC,GAAY,QAKZA,EAHCD,EAGKC,EAAM,aAAekC,EAAY,uDAFjClC,EAAM,aAAekC,EAAY,yCAI3ClC,GAAYC,GAAqBF,GACjCC,GAAY,UACZA,GAAY,eAEL,CAACA,IADRA,GAAY,OACCyzB,sBC9BXG,I,yDACF,WAAYliB,GAAQ,IAAD,8BACf,cAAMA,IAiBVmiB,iBAAmB,SAACn1B,EAAYsd,GAC5B,GAAI,EAAKtK,MAAMoiB,cACX,EAAKpiB,MAAMqiB,mBAAmB/X,OADlC,CAIA,IAAMld,EAAW,EAAK4S,MAAM1T,MAAMU,GAC9Bs1B,GAAY,EACZC,EAAc,GACZl0B,EAAajB,EAAShG,MAAQgG,EAAShG,KAAKiH,WAC9CA,IACAi0B,GAAY,EACZC,EAAc,YAGlB,IAAMC,EAAgBlY,EAAQza,IAAItG,MAC5Bk5B,EAAaC,GAA+BpY,EAAQzhB,GAAI25B,EAAen0B,EAAYi0B,GACzF,EAAKtiB,MAAMqiB,mBAAmBI,EAAYF,KAhC1C,EAAK92B,MAAQ,CAACk3B,SAAU3iB,EAAM4iB,SAC9B,EAAKC,eAAiB,EAAKA,eAAerc,KAApB,gBAHP,E,gEAQf,IAAKzF,KAAKf,MAAMzT,QAAQ,CAAC,IAAD,EACawU,KAAKf,MAA/B1Y,EADa,EACbA,YAAamF,EADA,EACAA,UACpBsU,KAAKf,MAAMxT,eAAelF,EAAamF,M,qCAIhCyT,GACXa,KAAKpB,SAAS,CAACgjB,SAAUziB,EAAMC,OAAOpK,U,+BAsBhC,IAAD,OACCjJ,EAAYiU,KAAKf,MAAM1T,MACvB0F,EAAUlF,EAAUC,KAAI,SAACK,EAAUrC,GAAX,OAC1B,4BAAQ8R,IAAK9R,EAAGgL,MAAOhL,GAAIqC,EAAS7D,UAEpC4D,EAAW,GAWf,OAVIL,EAAUtG,QAAUsG,EAAUiU,KAAKtV,MAAMk3B,UAAUx1B,WACnDA,EAAWL,EAAUiU,KAAKtV,MAAMk3B,UAAUx1B,SAASJ,KAAI,SAACud,EAASvf,GAAV,OACnD,kBAACyvB,GAAA,EAAD,CAAK3Z,UAAU,WAAWhE,IAAK9R,EAAG0vB,GAAI,IAClC,yBAAK5Z,UAAU,kBAAkB8d,KAAK,KAAKjd,QAAS,kBAAM,EAAKygB,iBAAiB,EAAK12B,MAAMk3B,SAAUrY,KAChGA,EAAQza,IAAItG,YAOzB,kBAACu5B,GAAA,EAAD,KACI,kBAACvI,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CAAK3Z,UAAU,OACX,kBAAC,KAAD,KACI,kBAAC,KAAKkiB,MAAN,CAAYliB,UAAU,OAAOmiB,UAAU,8BACnC,kBAAC,KAAKC,QAAN,CAAcpiB,UAAU,wBAAwB8d,KAAK,KAAKuE,GAAG,SAAS/hB,SAAUJ,KAAK8hB,gBAChF7wB,OAMrB,kBAACuoB,GAAA,EAAD,KACKptB,Q,GApEQ2zB,IAAMnf,YAoF7BC,GAAqB,CAAEpV,mBAEduV,gBAVS,SAACtW,EAAOwiB,GAC5B,OAAO,aACH3mB,YAAamE,EAAMoM,QAAQvQ,YAC3BmF,UAAWhB,EAAMoM,QAAQpL,WACtBhB,EAAMqB,aAQb8U,GAFWG,CAGbmgB,ICqBaiB,I,OA/GI,SAAAnjB,GAEf,IAAMxL,EAAcugB,aAAY,SAAAtpB,GAC5B,IAAM23B,EAAO,GAKb,OAJApjB,EAAMxL,YAAY3I,SAAQ,SAACwJ,GACvB,IAAMD,EAAM3J,EAAMsJ,MAAMP,YAAYa,GAChCD,GAAMguB,EAAKp4B,KAAKoK,MAEjBguB,KARa,EAUgBnO,mBAAS,IAVzB,mBAUjBoO,EAViB,KAUHC,EAVG,KA2DxB,OACI,kBAAC9I,GAAA,EAAD,KACI,kBAACD,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,0BAAM3Z,UAAU,IAAhB,0BACA,kBAAC8O,EAAA,EAAD,CAAQ9O,UAAU,qBAAqB8d,KAAK,KAAK/O,QAAQ,eAAelO,QAAS,kBAAK1B,EAAMujB,kBAAiB,KAA7G,UACA,kBAAC5T,EAAA,EAAD,CAAQ9O,UAAU,qBAAqB8d,KAAK,KAAK/O,QAAQ,eAAelO,QAAS,kBAAI1B,EAAMujB,kBAAiB,KAA5G,oBACA,kBAAC5T,EAAA,EAAD,CAAQ9O,UAAU,qBAAqB8d,KAAK,KAAK/O,QAAQ,eAAelO,QA/CtE,WACd,IAAO2hB,EAAe7N,MAAM5sB,KAAKoW,SAASC,eAAT,oBAAqCe,EAAM9K,SAAUsuB,uBAAuB,aAC7G,GAA4B,IAAxBH,EAAa78B,OAAjB,CAGA,IAAIsJ,EAAO,GAEXuzB,EAAax3B,SAAQ,SAAC4gB,GAClB,IAAMgX,EAAUhX,EAAIgX,QAChB9iB,EAAQ8L,EAAIuJ,aAIhB,GAHGrV,EAJU,MAKTA,EALS,KAOG,QAAZ8iB,EAAmB,CACnB,IAAM1M,EAAetK,EAAIiX,aAAa,OAClC7iB,EAAY,GAChB4L,EAAIkX,UAAU93B,SAAQ,SAAA+3B,GACM,KAApBA,EAASp9B,SACTqa,GAAa+iB,EAAW,QAGhC9zB,GAAQ,iCAAmC+Q,EAAY,UAAYkW,EAAe,YAAcpW,EAAQ,4BAA8BoW,EAAe,SAI7J/W,EAAMiX,kBAAkBnnB,KAsBgFoT,SAAkC,IAAxBmgB,EAAa78B,QAAnH,YAGR,kBAAC+zB,GAAA,EAAD,CAAKrsB,GAAE,oBAAe8R,EAAM9K,QAAU2L,UAAU,kBAExCrM,EAAYzH,KAAI,SAACoI,GAAD,OACR,yBAAK0H,IAAK1H,EAAWvJ,IAAKiV,UAAU,iCAChC,yBAAKA,UAAU,wBAEoC,IAA3C1L,EAAW/N,KAAKc,KAAKwtB,QAAQ,UAC7B,yBAAK7U,UAAW1L,EAAWvJ,IAAM,KAAOy3B,EAAan2B,SAASiI,EAAWvJ,KAAO,WAAa,IAAKgjB,IAAG,UAAKoI,GAAL,OAAiB7hB,EAAW/N,KAAKpB,KAAO0b,QAAS,SAAC4R,GAAD,OA7BrKje,EA6BwLF,EAAWvJ,SA5BhNy3B,EAAan2B,SAASmI,GACtBiuB,GAAgB,SAAC5a,GAAD,OAAUA,EAAKtgB,QAAQ,SAAAqkB,GAAG,OAAIA,IAAQpX,QAEtDiuB,GAAgB,SAAC5a,GAAD,6BAAcA,GAAd,CAAoBrT,QAJxB,IAACA,GA6B4MyZ,IAAI,eAEjM,uBAAGC,KAAI,UAAKiI,GAAL,OAAkB7hB,EAAW/N,KAAKy8B,aAAe1uB,EAAW/N,KAAKpB,KAAQuD,MAAO4L,EAAW5L,MAAOsb,UAAQ,GAC7G,yBAAKhE,UAAW1L,EAAWvJ,IAAKgjB,IAAG,UAAKoI,EAAL,sDAC9BztB,MAAM,qBAAqBulB,IAAI,iBAIhD,yBAAKjO,UAAU,sBACX,2BACI,uBAAGkO,KAAI,UAAKiI,GAAL,OAAkB7hB,EAAW/N,KAAKy8B,aAAe1uB,EAAW/N,KAAKpB,KACrEuD,MAAO4L,EAAW5L,MAAOsb,UAAQ,GAChC,yBAAKhE,UAAU,sBAAsB+N,IAAG,UAAKoI,EAAL,kDACnClI,IAAI,WAAWnK,OAAO,WAGnC,2BACI,4BAAQ9D,UAAU,oBAAoBa,QAAS,kBAvCzDrM,EAuCgFF,EAAWvJ,SAtC7GsL,OAAO+iB,QAAQ,2CACfja,EAAM8jB,eAAezuB,IAFJ,IAACA,IAwCc,yBAAKuZ,IAAG,UAAKoI,EAAL,sCAAoDlI,IAAI,oBAAoBnO,MAAM,OAAOgE,OAAO,YAIpH,yBAAK9D,UAAU,mBACX,uBAAGtX,MAAM,sBAAwC4L,EAAW5L,OAC5D,2BAAsB4L,EAAW/N,KAAKu3B,eC1B3DoF,I,yDAtEX,WAAY/jB,GAAO,IAAD,8BACd,cAAMA,IACDvU,MAAQ,CAACqrB,cAAc,EAAM/oB,aAAa,GAC/C,EAAKs0B,mBAAqB,EAAKA,mBAAmB7b,KAAxB,gBAC1B,EAAKwd,qBAAuB,EAAKA,qBAAqBxd,KAA1B,gBAC5B,EAAK/Y,iBAAmB,EAAKA,iBAAiB+Y,KAAtB,gBACxB,EAAKyQ,kBAAoB,EAAKA,kBAAkBzQ,KAAvB,gBACzB,EAAKsd,eAAiB,EAAKA,eAAetd,KAApB,gBAPR,E,+DAUCic,EAAYF,GAC3BxhB,KAAKf,MAAMmB,SAAS,CAAC/T,SAAU,CAACq1B,aAAYF,mB,2CAG3B0B,GACjBljB,KAAKpB,SAAS,CAACmX,aAAcmN,EAAQl2B,aAAa,M,wCAEpC+oB,GACd/V,KAAKf,MAAMmB,SAAS,CAACnJ,OAAQ8e,M,yCAG7B/V,KAAKpB,SAAS,CAAC5R,aAAa,M,qCAEjBm2B,GACXnjB,KAAKf,MAAMmB,SAAS,CAACgjB,aAAcD,M,+BAE7B,IAAD,EACmCnjB,KAAKf,MAAtC1N,EADF,EACEA,KAAM6O,EADR,EACQA,SAAUigB,EADlB,EACkBA,cACvB,OACI,kBAAC0B,GAAA,EAAD,CAAWjiB,UAAU,uBACb,kBAAC0Z,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,kBAAC,KAAKuI,MAAN,CAAYliB,UAAU,mBAAmBmiB,UAAU,cAC/C,kBAAC,KAAKC,QAAN,CAAc/6B,KAAK,OACL2Y,UAAU,kBACV8d,KAAK,KACL1d,YAAY,cACZlL,MAAOzD,EAAK/I,MACZ4X,SAAU,SAACf,GAASe,EAAS,CAAC5X,MAAO6W,EAAID,OAAOpK,cAI1E,kBAACwkB,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CAAKC,GAAI,EAAG5Z,UAAU,QAClB,kBAAC,GAAD,CAAgB+hB,QAAS,EAAGP,mBAAoBthB,KAAKshB,sBAEzD,kBAAC7H,GAAA,EAAD,CAAKC,GAAI,IACL,kBAAC,GAAD,CAAU1kB,MAAOzD,EAAKlL,KAAKyD,KACjBu2B,cAAeA,EACfQ,eAAgB,SAACxrB,EAAS+qB,GAAV,OAAqBhgB,EAAS,CAAE/Z,KAAM,CAACyD,KAAMuL,QACvE,yBAAKyK,UAAU,4BAA4BvO,EAAKgD,UAAhD,YAIR,kBAACilB,GAAA,EAAD,CAAK1Z,UAAU,QACX,kBAAC,GAAD,eAAa3L,OAAQ5C,EAAK1G,IAAKwpB,QAASrU,KAAKtT,iBAAkBwpB,kBAAmBlW,KAAKkW,mBAAuBlW,KAAKtV,QACnH,kBAAC,GAAD,CACIyJ,OAAQ5C,EAAK1G,IACb4I,YAAalC,EAAKkC,YAClB+uB,iBAAkBxiB,KAAKijB,qBACvB/M,kBAAmBlW,KAAKkW,kBACxB6M,eAAgB/iB,KAAK+iB,uB,GA/D1BhD,IAAMnf,YC0BdyiB,GAhCC,SAAApkB,GAAU,IAAD,EAEAA,EAAMrK,QAAQ0uB,QAC/B,SAACC,EAAKr3B,GAMF,MALgB,SAAZA,EAAG/E,KACHo8B,EAAI,GAAGt5B,KAAKiC,GAEZq3B,EAAI,GAAGt5B,KAAKiC,GAETq3B,IACR,CAAC,GAAG,KAVU,mBAEdC,EAFc,KAERC,EAFQ,KAWrB,OACI,6BACI,0CACA,uBAAG3jB,UAAU,QAAQ2jB,EAAKh+B,OAA1B,UACA,4BACKg+B,EAAKz3B,KAAI,SAAC+L,GAAD,OACN,wBAAI+D,IAAK/D,EAAOlN,KAAMkN,EAAOgL,KAA7B,KAAqChL,EAAOhN,YAGpD,0CACA,uBAAG+U,UAAU,QAAQ0jB,EAAK/9B,OAA1B,UACA,4BACK+9B,EAAKx3B,KAAI,SAAC+L,GAAD,OACN,wBAAI+D,IAAK/D,EAAOlN,KAAMkN,EAAOgL,KAA7B,KAAqChL,EAAOhN,cCwFjD24B,GAhHI,SAAAzkB,GAEf,IAAM0kB,EAAqB,SAACpY,GACxBtM,EAAMmB,SAAS,CAACzX,WAAY4iB,EAAInM,OAAOpK,SAO3C,OACI,yBAAK8K,UAAU,OACX,6BACI,2BAAOA,UAAU,yBAAjB,eACA,6BACI,2BAAOA,UAAU,+BACb,+BACI,4BACI,oCACA,uCACA,6CACA,wCAGA,+BACI,4BACI,4BACI,0BAAMnV,OAAO,IACT,yBAAKmV,UAAU,gCACX,2BAAOA,UAAU,mBAAmB3Y,KAAK,QAAQoW,KAAK,aAAavI,MAAM,UAAU7H,GAAG,sBAC/EiT,SAAUujB,EAAoBzuB,QAA2C,YAAlC+J,EAAM2kB,aAAaj7B,aAE7D,2BAAOmX,UAAU,sCAAsCO,QAAQ,uBAA/D,kBAMhB,kCACA,kCACA,kCAEJ,4BACI,4BACI,0BAAM1V,OAAO,IACT,yBAAKmV,UAAU,gCACX,2BAAOA,UAAU,mBAAmB3Y,KAAK,QAAQ6N,MAAM,YAAY7H,GAAG,sBAAsBoQ,KAAK,aAC1F6C,SAAUujB,EAAoBzuB,QAA2C,cAAlC+J,EAAM2kB,aAAaj7B,aAE7D,2BAAOmX,UAAU,sCAAsCO,QAAQ,uBAA/D,oBAMhB,kCACA,kCACA,kCAEJ,4BACI,4BACI,0BAAM1V,OAAO,IACT,yBAAKmV,UAAU,gCACX,2BAAOA,UAAU,mBAAmB3Y,KAAK,QAAQ6N,MAAM,SAAS7H,GAAG,sBAAsBoQ,KAAK,SACvF6C,SAAUujB,EAAoBzuB,QAA2C,WAAlC+J,EAAM2kB,aAAaj7B,aAE7D,2BAAOmX,UAAU,sCAAsCO,QAAQ,uBAA/D,iBAMhB,kCACA,kCACA,sCAKxB,2BAAOP,UAAU,yBAAjB,WACA,yBAAKA,UAAU,QACVb,EAAM2kB,aAAal7B,QAExB,2BAAOoX,UAAU,yBAAjB,aACA,0BAAMA,UAAU,OAAOnV,OAAO,IAC1B,yBAAKmV,UAAU,iCACX,2BAAOA,UAAU,mBAAmB3Y,KAAK,WAAWgG,GAAG,eAAe+H,QAAS+J,EAAM2kB,aAAav9B,KAAKiH,WAAY8S,SAhF9G,SAACmL,GACtBtM,EAAMmB,SAAS,CAAC/Z,KAAM,CAACiH,WAAYie,EAAInM,OAAOlK,cAiF1B,2BAAO4K,UAAU,sCAAsCO,QAAQ,gBAA/D,mBC9DbwjB,GAzBM,SAAA5kB,GACjB,IAAM6kB,EAAiB7vB,OAAOyoB,QAAQzd,EAAMxW,SAASuD,KACjD,SAAC6I,GAAW,MAAO,CAACG,MAAOH,EAAK,GAAGhK,IAAK2T,MAAM,GAAD,OAAK3J,EAAK,GAAGmD,UAAb,YAA0BnD,EAAK,GAAGoD,cAFzD,EAIkBic,mBAAS,MAJ3B,mBAInB6P,EAJmB,KAIHC,EAJG,KAS1B,OACI,6BACI,kBAACxK,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,kBAAC,KAAD,CAAQxoB,QAAS6yB,EAAgB1jB,SAR5B,SAAAwhB,GACjBoC,EAAkBpC,IAOmDqC,aAAa,KAE1E,kBAACxK,GAAA,EAAD,CAAKC,GAAG,QACJ,kBAAC9K,EAAA,EAAD,CAAQzM,UAAW4hB,EACfpjB,QAAS,kBAAM1B,EAAMilB,iBAAiBH,KAD1C,SAIR,2BAAID,EAAer+B,OAAnB,4CC8DG0+B,GA9EG,SAAAllB,GACd,IAAMxW,EAAUurB,aAAY,SAACtpB,GAAD,OAAWuU,EAAMxK,QAAQhM,QAAQuD,KAAI,SAAC6I,GAAD,OAAUnK,EAAMgN,MAAM7C,SACjFuvB,EAAmBpQ,aAAY,SAACtpB,GAAD,OAAWA,EAAMgN,SAChD2E,EAAS2X,aAAY,SAACtpB,GAAD,OAAWA,EAAMoM,QAAQ1F,UAAUiL,UACxDgoB,EAAgBhoB,EAAOrQ,KAAI,SAACs4B,GAAD,MAAQ,CAACtvB,MAAOsvB,EAAEz5B,IAAK2T,MAAO8lB,EAAE97B,UAC3D+7B,EAAeloB,EAAOlO,MAAK,SAAAoH,GAAK,OAAIA,EAAM1K,MAAQoU,EAAMxK,QAAQc,SAChE+uB,EAAIC,EAAe,CAACvvB,MAAOuvB,EAAa15B,IAAK2T,MAAO+lB,EAAa/7B,OAAS,CAACwM,MAAO,KAAMwJ,MAAO,qBA0BrG,OACY,yBAAKsB,UAAU,iBAAiBpB,MAAO,CAACkF,OAAQ,SAC5C,kBAAC4V,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,wCACA,4BAEQhxB,EAAQuD,KAAI,SAACjB,EAAQy5B,GAAT,OAER,wBAAI1oB,IAAK/Q,EAAOF,IAAK6T,MAAO,CAACmV,OAAQ,SAChC9oB,EAAOiN,UADZ,IACwBjN,EAAOkN,SAC3B,kBAAC2W,EAAA,EAAD,CAAQgP,KAAK,KAAK9d,UAAU,OACpBa,QAAS,kBAnCpC,SAAC5V,EAAQy5B,GACd,IAARA,EAGMA,GAAO,GACbvlB,EAAMmB,SAAS,CAAC3X,QAASwW,EAAMxK,QAAQhM,QAAQpB,QAAO,SAAAwN,GAAI,OAAIA,IAAS9J,EAAOF,SAH9E6F,GAAgB,CAAClI,MAAO,SAAUrB,KAAK,SAAUgQ,QAAQ,qCAiCFstB,CAAa15B,EAAQy5B,KAD5C,WAQpB,kBAAC/K,GAAA,EAAD,KACI,6BACI,2CACA,kBAAC,GAAD,CAAchxB,QAAS27B,EAAkBF,iBApCnD,SAACn5B,GACVkU,EAAMxK,QAAQhM,QAAQ0D,SAASpB,EAAOiK,QACvCiK,EAAMmB,SAAS,CAAC3X,QAAQ,GAAD,oBAAMwW,EAAMxK,QAAQhM,SAApB,CAA6BsC,EAAOiK,gBAsCnD,kBAACwkB,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,sCACA,6BAGQ,0BAAMxc,OAAO,GAAG9P,GAAG,GAAGxC,OAAO,IACzB,kBAAC,KAAD,CAAQqK,MAAOsvB,EAAGrzB,QAASozB,EAAejkB,SAzC1D,SAACwhB,GACjB3iB,EAAMmB,SAAS,CAAC7K,MAAOqsB,GAAYA,EAAS5sB,SAwCqDivB,aAAa,U,oBCxDzGS,I,iDAAc,SAACr2B,EAAMs2B,EAAkBhnB,EAAOinB,GACvDC,UAAUC,OAAOC,SAAW,WACxB,MAAO,CACHC,WAAY,WACRhlB,KAAKilB,UACAC,UAAU,qBAAqB,SAASnwB,GACjC4vB,GACAA,EAAiBQ,kBAAkBpwB,MAG1CmwB,UAAU,qBAAqB,SAASnwB,GACjC4vB,GACAA,EAAiBS,kBAAkBrwB,MAG1CmwB,UAAU,qBAAqB,SAASnwB,GACjC4vB,GACAA,EAAiBU,kBAAkBtwB,MAG1CmwB,UAAU,yBAAyB,SAAS9E,EAAQrrB,GAC7C4vB,GACAA,EAAiBW,cAAclF,EAAQrrB,MAG9CmwB,UAAU,yBAAyB,SAASK,EAAQC,GAC7Cb,GACAA,EAAiBc,cAAcF,EAAQC,MAG9CN,UAAU,0BAA0B,SAAS9E,EAAQrrB,GAC9C4vB,GACAA,EAAiBe,aAAatF,EAAQrrB,MAM9C4vB,GACAA,EAAiBgB,qBAAqB3lB,KAAKilB,cA0B3D,IAEIW,EAAY,GAAGC,eAInBhB,UAAUC,OAAOgB,SAAY,SAASC,IAHtB,SAASvJ,EAAOD,GAAU,IAAK,IAAIzgB,KAAOygB,EAAcqJ,EAAUI,KAAKzJ,EAAQzgB,KAAM0gB,EAAM1gB,GAAOygB,EAAOzgB,IAAQ,SAASmqB,IAASjmB,KAAKkmB,YAAc1J,EAASyJ,EAAKE,UAAY5J,EAAO4J,UAAW3J,EAAM2J,UAAY,IAAIF,EAAQzJ,EAAM4J,UAAY7J,EAAO4J,UAIrQE,CAAUP,EA4HXjB,UAAUC,QAxHT,IAAIwB,EAAU,GAkBd,SAASR,EAASS,EAAQt1B,GAEtB,OADO60B,EAASM,UAAUF,YAAYM,MAAMxmB,KAAMymB,WAmGtD,OAlHAX,EAASK,UAAUl1B,QAAU,CACzBy1B,QAAQ,CACJna,SAAU,6BACV+T,YAAa,cACb1c,OAAO,QACP4c,WAAW,EACXE,QAAS,uCACTH,SAAS,EACToG,mBAAoB,QACpBC,wBAA0B,2EAC1BhG,QAAS,yJAUjBkF,EAASK,UAAUnB,WAAa,WAC5B,IAAIC,EAAYjlB,KAAKilB,UACjB7E,EAASpgB,KAAKilB,UAAU7E,OAEvByE,UAAUgC,cAKf5B,EAAU7E,OAAO0G,SAAS,CACtB3/B,KAAM,QACN4/B,KAAM/mB,KAAKgnB,eAIf/B,EAAUM,OAAOuB,SAAS,CACtBC,KAAM/mB,KAAKinB,eAIfhC,EAAUC,UAAU,yBAAyB,eAK7CD,EAAUC,UAAU,0BAA0B,eAM9CllB,KAAK/O,QAAQy1B,QAAQvG,MAAQ,SAAS+G,GAClCpB,EAASK,UAAUgB,SAAWD,EAC9BA,EAAG9b,GAAG,UAAU,SAASmH,GAErBtkB,EAAEmyB,EAAOmG,SAASp4B,KAAK,YAAY,GAAG6G,MAAQ0xB,KAAQU,aAAaC,gBAEvEH,EAAG9b,GAAG,QAAQ,SAAS8b,GACnBj5B,EAAE,kBAAkBq5B,IAAI,UAAU,0BAGtCJ,EAAG9b,GAAG,UAAU,WACZmc,IAASC,uBAAuB1B,EAASK,UAAUsB,oBAEvDP,EAAGQ,GAAGC,SAASC,WAAW,YAAa,CACnCloB,QAAS,gBACT0b,KAAM,WACNyM,QAAS,SAAU38B,GACf,IAAM48B,EAAU58B,EAAIq7B,UACpBtoB,SAAS6pB,QAAUA,EACnBA,EAAQppB,MAAMkB,MAAQ,QACtBkoB,EAAQppB,MAAMqpB,SAAW,SACzBD,EAAQppB,MAAMspB,SAAW,SACzBT,IAASU,OAAOrD,EAAiBkD,EAAS,MAC1ChC,EAASK,UAAUsB,gBAAkBK,GAEzCI,OAAQ,SAAUh9B,KAQlBojB,OAAQ,SAAUpjB,QAW1Bw7B,KAAQxG,KAAKlgB,KAAK/O,QAAQy1B,WAG9BZ,EAASK,UAAUa,aAAe,SAASmB,EAAOpzB,GAC9C,IAAIpH,EAAgC,qBAAlBoH,EAAWpH,KAAmBoH,EAAWpH,KAAK,GAC5Dy6B,EAAQ1B,KAAQ2B,QAAQ5iC,OAC5B6gC,EAAWI,KAAQ2B,QAAQD,EAAM,GAAGj7B,GACpCu5B,KAAQtgC,IAAIkgC,GAAUgC,WAAW36B,GAEjCM,EAAEk6B,GAAO3e,UAGbsc,EAASK,UAAUc,aAAe,SAASkB,EAAOpzB,GAC9C,IAAIwzB,EAAUt6B,EAAEk6B,EAAMK,YAAYr6B,KAAK,qBAAqB,GAC5Do6B,EAAQ75B,UAAWqG,EAAWpH,KAC9BM,EAAEs6B,GAASn6B,SAAS,uBACpBH,EAAEk6B,GAAO3e,UAGNsc,EA3HkB,GAoI7Bz3B,EAAK42B,UAAU,YAAa,YAC5B52B,EAAK42B,UAAU,YAAa,QAC5B52B,EAAK42B,UAAU,YAAa,YAExBtnB,GACAtP,EAAK42B,UAAU,YAAa,cAAe,CACvC3pB,KAAMqC,EACN8qB,YAAa,CACTjF,KAAM,CAAC7lB,GACP+qB,OAAQ,CAAC/qB,GACT3V,OAAQ,CAAC2V,GACTgrB,MAAO,CAAChrB,IAEZirB,6BAA6B,MAK5BC,GAAO,SAAClwB,GACjB,IAAMmwB,EAA4C,IAAjCnwB,EAAK8vB,YAAYjF,KAAK/9B,OAEnCkT,EAAKhQ,WADLmgC,EACkB,YAEA,UAEtB,IAAMC,EAAMpwB,EAAKqwB,OAAO,GAOxB,OANqC,IAAjCD,EAAIE,MAAMtU,QAAQ,aAClBoU,EAAIE,MAAQF,EAAIE,MAAMzjC,UAAU,IAED,IAA/BujC,EAAIG,IAAIvU,QAAQ,aAChBoU,EAAIG,IAAMH,EAAIG,IAAI1jC,UAAU,IAEzBmT,GCpPIwwB,I,OAAAA,YAAe,CAC5BC,QAAS,CACLv8B,QAASD,GACToH,MAAOR,GACPzH,UAAWV,GACXyL,QAASkF,GACTtE,MAAOlN,IAET6+B,UAAU,KCgICxE,G,kDAtIX,WAAY5lB,GAAQ,IAAD,8BACf,cAAMA,IACDqqB,WAAavJ,IAAMwJ,YACxB,EAAK5D,qBAAuB,EAAKA,qBAAqBlgB,KAA1B,gBAC5B,EAAK0f,kBAAoB,EAAKA,kBAAkB1f,KAAvB,gBACzB,EAAK2f,kBAAoB,EAAKA,kBAAkB3f,KAAvB,gBACzB,EAAKwf,UAAY,KAEjB,EAAKK,cAAgB,EAAKA,cAAc7f,KAAnB,gBACrB,EAAKggB,cAAgB,EAAKA,cAAchgB,KAAnB,gBACrB,EAAK+jB,iBAAmB,EAAKA,iBAAiB/jB,KAAtB,gBACxB,EAAKigB,aAAe,EAAKA,aAAajgB,KAAlB,gBACpB,EAAKgkB,gBAAkB,EAAKA,gBAAgBhkB,KAArB,gBACvB,EAAK6b,mBAAqB,EAAKA,mBAAmB7b,KAAxB,gBAC1B,EAAKvY,IAAM,KAdI,E,gEAkBf,IAAMw8B,EAAgBz7B,EAAE+R,KAAKspB,WAAWK,SACxCD,EAAczE,YACdjlB,KAAK4pB,aACD,kBAAC,IAAD,CAAUh5B,MAAOA,IACb,kBAAC,GAAD,CAAgBixB,QAAS,EAAGP,mBAAoBthB,KAAKshB,sBAG7DuI,GAAyBH,EAAe,CACpCvE,kBAAmBnlB,KAAKmlB,kBACxBC,kBAAmBplB,KAAKolB,kBACxBC,kBAAmBrlB,KAAKf,MAAM6qB,SAC9BxE,cAAetlB,KAAKslB,cACpBG,cAAezlB,KAAKylB,cACpBE,qBAAsB3lB,KAAK2lB,qBAC3BD,aAAc1lB,KAAK0lB,cACpB1lB,KAAKf,MAAMlU,OAAOioB,SAAUhT,KAAK4pB,cACpC5pB,KAAK9S,IAAMe,EAAE,mBAAD,OAAoB+R,KAAKf,MAAM8qB,gB,yCAI5Ble,EAAWC,GACO,IAA7B9L,KAAKf,MAAM+qB,eAAuBhqB,KAAKf,MAAM+qB,gBAAkBne,EAAUme,eACzEhqB,KAAKypB,oB,6CAMLzpB,KAAKilB,WAAajlB,KAAKilB,UAAUvE,QAAQoF,SAASqB,UAClDnnB,KAAKilB,UAAUvE,QAAQoF,SAASqB,SAAS3d,W,mCAEpC4W,EAAQrrB,GACjB9G,EAAEmyB,EAAOmG,QAAQp4B,KAAK,wBAAwB87B,Q,wCAG9C,IAAMzE,EAAcvxB,OAAO6U,OAAO9I,KAAKf,MAAMirB,QAAQl+B,KAAI,SAAC6M,GACtD,IAAMF,EAAO1E,OAAOC,OAAO,GAAI2E,EAAMxS,MAIrC,OAHAsS,EAAKqwB,OAAL,aAAkBrwB,EAAKqwB,QACvBrwB,EAAKwxB,WAAL,aAAsBxxB,EAAKwxB,YF6LnB,SAACxxB,GACjB,IAAMowB,EAAM90B,OAAOC,OAAO,GAAIyE,EAAKqwB,OAAO,IAC1CD,EAAIE,MAAQ,UAAYF,EAAIE,MAC5BF,EAAIG,IAAM,UAAYH,EAAIG,IAC1BvwB,EAAKqwB,OAAO,GAAKD,EEhMTc,CAAkBlxB,GACXA,KAEXqH,KAAKilB,UAAUwE,gBAAgBjE,GAC/BxlB,KAAKf,MAAMmrB,mB,2CAEMnF,GACjBjlB,KAAKilB,UAAYA,EACjBjlB,KAAKypB,kBAEL,IAAIY,EAAWp8B,EAAE,uBACjBo8B,EAASC,KAAK,QAAS,cACvBD,EAASj8B,SAAS,YAClBi8B,EAAS/gC,OAAO,+CAEhB2U,SAASgnB,UAAYjlB,KAAKilB,UAC1B,IAAMsF,EAAQtF,EAAUsF,MAAMnkC,IAAI,GAClC4Z,KAAKwqB,SAAW,IAAIC,iBAAiB,SAASC,GAAe,IAAD,iBACpCA,GADoC,IACxD,IAAI,EAAJ,qBAAmC,CAC/B,GAAsB,eADS,QAClBvjC,MAEmB,SAAxBojC,EAAM7rB,MAAMC,QAGZ,OAFAqB,KAAKwpB,iBAAiBvE,EAAUsF,YAChCvqB,KAAKwqB,SAASG,eAN8B,gCAW1DllB,KAAKzF,OAEPA,KAAKwqB,SAASI,QAAQL,EAAO,CAAElmB,YAAY,EAAMwmB,mBAAmB,M,wCAEtD91B,GACdiL,KAAKf,MAAM6rB,SAASjB,GAAkB90B,M,wCAExBA,GACdiL,KAAKf,MAAM8rB,SAASlB,GAAkB90B,M,oCAE5BqrB,EAAQrrB,GAEbqrB,EAAOmG,QAAQh4B,SAAS6xB,EAAOjd,QAAQ6nB,OAAOv0B,IAC/C2pB,EAAOmG,QAAQn4B,SAASgyB,EAAOjd,QAAQ6nB,OAAOv0B,K,uCAGrCw0B,GACb,IAAMC,EAAYlrB,KAAK9S,IAAIi+B,SACrBC,EAAWH,EAAME,SACvBF,EAAME,OAAO,CAACE,IAAKD,EAASC,IAAMH,EAAUG,IAAKC,KAAMF,EAASE,KAAOJ,EAAUI,S,oCAEvE/F,EAAQxwB,GAClBiL,KAAKwpB,iBAAiBjE,EAAOgB,SAC7BhB,EAAOgB,QAAQn4B,SAASm3B,EAAOpiB,QAAQ6nB,OAAOv0B,K,yCAG/BirB,EAAYF,GAC3B,IAAM2F,EAAWnnB,KAAKilB,UAAUvE,QAAQoF,SAASqB,SAC3CvF,EAAWuF,EAASoE,UAAUlE,aAFI,EAIR3F,EADrBE,EAASn8B,OAASm8B,EAAWJ,GACjCj0B,EAJiC,EAIjCA,IAAKyzB,EAJ4B,EAI5BA,iBACZmG,EAASqE,cAAcj+B,GAEvB,IAAMk+B,EAAatE,EAASuE,IAAItlC,IAAI46B,GAChCyK,GACAtE,EAASoE,UAAUI,kBAAkBF,K,+BAIzC,OACI,yBAAKj9B,IAAKwR,KAAKspB,YACX,yBAAKrP,wBAAyB,CAACC,OAAQla,KAAKf,MAAM5J,gB,GAhI1C0qB,IAAMnf,WCWxBgrB,I,yDACF,WAAY3sB,GAAQ,IAAD,8BACf,cAAMA,IACDvU,MAAQ,CACTmJ,gBAAgB,EAChBg4B,YAAa,EAAK5sB,MAAM3J,KAAO,EAAK2J,MAAM3J,KAAO,SAErD,EAAK+qB,cAAgB,EAAKA,cAAc5a,KAAnB,gBACrB,EAAKoX,WAAa,EAAKA,WAAWpX,KAAhB,gBAClB,EAAKqmB,aAAe,EAAKA,aAAarmB,KAAlB,gBACpB,EAAKlR,UAAY,EAAKA,UAAUkR,KAAf,gBACjB,EAAKsmB,cAAgB,EAAKA,cAActmB,KAAnB,gBACrB,EAAKumB,oBAAsB,EAAKA,oBAAoBvmB,KAAzB,gBAC3B,EAAKwmB,oBAAsB,EAAKA,oBAAoBxmB,KAAzB,gBAC3B,EAAKymB,oBAAsB,EAAKA,oBAAoBzmB,KAAzB,gBAbZ,E,+DAgBAoG,EAAWC,EAAWqgB,GACjCnsB,KAAKf,MAAM2d,SAAW/Q,EAAU+Q,UAAY5c,KAAKf,MAAM2d,UACvD5c,KAAKogB,OAAOoL,cAAcxrB,KAAKf,MAAM2d,SACrC5c,KAAKf,MAAMmtB,uB,mCAIN76B,GACT,GAAIA,EAAKlF,SAAU,CAAC,IAAD,EACqBkF,EAAKlF,SAAjCq1B,EADO,EACPA,WAAYF,EADL,EACKA,YACpBxhB,KAAKqsB,YAAW,EAAM7K,EAAaE,QAC5BnwB,EAAK0F,OACZ+I,KAAKogB,OAAOoL,cAAcj6B,EAAK0F,QACxB1F,EAAK6xB,cACZpjB,KAAKf,MAAMqtB,iBAAiBtsB,KAAKf,MAAM1N,KAAK1G,IAAK0G,EAAK6xB,cACtDpjB,KAAKogB,OAAOsL,IAAIliB,OAAOxJ,KAAKogB,OAAOsL,IAAIa,OAAO,IAAMh7B,EAAK6xB,gBAGrD7xB,EAAKlL,MAAQkL,EAAKlL,KAAKyD,KACvBkW,KAAKf,MAAM6sB,aAAX,2BAA6Bv6B,GAA7B,IAAmCgD,UAAWyL,KAAKzL,UAAUhD,EAAKlL,KAAKyD,SAEvEkW,KAAKf,MAAM6sB,aAAX,eAA6Bv6B,M,gCAK/B5D,GACN,OAAOqS,KAAKogB,OAAOM,QAAQ8L,UAAUC,WxC1DZ,SAAC9+B,GAK9B,IAJA,IAAMI,EAAM,QAAUJ,EAAO,SAEzB++B,EADOz+B,KAAEF,GACGI,KAAK,wBACjBw+B,EAAW,EACN3iC,EAAI,EAAGA,EAAG0iC,EAAOjnC,OAAQuE,IAC9B2iC,GAAYD,EAAO1iC,GAAG0E,UAAUgB,MAAM,KAAKjK,OAE/C,OAAOknC,EwCkD+CC,CAAkBj/B,K,oCAG1DyyB,GACVA,EAAOyM,aAAe7sB,KAAKf,MAAM6tB,eACjC9sB,KAAKogB,OAASA,I,iCAGPxD,GAEP5c,KAAKogB,OAAOoL,cAAc5O,K,iCAGnB2O,EAAW/J,EAAaE,GAC/B,IAAME,EAAW5hB,KAAKogB,OAAOmL,UAAUlE,aADI,EAGT3F,EADvBE,EAASn8B,OAASm8B,EAAWJ,GAChCj0B,EAHmC,EAGnCA,IAAKyzB,EAH8B,EAG9BA,iBAGb,GAFAhhB,KAAKogB,OAAOoL,cAAcj+B,GAEtBg+B,EAAW,CACX,IAAME,EAAazrB,KAAKogB,OAAOsL,IAAItlC,IAAI46B,GACnCyK,GACAzrB,KAAKogB,OAAOmL,UAAUI,kBAAkBF,M,oCAItCsB,GACV/sB,KAAKpB,SAAS,CAACitB,YAAakB,IAChB,YAARA,GACA/sB,KAAKf,MAAMxH,aAAauI,KAAKf,MAAM1N,KAAK1G,KAC9B,WAARkiC,GACF/sB,KAAKf,MAAM7C,gBAAgB4D,KAAKf,MAAM1N,KAAKhL,e,0CAI/BwO,GAChB+D,QAAQC,IAAIhE,GACZiL,KAAKf,MAAM+tB,iBAAiBhtB,KAAKf,MAAM1N,KAAKhL,YAAayZ,KAAKf,MAAM1N,KAAK1G,IAAKmV,KAAKf,MAAMguB,WAAWpiC,IAAKkK,K,0CAGzFA,GACZA,EAAWvN,QAAUuN,EAAW6D,SAChCoH,KAAKf,MAAMiuB,iBAAiBn4B,EAAWvN,OAAQwY,KAAKf,MAAM1N,KAAK1G,IAAKkK,EAAW6D,W,0CAInE7D,GAChB,GAAKA,EAAWvN,QAAWuN,EAAW6D,QAAtC,CAIA,IAAMu0B,EAAQl5B,OAAOC,OAAO,GAAI8L,KAAKf,MAAM1N,KAAKuD,MAAMC,EAAW6D,UAC5Du0B,GAILA,EAAM9mC,KAAO0O,EACbiL,KAAKf,MAAMmuB,iBAAiBD,EAAOntB,KAAKf,MAAM1N,KAAKhL,YAAayZ,KAAKf,MAAM1N,KAAK1G,MAJ5EiO,QAAQ3O,MAAM,mCALd2O,QAAQ3O,MAAM,6C,+BAYZ,IAAD,OACCwN,EAAY,IAAIC,KAAKC,eAAe,UAAWC,IACrD,OACI,6BACI,yBAAKgI,UAAU,gBAAf,eACiBE,KAAKf,MAAMguB,WAAWj1B,UADvC,IACmDgI,KAAKf,MAAMguB,WAAWh1B,SADzE,IACmF,6BADnF,kBAEoBN,EAAUO,OAAO,IAAIC,KAAK6H,KAAKf,MAAM1N,KAAK87B,YAE9D,kBAACC,GAAA,EAAD,CAAMC,UAAWvtB,KAAKtV,MAAMmhC,YAAa2B,SAAUxtB,KAAK+rB,eACpD,kBAAC0B,GAAA,EAAD,CAAKC,SAAS,OAAOllC,MAAM,OAAOmlC,cAAY,EAACjvB,MAAO,CAACkF,OAAQ,SAC3D,kBAAC4V,GAAA,EAAD,CAAK9a,MAAO,CAACkF,OAAQ,SACb,kBAAC6V,GAAA,EAAD,KACI,kBAAC,GAAD,CAAWsQ,YAAa/pB,KAAKf,MAAM2uB,MAC/Bv4B,QAAS2K,KAAKf,MAAM1N,KAAKlL,KAAKyD,KAC9BogC,OAAQlqB,KAAKf,MAAM1N,KAAKuD,MACxBk1B,cAAehqB,KAAKf,MAAM1N,KAAKy4B,cAC/Bj/B,OAAQiV,KAAKf,MAAMguB,WACnBnC,SAAU9qB,KAAKgsB,oBACfjB,SAAU/qB,KAAKksB,oBACfpC,SAAU9pB,KAAKisB,oBACf7B,eAAgB,kBAAM,EAAKnrB,MAAMxM,qBAAqB,CAAEzJ,UAAW,EAAKiW,MAAM1N,KAAK1G,IAAKmK,MAAO,QAKtGgL,KAAKf,MAAM1N,KAAKlL,KAAKmL,WAAawO,KAAKf,MAAM4uB,aAAe7tB,KAAKf,MAAM6uB,YACvE,kBAACrU,GAAA,EAAD,CAAK3Z,UAAU,8CACX,kBAAC0Z,GAAA,EAAD,KACI,yBAAK1Z,UAAU,gBAAf,kBACI,kBAAC8O,EAAA,EAAD,CAAQ9O,UAAU,YAAY+O,QAAQ,UAAUb,KAAI,gBAAWhO,KAAKf,MAAM1N,KAAKlL,KAAKmL,UAAU7H,QAAUyV,OAAO,UAA/G,oBAGR,kBAACoa,GAAA,EAAD,CAAK1Z,UAAU,oBACX,kBAAC,GAAD,CACInW,OAAQqW,KAAKf,MAAM1N,KAAKlL,KAAKmL,UAAU7H,OACvCgI,UAAWqO,KAAKf,MAAM4uB,YACtBj8B,UAAWoO,KAAKf,MAAM6uB,YACtBziB,YAAa,SAAClX,GAAD,OAAU,EAAK8K,MAAM5G,iBAAiBlE,EAAQ,UAC3DmX,YAAa,SAAC3hB,GAAWwM,OAAOwkB,KAAP,gBAAqBhxB,GAAU,eAG3D,KAKE,SAApBqW,KAAKf,MAAM3J,KAEX,kBAACm4B,GAAA,EAAD,CAAKC,SAAS,QAAQllC,MAAM,SACxB,kBAAC,GAAD,CACI+I,KAAMyO,KAAKf,MAAM1N,KACjB+vB,mBAAoBthB,KAAKohB,iBACzBhhB,SAAUJ,KAAK8rB,aACfzL,cAAergB,KAAKqgB,iBAI5B,GAEJ,kBAACoN,GAAA,EAAD,CAAKC,SAAS,SAASllC,MAAM,aACzB,kBAAC,GAAD,CAAWiM,QAASuL,KAAKf,MAAM1N,KAAM6O,SAAUJ,KAAK8rB,gBAExD,kBAAC2B,GAAA,EAAD,CAAKC,SAAS,UAAUllC,MAAM,WAAU,kBAAC,GAAD,CAASoM,QAASoL,KAAKf,MAAM1N,KAAKqD,WAC1E,kBAAC64B,GAAA,EAAD,CAAKC,SAAS,aAAallC,MAAM,cAAa,kBAAC,GAAD,CAAYo7B,aAAc5jB,KAAKf,MAAM1N,KAAM6O,SAAUJ,KAAKf,MAAM6sB,sB,GAvK/G/L,IAAMnf,YAwLnBC,GAAqB,CACvB9J,oBAAkBU,gBAClBy1B,iBpCmQ4B,SAAC1lC,EAAQwB,EAAWiM,GAApB,8CAA+B,WAAOhK,GAAP,SAAA9E,EAAA,sEACrD+E,EAAe1D,GADsC,gCAEpDyD,EAASyH,GAAiB,CAAE1J,YAAWiM,aAFa,2CAA/B,uDoCnQVmH,mBAAiB4wB,iBpC8OP,SAACzmC,EAAayC,EAAWV,EAAUyM,GAAnC,8CAAkD,WAAO9J,GAAP,mBAAA9E,EAAA,6DACxEoC,EAAS,CACXhC,YAAaA,EACbY,KAAM,aACNqB,MAAO,gBACPC,QAAS,CAACH,GACVI,OAAQ,SACRC,WAAY,UACZtC,KAAM0O,GARoE,SAU5D7J,EAAsB3E,EAAagC,GAVyB,cAUxEwlC,EAVwE,gBAY3D7iC,EAAa6iC,EAAIljC,IAAK7B,EAAW,aAZ0B,OAYxEvB,EAZwE,OAc9EsN,EAAWvN,OAASC,EAAKoD,IACzBkK,EAAW6D,QAAUm1B,EAAIljC,IACzBI,EAASuH,GAAc,CAAExJ,YAAW+L,WAAYg5B,KAhB8B,4CAAlD,uDoC9OyBX,iBpCwQzB,SAACr4B,EAAYxO,EAAayC,GAA1B,8CAAwC,WAAOiC,GAAP,eAAA9E,EAAA,sEACzC+E,EAAc6J,EAAYxO,EAAawO,EAAWlK,KADT,cAC9DmjC,EAD8D,yBAE7D/iC,EAASuH,GAAc,CAAExJ,YAAW+L,WAAYi5B,MAFa,2CAAxC,uDoCvQ5Bv7B,wBAAsB65B,iBpCyTM,SAACtjC,EAAWsL,GAAZ,8CAAsB,WAAOrJ,EAAU4L,GAAjB,mBAAA1Q,EAAA,6DAC5CuE,EAAQmM,IACVpC,EAAU/J,EAAMsJ,MAAMhL,GACpBilC,EAAWx5B,EAAQC,UAAUrN,QAAO,SAAC+R,GAAD,OAASA,EAAItR,KAAOwM,KAAO,GAHnB,SAI5CpJ,EAAe+iC,EAASpjC,KAJoB,OAKlDI,EAASgH,GAAiB,CAAEqC,QAAOH,OAAQnL,KAC3CiC,EAASsM,GAAWvO,EAAW,SANmB,2CAAtB,yDoCzTYqP,qBAE7B2I,gBAfS,SAACtW,EAAOwiB,GAAc,IAAD,YACzC,MAAO,CACH+f,WAAY/f,EAAS3b,OAAS7G,EAAMgN,MAAMwV,EAAS3b,KAAK9I,QAAQ,KAAO,MACvEylC,cAAexjC,EAAMoM,QAAQ/L,OAC7B4L,SAAoBuW,EAAS3b,MAAQ2b,EAAS3b,KAAK9I,QAAQ0D,SAASzB,EAAMoM,QAAQ/L,OAAOF,KACzFgjC,aAAa,UAAA3gB,EAAS3b,YAAT,mBAAelL,YAAf,eAAqBmL,aAArB,UAAkC9G,EAAMsJ,MAAMD,QAAQmZ,EAAS3b,KAAKlL,KAAKmL,UAAU7H,eAAnF,aAAkC,EAA0DgI,WACzGm8B,aAAa,UAAA5gB,EAAS3b,YAAT,mBAAelL,YAAf,eAAqBmL,aAArB,UAAkC9G,EAAMsJ,MAAMD,QAAQmZ,EAAS3b,KAAKlL,KAAKmL,UAAU7H,eAAnF,aAAkC,EAA0DiI,cAW7GiP,GAFWG,CAGb4qB,ICzGauC,GAjGI,SAAAlvB,GAEf,IAAMmvB,EAASnvB,EAAMmvB,OACfC,EAAYra,aAAY,SAAAtpB,GAAK,OAAIA,EAAMsJ,MAAMo6B,EAAOplC,cACpDiC,EAAWgpB,cAJO,EAKAC,mBAAS,MALT,mBAKjB3iB,EALiB,KAKX+8B,EALW,OAMQpa,oBAAS,GANjB,mBAMjBpnB,EANiB,KAMPyhC,EANO,OAOFra,mBAAS,MAPP,mBAOjBhQ,EAPiB,KAOZsqB,EAPY,OAQMta,mBAAS,MARf,mBAQjB0I,EARiB,KAQR6R,EARQ,KAUxBC,qBAAU,WACNJ,GAAQ,SAAAK,GACJ,OAAiB,OAAbA,EACO,eAAIN,GAEJ,2BAAIM,GAAX,IAAqBl7B,YAAa46B,EAAU56B,YAAamB,QAASy5B,EAAUz5B,eAErF,CAACy5B,IAGJ,IA4BMvR,EAAkB,WACpB0R,EAAO,MACPD,GAAY,IAUhB,OACI,6BACI,kBAAC,GAAD,CAAQzyB,IAAKsyB,EAAOjhC,GACZA,GAAIihC,EAAOjhC,GACXqwB,YAAave,EAAMue,YACnBh1B,MAAO4lC,EAAO5lC,MACdkW,MAAO,CAACtR,OAAQghC,EAAOhhC,QACvBinB,QAAS,kBA9CrBppB,EAASsB,IADUW,EA+CoBkhC,GA9CdjhC,UACzBlC,EAAS6G,GAAW5E,EAAIlE,YAFN,IAACkE,GAgDP2wB,UAAW,WA1CvB5yB,EAAS3E,GAAiBiL,EAAM68B,EAAOjhC,MA2C3BuJ,cAAe03B,EAAO13B,cACtBC,SAAUy3B,EAAOz3B,SACjBmnB,QAASsQ,EAAO51B,QAChBulB,eAAgB,kBA3CR5pB,EA2C2Bi6B,EAAOplC,eA1CtDiC,EAAS2L,GAAYzC,IADF,IAACA,IA6CX5C,EACA,kBAAC,GAAD,CACIuK,IAAKsyB,EAAOplC,UACZ4kC,MAAOQ,EAAOjhC,GACdoE,KAAMA,EACN+D,KAAM84B,EAAOz3B,SAAU,QAAS,OAChCimB,QAASA,EACTkP,aAhDI,SAAC8C,GAClBN,GAAQ,SAAAK,GACJ,IAAMt4B,EAAO,2BAAOs4B,GAAaC,GAEjC,OADAv4B,EAAQhQ,KAAR,2BAAoBsoC,EAAStoC,MAASuoC,EAAYvoC,MAC3CgQ,MA6CEy2B,eAzCM,SAAC5oB,GAChBA,GACAsqB,EAAOtqB,GAEXqqB,GAAY,IAsCCnC,kBA9BS,WAAQqC,EAAW,SAgC/B,MAGJ3hC,EACD,kBAAC,GAAD,CAAUunB,QAASyI,EACPe,UAnCO,SAACjB,GACzB6R,EAAW7R,GACXE,KAkCiB5Y,IAAKA,IACZ,OCzBH2qB,GAjEI,SAAC5vB,GAChB,IACM7G,EADY,IAAIR,KAAKC,eAAe,UAAWC,IACzBI,OAAO,IAAIC,KAAK8G,EAAM7K,WAAWi5B,WACvDyB,EAAe9a,aAAY,SAAAtpB,GAAK,OAAIA,EAAMgN,MAAMuH,EAAM7K,WAAW3L,QAAQ,KAAO,QAChFwC,EAAWgpB,cAJS,EAKYC,mBAAS,QALrB,mBAKnB2X,EALmB,KAKNkD,EALM,KAe1B,OACI,6BACI,yBAAKjvB,UAAU,gBAAf,eACiBgvB,EAAa92B,UAD9B,IAC0C82B,EAAa72B,SADvD,IACiE,6BADjE,kBAEoBG,GAEpB,kBAACk1B,GAAA,EAAD,CAAMC,UAAW1B,EAAamD,YAAY,EAAOxB,SAfnC,SAACT,GACnBgC,EAAehC,GACH,YAARA,GACA9hC,EAASwM,GAAawH,EAAM7K,WAAWvJ,MAC7B,WAARkiC,GACF9hC,EAASmR,GAAgB6C,EAAM7K,WAAW7N,gBAWtC,kBAACknC,GAAA,EAAD,CAAK/uB,MAAO,CAACkF,OAAQ,QAAS8pB,SAAS,OAAOllC,MAAM,QAEhD,uBAAGwlB,KAAI,UAAKiI,GAAL,OAAkBhX,EAAM7K,WAAW/N,KAAKpB,KAAQuD,MAAOyW,EAAM7K,WAAW5L,MAAOsb,UAAQ,GACxF7E,EAAM7K,WAAW/N,KAAKpB,KAEK,oBAA/Bga,EAAM7K,WAAW/N,KAAKc,KACxB,4BAAQd,KAAI,UAAK4vB,GAAL,OAAkBhX,EAAM7K,WAAW/N,KAAKpB,KAAQkC,KAAK,kBAAkByY,MAAM,OAAOgE,OAAO,SAE3F,IAKG,SAAf3E,EAAM3J,KACN,kBAACm4B,GAAA,EAAD,CAAKC,SAAS,QAAQllC,MAAM,SACxB,kBAACgxB,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,kBAAC,KAAKuI,MAAN,CAAYliB,UAAU,mBAAmBmiB,UAAU,cAC/C,kBAAC,KAAKC,QAAN,CAAc/6B,KAAK,OACL2Y,UAAU,kBACV8d,KAAK,KACL1d,YAAY,cACZlL,MAAOiK,EAAM7K,WAAW5L,MACxB4X,SAAU,SAACf,GAASJ,EAAMmB,SAAS,CAAC5X,MAAO6W,EAAID,OAAOpK,eAMpF,GAGJ,kBAACy4B,GAAA,EAAD,CAAKC,SAAS,SAASllC,MAAM,aACzB,kBAAC,GAAD,CAAWiM,QAASwK,EAAM7K,WAAYgM,SAAUnB,EAAMmB,YAE1D,kBAACqtB,GAAA,EAAD,CAAKC,SAAS,UAAUllC,MAAM,WAAU,kBAAC,GAAD,CAASoM,QAASqK,EAAM7K,WAAWQ,WAC3E,kBAAC64B,GAAA,EAAD,CAAKC,SAAS,aAAallC,MAAM,cAAa,kBAAC,GAAD,CAAYo7B,aAAc3kB,EAAM7K,WAAYgM,SAAUnB,EAAMmB,eCR3G6uB,GArDU,SAAAhwB,GAErB,IAAMmvB,EAASnvB,EAAMmvB,OACfh6B,EAAa4f,aAAY,SAAAtpB,GAAK,OAAIA,EAAMsJ,MAAMo6B,EAAOplC,cACrDiC,EAAWgpB,cAoBjB,OACI,6BACI,kBAAC,GAAD,CAAQnY,IAAKsyB,EAAOjhC,GACZA,GAAIihC,EAAOjhC,GACXqwB,YAAave,EAAMue,YACnBh1B,MAAO4lC,EAAO5lC,MACdkW,MAAO,CAACtR,OAAQghC,EAAOhhC,QACvBinB,QAAS,kBAvBrBppB,EAASsB,IADUW,EAwBoBkhC,GAvBdjhC,UACzBlC,EAAS6G,GAAW5E,EAAIiH,SAFN,IAACjH,GAyBP2wB,UAAW,WAnBvB5yB,EAAS3E,GAAiB8N,EAAYg6B,EAAOjhC,MAoBjCuJ,cAAe03B,EAAO13B,cACtBC,SAAUy3B,EAAOz3B,SACjBmnB,QAASsQ,EAAO51B,QAChBulB,eAAgB,kBApBR5pB,EAoB2Bi6B,EAAOplC,eAnBtDiC,EAAS2L,GAAYzC,IADF,IAACA,IAsBXC,EACA,kBAAC,GAAD,CACI0H,IAAKsyB,EAAOplC,UACZ4kC,MAAOQ,EAAOjhC,GACdiH,WAAYA,EACZkB,KAAM84B,EAAOz3B,SAAU,QAAS,OAChCyJ,SAxBA,SAAC8uB,GACdjkC,EAAS8G,GAAS,aAAC,IAAOqC,EAAWvJ,KAAQqkC,QAyBnC,QC6FHC,GAxII,SAAAlwB,GACf,IAKImf,EALEzmB,EAAY,IAAIC,KAAKC,eAAe,UAAWC,IAC/Cs2B,EAASnvB,EAAMmvB,OACfxR,EAAU5I,aAAY,SAAAtpB,GAAK,OAAIA,EAAMsJ,MAAMo6B,EAAOplC,cAClDomC,EAAgBpb,aAAY,SAAAtpB,GAAK,OAAIA,EAAMgN,MAAMklB,EAAQn0B,QAAQ,KAAO,QACxE2P,EAAYT,EAAUO,OAAO,IAAIC,KAAKykB,EAAQyQ,WAE9CpiC,EAAWgpB,cAPO,EAScC,mBAAS,SATvB,mBASjB2X,EATiB,KASJkD,EATI,KAuDlBM,EAAgB,SAACniC,GACnBjC,EAASsB,GAAYW,EAAIC,KACzBlC,EAAS6G,GAAW5E,EAAIiH,UAmBtBiM,EAAW,SAACkvB,GACdrkC,EAAS8G,GAAS,aAAC,IAAO6qB,EAAQ/xB,KAAQykC,MAO9C,OACQ,kBAAC,GAAD,CAAQxzB,IAAKsyB,EAAOjhC,GACZA,GAAIihC,EAAOjhC,GACXqwB,YAAave,EAAMue,YACnBh1B,MAAO4lC,EAAO5lC,MACdkW,MAAO,CAACtR,OAAQghC,EAAOhhC,QACvBinB,QAAS,kBAAIgb,EAAcjB,IAC3BvQ,UAAW,kBAvEH,WACpB,IAAM0R,EAAMnR,EAAWC,cACvBkR,EAAIhR,UAAUa,cAAc,MAAO,KACnC,IAAMd,EAAKiR,EAAIhR,UAAUC,iBAAiBC,WAAW,GAC/C+Q,EAAQD,EAAIhR,UAAUC,iBAAiBC,WAAW,GAElDE,EAAO6Q,EAAM,GAAG5Q,UAAUhf,MAC1Bif,EAAO2Q,EAAM,GAAG5Q,UAAUhb,OAChC,GAAa,IAAT+a,GAAuB,IAATE,EAAlB,CAKA,GAAkC,SADtBP,EAAG,GAAGnD,SAAS,GACnB9W,WAAWorB,KAAKz6B,MAEpB,GADWu6B,EAAIhR,UAAUC,iBAAiBC,WAAW,GAC9C,GAAGra,WAAW3e,OAAS,EAAE,CAC5B8pC,EAAIhR,UAAUC,iBAAiBM,SAASjf,aAAa,QAAS8e,EAAO,GACrE4Q,EAAIhR,UAAUC,iBAAiBM,SAASjf,aAAa,SAAUgf,EAAO,GACtE,IAAMc,EAAI4P,EAAIhR,UAAUC,iBAAiBC,WAAW,GACpDkB,EAAE,GAAGvb,WAAW,GAAGvE,aAAa,QAAS8e,GACzCgB,EAAE,GAAGvb,WAAW,GAAGvE,aAAa,SAAUgf,GAC1C0Q,EAAIhR,UAAUQ,0BACdwQ,EAAIhR,UAAUS,wBACduQ,EAAIhR,UAAUU,sBAAsB,IAAK,QACzCsQ,EAAIhR,UAAUU,sBAAsB,IAAK,QACzCsQ,EAAIhR,UAAUW,yBACdqQ,EAAIhR,UAAUY,iBAGtBoQ,EAAIhR,UAAUa,cAAc,MAAO,OACnC,IAAMsQ,EAAU,eAAO9S,GACvB8S,EAAWrpC,KAAX,2BAAsBqpC,EAAWrpC,MAAjC,IAAuC6d,IAAKqrB,EAAIhR,UAAUoR,sBAC1D1kC,EAAS3E,GAAiBopC,EAAYtB,EAAOjhC,UAvBzCkiC,IA8DwBO,IAChBl5B,cAAe03B,EAAO13B,cACtBC,SAAUy3B,EAAOz3B,SACjBmnB,QAASsQ,EAAO51B,QAChBulB,eAAgB,kBAfR5pB,EAe2Bi6B,EAAOplC,eAdtDiC,EAAS2L,GAAYzC,IADF,IAACA,IAiBZ,6BACI,yBAAK2L,UAAU,gBAAf,eACiBsvB,EAAcp3B,UAD/B,IAC2Co3B,EAAcn3B,SADzD,IACmE,6BADnE,kBAEoBG,GAEpB,kBAACk1B,GAAA,EAAD,CAAMC,UAAW1B,EAAamD,YAAY,EAAOxB,SA3F3C,SAACT,GACnBgC,EAAehC,GACH,YAARA,GACA9hC,EAASwM,GAAamlB,EAAQ/xB,MACpB,WAARkiC,GACF9hC,EAASmR,GAAgBwgB,EAAQr2B,gBAuFrB,kBAACknC,GAAA,EAAD,CAAKC,SAAS,QAAQllC,MAAM,QAAQkW,MAAO,CAACkF,OAAQ,QAC/CgZ,EACC,oCACG,kBAACpD,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,kBAAC,KAAKuI,MAAN,CAAYliB,UAAU,mBAAmBmiB,UAAU,cAC/C,kBAAC,KAAKC,QAAN,CAAc/6B,KAAK,OACL2Y,UAAU,kBACV8d,KAAK,KACL1d,YAAY,cACZlL,MAAO4nB,EAAQp0B,MACf4X,SAAU,SAACf,GAASe,EAAS,CAAC5X,MAAO6W,EAAID,OAAOpK,cAI1E,4BAAQipB,OAnDtB,SAAC1L,GACZzZ,QAAQC,IAAI,gBACZ,IAAMmL,EAAM0Y,EAAQv2B,KAAK6d,IACrBA,IACAqO,EAAEnT,OAAOif,cAAcE,UAAUuB,aAAa5b,GAC9CqO,EAAEnT,OAAOif,cAAcE,UAAUa,cAAc,MAAO,SA8CT52B,MAAM,cAAcqlB,IAAI,+BAA+Brf,IA1DvF,SAACqxB,GACdA,IAGJzB,EAAayB,IAsD8GjgB,MAAM,OAAOgE,OAAO,UAG1H,IAGL,kBAAC6pB,GAAA,EAAD,CAAKC,SAAS,SAASllC,MAAM,aACzB,kBAAC,GAAD,CAAWiM,QAASmoB,EAASxc,SAAUA,KAE3C,kBAACqtB,GAAA,EAAD,CAAKC,SAAS,UAAUllC,MAAM,WAAU,kBAAC,GAAD,CAASoM,QAASgoB,EAAQhoB,WAClE,kBAAC64B,GAAA,EAAD,CAAKC,SAAS,aAAallC,MAAM,cAAa,kBAAC,GAAD,CAAYo7B,aAAchH,EAASxc,SAAUA,SCnFpGyvB,GAhDO,SAAA5wB,GAClB,IAAMpS,EAAUmnB,aAAY,SAAAtpB,GAAK,OAAIA,EAAMmC,WACrC5B,EAAWgpB,cAEX6b,EAAgBC,uBAClB,SAACnC,GAAD,OAAW3iC,EAASuB,GAAYohC,MAChC,CAAC3iC,IAGL,OACI,6BACI4B,EAAQA,QAAQb,KAAI,SAACgkC,EAAKhmC,GAEtB,MAAiB,SAAbgmC,EAAI7oC,KAEA,kBAAC,GAAD,CACI2U,IAAKk0B,EAAI7iC,GACTihC,OAAQ4B,EACRxS,YAAa,kBAAMsS,EAAcE,EAAI7iC,OAGzB,eAAb6iC,EAAI7oC,KAEP,kBAAC,GAAD,CACI2U,IAAKk0B,EAAI7iC,GACTihC,OAAQ4B,EACRxS,YAAa,kBAAMsS,EAAcE,EAAI7iC,OAGzB,YAAb6iC,EAAI7oC,KAGP,kBAAC,GAAD,CACI2U,IAAKk0B,EAAI7iC,GACTihC,OAAQ4B,EACRxS,YAAa,kBAAMsS,EAAcE,EAAI7iC,OAItC,QCAZ8iC,GAzCW,SAAAhxB,GAAU,IAAD,EAELiV,mBAAS,IAFJ,mBAExB1rB,EAFwB,KAEjB0nC,EAFiB,KAGzBjlC,EAAWgpB,cAQjB,OACI,kBAAC7F,EAAA,EAAD,CAAO2I,KAAM9X,EAAM8X,KAAMzI,OAAQrP,EAAMyO,aACnC,kBAACU,EAAA,EAAMG,OAAP,CAAcC,aAAW,GACrB,kBAACJ,EAAA,EAAMK,MAAP,uBAEJ,kBAACL,EAAA,EAAMM,KAAP,KACI,kBAAC8K,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,kBAAC,KAAKuI,MAAN,CAAYliB,UAAU,gBAAgBmiB,UAAU,YAC5C,kBAAC,KAAKC,QAAN,CAAc/6B,KAAK,OACLy2B,KAAK,KACL1d,YAAY,cACZlL,MAAOxM,EACP4X,SAAU,SAACf,GAAS6wB,EAAS7wB,EAAID,OAAOpK,cAKtE,kBAACoZ,EAAA,EAAMO,OAAP,KACI,kBAACC,EAAA,EAAD,CAAQC,QAAQ,YAAYlO,QAAS1B,EAAMyO,aAA3C,UAGA,kBAACkB,EAAA,EAAD,CAAQC,QAAQ,UAAUlO,QA5Bd,W3CwCA,IAACwvB,E2CvCrBllC,G3CuCqBklC,E2CvCC3nC,E3CuCF,uCAAoB,WAAOyC,EAAU4L,GAAjB,6BAAA1Q,EAAA,+DAER0Q,IAAWC,QAAxC/L,EAFqC,EAErCA,OAAQxE,EAF6B,EAE7BA,YAAa+P,EAFgB,EAEhBA,KACtBhB,EAAO,CACT3M,WAAY2N,EAAK3N,WACjB4M,MAAOe,EAAKf,MACZ,cAAkBe,EAAKd,eANiB,SAStBxE,GAAWm/B,EAAgBplC,EAAOF,IAAKtE,EAAa+O,GAAM,GATpC,cAStCnE,EATsC,OAWtCkF,EAAUlB,GAAW5O,EAAawE,EAAOF,IAAKyK,GAXR,SAa1BpK,EAAqB3E,EAAa8P,GAbR,cAaxC9E,EAbwC,OAakBlL,MACzDmC,MAAQ2nC,EAd+B,UAgB/B7+B,GAAcC,EAAMJ,EAAQtG,IAAKtE,GAhBF,QAgB5CgL,EAhB4C,OAkB5CrG,EAAaoL,EAAKzL,IAAK0G,EAAK1G,IAAK,WAAY,CAAC2L,EAAG,IAAKC,EAAG,MAlBb,4CAApB,0D2CtCpBwI,EAAMyO,gBA0BE,a,qBC7BV0iB,GAAmBC,wBAAc,MAIvB,eAAmB,IAC3BC,EACAC,EAFWpV,EAAe,EAAfA,SAITlwB,EAAWgpB,cAOXuc,EAAc,SAACC,GAIjBH,EAAOllB,GAAGqlB,EAAY,SAAS,SAACC,G5CnBd,IAACjpC,E4CoBG,SAAdgpC,GAAsC,aAAdC,EAAKvpC,MAA2C,WAApBupC,EAAK5hC,IAAIpG,QAC7DuC,G5CrBWxD,E4CqBSipC,E5CrBV,uCAAU,WAAOzlC,EAAU4L,GAAjB,eAAA1Q,EAAA,yDACjB0Q,IAAWC,QAAQnN,SACnBlC,EAAKI,KAFY,mBAG5BoD,EAAS+H,GAAYvL,IACC,SAAlBA,EAAKqH,IAAI3H,KAJe,gCAKL+D,EAAczD,EAAKK,IALd,OAKlByJ,EALkB,OAMxBtG,EAAS2H,GAAYrB,IANG,2CAAV,6D4C4BlB++B,EAAOllB,GAAGqlB,EAAY,WAAW,SAASC,GACpB,SAAdD,GAA4C,WAApBC,EAAK5hC,IAAIpG,SACjCuC,EAASqI,GAAeo9B,IACxBzlC,EAASsI,GAAe,CAAC,IAAOm9B,EAAK5oC,WAK3C6oC,EAAkB,SAAChnC,GACrB2mC,EAAOM,KAAK,YAAZ,mBAAqCjnC,IACrC2mC,EAAOM,KAAK,YAAZ,oBAAsCjnC,KA+E1C,OAXA4mC,EAAK,CACDD,OAAQA,EACRO,eArDmB,SAAC3L,EAAW4L,GAC1BR,GAoCGpL,GACAyL,EAAgBzL,GAEhB4L,GACAN,EAAYM,MAvChBR,EAASS,KAAG/vB,QACR/b,EACA,CAAC+rC,KxChBM,oBwCiBNj4B,KAAK,EACL,gBAAiB,GACf,oBAAqB,GACrB,qBAAsB,MAEtBqS,GAAG,WAAW,WACjBngB,EAAS0P,IAAgB,IACrBuqB,GACAyL,EAAgBzL,GAEhB4L,GACAN,EAAYM,MAGpBR,EAAOllB,GAAG,SAAS,SAAU/kB,GACzByS,QAAQC,IAAI1S,GAAQ,SACpBiqC,EAAS,KACTrlC,EAAS0P,IAAgB,OAG7B21B,EAAOllB,GAAG,kBAAkB,SAAU/kB,GAClCyS,QAAQC,IAAI1S,GAAQ,kBACpBiqC,EAAS,KACTrlC,EAAS0P,IAAgB,OAG7B21B,EAAOllB,GAAG,cAAc,SAAS/kB,GAC7BiqC,EAAS,KACTrlC,EAAS0P,IAAgB,SAqBjCi2B,KAnGS,SAACzD,EAAOh2B,GACjBm5B,EAAOM,KAAKzD,EAAOh2B,IAmGnB85B,cA5DmB,SAACR,GACpBH,EAAOY,mBAAmBT,EAAY,SACtCH,EAAOY,mBAAmBT,EAAY,YA2DtCD,YAAaA,EACbG,gBAAiBA,EACjBQ,kBAxEsB,SAACxnC,GACvB2mC,EAAOM,KAAK,cAAZ,mBAAuCjnC,IACvC2mC,EAAOM,KAAK,cAAZ,oBAAwCjnC,KAuExCynC,WAbe,WACXd,GACAA,EAAOc,eAeX,kBAAChB,GAAiBiB,SAAlB,CAA2Br8B,MAAOu7B,GAC7BpV,IC5GPmW,G,kDAEF,WAAYryB,GAAO,IAAD,8BACd,cAAMA,IAoEVsyB,mBAAqB,SAAChf,GAClB,IAAInT,EAASmT,EAAEnT,OACX7B,EAAO6B,EAAO7B,KACdvI,EAAQoK,EAAOpK,MAEnB,EAAK4J,SAAL,eACKrB,EAAOvI,KA3EE,EAmIlBw8B,cAAgB,WACZ,EAAKC,sBACL,EAAKxyB,MAAMO,QAAQvV,KAAK,eArIV,EAwIlBynC,WAAa,WACX,IAAIC,EAAsC,aAA3B,EAAKjnC,MAAMknB,YAA6B,QAAU,WACjE,EAAKhT,SAAS,CAAEgT,YAAa+f,KA1Ib,EA6IlBC,cAAgB,SAAC3yB,GAAD,OACZ,kBAAC4yB,GAAA,EAAD,eAAS1kC,GAAG,kBAAqB8R,GAC5BA,EAAM9H,UA7IX,EAAKzM,MAAQ,CACT9E,MAAOK,eAAed,QAAQ,SAC9BysB,iBAA2Cnc,IAA9B,EAAKwJ,MAAMzC,SAAS9R,MAAsB,WAAa,EAAKuU,MAAMzC,SAAS9R,MAAMknB,YAC9FC,oBAA8Cpc,IAA9B,EAAKwJ,MAAMzC,SAAS9R,MAAsB,KAAO,EAAKuU,MAAMzC,SAAS9R,MAAMmnB,eAC3F2G,QAAS,GACThL,WAAW,EACXwO,UAAU,EACV8V,iBAAiB,EACjBC,oBAAoB,GAGxB,EAAKN,oBAAsB,EAAKA,oBAAoBhsB,KAAzB,gBAC3B,EAAK6F,YAAc,EAAKA,YAAY7F,KAAjB,gBACnB,EAAK8rB,mBAAqB,EAAKA,mBAAmB9rB,KAAxB,gBAC1B,EAAKusB,oBAAsB,EAAKA,oBAAoBvsB,KAAzB,gBAC3B,EAAKtU,QAAU,EAAKA,QAAQsU,KAAb,gBACf,EAAKgI,WAAa,EAAKA,WAAWhI,KAAhB,gBAlBJ,E,gEAsBd,IAAI9b,EAASqW,KAAKf,MAAMtV,OAASqW,KAAKf,MAAMtV,OAASqW,KAAKf,MAAMgzB,MAAMC,OAAOvoC,OAC7EqW,KAAKmyB,QAAQtB,eAAelnC,EAAQ,QACpCqW,KAAKf,MAAMtC,uBAAuBhT,K,yCAGnBkiB,EAAWC,GACtB9L,KAAKf,MAAMtV,QAAUqW,KAAKf,MAAMtV,SAAWkiB,EAAUliB,SACrDqW,KAAKf,MAAMmzB,uBAAuBpyB,KAAKf,MAAMtV,QACzCqW,KAAKf,MAAMlD,cAAgB8P,EAAUliB,SACrCqW,KAAKmyB,QAAQhB,kBAAkBtlB,EAAUliB,QACzCqW,KAAKmyB,QAAQxB,gBAAgB3wB,KAAKf,MAAMtV,Y,6CAM5CqW,KAAKf,MAAMlD,eACXiE,KAAKmyB,QAAQlB,cAAc,QAC3BjxB,KAAKmyB,QAAQhB,kBAAkBnxB,KAAKf,MAAMtV,QAC1CqW,KAAKmyB,QAAQf,gB,4CAKnBpxB,KAAKf,MAAMlM,aAAa,IACxBiN,KAAKf,MAAMhM,YAAY,IACvB+M,KAAKf,MAAM5L,aAAa,IACxB2M,KAAKf,MAAMozB,aAAa,M,kCAGd1oC,GACRqW,KAAKyN,YAAW,GAChBzN,KAAKf,MAAMlF,UAAUpQ,GACrBqW,KAAKf,MAAMO,QAAQvV,KAAK,CACtB0nB,SAAS,SAAD,OAAWhoB,GACnBe,MAAO,CAAEknB,YAAa5R,KAAKtV,MAAMknB,YAAaC,eAAgB7R,KAAKtV,MAAMmnB,oB,gCAK3E7R,KAAKpB,SAAS,CACVod,UAAU,EACVW,WAAW,M,0CAeCpK,GAAI,IAAD,OACnBA,EAAEhT,iBACF,IAAIqZ,EAAS,CACT7yB,QAAS,CAAE6sB,cAAc,UAAD,OAAY5S,KAAKtV,MAAM9E,SAG/C0sC,EAAU,UAAMltC,EAAN,0BAA8B4a,KAAKf,MAAM1Y,aAEnD2B,EAAQ,CACR,QAAW,CAAC8X,KAAKf,MAAMlU,OAAOF,KAC9B,YAAemV,KAAKf,MAAM1Y,YAC1B,WAAc,SACd,OAAU,SACV,MAASyZ,KAAKtV,MAAM8tB,QACpB,KAAQ,QAEZM,IAAMryB,KAAK6rC,EAAYpqC,EAAO0wB,GACzBhvB,MAAK,SAAAC,GAEF,IAAI0oC,EAAY1oC,EAAOxD,KAAKwE,IAC5BnE,EAAa,EAAKuY,MAAM1Y,aAAaqD,MAAK,SAAAvD,GACtCA,EAAKA,KAAKgL,MAAMpH,KAAKsoC,GACrB5rC,EAAaN,EAAKA,KAAM,EAAK4Y,MAAM1Y,aAAaqD,MAAK,SAAApD,GACjDgD,GAAS,EAAKyV,MAAM1Y,aAAaqD,MAAK,SAAA4oC,GAKlC9qC,EAAS,EAAKuX,MAAMtV,OAAQ4oC,EAAW,WAJ7B,CACN/7B,EAAG,IACHC,EAAG,MAEiD7M,MAAK,SAAA6oC,GACzDr8B,MAAM,cACND,OAAOqG,SAASk2B,QAAO,eAIpCxoC,OAAM,SAAAC,GACL2O,QAAQC,IAAI5O,SAGlBD,OACE,SAAAC,GACI2O,QAAQC,IAAI5O,Q,iCAMjB6K,GACPgL,KAAKpB,SAAS,CACV+d,UAAW3nB,M,+BAoBV,IAAD,OACF29B,EAA0C,aAA3B3yB,KAAKtV,MAAMknB,YACX,kBAAC,GAAD,CACIjoB,OAAQqW,KAAKf,MAAMtV,OACnBgI,UAAWqO,KAAKf,MAAMtN,UACtBC,UAAWoO,KAAKf,MAAMrN,UACtB0Z,YAAatL,KAAKsL,YAClBD,YAAa,SAAClX,GAAD,OAAU,EAAK8K,MAAM5G,iBAAiBlE,EAAQ,YAG/D,kBAAC,GAAD,MAEnB,OACI,yBAAK2L,UAAU,qCAAqC3S,GAAG,+BACnD,kBAAC,GAAD,MACA,kBAAC,GAAD,CACIH,YAAagT,KAAKtV,MAAMonC,gBACxBnoC,OAAQqW,KAAKf,MAAMtV,OACnB0qB,QAAS,kBAAM,EAAKzV,SAAS,CAACkzB,iBAAiB,OAEnD,kBAAC,GAAD,CAAmB/a,KAAM/W,KAAKtV,MAAMqnC,mBAAoBrkB,YAAa,kBAAM,EAAK9O,SAAS,CAACmzB,oBAAoB,OAC9G,yBAAKjyB,UAAU,OACV,kBAAC,GAAD,CAAW8R,YAAa5R,KAAKtV,MAAMknB,YAAatG,YAAatL,KAAKsL,YAAauG,eAAgB7R,KAAKtV,MAAMmnB,kBAG/G,yBAAK/R,UAAU,mBAGX,yBAAKA,UAAU,SAAS3S,GAAG,kBACzB,yBAAK2S,UAAU,oBACb,yBAAKA,UAAU,6CACf,kBAAC8yB,GAAA,EAAD,CAAgBC,KAAK,QAAQ/yB,UAAU,sBAAsBtX,MAAO,uBAAGsX,UAAU,wBAE7E,kBAACgzB,GAAA,EAASC,KAAV,CAAepyB,QAAS,kBAAM,EAAK1B,MAAM5I,QAAQ,EAAK4I,MAAM3I,KAAM,EAAK2I,MAAM1Y,YAAa,EAAK0Y,MAAMlU,OAAOF,OAA5G,YAIA,kBAACioC,GAAA,EAASC,KAAV,CAAepyB,QAAS,kBAAM,EAAKxP,YAAnC,YAIA,kBAAC2hC,GAAA,EAASC,KAAV,CAAepyB,QAAS,kBAAM,EAAK/B,SAAS,CAACkzB,iBAAiB,MAA9D,kBAIA,kBAACgB,GAAA,EAASC,KAAV,CAAepyB,QAAS,kBAAM,EAAK1B,MAAMywB,WAAW,EAAKzwB,MAAMtV,OAAQ,EAAKsV,MAAM1Y,YAAa,EAAK0Y,MAAMlU,OAAOF,OAAjH,eAIA,kBAACioC,GAAA,EAASC,KAAV,CAAepyB,QAAS,kBAAM,EAAK/B,SAAS,CAACmzB,oBAAoB,MAAjE,mBAMJ,yBAAKjyB,UAAU,6CACf,kBAACkzB,GAAA,EAAD,CACIC,UAAU,QACVC,MAAO,CAAEnc,KAAM,IAAKoc,KAAM,KAC1BC,QAASpzB,KAAK4xB,cAAc,CAAEz6B,QAAS,oBACvC,kBAACyX,EAAA,EAAD,CAAQjO,QAASX,KAAKwxB,cAAe1xB,UAAU,6BAA4B,uBAAGA,UAAU,wBAI5F,yBAAKA,UAAU,6CACf,kBAACkzB,GAAA,EAAD,CACIC,UAAU,QACVC,MAAO,CAAEnc,KAAM,IAAKoc,KAAM,KAC1BC,QAASpzB,KAAK4xB,cAAc,CAAEz6B,QAAS,iBACvC,kBAACyX,EAAA,EAAD,CAAQjO,QAASX,KAAK0xB,WAAY5xB,UAAU,iCACxC,uBAAGA,UAAU,qBASzB,yBAAKA,UAAU,SAAS3S,GAAG,eACtBwlC,IAOT,kBAACvkB,EAAA,EAAD,CAAO2I,KAAM/W,KAAKtV,MAAMiyB,UAAWrO,OAAQ,kBAAM,EAAKb,YAAW,KAE5DzN,KAAKtV,MAAMsxB,SACR,oCACI,kBAAC5N,EAAA,EAAMG,OAAP,CAAcC,aAAW,GACrB,kBAACJ,EAAA,EAAMK,MAAP,KACI,kBAAC+K,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,eAEJ,kBAACD,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,KACI,kBAACD,GAAA,EAAD,KACI,kBAACjG,GAAA,EAAD,CAAMxT,SAAUC,KAAKgyB,oBAAqBlyB,UAAU,QAChD,kBAAC2Z,GAAA,EAAD,KACI,kBAACjG,GAAA,EAAD,KACI,kBAAC6f,GAAA,EAAD,CAAOhzB,QAAQ,UAAU3B,MAAO,CAAEspB,SAAU,SAA5C,YACA,kBAAC9U,GAAA,EAAD,CAAO/rB,KAAK,OAAOgG,GAAG,UAAU+S,YAAY,kBAAkB3C,KAAK,UAAUvI,MAAOgL,KAAKtV,MAAM8tB,QAASpY,SAAUJ,KAAKuxB,uBAG/H,kBAAC9X,GAAA,EAAD,KACI,kBAAC7K,EAAA,EAAD,CAAQ0kB,QAAQ,YAAYnsC,KAAK,UAAjC,cAQ5B,kBAACinB,EAAA,EAAMM,KAAP,CAAYhQ,MAAO,CAAE,UAAa,sBAAuB,UAAa,SACjEsB,KAAKf,MAAMs0B,QAAQvnC,KAAI,SAACxF,EAAKwD,GAC1B,OAAO,kBAACwvB,GAAA,EAAD,CAAK1d,IAAK9R,EAAGgL,MAAOxO,EAAIgC,MAAOsX,UAAU,cAC5C,kBAAC2Z,GAAA,EAAD,KAAK,kBAAC,IAAD,CAAM9Y,QAAS,kBAAM,EAAK2K,YAAY9kB,EAAIqE,OAA1C,IAAkDrE,EAAIgC,MAAtD,YAId,KAEX,kBAAC4lB,EAAA,EAAMO,OAAP,KACI,kBAACC,EAAA,EAAD,CAAQC,QAAQ,YAAYlO,QAAS,kBAAM,EAAK8M,YAAW,KAA3D,gB,GAlRH7M,aA6RnB0wB,GAAKkC,YAAcpD,GAEnB,IAeMvvB,GAAqB,CACvB9G,aACAhH,gBACAE,eACAI,gBACAg/B,anD/SwB,kBAAM,SAACpnC,GAC/BA,EAASV,GAAa,OmD+StBoS,0BACAy1B,uB3CpGkC,SAACzoC,GAAD,8CAAY,WAAOsB,GAAP,iBAAA9E,EAAA,6DAChD8E,EAAS4H,GAAgB,KADuB,SAE7B1K,EAAUwB,GAFmB,OAE1C2M,EAF0C,OAG1CsG,EAAStG,EAAK/P,YACpB0E,EAASgP,GAAQ3D,IACjBrL,EAAS+N,GAAe1C,EAAKzL,MAC7BI,EAASwO,GAAemD,EAAQtG,EAAKzL,MANW,2CAAZ,uD2CqGlCwN,oBACAhC,WACAq5B,W5CpEsB,SAAC/lC,EAAQpD,EAAa+B,GAAtB,8CAAmC,WAAM2C,GAAN,mBAAA9E,EAAA,6DAEnDoC,EAAS,CACXhC,YAAaA,EACbY,KAAM,UACNqB,MAAO,YACPC,QAAS,CAACH,GACVI,OAAQ,UACRC,WAAY,YACZtC,KAAM,CACF6d,IAAK,oJAV4C,SAclChZ,EAAqB3E,EAAagC,GAdA,OAcnDq0B,EAdmD,OAcSv2B,KAElE6E,EAAavB,EAAQizB,EAAQ/xB,IAAK,WAAY,CAAC2L,EAAG,IAAKC,EAAE,IAAK+f,aAAa,IAErE/hB,EAlBmD,aAkBxCG,QAAS,IAAOgoB,GAEjC3xB,EAAS4G,GAAQ4C,IAEjBxJ,EAASqB,GAAW,CAChB9D,MAAO,cACPkO,cAAe,SACf1N,UAAWyL,EAAQ5J,IACnB1D,KAAM,UACNwP,UAAU,KA3B2C,2CAAnC,wD4CuEXqK,gBA5BS,SAACtW,EAAOwiB,GAC5B,MAAO,CACHtnB,MAAO8E,EAAMoM,QAAQlR,MACrByV,cAAe3Q,EAAMoM,QAAQuE,cAC7B9U,YAAamE,EAAMoM,QAAQvQ,YAC3BoD,OAAQe,EAAMoM,QAAQnN,OACtB2M,KAAM5L,EAAMoM,QAAQR,KACpBvL,OAAQL,EAAMoM,QAAQ/L,OACtBwoC,QAAS7oC,EAAMoM,QAAQzF,MACvB0K,aAAcrR,EAAMoM,QAAQiF,aAC5BpK,UAAWjH,EAAMsJ,MAAMrC,UACvBC,UAAWlH,EAAMsJ,MAAMpC,aAmB3BiP,GAFWG,CAGbswB,I,UCtUamC,GARQ,SAAC,GAAuC,IAA1B7yB,EAAyB,EAApC8yB,UAAyBC,EAAW,8BACpDC,EAAW5f,aAAY,SAAAtpB,GAAK,OAAGA,EAAMoM,QAAQ0E,mBACnD,OAAQ,kBAAC,IAAD,iBAAWm4B,EAAX,CAAiB1L,OAAQ,SAAChpB,GAAD,OAC9B20B,EACC,kBAAChzB,EAAc3B,GACb,kBAAC,IAAD,CAAUnX,GAAG,W,OC+BR+rC,OA5Bf,WAEI,IAAM5oC,EAAWgpB,cAFN,EAIenV,KAJf,mBAIJxZ,EAJI,KAIIM,EAJJ,KAaX,OARIA,IACAD,EAASC,GACTP,EAAUC,GACV2F,EAASyO,GAAe9T,IACxBqF,EAAS6O,GAAiBxU,IAC1B2F,EAASqR,OAIT,yBAAKnP,GAAG,YACJ,kBAAC,IAAD,MACA,kBAAC,IAAD,KACI,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAO2mC,OAAK,EAAC9C,KAAK,IAAI0C,UAAWvmB,KACjC,kBAAC,GAAD,CAAgB2mB,OAAK,EAAC9C,KAAK,aAAa0C,UAAWtjB,KACnD,kBAAC,GAAD,CAAgB4gB,KAAK,gBAAgB0C,UAAWpC,KAChD,kBAAC,GAAD,CAAgBoC,UAAWtjB,SCzB/CmX,IAASU,OACL,kBAAC,IAAD,CAAUr3B,MAAOA,IACb,kBAACmjC,GAAD,KACI,kBAAC,GAAD,QAGR91B,SAASC,eAAe,W","file":"static/js/main.b3a367ab.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAACXBIWXMAAC4jAAAuIwF4pT92AAAGaGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDYtMjFUMTE6Mjc6NDYtMDU6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA5LTEyVDE2OjU4OjM1LTA1OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA5LTEyVDE2OjU4OjM1LTA1OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjEyZTJiMzk4LThjNzQtNDE1OS1iNTRiLTQxNjNhZGNiNmY4MyIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmM5Y2JkYzI3LTEwYmMtOWQ0Yy05MjFmLTg1MGRjOTBmZTAwNiIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjk3YjYxMzJlLTM1ZGItNDE3OS04MDMyLTYxMWRkMWYwNzVhYSI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OTdiNjEzMmUtMzVkYi00MTc5LTgwMzItNjExZGQxZjA3NWFhIiBzdEV2dDp3aGVuPSIyMDE4LTA2LTIxVDExOjI3OjQ2LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoxMmUyYjM5OC04Yzc0LTQxNTktYjU0Yi00MTYzYWRjYjZmODMiIHN0RXZ0OndoZW49IjIwMTgtMDktMTJUMTY6NTg6MzUtMDU6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChNYWNpbnRvc2gpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pia9hzQAAAD6SURBVFiF7dY/SgNBGIbx366LghqCf25kG1MJXsMDeAjxGFqaFCnU0kN4B1MZsDEW7sJImDVCxkkxT/OywzfwzAffzFYn149j3OJYPua4anCP3YwiMMBdjSazSEdV4z23Rcuizm0QUmRiFJkYRSZGkYlRZGIUmRhFJkaRibFNMoPU/7/PeMFyjdqPlDJPOPvLhpQyszYrDNvsYyelzGGbQ7xiv6e2wl5KmTrI0zXqp/8xTUssfql5wGgbRnuCMfnvmSnOu4+cMhOMwoVcMj860lHrH7lNEd7AKx0JZT4TCYSHPAhEVjrS0eASNzjasMy8zRpvvt+pi74NXzMDHXjf0mfDAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKp2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDYtMjFUMTE6Mjc6NDYtMDU6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA5LTEyVDE4OjA1OjUwLTA1OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA5LTEyVDE4OjA1OjUwLTA1OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmExYzgwOTQwLTIzMjYtNDc4NS05ZTA0LWE0MDJjMDdiNDI2ZCIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjcyNzMyNjhjLTE1OTEtYzA0Mi1iM2IxLWM5NjVhNzE5MzRkOCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjcwMTg5MDJiLTU5YjctNDNkNy1iODc1LTk5YmUyNTM2MWJiNCIgdGlmZjpPcmllbnRhdGlvbj0iMSIgdGlmZjpYUmVzb2x1dGlvbj0iMzAwMDAwMC8xMDAwMCIgdGlmZjpZUmVzb2x1dGlvbj0iMzAwMDAwMC8xMDAwMCIgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIgZXhpZjpDb2xvclNwYWNlPSIxIiBleGlmOlBpeGVsWERpbWVuc2lvbj0iMTg3MSIgZXhpZjpQaXhlbFlEaW1lbnNpb249IjE4NzEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjcwMTg5MDJiLTU5YjctNDNkNy1iODc1LTk5YmUyNTM2MWJiNCIgc3RFdnQ6d2hlbj0iMjAxOC0wNi0yMVQxMToyNzo0Ni0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjBiYzRiZGFkLTVkNTQtNDAzYS1iNGIwLWY0ZmViZTgyNzM0YSIgc3RFdnQ6d2hlbj0iMjAxOC0wOS0xMlQxODowMDozMi0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmMxM2M1OWI3LWE1MmItNDdkZC1hMmUwLTE3M2E1MGY3OGEyNCIgc3RFdnQ6d2hlbj0iMjAxOC0wOS0xMlQxODowNTo1MC0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmExYzgwOTQwLTIzMjYtNDc4NS05ZTA0LWE0MDJjMDdiNDI2ZCIgc3RFdnQ6d2hlbj0iMjAxOC0wOS0xMlQxODowNTo1MC0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOmMxM2M1OWI3LWE1MmItNDdkZC1hMmUwLTE3M2E1MGY3OGEyNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MDE4OTAyYi01OWI3LTQzZDctYjg3NS05OWJlMjUzNjFiYjQiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3MDE4OTAyYi01OWI3LTQzZDctYjg3NS05OWJlMjUzNjFiYjQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7C07tpAAAA+0lEQVRYhe3WMUoDQRSH8d+ui4IaguKBBNuYSvAatt5CPIaWJkUaLT2BlXcwlQEbY+EujIRZI2ScFPM1f3Z4A988eDNbvVyfjnGLY/mY46rBPXYzisAAdzWazCIdVY333BYtizq3QUiRiVFkYhSZGEUmRpGJUWRiFJkYRSbGNskMUv//PuEZyzVqP1LKPOLsLxtSyszarDBss4+dlDKHbQ7xiv2e2gp7KWXqIE/WqJ/+xzQtsfil5gGjbRjtCcbkv2emOO8+cspMMAoXcsn86EhHrX/kNkV4A690JJT5TCQQHvIgEFnpSEeDS9zgaMMy8zZrvPl+py76NnwBLFcduiEp6KQAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAJ/mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE4LTA5LTEyVDIxOjI1OjE0LTA1OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOC0wOS0xMlQyMTo1MjozNC0wNTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOC0wOS0xMlQyMTo1MjozNC0wNTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxYWYyNTA0Yy1hMDg0LTQwZDAtOTBjYi00N2VjOTM3MDk5MGIiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0NmM4MjBiYi01NGUyLTYxNDgtODE0Ny04ZGI2N2MxYjlkYzQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxZTRlNGRmMi0zYjYwLTQ0OWQtOWY1OS1hZDBlZjExMWNlMDMiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjFlNGU0ZGYyLTNiNjAtNDQ5ZC05ZjU5LWFkMGVmMTExY2UwMyIgc3RFdnQ6d2hlbj0iMjAxOC0wOS0xMlQyMToyNToxNC0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBpbWFnZS9wbmcgdG8gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6M2E4ZGZjNmQtZmVkNC00MzI4LTgzMjgtMzRmY2M2YjIyMzExIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIxOjM4OjQ1LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MjZlZDljYjYtOGJlZi00NDllLWI2NzQtNzZiYzAzNDIxYjY0IiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIxOjUyOjM0LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MWFmMjUwNGMtYTA4NC00MGQwLTkwY2ItNDdlYzkzNzA5OTBiIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIxOjUyOjM0LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MjZlZDljYjYtOGJlZi00NDllLWI2NzQtNzZiYzAzNDIxYjY0IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFlNGU0ZGYyLTNiNjAtNDQ5ZC05ZjU5LWFkMGVmMTExY2UwMyIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjFlNGU0ZGYyLTNiNjAtNDQ5ZC05ZjU5LWFkMGVmMTExY2UwMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pu/x7K8AAAkXSURBVFiFvVhpkFxVFf7OuW/r6WV6m+7ZiBIlBAOCLGICkigVBUeBKiuSgCguP4JQSgGJCEFERYkkJD9iWSWLUJRYgiAoUQqK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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAJ/mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE4LTA5LTEyVDIxOjI1OjE0LTA1OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOC0wOS0xMlQyMTo0ODoyNC0wNTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOC0wOS0xMlQyMTo0ODoyNC0wNTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowZmU3NjVjNi01NjhmLTRhY2UtYTVlMi1kMjJmMDA5NDBiNmMiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpiODQwOTQzYS1iNjliLTdhNDItODNiZS0zOTY2YWEwNmIxMDQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxZTRlNGRmMi0zYjYwLTQ0OWQtOWY1OS1hZDBlZjExMWNlMDMiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjFlNGU0ZGYyLTNiNjAtNDQ5ZC05ZjU5LWFkMGVmMTExY2UwMyIgc3RFdnQ6d2hlbj0iMjAxOC0wOS0xMlQyMToyNToxNC0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBpbWFnZS9wbmcgdG8gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6M2E4ZGZjNmQtZmVkNC00MzI4LTgzMjgtMzRmY2M2YjIyMzExIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIxOjM4OjQ1LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NTdmMzAzOWEtODMwNC00MDhlLWI2ZDQtNjRhNTczZGZlNTNiIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIxOjQ4OjI0LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MGZlNzY1YzYtNTY4Zi00YWNlLWE1ZTItZDIyZjAwOTQwYjZjIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIxOjQ4OjI0LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTdmMzAzOWEtODMwNC00MDhlLWI2ZDQtNjRhNTczZGZlNTNiIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFlNGU0ZGYyLTNiNjAtNDQ5ZC05ZjU5LWFkMGVmMTExY2UwMyIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjFlNGU0ZGYyLTNiNjAtNDQ5ZC05ZjU5LWFkMGVmMTExY2UwMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PotzvqwAAAlFSURBVFiFxVhpkF1FFf7O6b7v3vu2mSSTbTKTmYTJPkkGCISlCFjBsIiouEAoUNSSkooiGFNlJQiFSyRKAqXID1ZTilJlEbFY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\"","module.exports = \"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAArCAYAAADyijE0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAKp2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDYtMjFUMTE6Mjc6NDYtMDU6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTExLTE4VDE1OjQyOjQ3LTA2OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTExLTE4VDE1OjQyOjQ3LTA2OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmJjZmIyYjEwLWEzZmEtNDEzNC04MTRlLWFkOTk1MzY0YWI2MSIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjE4MzhiYWEzLTQ0OTEtODU0MC1hZDBkLTZlNDYxYjg1Y2FmNyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmMyZmRkYmUwLTkxNTktNDUzZi1hNTc0LTQyYWJlMjJmM2ViOCIgdGlmZjpPcmllbnRhdGlvbj0iMSIgdGlmZjpYUmVzb2x1dGlvbj0iMzAwMDAwMC8xMDAwMCIgdGlmZjpZUmVzb2x1dGlvbj0iMzAwMDAwMC8xMDAwMCIgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIgZXhpZjpDb2xvclNwYWNlPSIxIiBleGlmOlBpeGVsWERpbWVuc2lvbj0iMTg3MSIgZXhpZjpQaXhlbFlEaW1lbnNpb249IjE4NzEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmMyZmRkYmUwLTkxNTktNDUzZi1hNTc0LTQyYWJlMjJmM2ViOCIgc3RFdnQ6d2hlbj0iMjAxOC0wNi0yMVQxMToyNzo0Ni0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjRjNTVlYzUyLTNhMmItNDU4NC04ZWJmLThhNWQ5ODFmNGNhYiIgc3RFdnQ6d2hlbj0iMjAxOC0xMS0xOFQxNTozOTozOC0wNjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjQzZjE3NmNiLWFhMGYtNDZkYS1iZTk1LTczZjUyNTI2MGZkOCIgc3RFdnQ6d2hlbj0iMjAxOC0xMS0xOFQxNTo0Mjo0Ny0wNjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmJjZmIyYjEwLWEzZmEtNDEzNC04MTRlLWFkOTk1MzY0YWI2MSIgc3RFdnQ6d2hlbj0iMjAxOC0xMS0xOFQxNTo0Mjo0Ny0wNjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQzZjE3NmNiLWFhMGYtNDZkYS1iZTk1LTczZjUyNTI2MGZkOCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpjMmZkZGJlMC05MTU5LTQ1M2YtYTU3NC00MmFiZTIyZjNlYjgiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjMmZkZGJlMC05MTU5LTQ1M2YtYTU3NC00MmFiZTIyZjNlYjgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7y32vAAAADuklEQVRYhe2YTWhjVRTHf/e+jzRtMglaW1tSptC0tpShC0EQKqUutG6qojgrF8Iwiu4GcSEuFXfqTgYd7FpBMLNxNkJFunDRLrIouugH/bax9pm2JO+93DuL5MUmmYQOzWu78L+5eSfn8n7v3nPOe/cIrTUAs7Oz1EkAt4BpQAIOcA/4vd4xUCaTafbXmWQ2sSeBB8BzdfbbwCfAZ+e662PAJIA/gaeAPeCryvgC8A7wKdAPfNBuGPkI290KyDzwLHAIjALfAS9XfN4HXgobpge4Wfn9IfAD8DXwEfArkALuACil3jVNk46ODrTWKKXaB1MoFJBSjmqtkVJmDMN4TWv9PDCvtb5VcfsmmBOJRJ45OjpiZWUF0zTp6upqH8zAwAD5fF7bto3jOEe7u7v9AK7rfuF53j2lVEZKKT3Pu1YoFDAMw8hms2xtbWHbNqVS6dwwYm5u7gngY63106urq/2Li4vTsVhs3TAMXSqVBoeGhuaHh4dXFhYWXtzY2Lg+MjKS3dzcvBGNRv+dmpr6CZCWZbnn5PgH+NwEXgfei0ajXd3d3eRyOfr6+q7PzMzgOA5CiKlEIjFlWRa5XI7p6ekbk5OT5PP5a7Ztv62Uake8nAB/mMC3AL7vo5RCCAGAYRhEIhG01ggh0FoTFEjLsrBtu8Z2TnUCd03ABWwhBL7vA6C1xvM8fN9Ha12NByEESil836/6tlGuBIrBValUqt78dEC6rovrukhZjnfP89oNAlCsZpPneViWhRACKWV1VQCKxSK2bSOlrFmpdqum6AUxUB8HpmkihKiuSAhb1AjTSgFgEOBXAiZMnRnmInS1YZRSmKaJZVn/OUmJZVkopULdroZsqrwoOT4+rtpd18VxHGzbDg2kASYej9Pb28vh4SHr6+tV+87ODnt7eySTSTo7O0PLqJrPzkgkQjqdJpvNsrS0xNraGkII9vf3UUoxMTFBMpkMbasavoHHxsYQQrC8vMzBwQFQjpl0Os34+DjRaJSTk5OLgQEYHR0lFouxvb0NQE9PD4ODg0A5fsJSs6MKqVSKVCrVYA/rVQBXvc5cpv6HaaarBBNvmk1t0s/Ab8BZqmQxTJgHwCuPMyFMmF8qowSepNzvaSUZJky8MiaAFcpno2YSgAgTRpwaY2fw//4isklTPr620o/AzauQ2hngDbj8OpMBXg0uLhOmBgQuD+Z+PQiUYVqlXLt0ugLfBxqazgHM+TuDj9bphwwafk1BoFyB3wS+pNyIbqf+rowS+ItyK/etVhMeAuZkZDAeOcH2AAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAGAGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDktMTJUMjI6MDk6NDctMDU6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA5LTEyVDIyOjIxOjM5LTA1OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA5LTEyVDIyOjIxOjM5LTA1OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjYxYmMzYjk1LWE4ZDItNDFjZC1iMTFhLTFjMzY3NWYxY2IyZiIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmUxMGM5NWJkLWI1NmEtNzI0Zi1hMzJlLTJjZTk1NDRmMDljNCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjhhZDQ5Y2Q5LWMyZGEtNGMxYi1iMmJhLTBiZDZiMjJmZmM5MyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OGFkNDljZDktYzJkYS00YzFiLWIyYmEtMGJkNmIyMmZmYzkzIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIyOjA5OjQ3LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NjFiYzNiOTUtYThkMi00MWNkLWIxMWEtMWMzNjc1ZjFjYjJmIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIyOjIxOjM5LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6mqJQFAAADHklEQVRYhc2YTWhcVRSAv3Pfve/NNKbtdNKg0bQlFUOxakyVlnZR6EbQVTciFMSli26qBTei0B/cZO1OsHTjTkRcuZAKarASNG1J29CKEap2TJqQSTLv597r4iWDSnWmneFNDjzeD+ee93Huuefcc8V7z2YRKR85QbT/2Nuq8vgoNhY8RdIJJvJu6e7t5MqXE9qMHDird4+96xvL4KMCOZo4mOGn8Y3lIam+d8mLUvgsKR5kQwIDgALf8GncOxCALAFn1xTOpoj0FkYEvMtUbyn+Kbr5JAKioMilnnuk+U/d/GhTkAB0mCsUAWIzcFkewN6vwwSGiVf2Xnnj4K5nUmtrUEQMeUwQ7Pzkh1+nTn4xN04Wr8PYjKHtfXUAEwQ7CyBpyhPV/jo2BaAZwGmWhUVCbEiSZs1Mu6lWU9dgZq99ytLibx3Z6BrM4t3P+Xnmo45sdA1Gm3727fqO6W/eZKW+0FuYJDX8uZAwsPU2tZuvMjP92QPb0K0Urk5dRPvrxMm/M3P+LgJZllBWP1FfcaSZpxwpquUP+fHbSZ49dA6lgu7AlN3HlMKAsvrvrCwlYXXNkWUeJdCIHXGS8FhlitnLx4mq77DnySOdw6wlIWka41zrmrVR/DfutfmYvj5LOTnD5UvjvHj0g/8d3zpmfGelwTlPEICw2lK3pWe2lGKiUN/fMwLOepyHOHZY6/NCvK46sCOkvgL33Fu8cPSlzmEW0+Po+AaNv20GZX0enPOEYYCQoNwMoRGs9YShsH2r4c7CPkafP0up3N8SpC2Y8UMn2zI0+dUpqpWreJ975vfV13nu8Im2xrYN065EJp+W2V8GGBo9x3B1+IFtdA0mS+aZmRtj7PD5h7bRNZhtgy9TGTzQkY2uwTy1/7WObWzO/YzWOu0FgDG62cpqlNIozfzyagmqWOfuFQUSKFWpLa2UCAzYNJDq+1/nabNRx4sgOiqmdxLJ21rvINqCiBCEI+M7gsGRg3iHMmHeyKkCLlGINqA0UnqEbG76gk5vfX9a9VVqatuju12jIVDc+YwHxETYP27dSW5OTshmOrn6C2gfIpLerWS0AAAAAElFTkSuQmCC\"","module.exports = __webpack_public_path__ + \"static/media/sample_view.e92880b7.gif\";","module.exports = __webpack_public_path__ + \"static/media/appstore.9eadb2de.svg\";","module.exports = __webpack_public_path__ + \"static/media/googleplaystore.10b871ef.png\";","import axios from 'axios';\r\n\r\n// export const url = 'https://kf6.ikit.org';\r\n// export const url = 'https://kf6-stage.ikit.org';\r\nexport let url = localStorage.getItem(\"server\");\r\nexport let apiUrl = `${url}/api`;\r\n\r\nexport function setServer(server) {\r\n    //SET SERVER ON SESSION STORAGE\r\n    if (server.endsWith(\"/\")){\r\n        server = server.substring(0, server.length -1);\r\n    }\r\n    localStorage.setItem(\"server\", server);\r\n    url = server;\r\n    apiUrl = `${url}/api`;\r\n    return url;\r\n}\r\n\r\nexport function setToken(token) {\r\n    axios.defaults.headers.common['Authorization'] =\r\n        `Bearer ${token}`;\r\n}\r\n\r\nexport const removeToken = () => {\r\n    delete axios.defaults.headers.common.Authorization\r\n}\r\n\r\n\r\nconst token = sessionStorage.getItem('token');\r\nif (token) {\r\n    setToken(token)\r\n}\r\n\r\n//USER\r\nexport const getUser = async () => {\r\n    return (await axios.get(`${apiUrl}/users/me`)).data\r\n}\r\n\r\n//Contribution\r\nexport const postContribution = (communityId, obj) => {\r\n    return axios.post(`${apiUrl}/contributions/${communityId}`, obj);//, {mode: 'cors'});\r\n}\r\n\r\n//Community\r\nexport const getCommunity = (communityId) => {\r\n    return axios.get(`${apiUrl}/communities/${communityId}`);//, {mode: 'cors'});\r\n}\r\n\r\nexport const putCommunity = async (object, communityId) => {\r\n    return (await axios.put(`${apiUrl}/communities/${communityId}`, object)).data\r\n}\r\n\r\nexport const getCommunities = async () => {\r\n    return (await axios.get(`${apiUrl}/communities/`)).data\r\n}\r\n\r\nexport const getUserCommunities = async () => {\r\n    return (await axios.get(`${apiUrl}/users/myRegistrations`)).data\r\n}\r\n\r\nexport const getGroups = async (communityId) => {\r\n    return (await axios.get(`${apiUrl}/communities/${communityId}/groups`)).data\r\n}\r\n\r\nexport const getCommunityViews = async (communityId) => {\r\n    return (await axios.get(`${apiUrl}/communities/${communityId}/views`)).data\r\n}\r\n\r\n//Links\r\nexport const getLinks = async (objectId, direction, type) => {\r\n    let links = await axios.get(`${apiUrl}/links/${direction}/${objectId}`);\r\n    links = links.data;\r\n    if (type) {\r\n        links = links.filter(function (each) {\r\n            return each.type === type;\r\n        });\r\n    }\r\n    return links\r\n}\r\n\r\nexport const putLink = async (linkId, link) => {\r\n    return (await axios.put(`${apiUrl}/links/${linkId}`, link)).data\r\n}\r\nexport const postLink = async (fromId, toId, type, data) => {\r\n    return (await axios.post(`${apiUrl}/links`, { from: fromId, to: toId, type: type, data: data })).data\r\n}\r\n\r\nexport const deleteLink = async (linkId) => {\r\n    return (await axios.delete(`${apiUrl}/links/${linkId}`)).data\r\n}\r\n\r\nexport const linksSearch = async (communityId, query) => {\r\n    return (await axios.post(`${apiUrl}/links/${communityId}/search`, { \"query\": query })).data\r\n}\r\n\r\n//Object\r\nexport const getObject = async (objectId) => {\r\n    return (await axios.get(`${apiUrl}/objects/${objectId}`)).data\r\n}\r\n\r\nexport const putObject = async (object, communityId, objectId) => {\r\n    return (await axios.put(`${apiUrl}/objects/${communityId}/${objectId}`, object)).data\r\n}\r\n\r\n//Record\r\nexport const read = (communityId, objectId) => {\r\n    return axios.post(`${apiUrl}/records/read/${communityId}/${objectId}`)\r\n}\r\n\r\nexport const postAttachment = (communityId, authorId) => {\r\n    var newobj = {\r\n        communityId: communityId,\r\n        type: 'Attachment',\r\n        title: 'an Attachment',\r\n        authors: [authorId],\r\n        status: 'unsaved',\r\n        permission: 'protected',\r\n        data: {\r\n            version: 0\r\n        }\r\n    };\r\n    return axios.post(`${apiUrl}/contributions/${communityId}`, newobj)\r\n}\r\n\r\nexport const postContribObject = async (communityId, obj) => {\r\n    return (await axios.post(`${apiUrl}/contributions/${communityId}`, obj)).data\r\n}\r\n\r\n//Author\r\nexport const getAuthor = (communityId) => {\r\n    return axios.get(`${apiUrl}/authors/${communityId}/me`)\r\n}\r\nexport const getCommunityAuthors = async (communityId) => {\r\n    return (await axios.get(`${apiUrl}/communities/${communityId}/authors`)).data\r\n}\r\n\r\n//Records\r\nexport const getRecords = async (contribId) => {\r\n    return (await axios.get(`${apiUrl}/records/object/${contribId}`)).data\r\n}\r\n\r\nexport const uploadFile = (file, onProgress) => {\r\n    var formData = new FormData();\r\n    formData.append(\"file\", file);\r\n    return axios.post(`${apiUrl}/upload`, formData, {\r\n        headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n            // ...config.headers\r\n        },\r\n        onUploadProgress: onProgress,\r\n    })\r\n}\r\n\r\nexport const getLinkForObj = (objId) => {\r\n    return axios.get(`${apiUrl}/links/either/${objId}`)\r\n}\r\n\r\nexport const getViews = async (communityId) => {\r\n    return (await axios.get(`${apiUrl}/communities/${communityId}/views`)).data\r\n}\r\n\r\nexport const postView = (query,communityId) => {\r\n    return axios.post(`${apiUrl}/contributions/${communityId}`,query);\r\n}\r\n\r\n// returns a promise that on fullfillment returns an array of the read note ids only\r\nexport function getApiLinksReadStatus(communityId, viewId){\r\n    return axios.get(`${apiUrl}/records/myreadstatusview/${communityId}/${viewId}`).then(function(result) {\r\n        const body = result.data\r\n        var results = [];\r\n        for(var i in body){\r\n            if(body[i].type === \"read\"){ results.push(body[i].to); }\r\n        }\r\n        return (results);\r\n    }).catch(function(error) {\r\n        return (\"Error:\", error);\r\n    });\r\n}\r\n\r\n// used to mark notes as read according to the given parameters\r\nexport function postReadStatus(communityId, contributionId){\r\n    return axios.post(`${apiUrl}/records/read/${communityId}/${contributionId}`).then(function(body) {\r\n        return body\r\n    }).catch(function(error) {\r\n        return (\"Error:\", error);\r\n    });\r\n}\r\n","import { createAction, createReducer } from '@reduxjs/toolkit';\r\nimport * as api from './api.js'\r\n\r\nexport const addUser = createAction('ADD_USER')\r\nexport const addAuthors = createAction('ADD_AUTHORS')\r\nexport const resetAuthors = createAction('SET_AUTHORS')\r\nconst initState = {}\r\nexport const userReducer = createReducer(initState, {\r\n    [addUser]: (state, action) => {\r\n        state[action.payload._id] = action.payload\r\n    },\r\n    [addAuthors]: (state, action) => {\r\n        action.payload.forEach((author) => state[author._id] = author )\r\n    },\r\n    [resetAuthors]: (state, action) => {\r\n        return {}\r\n    }\r\n})\r\n\r\nexport const fetchAuthors = (communityId) => async (dispatch) => {\r\n    const authors = await api.getCommunityAuthors(communityId)\r\n    dispatch(addAuthors(authors))\r\n}\r\n\r\nexport const clearAuthors = () => (dispatch) => {\r\n    dispatch(resetAuthors([]))\r\n}\r\n","import { createAction, createReducer } from '@reduxjs/toolkit';\r\nimport * as api from './api.js'\r\n\r\nexport const requestScaffold = createAction('REQUEST_SCAFFOLD')\r\nexport const receiveScaffold= createAction('RECEIVE_SCAFFOLD')\r\n\r\nconst initState = {isFetching: false,\r\n                   items: [],\r\n                   fetched: false,\r\n                  }\r\n\r\nexport const scaffoldReducer = createReducer(initState, {\r\n    [receiveScaffold]: (state, action) => {\r\n        state.items = action.payload\r\n        state.isFetching = false\r\n        state.fetched = true\r\n    },\r\n    [requestScaffold]: (state, action) => {\r\n        state.isFetching = true\r\n    }\r\n});\r\n\r\nexport const fetchScaffolds = (communityId, contextId) => {\r\n    return dispatch => {\r\n        dispatch(requestScaffold)\r\n\r\n        let scaffold_promise = api.getCommunity(communityId).then( res => {\r\n            return Promise.all(res.data.scaffolds.map((scaffoldId) => {\r\n                return api.getObject(scaffoldId);\r\n            }));\r\n        });\r\n\r\n        return Promise.all([scaffold_promise, api.getLinks(contextId, 'from', 'uses')]).then(async res =>{\r\n            let links = res[1].map((link) => link.to);\r\n            let scaffolds = res[0].filter((el) => links.includes(el._id));\r\n            /* const scaffolds = this.state.scaffolds; */\r\n            let supports = await Promise.all(scaffolds.map((el) => api.getLinks(el._id, 'from')));\r\n            scaffolds = scaffolds.map((scaffold, i) => {\r\n                scaffold.supports = supports[i];\r\n                return scaffold;\r\n            })\r\n\r\n            dispatch(receiveScaffold(scaffolds))\r\n        });\r\n    }\r\n}\r\n","import { createAction, createReducer } from '@reduxjs/toolkit';\r\n\r\nexport const openDialog = createAction('OPEN_DIALOG');\r\nexport const closeDialog = createAction('CLOSE_DIALOG');\r\nexport const focusDialog = createAction('FOCUS_DIALOG')\r\nexport const openAttachPanel = createAction('OPEN_ATTACH_PANEL')\r\nexport const closeAttachPanel = createAction('CLOSE_ATTACH_PANEL')\r\n\r\nlet dialogCounter= 0\r\nconst defaultZIndex = 999\r\nconst focusedZindex = 1000\r\n//Dialog content\r\n// dialog = {id, noteId, title, content, confirmButton, zIndex}\r\nconst initState = { dialogs: [], drawTool: null, focused: null, attachPanel: {}};\r\nexport const dialogReducer = createReducer(initState, {\r\n    // actionCreator.toString() will automatically be called here\r\n    [openDialog] : (state, action) => {\r\n        //Unfocus previous focused dialog\r\n        const dlgs = state.dialogs.map(dlg => {\r\n            if (dlg.id === state.focused)\r\n                dlg.zIndex = defaultZIndex\r\n            return dlg\r\n        })\r\n        //Add new dialog\r\n        state.focused = dialogCounter\r\n        state.dialogs = [...dlgs, {id: dialogCounter++, zIndex: focusedZindex, ...action.payload}]\r\n        //Update index of focused\r\n        // state.dialogs.push({id: dialogCounter++, ...action.payload});\r\n    },\r\n\r\n    // Or, you can reference the .type field:\r\n    [closeDialog] : (state, action) => {\r\n        state.dialogs = state.dialogs.filter((dlg) => dlg.id !== action.payload)\r\n    },\r\n\r\n    [openAttachPanel]: (state, action) => {\r\n        state.attachPanel = action.payload;\r\n    },\r\n\r\n    [closeAttachPanel]: (state, action) => {\r\n        state.attachPanel = {};\r\n    },\r\n\r\n    [focusDialog]: (state, action) => {\r\n        if (state.focused !== action.payload) {\r\n            state.dialogs = state.dialogs.map( dlg => {\r\n                if (dlg.id === state.focused)\r\n                    dlg.zIndex = defaultZIndex\r\n                else if (dlg.id === action.payload)\r\n                    dlg.zIndex = focusedZindex\r\n                return dlg\r\n            })\r\n            state.focused = action.payload\r\n        }\r\n    }\r\n});\r\n\r\n","import $ from 'jquery'\r\nimport {postLink, deleteLink} from './api.js'\r\n\r\n//Count words inside scaffold labels\r\nexport const scaffoldWordCount = (text) => {\r\n    const doc = '<div>' + text + '</div>';\r\n    const jq = $(doc); //convert to jquery dom element\r\n    let labels = jq.find('.kfSupportStartLabel')\r\n    let numwords = 0;\r\n    for (let i = 0; i< labels.length; i++){\r\n        numwords += labels[i].innerHTML.split(' ').length\r\n    }\r\n    return numwords\r\n}\r\n\r\nconst createScaffoldStartTag = (title, isTemplate) => {\r\n    let tag = '';\r\n    tag = tag + ' '; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span class=\"kfSupportStartMark\"> &nbsp; </span>';\r\n    } else {\r\n        tag = tag + '<span class=\"kfSupportStartMark kfTemplateStartMark\"> &nbsp; </span>';\r\n    }\r\n    tag = tag + ' '; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span class=\"kfSupportStartLabel\">' + title + '</span>';\r\n    } else {\r\n        tag = tag + '<span class=\"kfSupportStartLabel kfTemplateStartLabel\">' + title + '</span>';\r\n    }\r\n    tag = tag + ' '; //important for mce\r\n    return tag;\r\n};\r\n\r\nconst createScaffoldEndTag = (isTemplate) => {\r\n    let tag = '';\r\n    tag = tag + ' '; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span class=\"kfSupportEndMark\"> &nbsp; </span>';\r\n    } else {\r\n        tag = tag + '<span class=\"kfSupportEndMark kfTemplateEndMark\"> &nbsp; </span>';\r\n    }\r\n    tag = tag + ' '; //important for mce\r\n    return tag;\r\n};\r\n\r\nconst createReferenceTag = (contId, title, authors, text) => {\r\n    const authorText = '(missing authors)'//TODO $community.makeAuthorStringByIds(authors);\r\n    let tag = '';\r\n    if (text && text.length > 0) {\r\n        tag = tag + '<span class=\"KFReferenceQuote\"><span>\"</span><span class=\"KFReferenceText\">' + text + '</span><span>\"</span></span>';\r\n    }\r\n    tag = tag + '<span> (<a href=\"contribution/' + contId + '\" target=\"' + contId + '\">';\r\n    tag = tag + '<img src=\"/manual_assets/kf4images/icon-note-unread-othr-.gif\">\"' + title + '\"</a>';\r\n    tag = tag + '<span class=\"KFReferenceAuthor\"> by ' + authorText + '</span>)</span>';\r\n    tag = tag + '</span>';\r\n    return tag;\r\n};\r\n\r\nexport const preProcess = (body, toConnections, fromConnections) => {\r\n    const doc = '<div>' + body + '</div>';\r\n    const jq = $(doc);\r\n\r\n    const supportStart = jq.find('.KFSupportStart')\r\n    supportStart.addClass('mceNonEditable');\r\n    for (let i = 0; i < supportStart.length; i++) {\r\n        const elem = supportStart[i]\r\n        if (!elem.id.startsWith('supportid_')) {\r\n            const isTemplate = $(elem).hasClass('KFTemplateStart');\r\n            const ref = toConnections.filter((conn) => conn._id === elem.id)\r\n            if (ref.length) {\r\n                elem.innerHTML =createScaffoldStartTag(ref[0]._from.title, isTemplate);\r\n            } else {\r\n                if(toConnections !== 'Annotation'){\r\n                    elem.innerHTML = createScaffoldStartTag('(missing link)', isTemplate);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    const supportEnd = jq.find('.KFSupportEnd')\r\n    supportEnd.addClass('mceNonEditable');\r\n    for (let i = 0; i < supportEnd.length; i++) {\r\n        const elem = supportEnd[i]\r\n        const isTemplate = $(elem).hasClass('KFTemplateEnd');\r\n        elem.innerHTML = createScaffoldEndTag(isTemplate);\r\n    }\r\n\r\n    const references = jq.find('.KFReference')\r\n    references.addClass('mceNonEditable');\r\n    for (let i = 0; i < references.length; i++) {\r\n        const elem = supportEnd[i]\r\n        let ref = fromConnections.filter((conn) => conn._id === elem.id)\r\n        if (ref.length) {\r\n            ref = ref[0]\r\n            let text = '';\r\n            if (ref.data) {\r\n                text = ref.data.text;\r\n            }\r\n            elem.innerHTML = createReferenceTag(ref.to, ref._to.title, ref._to.authors, text);\r\n        } else {\r\n            elem.innerHTML = createReferenceTag('', '(missing link)', '', '');\r\n        }\r\n    }\r\n    return jq.html();\r\n};\r\n\r\nexport const postProcess = async (text, contributionId, toConnections, fromConnections, handler) => {\r\n    const doc = '<div>' + text + '</div>';\r\n    const jq = $(doc); //convert to jquery dom element\r\n    const endtags = {};\r\n    const supportLinksIds = toConnections.filter((each) => each.type === 'supports')\r\n          .map((each) => each._id) //get only toConnections of type = supports\r\n    let supportStarts = jq.find('.KFSupportStart')\r\n    const supportEnds = jq.find('.KFSupportEnd')\r\n    const toCreate = []\r\n    const supportStartsIds = []\r\n\r\n    for (let i = 0; i < supportEnds.length; i++) {\r\n        const elem = supportEnds[i]\r\n        elem.innerHTML = '';\r\n        var id = elem.id;\r\n        endtags[id] = elem;\r\n    }\r\n    for (let i = 0; i < supportStarts.length; i++) {\r\n        const elem = supportStarts[i]\r\n        let supportId = elem.id;\r\n        elem.innerHTML = '';\r\n        if (supportId.startsWith('supportid_')) {\r\n            supportId = supportId.split('_')[1];\r\n        }\r\n        supportStartsIds.push(supportId)\r\n        if (!supportLinksIds.includes(supportId)) {//Is a new supportLink\r\n            //promise to create link\r\n            toCreate.push(postLink(supportId, contributionId, 'supports').then((link) => {\r\n                //Replace id with id of new created link\r\n                const oldId = elem.id;\r\n                const newId = link._id;\r\n                elem.id = newId;\r\n                if (endtags[oldId]) {\r\n                    endtags[oldId].id = newId;\r\n                }\r\n            }))\r\n        }\r\n    }\r\n    const toDeleteSupports = supportLinksIds.filter((each) => !supportStartsIds.includes(each))\r\n          .map((each) => deleteLink(each)) //Select toConnections that no longer appear in the tinymce text\r\n\r\n\r\n    const referenceLinksIds = fromConnections.filter((each) => each.type === 'references').map((each) => each._id) //get only ids of fromConnections of type=references\r\n    const kfReferences = jq.find('.KFReferenceText') //Get references dom elements\r\n    const kfreferenceIds = []\r\n\r\n    for (var i = 0; i < kfReferences.length; i++) {\r\n        const elem = kfReferences[i]\r\n        const data = {text:$(elem).find('.KFReferenceText').html()}\r\n        elem.innerHTML = '';\r\n        const referenceId = elem.id;\r\n        kfreferenceIds.push(referenceId)\r\n        if (!referenceLinksIds.includes(referenceId)) {//Is a new supportLink\r\n            //promise to create link\r\n            toCreate.push(postLink(contributionId, referenceId, 'references', data).then((link) => {\r\n                //Replace id with id of new created link\r\n                const oldId = elem.id;\r\n                const newId = link._id;\r\n                elem.id = newId;\r\n                if (endtags[oldId]) {\r\n                    endtags[oldId].id = newId;\r\n                }\r\n            }))\r\n        }\r\n    }\r\n\r\n    const toDeleteReferences = referenceLinksIds.filter((each) => !kfreferenceIds.includes(each)).map((each) => deleteLink(each)) //Select fromConnections that no longer appear in the tinymce text\r\n\r\n    await Promise.all(toDeleteSupports)\r\n    await Promise.all(toDeleteReferences)\r\n    await Promise.all(toCreate)\r\n    return jq\r\n}\r\n\r\n","import { store } from 'react-notifications-component';\r\n\r\nconst notifConfig = {\r\n    type: \"success\",\r\n    insert: \"top\",\r\n    container: \"top-right\",\r\n    animationIn: [\"animated\", \"fadeIn\"],\r\n    animationOut: [\"animated\", \"fadeOut\"],\r\n    dismiss: {\r\n        duration: 5000,\r\n        // onScreen: true\r\n    },\r\n}\r\nexport const addNotification = ( notif ) => {\r\n    return store.addNotification({...notifConfig, ...notif});\r\n}\r\n\r\nexport const removeNotification = (notifId) => {\r\n    store.removeNotification(notifId)\r\n}\r\n","import { createAction } from '@reduxjs/toolkit';\r\nexport const addRAView = createAction('ADD_RA_VIEW')\r\nexport const removeRAView = createAction('REMOVE_RA_VIEW')\r\nexport const addToRAView = createAction('ADD_TO_RA_VIEW')\r\n","import * as api from './api.js'\r\nimport { addViewLink, addViewNote, createNote } from './noteReducer.js'\r\nimport { addToRAView } from './noteActions.js'\r\n\r\nexport const updateViewLink = (link) => async (dispatch, getState) => {\r\n    await api.putLink(link._id, link);\r\n}\r\n\r\n//When new view link received, add/update to store, fetch\r\nexport const onViewLink = (link) => async (dispatch, getState) => {\r\n    const viewId = getState().globals.viewId;\r\n    if (viewId === link.from){\r\n        dispatch(addViewLink(link));\r\n        if (link._to.type === \"Note\"){\r\n            const note = await api.getObject(link.to)\r\n            dispatch(addViewNote(note))\r\n        }\r\n    }\r\n}\r\n\r\nexport const createView = async (title, authorId, communityId, options, registerToCommunity) => {\r\n    const newobj = {\r\n        communityId: communityId,\r\n        type: 'View',\r\n        title: title,\r\n        authors: [authorId],\r\n        status: 'active',\r\n        permission: 'public',\r\n        ...options\r\n    };\r\n\r\n    const newView = (await api.postView(newobj, communityId)).data\r\n\r\n    if (registerToCommunity){\r\n        const community = (await api.getCommunity(communityId)).data\r\n        community.views.push(newView)\r\n        api.putCommunity(community, communityId)\r\n    }\r\n    return newView\r\n}\r\n\r\nexport const makeRiseabove = async (note, viewId, communityId) => {\r\n    if (!note.data){ note.data = {}}\r\n    note.status = 'active'\r\n    note.data.riseabove = {viewId}\r\n\r\n    const noteModified = await api.putObject(note, communityId, note._id)\r\n    return noteModified\r\n}\r\n\r\nexport const newRiseAbove = (riseAboveTitle) => async (dispatch, getState) => {\r\n\r\n    const {author, communityId, view} = getState().globals\r\n    const mode = {\r\n        permission: view.permission,\r\n        group: view.group,\r\n        '_groupMembers':  view._groupMembers\r\n    };\r\n\r\n    const newView = await createView(riseAboveTitle, author._id, communityId, mode, false)\r\n\r\n    const newNote = createNote(communityId, author._id, mode)\r\n    //Create Note\r\n    let note = (await api.postContribution(communityId, newNote)).data\r\n    note.title = riseAboveTitle;\r\n\r\n    note = await makeRiseabove(note, newView._id, communityId)\r\n\r\n    api.postLink(view._id, note._id, 'contains', {x: 200, y: 200}) //TODO get element position\r\n\r\n    //$community.saveContainsLinktoITM(view._id, note._id);}\r\n}\r\n\r\nexport const loadRiseAboveData = async (viewId, communityId, dispatch) => {\r\n    const viewLinks = await api.getLinks(viewId, 'from')\r\n    const readLinks = await api.getApiLinksReadStatus(communityId, viewId)\r\n    dispatch(addToRAView({viewId, data: {viewLinks, readLinks}}))\r\n\r\n}\r\n","import { createAction, createReducer } from '@reduxjs/toolkit';\r\nimport { openDialog, closeDialog } from './dialogReducer.js'\r\nimport { preProcess, postProcess } from './kftag.service.js'\r\nimport * as api from './api.js'\r\nimport { addNotification } from './notifier.js'\r\nimport { dateFormatOptions } from './globalsReducer.js'\r\nimport {addRAView, removeRAView, addToRAView} from './noteActions.js'\r\nimport {loadRiseAboveData} from './async_actions.js'\r\nexport const addNote = createAction('ADD_NOTE')\r\nexport const removeNote = createAction('REMOVE_NOTE')\r\nexport const editNote = createAction('EDIT_NOTE')\r\nexport const addAttachment = createAction('ADD_ATTACHMENT')\r\nexport const removeAttachment = createAction('REMOVE_ATTACHMENT')\r\nexport const setAttachments = createAction('SET_ATTACHMENTS')\r\nexport const setWordCount = createAction('SET_WORDCOUNT')\r\nexport const setLinks = createAction('SET_CONNECTIONS')\r\nexport const setRecords = createAction('SET_RECORDS')\r\nexport const removeContribAuthor = createAction('REMOVE_CONTRIB_AUTHOR')\r\nexport const addContribAuthor = createAction('ADD_CONTRIB_AUTHOR')\r\nexport const setAnnotation = createAction('SET_ANNOTATION')\r\nexport const setAnnotationsLoaded = createAction('SET_ANNOTATIONS_LOADED')\r\nexport const removeAnnotation = createAction('REMOVE_ANNOTATION')\r\nexport const setViewNotes = createAction('SET_VIEW_NOTES')\r\nexport const addViewNote = createAction('ADD_VIEW_NOTE')\r\nexport const setCheckedNotes = createAction('SET_CHECKED_NOTES')\r\nexport const updateCheckedNotes = createAction('UPDATE_CHECKED_NOTES')\r\nexport const setViewLinks = createAction('SET_VIEW_LINKS')\r\nexport const addViewLink = createAction('ADD_VIEW_LINK')\r\nexport const setBuildsOn = createAction('SET_BUILDS_ON')\r\nexport const setSupports = createAction('SET_SUPPORTS')\r\nexport const setRiseAboveViewNotes = createAction('SET_RISEABOVE_VIEW_NOTES')\r\nexport const setRiseAboveNotes = createAction('SET_RISEABOVE_NOTES')\r\nexport const setReadLinks = createAction('SET_READ_LINKS')\r\nexport const removeViewLink = createAction('REMOVE_READ_LINKS')\r\nexport const removeViewNote = createAction('REMOVE_VIEW_NOTE')\r\nconst initState = {attachments: {}, viewNotes: {}, checkedNotes: [], viewLinks: [], buildsOn: [], supports: [], riseAboveNotes: {}, riseAboveViewNotes: {}, readLinks: [], raViews: {}}\r\n\r\nexport const noteReducer = createReducer(initState, {\r\n    [addNote]: (notes, action) => {\r\n        notes[action.payload._id] = action.payload\r\n    },\r\n    [removeNote]: (notes, action) => {\r\n        const note = notes[action.payload]\r\n        delete notes[action.payload]\r\n        if (note?.data?.riseabove)//if ra delete fetched view data\r\n            delete notes.raViews[note.data.riseabove.viewId]\r\n    },\r\n    [editNote]: (notes, action) => {\r\n        let note = notes[action.payload._id];\r\n        notes[action.payload._id] = Object.assign({}, note, action.payload)\r\n    },\r\n    [addAttachment]: (state, action) => {\r\n        let note = state[action.payload.noteId]\r\n        note.attachments.push(action.payload.attachment._id)\r\n        state.attachments[action.payload.attachment._id] = action.payload.attachment\r\n    },\r\n    [removeAttachment]: (state, action) => {\r\n        let note = state[action.payload.noteId]\r\n        note.attachments = note.attachments.filter((att) => att !== action.payload.attId)\r\n        delete state.attachments[action.payload.attId]\r\n    },\r\n    [setAttachments]: (state, action) => {\r\n        let note = state[action.payload.contribId]\r\n        note.attachments = action.payload.attachments.map((att) => att._id)\r\n        action.payload.attachments.forEach((att) => {\r\n            state.attachments[att._id] = att\r\n        })\r\n    },\r\n    [setWordCount]: (state, action) => {\r\n        let note = state[action.payload.contribId]\r\n        note.wordCount = action.payload.wc\r\n    },\r\n    [setLinks]: (state, action) => {\r\n        let contrib = state[action.payload.contribId]\r\n        if (action.payload.direction === 'from') {\r\n            contrib.fromLinks = action.payload.links\r\n        } else {\r\n            contrib.toLinks = action.payload.links\r\n        }\r\n    },\r\n    [setRecords]: (state, action) => {\r\n        let note = state[action.payload.contribId]\r\n        note.records = action.payload.records\r\n    },\r\n    [addContribAuthor]: (state, action) => {\r\n        let contrib = state[action.payload.contribId]\r\n        contrib.authors = [...contrib.authors, action.payload.author]\r\n    },\r\n    [removeContribAuthor]: (state, action) => {\r\n        let contrib = state[action.payload.contribId]\r\n        contrib.authors = contrib.authors.filter((auth) => auth !== action.payload.author)\r\n    },\r\n    [setAnnotation]: (state, action) => {\r\n        let contrib = state[action.payload.contribId]\r\n        contrib.annos[action.payload.annotation._id] = action.payload.annotation\r\n    },\r\n    [setAnnotationsLoaded]: (state, action) => {\r\n        let contrib = state[action.payload.contribId]\r\n        contrib['annotsFetched'] = action.payload.value\r\n    },\r\n    [removeAnnotation]: (state, action) => {\r\n        let contrib = state[action.payload.contribId]\r\n        delete contrib.annos[action.payload.annoId]\r\n    },\r\n    [setViewNotes]: (state, action) => {\r\n        const viewNotes = {}\r\n        for (let i in action.payload)\r\n            viewNotes[action.payload[i]._id] = action.payload[i]\r\n        state.viewNotes = viewNotes\r\n    },\r\n    [setCheckedNotes]: (state, action) => {\r\n        state.checkedNotes = action.payload\r\n    },\r\n    [updateCheckedNotes]: (state, action) => {\r\n        if (action.payload.checked) {\r\n            state.checkedNotes.push(action.payload.noteId)\r\n        } else {\r\n            state.checkedNotes = state.checkedNotes.filter(id => id !== action.payload.noteId)\r\n        }\r\n    },\r\n    [addViewNote]: (state, action) => {\r\n        state.viewNotes[action.payload._id] = action.payload\r\n    },\r\n    [removeViewNote]: (state, action) => {\r\n        delete state.viewNotes[action.payload._id]\r\n    },\r\n    [setViewLinks]: (state, action) => {\r\n        state.viewLinks = action.payload\r\n    },\r\n    [addViewLink]: (state, action) => {\r\n        const matchLink = state.viewLinks.filter((link) => link._id === action.payload._id)\r\n        if (matchLink.length === 0){\r\n            state.viewLinks.push(action.payload)\r\n        } else {//update view link\r\n            state.viewLinks = state.viewLinks.map((link) => link._id === action.payload._id ? action.payload : link);\r\n        }\r\n    },\r\n    [removeViewLink]: (state, action) => {\r\n        state.viewLinks = state.viewLinks.filter((link) => link._id !== action.payload._id)\r\n    },\r\n    [setBuildsOn]: (state, action) => {\r\n        state.buildsOn = action.payload\r\n    },\r\n    [setSupports]: (state, action) => {\r\n        state.supports = action.payload\r\n    },\r\n    [setRiseAboveViewNotes]: (state, action) => {\r\n        state.riseAboveViewNotes[action.payload.noteId] = [...action.payload.notes]\r\n        // state.riseAboveViewNotes = [...state.riseAboveViewNotes, action.payload]\r\n    },\r\n    [setRiseAboveNotes]: (state, action) => {\r\n        // let viewId = action.payload.viewId\r\n        // state.riseAboveNotes[viewId] = [...action.payload.notes]\r\n        action.payload.forEach(note => state.riseAboveNotes[note._id] = note)\r\n    },\r\n    [setReadLinks]: (state, action) =>{\r\n        state.readLinks = action.payload\r\n    },\r\n    [addRAView]: (state, action) => {\r\n        if (!state.raViews[action.payload])\r\n            state.raViews[action.payload] = {}\r\n    },\r\n    [removeRAView]: (state, action) => {\r\n        delete state.raViews[action.payload]\r\n    },\r\n    [addToRAView]: (state, action) => {\r\n        state.raViews[action.payload.viewId] = {...state.raViews[action.payload], ...action.payload.data}\r\n    }\r\n});\r\n\r\nexport const createNote = (communityId, authorId, contextMode, fromId, content) => {\r\n    if (!content) { content = '' }\r\n    if (contextMode && !contextMode.permission) {\r\n        window.alert('invalid mode object')\r\n        return\r\n    }\r\n    let mode = {}\r\n    if (contextMode && contextMode.permission === 'private') {\r\n        mode.permission = contextMode.permission;\r\n        mode.group = contextMode.group;\r\n        mode._groupMembers = contextMode._groupMembers;\r\n    } else {\r\n        mode.permission = 'protected';\r\n        mode.group = undefined;\r\n        mode._groupMembers = [];\r\n    }\r\n    let title = contextMode && contextMode.title ? contextMode.title : '';\r\n    let status = contextMode && contextMode.status ? contextMode.status : 'unsaved';\r\n\r\n    const newobj = {\r\n        communityId: communityId,\r\n        type: 'Note',\r\n        title: title,\r\n        /* 6.6 the default title was changed to blank by Christian */\r\n        authors: [authorId],\r\n        status: status,\r\n        permission: mode.permission,\r\n        group: mode.group,\r\n        _groupMembers: mode._groupMembers,\r\n        data: {\r\n            body: contextMode && contextMode.body ? contextMode.body : ''\r\n        },\r\n        buildson: fromId,\r\n        langInNote: []\r\n\r\n    }\r\n\r\n    //save google document id, createdBy and coauthors, current doc permission granted\r\n    if (contextMode && contextMode.docId) {\r\n        newobj.docId = contextMode.docId;\r\n        var myself = newobj.authors[0];\r\n        if (contextMode.coauthors) {\r\n            var ca = contextMode.coauthors.split(',');\r\n            for (var i = 0; i < ca.length; i++) {\r\n                if (ca[i] !== myself) {\r\n                    newobj.authors.push(ca[i]);\r\n                }\r\n            }\r\n        }\r\n        if (contextMode.createdBy) {\r\n            newobj.createdBy = contextMode.createdBy;\r\n        }\r\n        newobj.docShared = [myself];\r\n        newobj.text4search = contextMode.text4search;\r\n    }\r\n\r\n    return newobj\r\n}\r\n\r\nexport const newNote = (view, communityId, authorId, buildson) => dispatch => {\r\n    const mode = { permission: view.permission, group: view.group, _groupMembers: view._groupMembers }\r\n\r\n    const newN = createNote(communityId, authorId, mode, buildson)\r\n\r\n    return api.postContribution(communityId, newN).then((res) => {\r\n        const note = {\r\n            attachments: [],\r\n            fromLinks: [],\r\n            toLinks: [],\r\n            records: [],\r\n            annos: {},\r\n            group: null,\r\n            ...res.data\r\n        }\r\n        const pos = { x: 100, y: 100 }\r\n\r\n        if (!buildson) {\r\n            api.postLink(view._id, note._id, 'contains', pos)\r\n        }\r\n        //TODO saveContainsLinktoITM x2\r\n\r\n        dispatch(addNote(note))\r\n\r\n        dispatch(openDialog({\r\n            title: 'New Note',\r\n            confirmButton: 'create',\r\n            contribId: note._id,\r\n            type: 'Note',\r\n            editable: true, // new note should open in write tab\r\n        }))\r\n    })\r\n\r\n}\r\n\r\nexport const newDrawing = (viewId, communityId, authorId) => async dispatch => {\r\n\r\n    const newobj = {\r\n        communityId: communityId,\r\n        type: 'Drawing',\r\n        title: 'a Drawing',\r\n        authors: [authorId],\r\n        status: 'unsaved',\r\n        permission: 'protected',\r\n        data: {\r\n            svg: '<svg width=\"200\" height=\"200\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns=\"http://www.w3.org/2000/svg\"><g><title>Layer 1<\\/title><\\/g><\\/svg>',\r\n        }\r\n    }\r\n\r\n    const drawing = (await api.postContribution(communityId, newobj)).data\r\n\r\n    api.postLink(viewId, drawing._id, 'contains', {x: 100, y:100, showInPlace: true})\r\n    //TODO save contains link to ITM\r\n    const contrib = {records: [], ...drawing}\r\n\r\n    dispatch(addNote(contrib))\r\n\r\n    dispatch(openDialog({\r\n        title: 'New Drawing',\r\n        confirmButton: 'create',\r\n        contribId: contrib._id,\r\n        type: 'Drawing',\r\n        editable: true, // new note should open in write tab\r\n    }))\r\n}\r\n\r\nexport const buildOnNote = (noteId) => (dispatch, getState )=> {\r\n    const state = getState()\r\n    dispatch(newNote(state.globals.view, state.globals.communityId, state.globals.author._id, noteId))\r\n}\r\n\r\n\r\nexport const attachmentUploaded = (noteId, attachment, inline, x, y) => dispatch => {\r\n    return api.postLink(noteId, attachment._id, 'attach').then((res) => {\r\n        dispatch(addAttachment({ noteId, attachment }))\r\n    });\r\n}\r\n\r\nexport const fetchAttachments = (contribId) => async dispatch => {\r\n    const link_atts = await api.getLinks(contribId, 'from', 'attach')\r\n    const attachments = await Promise.all(link_atts.map((attach) => api.getObject(attach.to)))\r\n    dispatch(setAttachments({ contribId, attachments }))\r\n}\r\n\r\nexport const postContribution = (contrib, dialogId) => async (dispatch, getState) => {\r\n    contrib = Object.assign({}, contrib)\r\n    contrib.data = Object.assign({}, contrib.data)\r\n    if (!contrib.title) {\r\n        addNotification({ title: 'Error Saving Note!', type: 'danger', message: 'Title is required' })\r\n        return\r\n    }\r\n    //TODO sync checking?\r\n    //TODO status.contribution = 'saving'\r\n    if (contrib.type === 'Note') {\r\n        // TODO if isGoogleDoc\r\n        // const isNewNote = contrib.status === 'unsaved'\r\n        const wasActive = contrib.status === 'active'\r\n        contrib.status = 'active'\r\n        const jq = await postProcess(contrib.data.body, contrib._id, contrib.toLinks, contrib.fromLinks)\r\n\r\n        const text = jq.html()\r\n        const prev_text = contrib.data.body\r\n        contrib.data.body = text\r\n        const newNote = await api.putObject(contrib, contrib.communityId, contrib._id)\r\n        newNote.data.body = prev_text\r\n        dispatch(addViewNote(newNote))\r\n\r\n        if (dialogId !== undefined)\r\n            dispatch(closeDialog(dialogId))\r\n        if (!wasActive) //To update builds on hierarchy\r\n            dispatch(fetchBuildsOn(newNote.communityId))\r\n\r\n        dispatch(removeNote(contrib._id))//Remove from redux when dialog is closed\r\n    } else {\r\n        contrib.status = 'active'\r\n         await api.putObject(contrib, contrib.communityId, contrib._id)\r\n        if (dialogId !== undefined){\r\n            dispatch(closeDialog(dialogId))\r\n            dispatch(removeNote(contrib._id))\r\n        }\r\n    }\r\n\r\n    addNotification({ title: 'Saved!', type: 'success', message: 'Contribution updated!' })\r\n}\r\n\r\nexport const fetchLinks = (contribId, direction) => async (dispatch) => {\r\n    const links = await api.getLinks(contribId, direction)\r\n    dispatch(setLinks({ contribId, direction, links }))\r\n\r\n    if (direction === \"to\"){\r\n        const viewLink = links.filter((link) => link.type === \"contains\")[0];\r\n        dispatch(addViewLink(viewLink));\r\n    }\r\n}\r\n\r\nexport const fetchRecords = (contribId) => async (dispatch, getState) => {\r\n    const authors = getState().users\r\n    const records = await api.getRecords(contribId)\r\n    const formatter = new Intl.DateTimeFormat('default', dateFormatOptions)\r\n    records.forEach((record) => {\r\n        if (authors[record.authorId]) {\r\n            const author = authors[record.authorId]\r\n            record['author'] = `${author.firstName} ${author.lastName}`\r\n        } else {\r\n            record['author'] = 'NA'\r\n        }\r\n        record['date'] = formatter.format(new Date(record.timestamp))\r\n    })\r\n    dispatch(setRecords({ contribId, records }))\r\n}\r\n\r\nexport const openContribution = (contribId) => async (dispatch, getState) => {\r\n\r\n    const contrib = await api.getObject(contribId)\r\n    const author = getState().globals.author;\r\n    if (contrib.type === 'Note'){\r\n        const [fromLinks, toLinks] = await Promise.all([\r\n            api.getLinks(contribId, 'from'),\r\n            api.getLinks(contribId, 'to')])\r\n        const note = { attachments: [], fromLinks, toLinks, records: [], annos: {}, ...contrib }\r\n        const noteBody = preProcess(note.data.body, toLinks, fromLinks)\r\n        note.data.body = noteBody\r\n        dispatch(addNote(note))\r\n\r\n        if (note.data.riseabove){\r\n            dispatch(addRAView(note.data.riseabove.viewId))\r\n            loadRiseAboveData(note.data.riseabove.viewId, note.communityId, dispatch)\r\n        }\r\n        dispatch(fetchAttachments(contribId))\r\n        dispatch(openDialog({\r\n            title: 'Edit Note',\r\n            confirmButton: 'edit',\r\n            contribId: note._id,\r\n            type: 'Note',\r\n            editable: author && (note.authors.includes(author._id) || author.role === \"manager\"), // read or write tab\r\n            buildOn: true\r\n        }))\r\n        //annotations\r\n        const annoLinks = toLinks.filter((link) => link.type === 'annotates')\r\n\r\n        const annotations = await Promise.all(\r\n            annoLinks.map((annLink) =>\r\n                api.getObject(annLink.from).then(anno => {\r\n                    anno.data.linkId = annLink._id\r\n                    anno.data.modelId = anno._id\r\n                    return anno\r\n                })\r\n            )\r\n        )\r\n\r\n        annotations.forEach((annot) => dispatch(setAnnotation({ annotation: annot, contribId })))\r\n        dispatch(setAnnotationsLoaded({ contribId, value: 1 }))\r\n    }else {\r\n        const attachment = { records: [],  ...contrib }\r\n        dispatch(addNote(attachment))\r\n\r\n        dispatch(openDialog({\r\n            title: `Edit ${contrib.type}`,\r\n            confirmButton: 'edit',\r\n            contribId: contrib._id,\r\n            type: contrib.type,\r\n            editable: author && (contrib.authors.includes(author._id) || author.role === \"manager\"), // read or write tab\r\n            buildOn: true\r\n        }))\r\n    }\r\n    console.log(contrib)\r\n\r\n    if (contrib.status === 'active') {\r\n        api.read(contrib.communityId, contrib._id)\r\n    }\r\n    return;\r\n}\r\n\r\nexport const createAnnotation = (communityId, contribId, authorId, annotation) => async (dispatch) => {\r\n    const newobj = {\r\n        communityId: communityId,\r\n        type: 'Annotation',\r\n        title: 'an Annotation',\r\n        authors: [authorId],\r\n        status: 'active',\r\n        permission: 'private',\r\n        data: annotation\r\n    };\r\n    const ann = await api.postContribObject(communityId, newobj)\r\n\r\n    const link = await api.postLink(ann._id, contribId, 'annotates')\r\n\r\n    annotation.linkId = link._id;\r\n    annotation.modelId = ann._id;\r\n    dispatch(setAnnotation({ contribId, annotation: ann }))\r\n    // TODO save in store link\r\n    // $scope.annoLinks[link._id] = link;\r\n}\r\n\r\nexport const deleteAnnotation = (linkId, contribId, annoId) => async (dispatch) => {\r\n    await api.deleteLink(linkId)\r\n    return dispatch(removeAnnotation({ contribId, annoId }))\r\n}\r\n\r\nexport const modifyAnnotation = (annotation, communityId, contribId) => async (dispatch) => {\r\n    const anno_updated = await api.putObject(annotation, communityId, annotation._id)\r\n    return dispatch(setAnnotation({ contribId, annotation: anno_updated }))\r\n}\r\n\r\nexport const fetchViewNotes = (viewId) => async (dispatch) => {\r\n    const links = (await api.getLinks(viewId, 'from'))\r\n    const noteLinks = links\r\n        .filter(obj => (obj._to.type === \"Note\" && obj._to.title !== \"\" && obj._to.status === \"active\"))\r\n\r\n    dispatch(setViewLinks(links))\r\n    const notes = await Promise.all(noteLinks.map((filteredObj) => api.getObject(filteredObj.to)))\r\n\r\n    dispatch(setViewNotes(notes))\r\n\r\n    //RISEABOVE\r\n    notes.forEach(async note => {\r\n        if (note.data && note.data.riseabove) {\r\n            //SET NOTES INTO RISEABOVE LIST\r\n            let viewId = note.data.riseabove.viewId\r\n            const riseAboveNoteIds = (await api.getLinks(viewId, 'from'))\r\n                  .filter(obj => (obj._to.type === \"Note\" && obj._to.title !== \"\" && obj._to.status === \"active\")).map(lnk => lnk.to)\r\n            const riseAboveNotes = await Promise.all(riseAboveNoteIds.map((noteId) => api.getObject(noteId)))\r\n            // let data = {\r\n            //     viewId: viewId,\r\n            //     notes: riseAboveNotes,\r\n            // }\r\n\r\n            dispatch(setRiseAboveNotes(riseAboveNotes))\r\n            dispatch(setRiseAboveViewNotes({noteId: note._id, notes: riseAboveNoteIds}))\r\n            // riseAboveNotes.forEach(note => dispatch(setRiseAboveViewNotes(note)))\r\n        }\r\n    })\r\n}\r\n\r\nexport const fetchBuildsOn = (communityId) => async (dispatch) => {\r\n    let buildOnResult = await api.linksSearch(communityId, { \"type\": \"buildson\" })\r\n    buildOnResult = buildOnResult.reverse();\r\n    const filteredBuildOn = buildOnResult.filter(\r\n        (obj) =>\r\n            (obj._to.type === \"Note\" && obj._to.status === \"active\" && obj._from.type === \"Note\" && obj._from.status === \"active\")\r\n    )\r\n    dispatch(setBuildsOn(filteredBuildOn))\r\n}\r\n\r\nexport const fetchSupports = (communityId) => async (dispatch) => {\r\n    let supports = await api.linksSearch(communityId, { \"type\": \"supports\" })\r\n    dispatch(setSupports(supports))\r\n}\r\n\r\nexport const deleteAttachment = (contribId, attId) => async (dispatch, getState) => {\r\n    const state = getState()\r\n    let contrib = state.notes[contribId]\r\n    const att_link = contrib.fromLinks.filter((lnk) => lnk.to === attId)[0]\r\n    await api.deleteLink(att_link._id)\r\n    dispatch(removeAttachment({ attId, noteId: contribId }))\r\n    dispatch(fetchLinks(contribId, 'from'))\r\n}\r\n\r\nexport const fetchReadLinks = (communityId, viewId) => async (dispatch) =>{\r\n    const readLinks = await api.getApiLinksReadStatus(communityId, viewId)\r\n    dispatch(setReadLinks(readLinks))\r\n}\r\n","import { createAction, createReducer } from '@reduxjs/toolkit'\r\nimport { getObject, getCommunity, getGroups, getUser, getAuthor, getCommunityViews, getCommunities, getUserCommunities } from './api.js'\r\nimport { fetchAuthors } from './userReducer.js';\r\nimport { fetchScaffolds } from './scaffoldReducer.js'\r\nimport { fetchViewNotes, fetchBuildsOn, setCheckedNotes, fetchSupports, fetchReadLinks } from './noteReducer.js'\r\nexport const setGlobalToken = createAction('SET_TOKEN')\r\nexport const setCurrentLoginForm = createAction('SET_CURRENT_LOGIN_FORM')\r\nexport const setCommunity = createAction('SET_COMMUNITY')\r\nexport const setCommunityId = createAction('SET_COMMUNITY_ID')\r\nexport const setCurrentServer = createAction('SET_CURRENT_SERVER')\r\nexport const setViewId = createAction('SET_VIEW_ID')\r\nexport const setLoggedUser = createAction('SET_AUTHOR')\r\nexport const setView = createAction('SET_VIEW')\r\nexport const setAuthor = createAction('SET_AUTHOR')\r\nexport const setViews = createAction('SET_VIEWS')\r\nexport const editCommunity = createAction('EDIT_COMMUNITY')\r\nexport const setUserId = createAction('SET_USERID')\r\nexport const setIsAuthenticated = createAction('SET_ISAUTHENTICATED')\r\nexport const setCommunities = createAction('SET_COMMUNITIES')\r\nexport const setUserCommunities = createAction('SET_USER_COMMUNITIES')\r\nexport const setSearchQuery = createAction('SET_SEARCH_QUERY')\r\nexport const setSearchFilter = createAction('SET_SEARCH_FILTER')\r\nexport const setSocketStatus = createAction('SET_SOCKET_STATUS')\r\nexport const dateFormatOptions = {\r\n    year: 'numeric', month: 'numeric', day: 'numeric',\r\n    hour: 'numeric', minute: 'numeric', second: 'numeric',\r\n    hour12: true\r\n};\r\n\r\nconst initState = {\r\n    token: sessionStorage.getItem(\"token\"),\r\n    currentLoginForm: \"Login\",\r\n    communityId: null,\r\n    currentServer: null,\r\n    viewId: null,\r\n    contextId: '',\r\n    user: null,\r\n    view: null,\r\n    views: [],\r\n    community: null,\r\n    userId: '',\r\n    isAuthenticated: sessionStorage.getItem(\"token\") ? true : false,\r\n    communities: [],\r\n    userCommunities: [],\r\n    searchQuery: '',\r\n    searchFilter: 'title',\r\n    servers: [\r\n        {\r\n            id: 0,\r\n            key: \"kf6.ikit.org\",\r\n            value: \"https://kf6.ikit.org\"\r\n\r\n        },\r\n        {\r\n            id: 1,\r\n            key: \"kf6-stage.ikit.org\",\r\n            value: \"https://kf6-stage.ikit.org\"\r\n\r\n        },\r\n        {\r\n            id: 2,\r\n            key: \"kf6-stage.rit.albany.edu\",\r\n            value: \"https://kf6-stage.rit.albany.edu\"\r\n\r\n        },\r\n        {\r\n            id: 3,\r\n            key: \"kf.rdc.nie.edu.sg\",\r\n            value: \"https://kf.rdc.nie.edu.sg\"\r\n\r\n        },\r\n        {\r\n            id: 4,\r\n            key: \"kf.rit.albany.edu\",\r\n            value: \"https://kf6.rit.albany.edu\"\r\n\r\n        },\r\n        // {\r\n        //     id: 5,\r\n        //     key: \"localhost 9000\",\r\n        //     value: \"http://localhost:9000\"\r\n\r\n        // },\r\n    ],\r\n    socketStatus: false\r\n}\r\n\r\nexport const globalsReducer = createReducer(initState, {\r\n    [setGlobalToken]: (state, action) => {\r\n        state.token = action.payload\r\n        state.isAuthenticated = state.token ? true : false\r\n    },\r\n    [setIsAuthenticated]: (state, action) => {\r\n        state.isAuthenticated = state.token ? true : false\r\n    },\r\n    [setCurrentLoginForm]: (state, action) => {\r\n        state.currentLoginForm = action.payload\r\n    },\r\n    [setCommunityId]: (state, action) => {\r\n        state.communityId = action.payload\r\n    },\r\n    [setCurrentServer]: (state, action) => {\r\n        state.currentServer = action.payload\r\n    },\r\n    [setViewId]: (state, action) => {\r\n        state.viewId = action.payload\r\n    },\r\n    [setUserId]: (state, action) => {\r\n        state.userId = action.payload\r\n    },\r\n    [setLoggedUser]: (state, action) => {\r\n        state.user = action.payload\r\n    },\r\n    [setView]: (state, action) => {\r\n        state.view = action.payload\r\n    },\r\n    [setViews]: (state, action) => {\r\n        state.views = action.payload\r\n    },\r\n    [setCommunity]: (state, action) => {\r\n        state.community = action.payload\r\n        state.communityId = action.payload._id\r\n        state.contextId = action.payload.rootContextId\r\n    },\r\n    [editCommunity]: (state, action) => {\r\n        state.community = { ...state.community, ...action.payload }\r\n    },\r\n    [setCommunities]: (state, action) => {\r\n        state.communities = action.payload\r\n    },\r\n    [setUserCommunities]: (state, action) => {\r\n        state.userCommunities = action.payload\r\n    },\r\n    [setSearchQuery]: (state, action) => {\r\n        state.searchQuery = action.payload\r\n    },\r\n    [setSearchFilter]: (state, action) => {\r\n        state.searchFilter = action.payload\r\n    },\r\n    [setAuthor]: (state, action) => {\r\n        state.author = action.payload\r\n    },\r\n    [setSocketStatus]: (state, action) => {\r\n        state.socketStatus = action.payload\r\n    }\r\n});\r\n\r\nexport const fetchAuthor = (communityId) => {\r\n    return dispatch => {\r\n        return getAuthor(communityId).then(res => {\r\n            dispatch(setAuthor(res.data));\r\n        })\r\n    }\r\n}\r\nexport const fetchCommunities = () => {\r\n    return async dispatch => {\r\n        const communities = await getCommunities()\r\n        dispatch(setCommunities(communities))\r\n    }\r\n}\r\n\r\nexport const fetchUserCommunities = () => {\r\n    return async dispatch => {\r\n        const communities = await getUserCommunities()\r\n        dispatch(setUserCommunities(communities))\r\n    }\r\n}\r\n\r\nexport const fetchView = (viewId) => {\r\n    return dispatch => {\r\n        return getObject(viewId).then(res => {\r\n            dispatch(setView(res))\r\n        })\r\n    }\r\n}\r\n\r\nexport const fetchCommunity = (communityId) => {\r\n    return dispatch => {\r\n        return getCommunity(communityId).then(res => {\r\n            dispatch(setCommunity(\r\n                { groups: [], ...res.data }\r\n            ))\r\n        })\r\n    }\r\n}\r\n\r\nexport const fetchCommGroups = (communityId) => async (dispatch) => {\r\n    const groups = await getGroups(communityId)\r\n    dispatch(editCommunity({ groups }))\r\n}\r\n\r\nexport const fetchLoggedUser = () => async (dispatch) => {\r\n    try {\r\n        const user = await getUser()\r\n        dispatch(setUserId(user._id))\r\n        dispatch(setLoggedUser(user))\r\n    }catch (e){//Error with token, logout\r\n        sessionStorage.clear();\r\n        localStorage.clear();\r\n        window.location.replace('/')\r\n    }\r\n}\r\n\r\nexport const fetchCommunityViews = (communityId) => async (dispatch) => {\r\n    const views = await getCommunityViews(communityId)\r\n    dispatch(setViews(views))\r\n}\r\n\r\nexport const fetchViewCommunityData = (viewId) => async (dispatch) => {\r\n    dispatch(setCheckedNotes([]))\r\n    dispatch(setViewId(viewId))\r\n    const view = await getObject(viewId)\r\n    const commId = view.communityId\r\n    dispatch(setView(view))\r\n    dispatch(fetchViewNotes(view._id))\r\n    const community = (await getCommunity(commId)).data\r\n    dispatch(setCommunity(\r\n        { groups: [], ...community }\r\n    ))\r\n    dispatch(fetchBuildsOn(commId))\r\n    dispatch(fetchAuthor(commId))\r\n    dispatch(fetchCommunityViews(commId))\r\n    dispatch(fetchAuthors(commId))\r\n    dispatch(fetchReadLinks(commId, view._id))\r\n    dispatch(fetchScaffolds(commId, community.rootContextId))\r\n    dispatch(fetchSupports(commId))\r\n}\r\n\r\n// A COMPACT VERSION OF fetchViewCommunityData - only retrieves what will be different between views within a community\r\nexport const fetchNewViewDifference = (viewId) => async (dispatch) => {\r\n  dispatch(setCheckedNotes([]))\r\n  const view = await getObject(viewId)\r\n  const commId = view.communityId\r\n  dispatch(setView(view))\r\n  dispatch(fetchViewNotes(view._id))\r\n  dispatch(fetchReadLinks(commId, view._id))\r\n}\r\n","// returns a promise that on fullfillment returns the users token\r\nexport function getUserToken(username, password, server){\r\n  var body = {\r\n    'userName': username,\r\n    'password': password\r\n  };\r\n\r\n  return fetch(server + 'auth/local', {\r\n    method: \"POST\",\r\n    headers: {'Content-Type': 'application/json'},\r\n    body: JSON.stringify(body),\r\n  }).then(function(response) {\r\n      if(response.status !== 200){\r\n        console.log(\"Error: \" + server + 'auth/local');\r\n        console.log(response);\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return body;\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n\r\n}\r\n\r\n\r\n// returns a promise that on fulfillment returns an [user token, server] object pair\r\nexport function getUserTokenServerPair(username, password, server){\r\n  var body = {\r\n    'userName': username,\r\n    'password': password\r\n  };\r\n\r\n  return fetch(server + 'auth/local', {\r\n    method: \"POST\",\r\n    headers: {'Content-Type': 'application/json'},\r\n    body: JSON.stringify(body),\r\n  }).then(function(response) {\r\n      if(response.status !== 200){\r\n        console.log(\"Error: \" + server + 'auth/local');\r\n        console.log(response);\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return [body, server];\r\n  }).catch(function(error) {\r\n      console.log(\"Error: \" + server + 'auth/local');\r\n      console.log(error);\r\n      return [{error: \"Error: server unavailable\"}, server];\r\n  });\r\n}\r\n\r\n\r\n// returns a promise that on fullfillment returns the user information corresponding to the given token and server\r\nexport function getUserInfo(token, server){\r\n\r\n  return fetch(server + 'api/users/me', {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n      if(response.status !== 200 && response.status !== 304){\r\n        console.log(\"Error: \" + server + \"api/users/me\");\r\n        console.log(response);\r\n        return {error: true};\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return (body);\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n\r\n}\r\n\r\n\r\n// returns a promse that on fulfillment returns the communities a user is registered to in a given server from their token\r\nexport function getUserCommunities(token, server){\r\n  return fetch(server + 'api/users/myRegistrations', {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n    if(response.status !== 200){\r\n      console.log(\"Error: \" + server + 'api/users/myRegistrations');\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n      return (body);\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n}\r\n\r\nexport function postNewUser(server, firstname, lastname, email, username, password, registrationKey){\r\n  var body;\r\n  if(registrationKey === null){\r\n    body = {\r\n      'email': email,\r\n      'firstName': firstname,\r\n      'lastName': lastname,\r\n      'password': password,\r\n      'userName': username\r\n    }\r\n  } else {\r\n    body = {\r\n      'email': email,\r\n      'firstName': firstname,\r\n      'lastName': lastname,\r\n      'password': password,\r\n      'registrationKey': registrationKey,\r\n      'userName': username\r\n    };\r\n  }\r\n\r\n\r\n  return fetch(server + 'api/users', {\r\n    method: \"POST\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify(body),\r\n  }).then(function(response) {\r\n    if(response.status !== 200){\r\n      console.log(\"Error: \" + server + 'api/users');\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n    return [body, server];\r\n  }).catch(function(error) {\r\n    return [{error: \"Error: server unavailable\"}, server];\r\n  });\r\n}\r\n","/*\r\n* EDIT AVAILABLE SERVERS HERE\r\n* {name:\"SERVER NAME\", url:\"SERVER URL\"}\r\n*/\r\nexport const SERVERS = [\r\n  {name:\"IKIT Stage\", url:\"https://kf6-stage.ikit.org/\"},\r\n  {name:\"Albany Stage\", url:\"https://kf6-stage.rit.albany.edu/\"},\r\n  {name:\"IKIT\", url:\"https://kf6.ikit.org/\"},\r\n  {name:\"Albany\", url:\"https://kf6.rit.albany.edu/\"},\r\n  {name:\"Singapore\", url:\"https://kf.rdc.nie.edu.sg/\"},\r\n  // {name:\"Local\", url:\"http://localhost:9000/\"}\r\n];\r\n\r\n// ZOOM VALUES FOR CYTOSCAPE GRAPH\r\nexport const MINZOOM = 0.75;\r\nexport const MAXZOOM = 2;\r\n\r\n// GOOGLE RECAPTCHA SITE KEY FOR SIGN UP PAGE\r\nexport const siteKey = \"6LdTo2oaAAAAALKB-WW7km7SabLVsBXSg4NAaX_K\";\r\n\r\n// Helper function to retrieve a servers name from its URL\r\nexport function getServerName(url){\r\n  for(var i in SERVERS){\r\n    if(SERVERS[i].url === url){ return SERVERS[i].name; }\r\n  }\r\n\r\n  return \"Error: server \" + url + \" does not exist\";\r\n}\r\n\r\n\r\n// Helper function to retrieve a servers URL from its name\r\nexport function getServerURL(name){\r\n  for(var i in SERVERS){\r\n    if(SERVERS[i].name === name){ return SERVERS[i].url; }\r\n  }\r\n\r\n  return \"Error: server \" + name + \" does not exist\";\r\n}\r\n\r\n\r\n// Helper function to retrieve the current users token for a specified server\r\nexport function extractTokenFromStorage(server) {\r\n  var uname = localStorage.getItem(\"Username\");\r\n  var data = JSON.parse(localStorage.getItem(uname));\r\n\r\n  for (var i in data) {\r\n    if (data[i][0] === server) {\r\n      return data[i][1];\r\n    }\r\n  }\r\n}\r\n\r\nexport const WS_BASE = '/socket.io-client';\r\n","/*\r\n* THIS FILE PROVIDES HELPER FUNCTIONS FOR LOGIN COMPONENT\r\n*/\r\nimport {getUserTokenServerPair} from '../api/user.js';\r\nimport {SERVERS} from '../config.js';\r\n\r\n\r\n// Executes all promises to get user token for each server at once\r\nexport function executePromises(uname, pwd, login_form_component){\r\n  const promises = [];\r\n\r\n  // if the checkbox on login page is checked clear the local storage\r\n  var firstLogin = document.getElementById(\"refreshCheckbox\").checked;\r\n  if(firstLogin){ localStorage.clear(); }\r\n\r\n  var userStorage = JSON.parse(localStorage.getItem(uname));\r\n\r\n  // If it is the first time logging in we test all servers (userStorage == null)\r\n  // else we only call the servers stored in users local storage list\r\n  if(userStorage == null){\r\n    for(let i in SERVERS){\r\n      promises.push(getUserTokenServerPair(uname, pwd, SERVERS[i].url));\r\n    }\r\n  } else {\r\n    for(let i in userStorage){\r\n      promises.push(getUserTokenServerPair(uname, pwd, userStorage[i][0]));\r\n    }\r\n  }\r\n\r\n  // execute all the login promises\r\n  return Promise.all(promises).then(function(data){\r\n    return responseHandler(uname, data, login_form_component);\r\n  }).catch(function(error){\r\n    console.log(error);\r\n  });\r\n}\r\n\r\n\r\n// Handles each servers response to the users credentials\r\n// If no succesful logins then displays error message to user\r\n// Otherwise redirects to next page\r\n// each item in data is [response body, server]\r\nexport function responseHandler(uname, data, login_form_component){\r\n  var successfulLogin = false;\r\n  var errorMessage = \"\";\r\n  var serverTokenPair = [];\r\n\r\n  // retrieve users server information from local storage in order to find last active server\r\n  // value will be null if its first login\r\n  var userStorage = JSON.parse(localStorage.getItem(uname));\r\n\r\n  for(var i in data){\r\n    if(data[i][0].token !== undefined) {\r\n      var token = data[i][0].token;\r\n      var server = data[i][1];\r\n\r\n      var viewPreference = userStorage !== null && userStorage[i][3] ? userStorage[i][3] : {value: 'Classic', label: 'Classic'};\r\n\r\n      if((userStorage === null && successfulLogin === false) || (userStorage !== null && userStorage[i][2] === \"active\")){\r\n        serverTokenPair.push([server, token, \"active\", viewPreference]);\r\n      } else {\r\n        serverTokenPair.push([server, token, \"inactive\", viewPreference]);\r\n      }\r\n\r\n      successfulLogin = true;\r\n\r\n      // this else if case handles a user having the same username on multiple servers but with different passwords\r\n    } else if(data[i][0].message !== undefined && userStorage !== null){\r\n      var username = document.getElementById(\"uname\").value;\r\n      var password = document.getElementById(\"pwd\").value;\r\n      localStorage.removeItem(username);\r\n      return executePromises(username, password, login_form_component);\r\n    } else if(data[i][0].message !== undefined && errorMessage === \"\") {\r\n      errorMessage = data[i][0].message;\r\n    } else if(errorMessage === \"This userName is not registered.\" && data[i][0].message === \"This password is not correct.\") {\r\n      errorMessage = data[i][0].message;\r\n    } else if(data[i][0].error !== undefined && errorMessage === \"\") {\r\n      errorMessage = data[i][0].error;\r\n    }\r\n  }\r\n\r\n  if(!successfulLogin){\r\n    document.getElementById(\"errorMessage\").style.display = \"visible\";\r\n    login_form_component.setState({errorMessage: errorMessage});\r\n    return 0;\r\n  } else {\r\n    localStorage.setItem(\"Username\", uname);\r\n    localStorage.setItem(uname, JSON.stringify(serverTokenPair));\r\n    return 1;\r\n  }\r\n}\r\n\r\nexport function getLoginData(){\r\n    const uname = localStorage.getItem(\"Username\");\r\n    if (uname){\r\n        const servers = JSON.parse(localStorage.getItem(uname));\r\n        for(let server_data of servers){\r\n            if (server_data[2] === 'active' && server_data[1] !== \"\"){\r\n                return server_data;\r\n            }\r\n        }\r\n    }\r\n    return [null,null,null,null]\r\n}\r\n","import React, {Component} from 'react';\r\nimport {withRouter} from 'react-router';\r\nimport { connect } from 'react-redux';\r\nimport { compose } from 'redux';\r\nimport { setCurrentLoginForm, setGlobalToken } from './store/globalsReducer.js'\r\nimport $ from 'jquery';\r\nimport '../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js';\r\nimport {executePromises, getLoginData} from './helper/Login_helper.js';\r\n\r\nimport './css/Login.css';\r\n\r\nclass LoginForm extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      uname: null,\r\n      pwd: null,\r\n      errorMessage: null,\r\n    }\r\n  }\r\n\r\n  inputChangeHandler = (event) => {\r\n    let name = event.target.name;\r\n    let val = event.target.value;\r\n\r\n    this.setState({[name] : val});\r\n  }\r\n\r\n  formSubmitHandler = (event) => {\r\n    event.preventDefault();\r\n    var uname = this.state.uname;\r\n    var pwd = this.state.pwd;\r\n    document.getElementById(\"errorMessage\").style.display = \"hidden\";\r\n    executePromises(uname, pwd, this).then((result) => {\r\n      if(result === 1){\r\n        this.props.setGlobalToken(getLoginData()[1]);\r\n        this.props.history.push(\"/dashboard\");\r\n      }\r\n    });\r\n    return false;\r\n  }\r\n\r\n  openSignUpForm = (event) => {\r\n    this.props.setCurrentLoginForm(\"SignUp\");\r\n  }\r\n\r\n  componentDidMount(){\r\n    // enables the popover for refreshing servers on login tool tip\r\n    $('[data-toggle=\"tooltip\"]').tooltip()\r\n    $('[data-toggle=\"popover\"]').popover()\r\n    if($(window).width() <= 768) {\r\n      document.getElementById(\"popover\").setAttribute(\"data-trigger\", \"focus\");\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return(\r\n      <div className = \"row login-form-row\">\r\n        <div className = {\"col-lg-8 col-md-10 col-sm-12 login-form-wrapper\"}>\r\n          <h1>knowledgeforum.org</h1>\r\n          <form onSubmit={this.formSubmitHandler} className = \"loginForm\" id = \"loginForm\" autoComplete=\"on\">\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-user\"></i>\r\n              <input type=\"text\" id=\"uname\" name=\"uname\" placeholder=\"Username\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-lock\"></i>\r\n              <input type=\"password\" id=\"pwd\" name=\"pwd\" placeholder=\"Password\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-checkbox-wrapper\">\r\n              <input type=\"checkbox\" id=\"refreshCheckbox\" name=\"refreshCheckbox\"></input>\r\n              <label htmlFor=\"refreshCheckbox\">Refresh my servers on login?</label>\r\n              <span id=\"popover\" tabIndex=\"0\" role=\"button\" data-toggle=\"popover\"\r\n                data-trigger=\"hover\" data-content=\"Check this box if you have registered to any new knowledge forums servers since your last login.\">\r\n              <i className=\"far fa-question-circle\"></i></span>\r\n            </div>\r\n\r\n            <div>\r\n              <p style={{display:'hidden',color:'red'}} id = \"errorMessage\" name=\"errorMessage\">{this.state.errorMessage}</p>\r\n            </div>\r\n\r\n            <input className = \"login-button\" type=\"submit\" value=\"Login\"></input>\r\n\r\n          </form>\r\n\r\n          <p className=\"login-create-account-p\" onClick={this.openSignUpForm}>Don't have an account? Sign up <i className=\"far fa-arrow-alt-circle-right\"></i></p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nconst mapDispatchToProps = {\r\n    setGlobalToken,\r\n    setCurrentLoginForm\r\n};\r\n\r\nexport default compose(\r\n    withRouter,\r\n    connect(null, mapDispatchToProps)\r\n)(LoginForm)\r\n","import React, {Component} from 'react';\r\nimport Select from 'react-select';\r\nimport { withRouter } from 'react-router';\r\nimport { connect } from 'react-redux';\r\nimport { compose } from 'redux';\r\nimport ReCAPTCHA from 'react-google-recaptcha';\r\nimport { setCurrentLoginForm, setGlobalToken } from './store/globalsReducer.js'\r\nimport '../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js';\r\nimport {SERVERS, getServerURL, siteKey} from './config.js';\r\nimport {postNewUser} from './api/user.js';\r\n\r\nimport './css/Login.css';\r\nimport './css/SignUpForm.css';\r\n\r\nclass SignUpForm extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      server: null,\r\n      firstname: null,\r\n      lastname: null,\r\n      email: null,\r\n      username: null,\r\n      password: null,\r\n      confirmPassword: null,\r\n      registrationKey: null,\r\n      errorMessage: null,\r\n      singaporeSelected: false,\r\n      recaptchaVerified: false,\r\n    }\r\n\r\n  }\r\n\r\n  inputChangeHandler = (event) => {\r\n    let name = event.target.name;\r\n    let val = event.target.value;\r\n\r\n    this.setState({[name] : val});\r\n  }\r\n\r\n  serverSelectHandler = (event) => {\r\n    event.value === getServerURL(\"Singapore\") ? this.setState({singaporeSelected: true}) : this.setState({singaporeSelected: false});\r\n    this.setState({server: event.value});\r\n  }\r\n\r\n  formSubmitHandler = (event) => {\r\n    event.preventDefault();\r\n    if(this.state.server === null) {\r\n      this.setState({errorMessage: \"Please select a server.\"});\r\n    } else if(/^[a-zA-Z][.0-9a-zA-Z@_-]{1,100}$/.test(this.state.username) === false) {\r\n      this.setState({errorMessage: [\"Username must meet the following requirements:\", <br />, \"1. Start with a letter\", <br />,\r\n      \"2. Not contain any white spaces\", <br />, \"3. Can only contain the special characters @._-\"]});\r\n    } else if(this.state.password !== this.state.confirmPassword){\r\n      this.setState({errorMessage: \"Passwords do not match.\"});\r\n    } else {\r\n      postNewUser(this.state.server, this.state.firstname, this.state.lastname, this.state.email, this.state.username, this.state.password, this.state.registrationKey).then((result) => {\r\n        if(result[0] && result[0].token !== undefined) {\r\n          localStorage.setItem(\"Username\", this.state.username);\r\n          localStorage.setItem(this.state.username, JSON.stringify([[result[1], result[0].token, \"active\"]]));\r\n          this.props.setGlobalToken(result[0].token);\r\n          this.props.history.push('/dashboard');\r\n        } else {\r\n          var resultErrorMessage = result[0].message || result[0].error || result[0].errorCode || result[0];\r\n          this.setState({errorMessage: resultErrorMessage});\r\n        }\r\n      });\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  openLoginForm = (event) => {\r\n    this.props.setCurrentLoginForm(\"Login\");\r\n  }\r\n\r\n  verifyRecaptcha = (event) => {\r\n    event === null ? this.setState({recaptchaVerified: false}) : this.setState({recaptchaVerified: true})\r\n  }\r\n\r\n  render() {\r\n    let userAuthenticationMethod;\r\n    if(this.state.singaporeSelected){\r\n      userAuthenticationMethod = <div className = \"login-input-wrapper\"><i className=\"fas fa-lock\"></i><input type=\"text\" id=\"registrationKey\" name=\"registrationKey\" placeholder=\"Singapore Account Creation Key\" required onChange={this.inputChangeHandler}></input></div>;\r\n    } else {\r\n      userAuthenticationMethod = <ReCAPTCHA sitekey={siteKey} onChange={this.verifyRecaptcha}/>;\r\n    }\r\n\r\n    let signUpButton;\r\n    if((this.state.recaptchaVerified === true && !this.state.singaporeSelected) || (this.state.singaporeSelected && this.state.registrationKey !== null)){\r\n      signUpButton = <input className = \"login-button\" type=\"submit\" value=\"Create Account\"></input>;\r\n    } else {\r\n      signUpButton = <input className = \"login-button login-disabled\" type=\"submit\" value=\"Create Account\" disabled></input>;\r\n    }\r\n\r\n    return(\r\n      <div className = \"row login-form-row\">\r\n        <div className = {\"col-lg-8 col-md-10 col-sm-12 login-form-wrapper\"}>\r\n          <h1>knowledgeforum.org</h1>\r\n          <form onSubmit={this.formSubmitHandler} className = \"loginForm\" id = \"loginForm\" autoComplete=\"on\">\r\n\r\n            <div className=\"login-input-wrapper signup-select-server\">\r\n              <i className=\"fas fa-server\"></i>\r\n              <div className=\"select-container\">\r\n                <Select\r\n                  placeholder={\"Select a Server\"}\r\n                  options={SERVERS.map((s) => ({value: s.url, label: s.name}))}\r\n                  onChange = {this.serverSelectHandler}\r\n                  className=\"basic-multi-select\"\r\n                  classNamePrefix=\"select\"\r\n                />\r\n              </div>\r\n              <div className=\"clearFix\"></div>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-user\"></i>\r\n              <input type=\"text\" id=\"firstname\" name=\"firstname\" placeholder=\"First Name\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-user\"></i>\r\n              <input type=\"text\" id=\"lastname\" name=\"lastname\" placeholder=\"Last Name\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-envelope\"></i>\r\n              <input type=\"email\" id=\"email\" name=\"email\" placeholder=\"Email\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-user\"></i>\r\n              <input type=\"text\" id=\"username\" name=\"username\" placeholder=\"Username\" minLength=\"3\" maxLength=\"49\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-lock\"></i>\r\n              <input type=\"password\" id=\"password\" name=\"password\" placeholder=\"Password\" minLength=\"4\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-lock\"></i>\r\n              <input type=\"password\" id=\"confirmPassword\" name=\"confirmPassword\" placeholder=\"Confirm Password\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            {userAuthenticationMethod}\r\n\r\n            <div>\r\n              <p style={{color:'red'}} id = \"errorMessage\" name=\"errorMessage\">{this.state.errorMessage}</p>\r\n            </div>\r\n\r\n            {signUpButton}\r\n\r\n          </form>\r\n\r\n          <p className=\"login-create-account-p\" onClick={this.openLoginForm}>Already have an account? Login <i className=\"far fa-arrow-alt-circle-right\"></i></p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    setGlobalToken,\r\n    setCurrentLoginForm\r\n};\r\n\r\nexport default compose(\r\n    withRouter,\r\n    connect(null, mapDispatchToProps)\r\n)(SignUpForm)\r\n","// returns a promise that on fullfillment returns the object given by objectId\r\nexport function getApiObjectsObjectId(token, server, objectId) {\r\n  return fetch(server + 'api/objects/' + objectId, {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n    if(response.status !== 200){\r\n      console.log(\"Error: \" + server + 'api/objects/' + objectId);\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n    return (body);\r\n  }).catch(function(error) {\r\n    return (\"Error:\", error);\r\n  });\r\n}\r\n","import {getApiObjectsObjectId} from '../api/object.js';\r\n\r\n// adds the notes to the cytoscape graph\r\n// parameters are token, cytoscape instance, cytoscape-supportimage instance, notes map, getApiLinksFromViewId, getApiLinksReadStatus, and getCommunityAuthors results\r\nexport function addNodesToGraph(server, token, nodes, nodeData, authorData){\r\n  var graph_nodes = [];\r\n  for(var i = 0; i < nodeData.length; i++){\r\n    var id = createCytoscapeId(nodes, nodeData[i].to);\r\n\r\n    if(nodeData[i]._to.type === \"Note\" && nodeData[i]._to.title !== \"\" && nodeData[i]._to.status === \"active\"){\r\n      graph_nodes.push(handleNote(id, nodeData[i], authorData));\r\n    } else if(nodeData[i]._to.type === \"Attachment\" && nodeData[i]._to.title !== \"\" && nodeData[i]._to.status === \"active\"){\r\n      graph_nodes.push(handleAttachment(server, token, nodes, nodeData[i], authorData));\r\n    } else if(nodeData[i]._to.type === \"Drawing\" && nodeData[i]._to.title !== \"\" && nodeData[i]._to.status === \"active\"){\r\n      graph_nodes.push(handleDrawing(server, token, nodes, nodeData[i], authorData));\r\n    } else if(nodeData[i]._to.type === \"View\" && nodeData[i]._to.title !== \"\" && nodeData[i]._to.status === \"active\"){\r\n      graph_nodes.push(handleView(nodes, nodeData[i], authorData));\r\n    }\r\n  }\r\n\r\n  return graph_nodes;\r\n}\r\n\r\n\r\n// adds the edges to the cytoscape graph\r\n// parameters are cytoscape instance, notes map, and postApiLinksCommunityIdSearch results\r\nexport function addEdgesToGraph(nodes, edgeData){\r\n  var graph_edges = [];\r\n  for(var i = 0; i < edgeData.length; i++){\r\n    var obj = edgeData[i];\r\n\r\n    if(obj._to.type === \"Note\" && obj._to.status === \"active\" && obj._to.title !== \"\" && obj._from.type === \"Note\" && obj._from.status === \"active\" && obj._from.title !== \"\"){\r\n        var fromCount = nodes.get(obj.from);\r\n        var toCount = nodes.get(obj.to);\r\n\r\n        if(fromCount !== 'undefined' && toCount !== 'undefined'){\r\n          for(var j = 0; j < fromCount; j++){\r\n            for(var k = 0; k < toCount; k++){\r\n              graph_edges.push({\r\n                group: 'edges',\r\n                data: {\r\n                  id: obj._id + '-' + (parseInt(j) + 1) + (parseInt(k) + 1),\r\n                  source: obj.from + '-' + (parseInt(j) + 1),\r\n                  target: obj.to + '-' + (parseInt(k) + 1)\r\n                }\r\n              });\r\n            }\r\n          }\r\n        } else {\r\n          console.log(obj.from + \" fromCount: \" + fromCount + \"\\n\" + obj.to + \" toCount: \" + toCount);\r\n        }\r\n    }\r\n  }\r\n  return graph_edges;\r\n}\r\n\r\n\r\n// handles adding notes to the cytoscape instance\r\nfunction handleNote(id, nodeData, authorData){\r\n  var authorName = matchAuthorId(nodeData._to.authors[0], authorData);\r\n  var date = parseDate(nodeData.created);\r\n  var readStatus, type;\r\n\r\n  // handles whether it is a note or a riseabove\r\n  if(nodeData._to.data === undefined){\r\n    readStatus = 'unread-note';\r\n    type = \"note\";\r\n  } else {\r\n    readStatus = 'unread-riseabove';\r\n    type = \"riseabove\";\r\n  }\r\n\r\n  return {\r\n      group: 'nodes',\r\n      data: {\r\n        id: id,\r\n        name: nodeData._to.title,\r\n        author: authorName,\r\n        date: date,\r\n        kfId: nodeData.to,\r\n        type: type\r\n      },\r\n      classes: readStatus,\r\n      position: {\r\n        x: nodeData.data.x,\r\n        y: nodeData.data.y\r\n      }\r\n  };\r\n}\r\n\r\n\r\n// handles adding attachments to the cytoscape instance\r\nfunction handleAttachment(server, token, nodes, nodeData, authorData){\r\n\r\n  var authorName = matchAuthorId(nodeData._to.authors[0], authorData);\r\n  var date = parseDate(nodeData.created);\r\n  var id = createCytoscapeId(nodes, nodeData.to);\r\n\r\n  return getApiObjectsObjectId(token, server, nodeData.to).then(function(result){\r\n    if(String(result.data.type).substring(0,5) === \"image\"){\r\n      var imageUrl =  (server + String(result.data.url).substring(1,)).replace(/\\s/g,\"%20\");\r\n\r\n      if(String(result.data.type).slice(-3) === \"gif\"){\r\n        imageUrl = imageUrl.substring(0, imageUrl.length - 3) + \"mp4\";\r\n      }\r\n\r\n      var bounds = {\r\n        x: nodeData.data ? nodeData.data.x : 0,\r\n        y: nodeData.data ? nodeData.data.y : 0,\r\n        width: nodeData.data ? nodeData.data.width : 0,\r\n        height: nodeData.data ? nodeData.data.height : 0,\r\n      };\r\n\r\n      return {\r\n        url: imageUrl,\r\n        name: nodeData._to.title,\r\n        bounds: bounds,\r\n        locked: false,\r\n        linkId: nodeData._id,\r\n        author: authorName,\r\n        kfId: nodeData.to,\r\n        type: nodeData._to.type,\r\n      };\r\n\r\n    } else {\r\n      return {\r\n        group: 'nodes',\r\n        data: {\r\n          id: id,\r\n          name: nodeData._to.title,\r\n          author: authorName,\r\n          date: date,\r\n          kfId: nodeData.to,\r\n          type: nodeData._to.type,\r\n          download: server + result.data.url.substring(1,)\r\n        },\r\n        classes: \"attachment\",\r\n        position: {\r\n          x: nodeData.data.x,\r\n          y: nodeData.data.y\r\n        }\r\n      };\r\n    }\r\n  });\r\n}\r\n\r\n\r\n// handles adding drawings to the cytoscape instance\r\nfunction handleDrawing(server, token, nodes, nodeData, authorData){\r\n  var authorName = matchAuthorId(nodeData._to.authors[0], authorData);\r\n\r\n  return getApiObjectsObjectId(token, server, nodeData.to).then(function(result){\r\n    var parser = new DOMParser();\r\n    var doc = parser.parseFromString(result.data.svg, \"image/svg+xml\");\r\n\r\n    // use width and height from svg tag to find the aspect ratio\r\n    var svg_width = doc.childNodes[0].attributes.width.value;\r\n    var svg_height = doc.childNodes[0].attributes.height.value;\r\n    var aspect_ratio = svg_width/svg_height;\r\n\r\n    // use the given width and known aspect ratio to calculate appropiate height for svg\r\n    var node_width = parseInt(nodeData.data.width);\r\n    var node_height = node_width/aspect_ratio;\r\n\r\n    var bounds = {\r\n      x: nodeData.data ? nodeData.data.x : 0,\r\n      y: nodeData.data ? nodeData.data.y : 0,\r\n      height: nodeData.data ? node_height : 0,\r\n      width: nodeData.data ? parseInt(nodeData.data.width) : 0,\r\n    };\r\n\r\n    return {\r\n      url: 'data:image/svg+xml;utf8,' + encodeURIComponent('<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE svg>' + result.data.svg),\r\n      name: nodeData._to.title,\r\n      bounds: bounds,\r\n      locked: false,\r\n      author: authorName,\r\n      kfId: nodeData.to,\r\n      type: nodeData._to.type,\r\n      linkId: nodeData._id\r\n    };\r\n\r\n  });\r\n}\r\n\r\n\r\n// handles adding a link to another view\r\nfunction handleView(nodes, nodeData, authorData){\r\n  var id = createCytoscapeId(nodes, nodeData.to);\r\n  var authorName = matchAuthorId(nodeData._to.authors[0], authorData);\r\n  return {\r\n    group: 'nodes',\r\n    data: {\r\n      id: id,\r\n      author: authorName,\r\n      name: nodeData._to.title,\r\n      kfId: nodeData.to,\r\n      type: nodeData._to.type,\r\n      communityId: nodeData.communityId,\r\n    },\r\n    classes: \"view\",\r\n    position: {\r\n      x: nodeData.data.x,\r\n      y: nodeData.data.y\r\n    }\r\n  };\r\n}\r\n\r\n\r\n// helper function to find an authors name from their author id using the getCommunityAuthors data\r\nfunction matchAuthorId(authorId, authorsInfo){\r\n    for(let i in authorsInfo){\r\n      if(authorId === authorsInfo[i]._id){\r\n        return authorsInfo[i].firstName + \" \" + authorsInfo[i].lastName;\r\n      }\r\n    }\r\n    return \"Author not found\";\r\n}\r\n\r\n\r\n// helper function to return formatted creation date of a note\r\nfunction parseDate(date){\r\n  var year = date.substring(0, 4);\r\n  var month = date.substring(5, 7);\r\n  var day = date.substring(8, 10);\r\n  var hour = date.substring(11, 13);\r\n  var minute = date.substring(14, 16);\r\n  var second = date.substring(17, 19);\r\n  if(hour < 12){\r\n    return(month + \"/\" + day + \"/\" + year + \", \" + hour + \":\" + minute + \":\" + second + \" AM\");\r\n  } else {\r\n    return(month + \"/\" + day + \"/\" + year + \", \" + (hour - 12) + \":\" + minute + \":\" + second + \" PM\");\r\n  }\r\n}\r\n\r\n\r\n// returns a unique cytoscape id corresponding to the given kf id\r\nfunction createCytoscapeId(nodes, kfId){\r\n  // create the notes unique id\r\n  // example id would be \"5a0497f1ad39ced746109d6e-1\"\r\n  // the number fixed on the end is the count of that id on this view\r\n  if(nodes.has(kfId)){\r\n    nodes.set(kfId, nodes.get(kfId) + 1);\r\n    return kfId + '-' + nodes.get(kfId);\r\n  } else {\r\n    nodes.set(kfId, 1);\r\n    return kfId + '-1';\r\n  }\r\n}\r\n","import React, {Component} from 'react'\r\nimport { connect } from 'react-redux'\r\nimport Cytoscape from 'cytoscape';\r\nimport CytoscapeComponent from 'react-cytoscapejs';\r\nimport CytoscapePanZoom from 'cytoscape-panzoom';\r\nimport CytoscapeNodeHtmlLabel from 'cytoscape-node-html-label';\r\nimport CytoscapeSupportImages from 'cytoscape-supportimages';\r\n\r\nimport { updateViewLink } from './store/async_actions.js'\r\nimport {addNodesToGraph, addEdgesToGraph} from './helper/Graph_helper.js';\r\nimport './css/cytoscape.js-panzoom.css';\r\nimport './css/Graph.css';\r\n\r\nimport unread_note_icon from './assets/icon_note_blue.png';\r\nimport read_note_icon from './assets/icon_note_red.png';\r\nimport unread_riseabove_icon from './assets/icon_riseabove_blue.png';\r\nimport read_riseabove_icon from './assets/icon_riseabove_red.png';\r\nimport attachment_icon from './assets/icon_attachment.gif';\r\nimport view_icon from './assets/icon_view.png';\r\nimport {MINZOOM, MAXZOOM} from './config.js';\r\n\r\nCytoscape.use(CytoscapePanZoom);\r\nCytoscape.use(CytoscapeNodeHtmlLabel);\r\nCytoscape.use(CytoscapeSupportImages);\r\n\r\nclass GraphView extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      elements: {nodes: [], edges: []},\r\n      kfToCyMap: null,\r\n      removedElements: null,\r\n      currViewLinksLength: 0\r\n    };\r\n\r\n    this.loadElements = this.loadElements.bind(this);\r\n    this.supportImageIsDuplicate = this.supportImageIsDuplicate.bind(this);\r\n    this.compareSupportImages = this.compareSupportImages.bind(this);\r\n    this.findCyIdsFromKfId = this.findCyIdsFromKfId.bind(this);\r\n    this.updateReadLinks = this.updateReadLinks.bind(this);\r\n    this.focusRecentAddition = this.focusRecentAddition.bind(this);\r\n    this.filterNodes = this.filterNodes.bind(this);\r\n  };\r\n\r\n  loadElements(prevViewLinksLength, forceRender) {\r\n      // ensure we have all the informationn needed to render the graph\r\n      // if ((VIEWLINKS UPDATED OR FORCE RENDER FROM EDGE CASE) AND WE HAVE BUILDSON + AUTHORS INFO)\r\n      // only the viewlinks prop changes between views - buildson and author info stays the same\r\n      if ((this.props.viewLinks.length !== this.state.currViewLinksLength || forceRender) && this.props.buildsOn.length !== 0 && Object.keys(this.props.authors).length !== 0){\r\n          this.setState({currViewLinksLength: this.props.viewLinks.length});\r\n          const cy = this.cy;\r\n          const si = cy.supportimages();\r\n\r\n          // we keep a map with (key, value) of (kfId, count) in order to create duplicate notes with unique ids\r\n          // simply append the count to the end of their note id\r\n          var nodes = new Map();\r\n\r\n          // clear the support images extension\r\n          si._private.supportImages = [];\r\n\r\n          var graph_nodes = addNodesToGraph(this.props.server, this.props.token, nodes, this.props.viewLinks, this.props.authors);\r\n          var graph_edges = addEdgesToGraph(nodes, this.props.buildsOn);\r\n          var self = this;\r\n\r\n          Promise.all(graph_nodes.concat(graph_edges)).then((graph_results) => {\r\n              var cy_elements = {nodes: [], edges: []};\r\n              for(let i = 0; i < graph_results.length; i++){\r\n                  if(graph_results[i].group === \"nodes\"){\r\n                      cy_elements.nodes.push(graph_results[i]);\r\n                  } else if(graph_results[i].group === \"edges\"){\r\n                      cy_elements.edges.push(graph_results[i]);\r\n                  } else if(graph_results[i].url && !this.supportImageIsDuplicate(si.images(), graph_results[i])){\r\n                      si.addSupportImage(graph_results[i]);\r\n                  }\r\n              }\r\n\r\n              self.setState({elements: cy_elements});\r\n              self.setState({kfToCyMap: nodes});\r\n              // support-images extension will not trigger a redraw if there are no images in the view - this line handles that\r\n              if(si.images().length === 0){ si._private.renderer.redraw(); }\r\n              // if a single new element was added to the graph - highlight it\r\n              if(this.props.viewLinks.length === prevViewLinksLength + 1){ this.focusRecentAddition(this.props.viewLinks[this.props.viewLinks.length - 1]); }\r\n              this.updateReadLinks();\r\n          });\r\n      }\r\n  }\r\n\r\n  // checks if the given image a is already present in the list of support images\r\n  supportImageIsDuplicate(imgs, a){\r\n    for(var i in imgs){\r\n      if(this.compareSupportImages(imgs[i], a)) return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  // returns a deep comparison of two support images\r\n  compareSupportImages(a, b){\r\n    return a.bounds.height === b.bounds.height && a.bounds.width === b.bounds.width && a.bounds.x === b.bounds.x && a.bounds.y === b.bounds.y\r\n        && a.name === b.name && a.url === b.url;\r\n  }\r\n\r\n  // returns an array of cytoscapeIds corresponding to the given kfId\r\n  findCyIdsFromKfId(kfId){\r\n    var map = this.state.kfToCyMap;\r\n    if(map.has(kfId)){\r\n      var cytoscapeIds = [];\r\n      var countInstances = map.get(kfId);\r\n      for(let i = 1; i <= countInstances; i++){\r\n        cytoscapeIds.push(kfId+'-'+i);\r\n      }\r\n      return cytoscapeIds;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  // all links are initially marked as unread - this function updates the read links accordingly afterward\r\n  updateReadLinks(){\r\n    var cy = this.cy;\r\n    var readLinks = this.props.readLinks;\r\n    var self = this;\r\n\r\n    // cy.batch() updates all the elements one time instead of triggering multiple redraws\r\n    cy.batch(function(){\r\n\r\n      for(let i in readLinks){\r\n        var cy_elems = self.findCyIdsFromKfId(readLinks[i]); // the element will either be a riseabove or a regular note\r\n        if(cy_elems !== null && cy_elems.length !== 0){\r\n          var isRiseAbove = cy.$('#'+cy_elems[0]).hasClass('unread-riseabove') ? true : false;\r\n          var classToRemove = isRiseAbove ? 'unread-riseabove' : 'unread-note';\r\n          var classToAdd = isRiseAbove ? 'read-riseabove' : 'read-note';\r\n          for(let i in cy_elems){\r\n            cy.$('#'+cy_elems[i]).removeClass(classToRemove).addClass(classToAdd);\r\n          }\r\n        }\r\n      }\r\n\r\n    });\r\n  }\r\n\r\n  focusRecentAddition(note){\r\n    var cy = this.cy;\r\n    var kfId = note.to;\r\n    var cyIds = this.findCyIdsFromKfId(kfId);\r\n    if(cyIds !== null){\r\n      var newestCyElem = cy.$('#'+cyIds[cyIds.length - 1]);\r\n      cy.center(newestCyElem);\r\n      newestCyElem.flashClass('recentAddition', 10000);\r\n    }\r\n  }\r\n\r\n  filterNodes(q){\r\n    var cy = this.cy;\r\n    const si = cy.supportimages();\r\n\r\n    if(this.state.removedElements !== null) this.state.removedElements.restore();\r\n    this.setState({removedElements: null});\r\n    var imgs = si.images();\r\n    for(let i in imgs){\r\n      si.setImageVisible(imgs[i], true);\r\n    }\r\n\r\n    var nodesToHide = cy.collection();\r\n    const query = q || this.props.searchQuery;\r\n    const notes = Object.values(this.props.viewNotes);\r\n    var filter = this.props.searchFilter;\r\n    var self = this;\r\n    switch (filter) {\r\n        case \"title\":\r\n            // eslint-disable-next-line\r\n            nodesToHide = cy.filter(function(elem, i){\r\n               const elem_type = elem.data('type');\r\n               const elem_title = elem.data('name');\r\n               if((elem_type === \"note\" || elem_type === \"View\" || elem_type === \"riseabove\" || elem_type === \"Attachment\") && !elem_title.toLowerCase().includes(query.toLowerCase())){\r\n                 return elem;\r\n               }\r\n            });\r\n\r\n            // for(let i in imgs){\r\n            //   var supportImg = imgs[i];\r\n            //   if(!supportImg.name.toLowerCase().includes(query.toLowerCase())){\r\n            //     si.setImageVisible(supportImg, false);\r\n            //   }\r\n            // }\r\n\r\n            break;\r\n\r\n        case \"content\":\r\n            // eslint-disable-next-line\r\n            notes.filter(function (obj) {\r\n                if (obj.data && ( (obj.data.English && !obj.data.English.includes(query)) || (obj.data.body && !obj.data.body.includes(query)) ) ) {\r\n                  var cy_ids = self.findCyIdsFromKfId(obj._id);\r\n                  for(let j in cy_ids){ nodesToHide = nodesToHide.union(cy.$('#'+cy_ids[j])); }\r\n                }\r\n            });\r\n\r\n            break;\r\n\r\n        case \"author\":\r\n            // eslint-disable-next-line\r\n            nodesToHide = cy.filter(function(elem, i){\r\n               const elem_type = elem.data('type');\r\n               const elem_author = elem.data('author');\r\n               if((elem_type === \"note\" || elem_type === \"View\" || elem_type === \"riseabove\" || elem_type === \"Attachment\") && !elem_author.toLowerCase().includes(query.toLowerCase())){\r\n                 return elem;\r\n               }\r\n            });\r\n\r\n            // for(let i in imgs){\r\n            //   var supportImg = imgs[i];\r\n            //   if(!supportImg.author.toLowerCase().includes(query.toLowerCase())){\r\n            //     si.setImageVisible(supportImg, false);\r\n            //   }\r\n            // }\r\n\r\n            break;\r\n\r\n        case \"scaffold\":\r\n            const noteIds = this.props.supports.filter(support => support.from === query).map(support => support.to);\r\n            // eslint-disable-next-line\r\n            notes.filter(function(note){\r\n              if(!noteIds.includes(note._id)){\r\n                var cy_ids = self.findCyIdsFromKfId(note._id);\r\n                for(let j in cy_ids){ nodesToHide = nodesToHide.union(cy.$('#'+cy_ids[j])); }\r\n              }\r\n            });\r\n            break;\r\n\r\n        default:\r\n            break;\r\n    }\r\n\r\n    if(nodesToHide.length !== 0){\r\n      var removedElements = cy.remove(nodesToHide);\r\n      this.setState({removedElements: removedElements});\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    var cy = this.cy;\r\n\r\n    // CYTOSCAPE-PANZOOM EXTENSION\r\n    // the default values of each option are outlined below:\r\n    var defaults = {\r\n      zoomFactor: 0.05, // zoom factor per zoom tick\r\n      zoomDelay: 45, // how many ms between zoom ticks\r\n      minZoom: MINZOOM, // min zoom level\r\n      maxZoom: MAXZOOM, // max zoom level\r\n      fitPadding: 50, // padding when fitting\r\n      panSpeed: 10, // how many ms in between pan ticks\r\n      panDistance: 10, // max pan distance per tick\r\n      panDragAreaSize: 75, // the length of the pan drag box in which the vector for panning is calculated (bigger = finer control of pan speed and direction)\r\n      panMinPercentSpeed: 0.25, // the slowest speed we can pan by (as a percent of panSpeed)\r\n      panInactiveArea: 8, // radius of inactive area in pan drag box\r\n      panIndicatorMinOpacity: 0.5, // min opacity of pan indicator (the draggable nib); scales from this to 1.0\r\n      zoomOnly: false, // a minimal version of the ui only with zooming (useful on systems with bad mousewheel resolution)\r\n      fitSelector: undefined, // selector of elements to fit\r\n      animateOnFit: function(){ // whether to animate on fit\r\n        return false;\r\n      },\r\n      fitAnimationDuration: 1000, // duration of animation on fit\r\n\r\n      // icon class names\r\n      sliderHandleIcon: 'fa fa-minus',\r\n      zoomInIcon: 'fa fa-plus',\r\n      zoomOutIcon: 'fa fa-minus',\r\n      resetIcon: 'fa fa-expand'\r\n    };\r\n\r\n    // add the panzoom control\r\n    cy.panzoom( defaults );\r\n\r\n    // CYTOSCAPE-NODE-HTML-LABEL EXTENSION\r\n    cy.nodeHtmlLabel([\r\n      {\r\n        query: 'node',\r\n        halign: 'center', // title horizontal position. Can be 'left',''center, 'right'\r\n        valign: 'bottom', // title vertical position. Can be 'top',''center, 'bottom'\r\n        halignBox: 'right', // title relative box horizontal position. Can be 'left',''center, 'right'\r\n        valignBox: 'bottom', // title relative box vertical position. Can be 'top',''center, 'bottom'\r\n        cssClass: 'cytoscape-label', // any classes will be as attribute of <div> container for every title\r\n        tpl: function(data){\r\n          // we only want author and creation date listed for notes\r\n          if(data.type === 'note' || data.type === 'riseabove' || data.type === 'Attachment'){\r\n            return '<div>' + data.author + '<br>' + data.date + '</div>';\r\n          } else {\r\n            return '';\r\n          }\r\n        }\r\n      },\r\n    ]);\r\n\r\n    this.loadElements();\r\n\r\n    var ref = this;\r\n    // on single click of node log its kf id and mark it as read\r\n    cy.on('tap', 'node', function(event){\r\n      var kfId = this.data('kfId');\r\n      var type = this.data('type');\r\n\r\n      if(this.hasClass(\"image\")){\r\n        console.log(\"image\");\r\n      } else if(this.hasClass(\"attachment\")){\r\n          ref.props.onNoteClick(kfId)\r\n      } else if(this.hasClass(\"view\")){\r\n          ref.props.onViewClick(kfId);\r\n      } else {\r\n        if(type === \"riseabove\"){\r\n            ref.props.onNoteClick(kfId)\r\n            this.removeClass(\"unread-riseabove\");\r\n            this.addClass(\"read-riseabove\");\r\n        } else if(type === \"note\"){\r\n            ref.props.onNoteClick(kfId)\r\n            this.removeClass(\"unread-note\");\r\n            this.addClass(\"read-note\");\r\n        }\r\n      }\r\n    });\r\n\r\n      cy.on('dragfree', 'node', (evt) => {\r\n          const {x, y} = evt.target.position();\r\n\r\n          var kfId = evt.target.data().kfId;\r\n\r\n          let viewLink = this.props.viewLinks.filter((link) => link.to === kfId)\r\n          if (viewLink.length) {\r\n              viewLink = viewLink[0];\r\n              const data = {x, y}\r\n              const newViewLink = { ...viewLink }\r\n              newViewLink.data = { ...newViewLink.data, ...data };\r\n              this.props.updateViewLink(newViewLink)\r\n          }\r\n      })\r\n\r\n      //Update view link of image if position is changed\r\n      cy.on('cysupportimages.imagemoved', (evt, img) => {\r\n          let viewLink = this.props.viewLinks.filter((link) => link._id === img.linkId)\r\n          if (viewLink.length) {\r\n              viewLink = viewLink[0];\r\n              const data = {x: img.bounds.x, y: img.bounds.y}\r\n              const newViewLink = { ...viewLink }\r\n              newViewLink.data = { ...newViewLink.data, ...data };\r\n              this.props.updateViewLink(newViewLink)\r\n          }\r\n      })\r\n\r\n      cy.on('cysupportimages.imageresized', (evt, img, b1, b2) => {\r\n          let viewLink = this.props.viewLinks.filter((link) => link._id === img.linkId)\r\n          if (viewLink.length) {\r\n              viewLink = viewLink[0];\r\n              const data = {width: img.bounds.width, height: img.bounds.height}\r\n              const newViewLink = { ...viewLink }\r\n              newViewLink.data = { ...newViewLink.data, ...data };\r\n              this.props.updateViewLink(newViewLink)\r\n          }\r\n      })\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n      // AN OBJECT MAPPING DIFFERENT RENDERING CASES TO BOOLEAN VALUES\r\n      // this is an attempt to organize and account for all the edge cases when deciding to rerender the graph\r\n      let cases = {\r\n        anyPropUpdated: (this.props.viewId !== prevProps.viewId || this.props.buildsOn !== prevProps.buildsOn\r\n                            || this.props.authors !== prevProps.authors || this.props.viewLinks !== prevProps.viewLinks || this.props.readLinks !== prevProps.readLinks),\r\n\r\n        nodePositionUpdated: (this.props.viewId === prevProps.viewId && this.props.buildsOn === prevProps.buildsOn && this.props.authors === prevProps.authors\r\n                            && this.props.viewLinks !== prevProps.viewLinks && this.props.viewLinks.length === prevProps.viewLinks.length && this.props.readLinks === prevProps.readLinks),\r\n\r\n        switchedToEmptyView: (this.props.viewId !== prevProps.viewId && this.props.buildsOn === prevProps.buildsOn && this.props.authors === prevProps.authors\r\n                            && this.props.viewLinks !== prevProps.viewLinks && this.props.viewLinks.length === 0 && prevProps.viewLinks.length !== undefined),\r\n\r\n        searchTriggered: (this.props.searchQuery !== prevProps.searchQuery || this.props.searchFilter !== prevProps.searchFilter),\r\n      }\r\n\r\n      var forceRender = (cases.nodePositionUpdated || cases.switchedToEmptyView);\r\n\r\n      if(cases.searchTriggered){ this.filterNodes(); }\r\n      if(cases.anyPropUpdated){ this.loadElements(prevProps.viewLinks.length, forceRender); }\r\n  }\r\n\r\n  render() {\r\n    return(\r\n          <CytoscapeComponent\r\n          cy={(cy) => { this.cy = cy }}\r\n          style={ { width: '100%', height: '100%' } }\r\n          elements={CytoscapeComponent.normalizeElements(this.state.elements)}\r\n          stylesheet={ [\r\n            {\r\n              selector: 'node',\r\n              style: {\r\n                'label': \"data(name)\",\r\n                'font-size': '11px',\r\n                'text-halign': 'right',\r\n                'text-valign': 'center',\r\n                'text-margin-x': '-5',\r\n                'padding': '0',\r\n                'background-opacity': '0',\r\n                'background-clip': 'none',\r\n                'background-width': '15px',\r\n                'background-height': '15px',\r\n              }\r\n            },\r\n            {\r\n              selector: 'edge',\r\n              style: {\r\n                'width': 1,\r\n                'line-color': '#29648f',\r\n                'target-arrow-color': '#29648f',\r\n                'target-arrow-shape': 'triangle',\r\n                'curve-style': 'bezier'\r\n              }\r\n            },\r\n\r\n            {selector: '.unread-note', style: {'background-image': [unread_note_icon]}},\r\n            {selector: '.read-note', style: {'background-image': [read_note_icon]}},\r\n            {selector: '.unread-riseabove', style: {'background-image': [unread_riseabove_icon]}},\r\n            {selector: '.read-riseabove', style: {'background-image': [read_riseabove_icon]}},\r\n            {selector: '.attachment', style: {'background-image': [attachment_icon]}},\r\n            {selector: '.view', style: {'background-image': [view_icon]}},\r\n            {selector: '.image', style: {'label': ''}},\r\n            {selector: '.drawing', style: {'label': ''}},\r\n            {\r\n              selector: '.recentAddition',\r\n              style: {\r\n                'border-style': 'solid',\r\n                'border-width': '2',\r\n                'border-color': 'red',\r\n              }\r\n            },\r\n          ] }\r\n          layout={ {name: 'grid'} }\r\n          hideEdgesonViewport={ false }\r\n          autolock={ false }\r\n          wheelSensitivity={ 0.15 }\r\n          minZoom={ MINZOOM }\r\n          maxZoom={ MAXZOOM }\r\n          />\r\n          );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        token: state.globals.token,\r\n        server: state.globals.currentServer,\r\n        viewId: state.globals.viewId,\r\n        author: state.globals.author,\r\n        authors: state.users,\r\n        viewNotes: state.notes.viewNotes,\r\n        viewLinks: state.notes.viewLinks,\r\n        readLinks: state.notes.readLinks,\r\n        buildsOn: state.notes.buildsOn,\r\n        supports: state.notes.supports,\r\n        searchQuery: state.globals.searchQuery,\r\n        searchFilter: state.globals.searchFilter\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    updateViewLink\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(GraphView)\r\n","import React, {Component} from 'react';\r\nimport {withRouter} from 'react-router';\r\nimport { connect } from 'react-redux';\r\nimport { compose } from 'redux';\r\nimport { Modal, Button } from 'react-bootstrap';\r\nimport LoginForm from './LoginForm';\r\nimport SignUpForm from './SignUpForm';\r\nimport Graph from './GraphView';\r\nimport $ from 'jquery';\r\nimport '../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js';\r\nimport {getUserToken} from './api/user.js';\r\n\r\nimport './css/Login.css';\r\nimport sample_view from './assets/sample_view.gif';\r\nimport app_store from './assets/appstore.svg';\r\nimport googleplay_store from './assets/googleplaystore.png';\r\n\r\nclass Login extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      demoToken: null,\r\n      demoServer: \"https://kf6-stage.ikit.org/\",\r\n      demoCommunityId: \"5ea995a6cbdc04a6f53a1b5c\",\r\n      demoViewId: \"5ea995a7cbdc04a6f53a1b5f\",\r\n      showModal: false,\r\n    }\r\n\r\n    this.handleShow = this.handleShow.bind(this);\r\n    this.handleClose = this.handleClose.bind(this);\r\n  }\r\n\r\n  handleShow(){\r\n    this.setState({showModal: true});\r\n    var ref = this;\r\n    var demoTokenPromise = getUserToken(\"demo1\", \"demo1\", this.state.demoServer);\r\n    demoTokenPromise.then(function(result) {\r\n      ref.setState({demoToken: result.token});\r\n    });\r\n  }\r\n\r\n  handleClose(){\r\n    this.setState({showModal: false});\r\n  }\r\n\r\n  componentDidMount(){\r\n    // enables the popover for refreshing servers on login tool tip\r\n    $('[data-toggle=\"tooltip\"]').tooltip()\r\n    $('[data-toggle=\"popover\"]').popover()\r\n    if($(window).width() <= 768) {\r\n      document.getElementById(\"popover\").setAttribute(\"data-trigger\", \"focus\");\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let formToRender;\r\n    if(this.props.currentLoginForm === \"Login\"){\r\n      formToRender = <LoginForm></LoginForm>;\r\n    } else if(this.props.currentLoginForm === \"SignUp\"){\r\n      formToRender = <SignUpForm></SignUpForm>;\r\n    }\r\n\r\n    return(\r\n      <div className='container-fluid login-main'>\r\n\r\n        <div className = \"row login-row\">\r\n\r\n            <div className = \"col-md-6 login-col login\" id = \"login\">\r\n              {formToRender}\r\n            </div>\r\n\r\n\r\n            <div className = \"col-md-6 login-about\">\r\n\r\n              <div className = \"login-about-wrapper\">\r\n                <h1>What is knowledgeforum.org?</h1>\r\n                <p>A knowledge forum is an electronic group workspace designed to support the process of knowledge building.\r\n                    There are multiple installations of knowledge forums hosted by many universities and private entities all over the world.\r\n                    Knowledgeforum.org unites all of these installations and hence the stakeholders to help confluence knowledge building research,\r\n                    widen the reach of the tool & provide a central location for all global stakeholders.</p>\r\n\r\n                  <div className=\"login-overlay-container login-demo-image\" onClick={this.handleShow} id=\"demo-image-container\">\r\n                    <img className=\"d-block w-100\" src={sample_view} alt={\"First slide\"}></img>\r\n                    <div className=\"login-overlay\">\r\n                        <div className=\"login-overlay-text\">Demo a Knowledge Forum</div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"login-apps-div\">\r\n                    <a href=\"itms-apps://apps.apple.com/us/app/id1554705711\"><img className=\"login-appstore-img\" src={app_store} alt={\"Apple App Store\"}/></a>\r\n                    <a style={{marginLeft: \"10px\"}} href=\"https://play.google.com/store/apps/details?id=com.kf6mobile&hl=en_US&gl=US\"><img className=\"login-appstore-img\" src={googleplay_store} alt={\"Google Play Store\"}/></a>\r\n                  </div>\r\n\r\n\r\n\r\n\r\n                  <Modal dialogClassName=\"login-modal-dialog\" /*show={this.state.showModal}*/ onHide={this.handleClose}>\r\n                    <Modal.Header closeButton>\r\n                      <Modal.Title>Knowledge Forum Demo</Modal.Title>\r\n                    </Modal.Header>\r\n                    <Modal.Body className=\"login-modal-body\">\r\n                      <Graph style={{width: '100%', height: '100%'}} token={this.state.demoToken} server={this.state.demoServer} communityId={this.state.demoCommunityId} viewId={this.state.demoViewId}/>\r\n                    </Modal.Body>\r\n                    <Modal.Footer>\r\n                      <Button variant=\"primary\" onClick={this.handleClose} className=\"login-modal-btn\">\r\n                        Close\r\n                      </Button>\r\n                    </Modal.Footer>\r\n                </Modal>\r\n\r\n              </div>\r\n            </div>\r\n\r\n\r\n          </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        currentLoginForm: state.globals.currentLoginForm,\r\n    }\r\n}\r\n\r\nexport default compose(\r\n    withRouter,\r\n    connect(mapStateToProps, null)\r\n)(Login)\r\n","/*\r\n* THIS FILE PROVIDES HELPER FUNCTIONS FOR LOGIN COMPONENT\r\n*/\r\nimport {getServerName} from '../config.js';\r\nimport {extractTokenFromStorage} from '../config.js';\r\nimport {getUserInfo} from '../api/user.js';\r\nimport {getUserCommunities} from '../api/user.js';\r\nimport {getCommunities} from '../api/community.js';\r\nimport {postCommunityRegistration} from '../api/community.js';\r\n\r\n// adds the users servers to the side bar\r\nexport function appendUserServers(dashboard_component){\r\n  var uname = localStorage.getItem(\"Username\");\r\n  var data = JSON.parse(localStorage.getItem(uname));\r\n  var servers = [];\r\n\r\n  dashboard_component.setState({username: uname});\r\n\r\n  for(var i = 0; i < data.length; i++){\r\n    var serverName = getServerName(data[i][0]);\r\n\r\n    // set the last active server as the default\r\n    if(data[i][2] === \"active\"){\r\n      dashboard_component.setState({currentServerURL: data[i][0]});\r\n      dashboard_component.setState({currentServerName: getServerName(data[i][0])});\r\n      dashboard_component.setState({token: data[i][1]});\r\n      servers.push({\r\n        name: serverName,\r\n        class: 'active',\r\n        url: data[i][0]\r\n      });\r\n      loadServer(data[i][0], dashboard_component);\r\n    } else {\r\n      servers.push({\r\n        name: serverName,\r\n        class: '',\r\n        url: data[i][0]\r\n      });\r\n    }\r\n  }\r\n\r\n  dashboard_component.setState({serverList: servers});\r\n}\r\n\r\n\r\n// replaces the \"join community\" and \"my knowledge building communities\" sections\r\n// with the relevant information for the specified server\r\nexport function loadServer(server, dashboard_component){\r\n  var token = extractTokenFromStorage(server);\r\n\r\n  // LOAD USER COMMUNITY DATA AND UPDATE REACT STATE\r\n  var userCommunitiesData = getUserCommunities(token, server);\r\n  userCommunitiesData.then(function(result) {\r\n    result.sort((a, b) => compareStrings(a._community.title, b._community.title));\r\n    updateUserCommunities(result, server, dashboard_component);\r\n  });\r\n\r\n  // LOAD USER DATA AND UPDATE REACT STATE\r\n  var userInfo = getUserInfo(token, server);\r\n  userInfo.then(function(result) {\r\n    if(result.error === true){\r\n      tokenErrorHandler();\r\n    } else {\r\n      dashboard_component.setState({name: result.firstName + ' ' + result.lastName});\r\n      dashboard_component.setState({userId: result._id});\r\n    }\r\n\r\n  });\r\n\r\n  // LOAD SERVER COMMUNITY DATA AND UPDATE REACT STATE\r\n  var serverCommunitiesData = getCommunities(token, server);\r\n  serverCommunitiesData.then(function(result) {\r\n    result.sort((a, b) => compareStrings(a.title, b.title));\r\n    updateCommunities(result, dashboard_component);\r\n  });\r\n\r\n}\r\n\r\n// updates the server community data react state\r\nfunction updateCommunities(result, dashboard_component){\r\n  var serverCommunityData = [];\r\n  for(var i = 0; i < result.length; i++){\r\n    var title = result[i].title;\r\n    var communityId = result[i]._id;\r\n    serverCommunityData.push({title: title, communityId: communityId});\r\n  }\r\n\r\n  const community_options = serverCommunityData.map(c => ({\r\n    \"value\": c.communityId,\r\n    \"label\": c.title\r\n  }));\r\n\r\n  dashboard_component.setState({serverCommunityData: community_options});\r\n}\r\n\r\n\r\n// updates the user community data react state\r\nfunction updateUserCommunities(data, server, dashboard_component) {\r\n  var userCommunityData = [];\r\n\r\n  // for loop to append the users communities\r\n  for(var i = 0; i < data.length; i++){\r\n    if(data[i] && data[i]._id){\r\n      userCommunityData.push({\r\n          title: data[i]._community.title,\r\n          server: dashboard_component.state.currentServerURL,\r\n          token: dashboard_component.state.token,\r\n          communityId: data[i].communityId\r\n      });\r\n    }\r\n  }\r\n\r\n  dashboard_component.setState({userCommunityData: userCommunityData});\r\n}\r\n\r\n\r\n// registers the user for a community\r\nexport function joinCommunity(userId, server, registrationKey, communityId, dashboard_component){\r\n  var token = extractTokenFromStorage(server);\r\n  var ref = dashboard_component;\r\n  var promise = postCommunityRegistration(token, communityId, server, userId, registrationKey);\r\n  promise.then(result => {\r\n    document.getElementById('communityKey').value = '';\r\n    if(result[0].status !== 201){\r\n      ref.setState({joinCommunityErrorMessage: \"Registration key does not match or you are already registered.\"});\r\n    } else {\r\n      ref.setState({joinCommunityErrorMessage: \"\"});\r\n      loadServer(server, ref);\r\n    }\r\n  })\r\n}\r\n\r\n\r\n// function to handle an expired/invalid user token\r\n// called if response status is 401 (might be errors other than invalid token)\r\nfunction tokenErrorHandler(){\r\n  alert(\"User authorization token expired\");\r\n  logout();\r\n}\r\n\r\n\r\n// clears local storage of the username and their user tokens and redircts to the login page\r\nexport function logout(dashboard_component){\r\n  var uname = localStorage.getItem(\"Username\");\r\n  var userinfo = JSON.parse(localStorage.getItem(uname));\r\n\r\n  if(uname === null || userinfo === null){\r\n    localStorage.clear();\r\n  } else {\r\n    for(var i in userinfo){\r\n      userinfo[i][1] = \"\";\r\n    }\r\n    localStorage.setItem(uname, JSON.stringify(userinfo));\r\n    localStorage.removeItem(\"Username\");\r\n  }\r\n\r\n  dashboard_component.props.history.push('/');\r\n}\r\n\r\n\r\n// function to add to buttons to toggle the side bar\r\nexport function toggleSidebar(){\r\n  var div = document.getElementById('wrapper');\r\n  if (div.className === \"d-flex\") {\r\n    div.className = \"d-flex toggled\";\r\n  } else {\r\n    div.className = \"d-flex\";\r\n  }\r\n}\r\n\r\n\r\n// function to return which string is higher alphabetically\r\n// 1 if a is higher, -1 if b is higher, 0 if a == b\r\nfunction compareStrings(a, b){\r\n    if(a.toLowerCase() < b.toLowerCase()) { return -1; }\r\n    if(a.toLowerCase() > b.toLowerCase()) { return 1; }\r\n    return 0;\r\n}\r\n","// returns a promise that on fullfillment returns all the communities from the specified server\r\nexport function getCommunities(token, server) {\r\n  return fetch(server + 'api/communities', {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n      if(response.status !== 200){\r\n        console.log(\"Error: \" + server + 'api/communities');\r\n        console.log(response);\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return (body);\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n}\r\n\r\n\r\n// returns a promise that on fullfillment returns all the views from the specified community on the specified server\r\nexport function getCommunityViews(token, communityId, server){\r\n  return fetch(server + 'api/communities/' + communityId + '/views', {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n      if(response.status !== 200){\r\n        console.log(\"Error: \" + server + 'api/communities/' + communityId + '/views');\r\n        console.log(response);\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return (body);\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n}\r\n\r\n\r\n// returns a promise that on fullfillment returns the welcome view from the specified community on the specified server\r\nexport function getCommunityWelcomeView(token, communityId, server){\r\n  return fetch(server + 'api/communities/' + communityId + '/views', {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n      if(response.status !== 200){\r\n        console.log(\"Error: \" + server + 'api/communities/' + communityId + '/views');\r\n        console.log(response);\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return (body[0]);\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n}\r\n\r\n\r\n// returns a promise that on fullfillment returns the authors from the specified community on the specified server\r\nexport function getCommunityAuthors(token, communityId, server){\r\n  return fetch(server + 'api/communities/' + communityId + '/authors', {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n    if(response.status !== 200){\r\n      console.log(\"Error: \" + server + 'api/communities/' + communityId + '/authors');\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n    return (body);\r\n  }).catch(function(error) {\r\n    return (\"Error:\", error);\r\n  });\r\n}\r\n\r\n\r\n// registers a given user to the specified community on the specified server\r\nexport function postCommunityRegistration(token, communityId, server, userId, registrationKey){\r\n  var body = {\r\n    'communityId': communityId,\r\n    'registrationKey': registrationKey,\r\n    'userId': userId\r\n  };\r\n\r\n  return fetch(server + 'api/authors', {\r\n    method: \"POST\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n    body: JSON.stringify(body),\r\n  }).then(function(response) {\r\n      if(response.status !== 200){\r\n        console.log(\"Error: \" + server + 'api/authors');\r\n        console.log(response);\r\n        return response;\r\n      } else {\r\n        return response.json();\r\n      }\r\n  }).then(function(body) {\r\n      return (\"Success:\", [body, server]);\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n}\r\n","import React, {Component} from 'react';\r\nimport { connect } from 'react-redux'\r\nimport Select from 'react-select';\r\n\r\nimport { setGlobalToken, setCurrentServer, setCommunityId, setViewId, fetchLoggedUser } from './store/globalsReducer.js';\r\n\r\nimport $ from 'jquery';\r\nimport { setToken, setServer } from './store/api';\r\nimport { getCommunityWelcomeView } from './api/community.js';\r\nimport { appendUserServers, loadServer, joinCommunity, toggleSidebar, logout } from './helper/Dashboard_helper.js';\r\nimport { getServerURL } from './config.js';\r\n\r\nimport './css/Dashboard.css';\r\n\r\nclass Dashboard extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      token: null,\r\n      username: null,\r\n      name: null,\r\n      userId: null,\r\n      currentServerURL: null,\r\n      currentServerName: null,\r\n      serverList: [],\r\n      userCommunityData: [],\r\n      serverCommunityData: [],\r\n      selectedCommunityToJoin: null,\r\n      communityRegistrationKey: null,\r\n      joinCommunityErrorMessage: null,\r\n      viewType: JSON.parse(localStorage.getItem(localStorage.getItem('Username')))[0][3]\r\n    }\r\n\r\n    this.enterCommunity = this.enterCommunity.bind(this);\r\n  }\r\n\r\n  inputChangeHandler = (event) => {\r\n    let name = event.target.name;\r\n    let value = event.target.value;\r\n    this.setState({[name]: value});\r\n  }\r\n\r\n  serverSelectHandler = (event) => {\r\n    var domElement = event.target;\r\n    var serverName = event.target.innerText;\r\n    var serverURL = getServerURL(event.target.innerText);\r\n    var serverTokenPairs = JSON.parse(localStorage.getItem(this.state.username));\r\n\r\n    this.setState({currentServerURL: getServerURL(serverName)});\r\n    this.setState({currentServerName: serverName});\r\n\r\n    // handles active tag in html\r\n    $(domElement).addClass('active').siblings().removeClass('active');\r\n\r\n    // handles the active tag in local storage\r\n    var activeServerURL = getServerURL(serverName);\r\n    var serverTokenPair = [];\r\n    for(var i in serverTokenPairs){\r\n      var server = serverTokenPairs[i][0];\r\n      var token = serverTokenPairs[i][1];\r\n      var status = (server === activeServerURL) ? \"active\" : \"inactive\";\r\n      var viewType = serverTokenPairs[i][3];\r\n      if(server === activeServerURL) { this.setState({token: serverTokenPairs[i][1]}); }\r\n      serverTokenPair.push([server, token, status, viewType]);\r\n    }\r\n    localStorage.setItem(this.state.username, JSON.stringify(serverTokenPair));\r\n\r\n    // loads the server specific data\r\n    loadServer(serverURL, this);\r\n  }\r\n\r\n  handleViewChange = (event) => {\r\n    var selectedViewType = {value: event.value, label: event.label};\r\n    this.setState({viewType: selectedViewType});\r\n\r\n    // handles the view type preference in local storage\r\n    var serverTokenPairs = JSON.parse(localStorage.getItem(this.state.username));\r\n    var newServerTokenPair = [];\r\n    for(var i in serverTokenPairs){\r\n      newServerTokenPair.push([serverTokenPairs[i][0], serverTokenPairs[i][1], serverTokenPairs[i][2], selectedViewType]);\r\n    }\r\n    localStorage.setItem(this.state.username, JSON.stringify(newServerTokenPair));\r\n  }\r\n\r\n  handleCommunityDropDownChange = (event) => {\r\n    this.setState({selectedCommunityToJoin: {value: event.value, label: event.label}});\r\n  }\r\n\r\n  enterCommunity(c){\r\n    var welcomeViewId = getCommunityWelcomeView(c.token, c.communityId, c.server);\r\n    var self = this;\r\n\r\n    welcomeViewId.then(function(response){\r\n      if(self.state.viewType.value === \"Classic\") {\r\n        var aTag = document.createElement('a');\r\n        aTag.href = c.server + 'auth/jwt?token=' + c.token + '&redirectUrl=/view/' + response._id;\r\n        aTag.target = \"_blank\";\r\n        document.body.appendChild(aTag);\r\n        aTag.click();\r\n      } else if(self.state.viewType.value === \"Enhanced\" || self.state.viewType.value === \"Light\") {\r\n        setServer(c.server);\r\n        setToken(c.token);\r\n        sessionStorage.setItem('token', c.token);\r\n        sessionStorage.setItem('communityId', c.communityId);\r\n        sessionStorage.setItem('viewId', response._id);\r\n        self.props.setGlobalToken(c.token);\r\n        self.props.fetchLoggedUser();\r\n        self.props.setCommunityId(c.communityId);\r\n        self.props.setViewId(response._id);\r\n        self.props.setCurrentServer(c.server);\r\n        self.props.history.push({\r\n          pathname: `/view/${response._id}`,\r\n          state: { currentView: self.state.viewType.value, communityTitle: c.title }\r\n        });\r\n      }\r\n\r\n    }).catch(function(error){\r\n      console.log(error);\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    appendUserServers(this);\r\n  }\r\n\r\n  render(){\r\n    return (\r\n      <div className=\"d-flex\" id=\"wrapper\">\r\n\r\n        <div className=\"sidebar-custom dashboard-sidebar-custom\" id=\"sidebar-wrapper\">\r\n          <h1 className=\"sidebar-heading dashboard-sidebar-heading\">Your Servers:</h1>\r\n          <div className=\"list-group list-group-flush\">\r\n            <ul className = \"dashboard-server-list\" id = \"server-list\">{this.state.serverList.map((s) =>\r\n                    <li key={s.name} onClick={this.serverSelectHandler} className={s.class}>{s.name}</li>)}</ul>\r\n            <div className=\"dashboard-viewDropDownContainer\">\r\n              <p>View Type:</p>\r\n              <Select isSearchable={false}\r\n                      value = {this.state.viewType}\r\n                      onChange = {this.handleViewChange}\r\n                      options={[\r\n                        { value: 'Classic', label: 'Classic' },\r\n                        { value: 'Enhanced', label: 'Enhanced' },\r\n                        { value: 'Light', label: 'Light' },\r\n                      ]} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div id=\"page-content-wrapper\">\r\n\r\n          <nav className=\"navbar navbar-expand-lg navbar-light bg-light border-bottom dashboard-navbar\">\r\n            <button className=\"d-none d-md-block btn btn-primary dashboard-select-server\" id=\"menu-toggle\" onClick={toggleSidebar}>Select Server</button>\r\n            <button className=\"d-md-none btn btn-primary dashboard-select-server\" id=\"menu-toggle\" onClick={toggleSidebar}><i className=\"fas fa-server\"></i></button>\r\n            <div className=\"dashboard-currentInfo\" id=\"currentInfo\">{this.state.name}<div></div>{this.state.currentServerName}</div>\r\n\r\n            <button className=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarSupportedContent\" aria-controls=\"navbarSupportedContent\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\r\n              <span className=\"navbar-toggler-icon\"></span>\r\n            </button>\r\n\r\n            <div className=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\r\n              <ul className=\"navbar-nav ml-auto mt-2 mt-lg-0\">\r\n                <li className=\"nav-item\">\r\n                  <button className=\"nav-link dashboard-nav-link btn btn-link\" href=\"\" id=\"logout\" onClick={() => logout(this)}>Logout</button>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </nav>\r\n\r\n          <div className=\"container-fluid\" id=\"dashboard-mainContentContainer\">\r\n            <div className = \"row\">\r\n\r\n              <div className = \"col-md-6 dashboard-mainContentCol userCommunitiesTableCol\">\r\n                <h1>My Knowledge Building Communities</h1>\r\n                <table className=\"dashboard-userCommunities table\" id = \"userCommunities\">\r\n                  <tbody>\r\n                    {this.state.userCommunityData.map((c) => {\r\n                        return(\r\n                          <tr key={c.communityId} onClick={() => this.enterCommunity(c)}>\r\n                            <td className=\"dashboard-userCommunities-row\">\r\n                              {c.title}<button className=\"dashboard-enterButton\" type=\"button\"><i className=\"fas fa-door-open\"></i></button>\r\n                            </td>\r\n                          </tr>)\r\n                    })}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n\r\n              <div className = \"col-md-6 dashboard-mainContentCol\">\r\n                <h1>Join Community</h1>\r\n                <form className=\"col-lg-8 col-md-10 col-sm-12 dashboard-joinCommunityForm\" id = \"joinCommunityForm\" autoComplete=\"off\">\r\n\r\n                  <label htmlFor=\"server\">Community:</label><br></br>\r\n                  <Select value={this.state.selectedCommunityToJoin}\r\n                          className=\"dashboard-communityChoiceDropdown\"\r\n                          id=\"communityChoiceDropdown\"\r\n                          options={this.state.serverCommunityData}\r\n                          onChange={this.handleCommunityDropDownChange}\r\n                          required>\r\n                  </Select><br></br>\r\n\r\n                  <label htmlFor=\"communityKey\">Community Registration Key:</label><br></br>\r\n                  <input className=\"dashboard-communityKeyInput\" type=\"text\" id=\"communityKey\" name=\"communityRegistrationKey\" required onChange={this.inputChangeHandler}></input><br></br>\r\n\r\n                  <div>\r\n                    <p style={{color: 'red'}} id = \"errorMessage\">{this.state.joinCommunityErrorMessage}</p>\r\n                  </div>\r\n\r\n                  <input className = \"dashboard-joinButton\" type=\"button\" value=\"Join\"\r\n                      onClick={() => joinCommunity(this.state.userId, this.state.currentServerURL, this.state.communityRegistrationKey, this.state.selectedCommunityToJoin.value, this)} id=\"joinCommunityButton\"></input>\r\n\r\n                </form>\r\n              </div>\r\n\r\n            </div>\r\n\r\n          </div>\r\n        </div>\r\n\r\n\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    setGlobalToken,\r\n    setCurrentServer,\r\n    setCommunityId,\r\n    setViewId,\r\n    fetchLoggedUser,\r\n}\r\n\r\nexport default connect(\r\n    null,\r\n    mapDispatchToProps,\r\n)(Dashboard)\r\n","import React, { Component } from 'react'\r\nimport { Navbar, Nav, Button } from 'react-bootstrap'\r\nimport { Row, Col, Form, FormGroup, Input, InputGroup, InputGroupAddon, InputGroupText } from 'reactstrap'\r\nimport { connect } from 'react-redux'\r\nimport { withRouter } from 'react-router'\r\n\r\nimport { removeToken } from '../store/api.js'\r\nimport { setViewId, setGlobalToken, setSearchQuery, setSearchFilter } from '../store/globalsReducer'\r\n\r\nclass TopNavbar extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      query: '',\r\n    }\r\n\r\n    this.handleChange = this.handleChange.bind(this);\r\n  }\r\n\r\n  handleFilter = (e) => {\r\n      let value = e.target.value;\r\n      if(value === \"scaffold\"){\r\n        var query = this.props.scaffolds[0].supports[0].to;\r\n        this.setState({query: query});\r\n        this.props.setSearchQuery(query);\r\n      } else {\r\n        this.setState({query: ''});\r\n        this.props.setSearchQuery('');\r\n      }\r\n      this.props.setSearchFilter(value);\r\n  }\r\n\r\n  handleInputChange = (event) => {\r\n      const query = event.target.value\r\n      this.setState({query: query});\r\n      if(query === '' || this.props.filter === 'scaffold') this.props.setSearchQuery(query);\r\n  };\r\n\r\n  handleSearchSubmit = (e) => {\r\n    this.props.setSearchQuery(this.state.query);\r\n    e.preventDefault();\r\n  }\r\n\r\n  logout() {\r\n    sessionStorage.clear();\r\n    removeToken()//remove token from api header\r\n    setGlobalToken(null)//Remove token from store\r\n  }\r\n\r\n  handleChange(e) {\r\n    const viewId = e.target.value;\r\n    this.props.onViewClick(viewId);\r\n  }\r\n\r\n  signUp = (e) => {\r\n    this.props.history.push(\"/\");\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState){\r\n    if(this.props.currentView !== prevProps.currentView || this.props.viewId !== prevProps.viewId){\r\n      this.setState({query: ''});\r\n      this.props.setSearchQuery('');\r\n      this.props.setSearchFilter('title');\r\n      document.getElementById('queryForm').reset();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const isLoggedIn = this.props.isAuthenticated\r\n    const userName = this.props.user ? `${this.props.user.firstName} ${this.props.user.lastName}` : null\r\n    const isViewUrl = this.props.location.pathname.startsWith('/view/')\r\n\r\n    var searchInput;\r\n    if(this.props.filter === \"scaffold\"){\r\n      searchInput = <Input type=\"select\" onChange={this.handleInputChange}>\r\n                        {this.props.scaffolds.map((scaffold, i) => {\r\n                          return <optgroup key={i} label={scaffold.title}>\r\n                              {scaffold.supports.map((support, j) => {\r\n                                  return <option key={j} value={support.to}>{support._to.title}</option>;\r\n                              })}\r\n                          </optgroup>;\r\n                        })}\r\n                    </Input>;\r\n    } else {\r\n      searchInput = <Input\r\n          className=\"form-control\"\r\n          value={this.state.query}\r\n          placeholder=\"Search\"\r\n          onChange={this.handleInputChange}\r\n      />;\r\n    }\r\n\r\n    return (\r\n      <Navbar className=\"viewNavBar\">\r\n        <Navbar.Brand className=\"viewNavBar-brand d-none d-sm-block\">{this.props.communityTitle}</Navbar.Brand>\r\n\r\n        <Navbar.Text className=\"viewNavBar-dropdown-title\">View:</Navbar.Text>\r\n        {isViewUrl ?\r\n          (\r\n            <Nav className=\"viewNavBar-dropdown\">\r\n              {this.props.view ?\r\n                <Form>\r\n                    <FormGroup className=\"viewNavBar-dropdown-formgroup\">\r\n                      <Input type=\"select\" name=\"viewId\" value={this.props.view._id} onChange={this.handleChange}>\r\n                        {\r\n                          this.props.views.map((obj) => {\r\n                            return <option key={obj._id} value={obj._id}> {obj.title} </option>\r\n                          })\r\n                        }\r\n                      </Input>\r\n                    </FormGroup>\r\n                </Form>\r\n                : null}\r\n            </Nav>\r\n          )\r\n          : null}\r\n\r\n          <Navbar.Text className=\"viewNavBar-dropdown-title\">Search:</Navbar.Text>\r\n          <Form id={\"queryForm\"} onSubmit={this.handleSearchSubmit}>\r\n              <Row>\r\n                  <Col>\r\n                      <InputGroup>\r\n                          <InputGroupAddon addonType=\"prepend\">\r\n                              <Input type=\"select\" name=\"filter\" id=\"filter\" onChange={this.handleFilter}>\r\n                                  <option key=\"title\" value=\"title\">Title</option>\r\n                                  <option key=\"scaffold\" value=\"scaffold\">Scaffold</option>\r\n                                  <option key=\"content\" value=\"content\">Content</option>\r\n                                  <option key=\"author\" value=\"author\">Author</option>\r\n                              </Input>\r\n                          </InputGroupAddon>\r\n                          {searchInput}\r\n\r\n                          {<InputGroupAddon addonType=\"append\">\r\n                              <InputGroupText style={{ cursor: \"pointer\" }} onClick={this.handleSearchSubmit}>\r\n                                  <i className=\"fa fa-search\"></i>\r\n                              </InputGroupText>\r\n                          </InputGroupAddon>}\r\n                      </InputGroup>\r\n                  </Col>\r\n              </Row>\r\n          </Form>\r\n\r\n        {isLoggedIn ? (\r\n          <>\r\n            <Nav className=\"ml-auto\">\r\n              <Nav.Link className=\"white mr-auto d-none d-sm-block\"> {userName} </Nav.Link>\r\n              <Button className='ml-2 viewNavBar-logout-btn' href=\"/\" onClick={this.logout}>Logout</Button>\r\n            </Nav>\r\n          </>\r\n        ) :\r\n          <>\r\n            <Nav className=\"ml-auto\">\r\n              <Nav.Link onClick={this.signUp}>Signup</Nav.Link>\r\n              <Nav.Link href=\"/\">Login</Nav.Link>\r\n            </Nav>\r\n          </>\r\n        }\r\n\r\n      </Navbar>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n  return {\r\n    communityId: state.globals.communityId,\r\n    viewId: state.globals.viewId,\r\n    isAuthenticated: state.globals.isAuthenticated,\r\n    user: state.globals.author,\r\n    views: state.globals.views,\r\n    view: state.globals.view,\r\n    viewNotes: state.notes.viewNotes,\r\n    authors: state.users,\r\n    scaffolds: state.scaffolds.items,\r\n    supports: state.notes.supports,\r\n    query: state.globals.searchQuery,\r\n    filter: state.globals.searchFilter\r\n  }\r\n}\r\nconst mapDispatchToProps = {\r\n  setViewId,\r\n  setGlobalToken,\r\n  setSearchQuery,\r\n  setSearchFilter\r\n}\r\n\r\nexport default withRouter(connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(TopNavbar));\r\n","import React, {useState} from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { Modal, Button, Form, ProgressBar} from 'react-bootstrap'\r\nimport { addNotification } from '../../store/notifier.js'\r\nimport { fetchAttachments, fetchLinks } from '../../store/noteReducer.js'\r\nimport { FileDrop } from 'react-file-drop';\r\nimport {url as serverUrl} from '../../store/api.js'\r\nimport './AttachPanel.css'\r\n\r\nimport {postAttachment, uploadFile, putObject, postLink, putLink} from '../../store/api.js'\r\n\r\n//TODO if dropping files is not supported\r\nconst AttachPanel = props => {\r\n    const author = useSelector(state => state.globals.author);\r\n    const dispatch = useDispatch();\r\n    const [progress, setProgress] = useState(0);\r\n\r\n    const  handleClose= (e) => {\r\n        props.onClose();\r\n    }\r\n    const onFileChange = (e) => {\r\n        onFileSelect(e.target.files);\r\n        // TODO After upload, clear input\r\n        /* e.target.value = null; */\r\n\r\n    }\r\n    const onFileSelect = async (fileList) => {\r\n        const files = Array.from(fileList)\r\n        setProgress(0)\r\n        // TODO googleOauth, googledrive\r\n        const upload_promises = []\r\n        files.forEach(async (file) => {\r\n            if (file.type.indexOf(\"image/\") >= 0){\r\n                const _URL = window.URL || window.webkitURL;\r\n                const img = await addImageProcess(_URL.createObjectURL(file))\r\n                var width  = img.naturalWidth  || img.width;\r\n                var height = img.naturalHeight || img.height;\r\n                file.width = width;\r\n                file.height = height;\r\n                upload_promises.push(createAttachment(file, 'image'))\r\n            }else if (file.type.startsWith('video')){\r\n                upload_promises.push(createAttachment(file, 'video'))\r\n            }else{\r\n                upload_promises.push(createAttachment(file, 'link'))\r\n            }\r\n        });\r\n\r\n        await Promise.all(upload_promises)\r\n        handleClose()\r\n        addNotification({title: 'Uploaded!', type:'success', message:'Attachments uploaded!'})\r\n    }\r\n    const addImageProcess = (src) => {\r\n        return new Promise((resolve, reject) => {\r\n            let img = document.createElement(\"img\")\r\n            img.onload = () => resolve(img)\r\n            img.onerror = reject\r\n            img.src = src\r\n        })\r\n    }\r\n    const createAttachment = async (file, type, x, y) => {\r\n        try {\r\n            const attachRes = await postAttachment(author.communityId, author._id)\r\n            const uploadRes = await uploadFile(file, onUploadProgress)\r\n            const attachment = attachRes.data\r\n            const data = uploadRes.data\r\n            attachment.title = data.filename;\r\n            attachment.status = 'active';\r\n            data.version = attachment.data.version + 1;\r\n            attachment.data = data;\r\n            attachment.tmpFilename = data.tmpFilename;\r\n            const newAttachment = await putObject(attachment, author.communityId, attachment._id)\r\n\r\n            newAttachment.data.width = file.width;\r\n            newAttachment.data.height = file.height;\r\n\r\n            if (props.noteId){\r\n                linkToNote(newAttachment, type);\r\n            }else if (props.viewId){\r\n                linkToView(newAttachment, x, y, type);\r\n            }\r\n        } catch (err) {\r\n            console.log(err)\r\n        } finally {\r\n\r\n        }\r\n\r\n    }\r\n\r\n    const linkToNote = async (attachment, type) => {\r\n            await postLink(props.noteId, attachment._id, 'attach')\r\n            //TODO updateFromConnections\r\n            dispatch(fetchLinks(props.noteId, 'from'))\r\n            if (props.inlineAttach){\r\n                const data_mce_src = `${serverUrl}${attachment.data.url}`;\r\n                const title = attachment.title;\r\n                let html = '';\r\n                if (type==='image') {\r\n                    html = '<img class=\"inline-attachment ' + attachment._id + '\" src=\"' + data_mce_src +'\" width=\"100px\" alt=\"' + title + '\" data-mce-src=\"' + data_mce_src + '\">';\r\n                } else if (type==='video') {\r\n                    html = `<video controls=\"controls\" width=\"300\" height=\"150\"> <source src=\"${data_mce_src}\" type=\"video/mp4\" /></video>`\r\n                } else {\r\n                    html ='<a class=\"inline-attachment ' + attachment._id + '\" href=\"' + data_mce_src + '\" target=\"_blank\" download>';\r\n                    html += `<img src=\"${serverUrl}/manual_assets/kf6images/03-toolbar-attachment.png\" alt=\"` + title + '\">' + title + '</a>';\r\n                }\r\n                props.onNewInlineAttach(html)\r\n            }\r\n            dispatch(fetchAttachments(props.noteId))\r\n            //TODO googledrive\r\n            /* if(newAttachment.data.type.indexOf('video') === 0 && $community.isPluginEnabled('googledrive')){\r\n             *     $scope.save2GoogleDrive(userName, newAttachment);\r\n             * } */\r\n    }\r\n\r\n    const linkToView = async (attachment, x, y, attach_type) => {\r\n        const newX = x ? x: 200;\r\n        const newY = y ? y: 200;\r\n        let w = 200;\r\n        let h = 200;\r\n        let showInPlace = false;\r\n        if (attach_type ==='image'){\r\n            w = attachment.data.width;\r\n            h = attachment.data.height;\r\n            if (w > 200){ w = 200; }\r\n            h = (w*h) / attachment.data.width;\r\n            showInPlace = true;\r\n        }\r\n        const link = await postLink(\r\n            props.viewId,\r\n            attachment._id,\r\n            'contains',\r\n            {x: newX, y: newY, width: w, height: h}\r\n        )\r\n        if (showInPlace){\r\n            link.data.showInPlace = true\r\n            await putLink(link._id, link)\r\n        }\r\n\r\n    }\r\n    const onUploadProgress = (progressEvent) => {\r\n        const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total)\r\n        setProgress(percentCompleted)\r\n    }\r\n\r\n    const styles = { width: '100%', color: 'black' };\r\n    return (\r\n        <Modal show={props.attachPanel} onHide={handleClose}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Insert Attachment File</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Form.File id=\"custom-file\">\r\n                    <Form.File.Input onChange={onFileChange}/>\r\n                </Form.File>\r\n                <div style={styles}>\r\n                    <FileDrop\r\n                        onFrameDragEnter={(event) => console.log('onFrameDragEnter', event)}\r\n                        onFrameDragLeave={(event) => console.log('onFrameDragLeave', event)}\r\n                        onFrameDrop={(event) => console.log('onFrameDrop', event)}\r\n                        onDragOver={(event) => console.log('onDragOver', event)}\r\n                        onDragLeave={(event) => console.log('onDragLeave', event)}\r\n                        onDrop={(files, event) => onFileSelect(files)}\r\n                    >\r\n                        or drop some files here!\r\n                    </FileDrop>\r\n                </div>\r\n                <ProgressBar now={progress} />\r\n            </Modal.Body>\r\n            <Modal.Footer>\r\n                <Button variant=\"primary\" onClick={handleClose}>\r\n                    Close\r\n                </Button>\r\n            </Modal.Footer>\r\n        </Modal>\r\n    )\r\n\r\n};\r\n\r\nexport default AttachPanel;\r\n","let authorRequirementTable = {\r\n    private: {\r\n        r: true,\r\n        w: true\r\n    },\r\n    protected: {\r\n        r: false,\r\n        w: true\r\n    },\r\n    public: {\r\n        r: false,\r\n        w: false\r\n    }\r\n};\r\n\r\nexport let fullfillRequirement = (object, author, requiredPermission) => {\r\n    if (!object || !author) {\r\n        return false;\r\n    }\r\n\r\n    if (author.role === 'manager') {\r\n        return true;\r\n    }\r\n\r\n    if (authorRequirementTable[object.permission][requiredPermission] === false) {\r\n        return true;\r\n    }\r\n\r\n    //author requirement\r\n    return isAuthorOrGroupMember(object, author);\r\n};\r\n\r\nexport let isAuthorOrGroupMember = (object, author) => {\r\n    return isAuthor(object, author) || isGroupMember(object, author);\r\n};\r\n\r\nexport let isAuthor = (object, author) => {\r\n    return object.authors.includes(author._id)\r\n};\r\n\r\nexport let isGroupMember = (object, author) => {\r\n    if (!object._groupMembers) {\r\n        return false;\r\n    }\r\n    return object._groupMembers.includes(author._id)    \r\n};\r\n\r\nexport let isManager = function(author) {\r\n    if (!author) {\r\n        return false;\r\n    }\r\n    return author.role === 'manager';\r\n};\r\n\r\nexport let isEditable = (object, author) => {\r\n    return fullfillRequirement(object, author, 'w')\r\n};","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Button, Row, Col, } from 'react-bootstrap';\r\nimport { Form, FormGroup, Input, Alert } from 'reactstrap';\r\nimport { dateFormatOptions } from '../../store/globalsReducer'\r\nimport Axios from 'axios';\r\n\r\nimport './NoteContent.css';\r\nimport { url, apiUrl } from '../../store/api.js'\r\nimport * as access from '../../store/access'\r\nimport { openContribution, updateCheckedNotes } from '../../store/noteReducer'\r\nimport { fetchViewCommunityData } from '../../store/globalsReducer'\r\nimport { createRiseAbove } from '../../store/riseAboveReducer'\r\n\r\nclass NoteContent extends Component {\r\n    noteList = [];\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            token: sessionStorage.getItem('token'),\r\n            addView: this.props.viewId,\r\n            communityId: sessionStorage.getItem('communityId'),\r\n            visible: false,\r\n            viewError: false,\r\n        };\r\n\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n\r\n        this.handleRiseAbove = this.handleRiseAbove.bind(this);\r\n        this.getRiseAboveNotes = this.getRiseAboveNotes.bind(this);\r\n        this.openNote = this.openNote.bind(this);\r\n        this.editNote = this.editNote.bind(this);\r\n\r\n    }\r\n\r\n    componentDidMount() {\r\n    }\r\n\r\n    handleChange(e) {\r\n        e.persist();\r\n        let target = e.target;\r\n        let id = target.value;\r\n\r\n        this.setState({\r\n            addView: id,\r\n        });\r\n\r\n    }\r\n\r\n    // CREATE VIEW->NOTE LINK\r\n    handleSubmit = (e) => {\r\n        if (this.props.viewId === this.state.addView) {\r\n            this.setState({\r\n                viewError: true,\r\n            })\r\n            window.setTimeout(() => {\r\n                this.setState({ viewError: false })\r\n            }, 1500)\r\n        }\r\n        else {\r\n            const topleft = { x: 1000, y: 1000 };\r\n            let url = `${apiUrl}/links`;\r\n            let config = {\r\n                headers: { Authorization: `Bearer ${this.state.token}` }\r\n            };\r\n            this.props.checkedNotes.forEach(note => {\r\n                const ref = this.props.viewLinks.filter((lnk) => lnk.to === note._id)[0]\r\n                topleft.x = Math.min(topleft.x, ref.data.x);\r\n                topleft.y = Math.min(topleft.y, ref.data.y);\r\n            })\r\n            this.props.checkedNotes.forEach(note => {\r\n                let noteId = note._id;\r\n                let query = {\r\n                    \"from\": this.state.addView,\r\n                    \"to\": noteId,\r\n                    \"type\": \"contains\",\r\n                    'data': topleft\r\n                };\r\n                Axios.post(url, query, config).then(\r\n                    res => {\r\n                        this.setState({ visible: true }, () => {\r\n                            window.setTimeout(() => {\r\n                                this.setState({ visible: false })\r\n                            }, 1000)\r\n                        });\r\n\r\n                    }\r\n                );\r\n            });\r\n        }\r\n        // TODO POST LINKS ALERT THEY'RE ADDED TO VIEW TITLE\r\n\r\n    }\r\n\r\n    handleRiseAbove = async (e) => {\r\n        let noOfNotes = this.props.checkedNotes.length;\r\n        //IF CHECKED NOTES\r\n        if (noOfNotes > 0) {\r\n            let confirmation = window.confirm(\"Are you sure to create riseabove using the selected \" + noOfNotes + \" object(s)?\");\r\n            if (!confirmation) {\r\n                return;\r\n            }\r\n            //CREATE RISEABOVE\r\n            let view = this.props.view;\r\n            let communityId = this.props.communityId;\r\n            let author = this.props.author._id;\r\n            let notes = this.props.checkedNotes;\r\n            await this.props.createRiseAbove(view, communityId, author, notes);\r\n            this.props.fetchViewCommunityData(this.props.viewId)\r\n\r\n\r\n        } else {\r\n            alert(\"Please select at least 1 note to create RiseAbove\");\r\n        }\r\n    }\r\n\r\n    editNote = (contribId, mode) => {\r\n        this.props.openContribution(contribId, mode);\r\n    }\r\n\r\n    getRiseAboveNotes = (riseAboveId) => {\r\n        if (this.props.riseAboveViewNotes[riseAboveId]) {\r\n            let riseAboveNotes = this.props.riseAboveViewNotes[riseAboveId].map((noteId) => this.props.riseAboveNotes[noteId])\r\n            return riseAboveNotes;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    openNote = (noteId) => {\r\n        this.props.openContribution(noteId, \"read\")\r\n    }\r\n\r\n    render() {\r\n        const formatter = new Intl.DateTimeFormat('default', dateFormatOptions)\r\n        return (\r\n            <>\r\n                <Form className=\"mrg-1-top\">\r\n                    <Row>\r\n                        <Col md=\"6\">\r\n                            <FormGroup>\r\n                                <Input type=\"select\" name=\"viewId\" onChange={this.handleChange}>{\r\n                                    this.props.views.map((obj, i) => {\r\n                                        return <option key={i} value={obj._id}> {obj.title} </option>\r\n                                    })\r\n                                }</Input>\r\n                            </FormGroup>\r\n                        </Col>\r\n\r\n                        <Col md=\"3\">\r\n                            <Button onClick={this.handleSubmit} >Add to View</Button>\r\n                        </Col>\r\n\r\n                        <Col md=\"3\">\r\n                            <Button onClick={this.handleRiseAbove} >create RiseAbove</Button>\r\n                        </Col>\r\n                    </Row>\r\n                    <Row>\r\n                        <Col>\r\n                            <Alert color=\"danger\" isOpen={this.state.viewError} >\r\n                                Please select a Different View.\r\n                            </Alert>\r\n                            <Alert color=\"info\" isOpen={this.state.visible} >\r\n                                Notes added to View!\r\n                            </Alert>\r\n                        </Col>\r\n                    </Row>\r\n                </Form>\r\n                {this.props.checkedNotes.map(\r\n                    (obj, i) => {\r\n                        let riseAboveNotes = this.getRiseAboveNotes(obj._id);\r\n                        let RiseAboveNotes;\r\n                        if (riseAboveNotes) {\r\n                            RiseAboveNotes = <Row>\r\n                                <Col className=\"pd-1-left\">\r\n                                    <Row className=\"sz-1 primary-800 font-weight-bold\" >RiseAbove Notes</Row>\r\n                                    {riseAboveNotes.map((note, i) => {\r\n                                        return <Row key={i}>\r\n                                            <Button variant=\"light\" className=\"min-width-10 rounded-pill pd-05\" onClick={() => this.openNote(note._id)}>{note.title}</Button>\r\n                                        </Row>\r\n                                    })}\r\n                                </Col>\r\n                            </Row>\r\n                        }\r\n                        let data;\r\n                        if (this.props.query && obj.data.English) {\r\n                            let innerHTML = obj.data.English;\r\n                            let index = innerHTML.indexOf(this.props.query);\r\n                            if (index >= 0) {\r\n                                data = innerHTML.substring(0, index) + \"<span class='highlight'>\" + innerHTML.substring(index, index + this.props.query.length) + \"</span>\" + innerHTML.substring(index + this.props.query.length);\r\n                            }\r\n                        } else if (this.props.query && obj.data.body) {\r\n                            let innerHTML = obj.data.body;\r\n                            let index = innerHTML.indexOf(this.props.query);\r\n                            if (index >= 0) {\r\n                                data = innerHTML.substring(0, index) + \"<span class='highlight'>\" + innerHTML.substring(index, index + this.props.query.length) + \"</span>\" + innerHTML.substring(index + this.props.query.length);\r\n                            }\r\n                        } else {\r\n                            data = obj.data.English ? obj.data.English : obj.data.body;\r\n                        }\r\n\r\n                        //eslint-disable-next-line\r\n                        while (data && data.includes(\"src=\\\"\\/attachments\")) {\r\n                            //eslint-disable-next-line\r\n                            data = data.replace(\"src=\\\"\\/attachments\", \"src=\\\"\" + url + \"\\/attachments\");\r\n                        }\r\n\r\n                        // EDIT BUTTON\r\n                        let EditNoteButton;\r\n                        if (access.isEditable(obj, this.props.author) === true) {\r\n                            EditNoteButton = <Button className=\"float-right\" variant=\"outline-info\" onClick={() => this.editNote(obj._id, \"write\")}>Edit Note</Button>\r\n                        } else {\r\n                            EditNoteButton = <Button className=\"float-right\" variant=\"outline-info\" onClick={() => this.editNote(obj._id, \"read\")}>Read Note</Button>\r\n                        }\r\n\r\n                        return (\r\n                            <Row className=\"min-height-2 mrg-05 border rounded mrg-1-bot pd-1\" key={i}>\r\n                                <Col>\r\n                                    <Row>\r\n                                        <Col md=\"10\" className=\"pd-1 primary-800 font-weight-bold\">{obj.title}</Col>\r\n                                        <Col md=\"2\">\r\n                                            <Button variant=\"outline-secondary\" className=\"circular-border float-right\"\r\n                                                onClick={() => this.props.updateCheckedNotes({ checked: false, noteId: obj._id })}>\r\n                                                <i className=\"fas fa-times\"></i>\r\n                                            </Button>\r\n                                        </Col>\r\n                                    </Row>\r\n                                    <Row>\r\n                                        <Col>\r\n                                            <span className=\"pd-1\" dangerouslySetInnerHTML={{ __html: data ? (data) : (obj.data.English ? obj.data.English : obj.data.body) }} />\r\n                                        </Col>\r\n                                    </Row>\r\n                                    {RiseAboveNotes}\r\n                                    <Row>\r\n                                        <Col>\r\n                                            <Col><div className=\"primary-600 sz-075 pd-05 float-left\">{this.props.users[obj.authors[0]].firstName + \" \"+ this.props.users[obj.authors[0]].lastName } &nbsp; {formatter.format(new Date(obj.created))}</div></Col>\r\n                                            <Col><Button className=\"float-right mrg-1-left\" variant=\"outline-info\" onClick={() => this.props.buildOn(obj._id)}>BuildOn</Button></Col>\r\n                                            <Col>{EditNoteButton}</Col>\r\n                                        </Col>\r\n                                    </Row>\r\n                                </Col>\r\n                            </Row>\r\n                        )\r\n                    }\r\n                )}\r\n            </>\r\n        )\r\n    }\r\n\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    const viewNotes = state.notes.viewNotes\r\n    const users = state.users\r\n    return {\r\n        viewId: state.globals.viewId,\r\n        views: state.globals.views,\r\n        view: state.globals.view,\r\n        checkedNotes: state.notes.checkedNotes.map(\r\n            noteId => noteId in viewNotes ? //Find note in viewNotes or in riseAboveNotes\r\n                viewNotes[noteId] : state.notes.riseAboveNotes[noteId]\r\n        ),\r\n        viewLinks: state.notes.viewLinks,\r\n        author: state.globals.author,\r\n        communityId: state.globals.communityId,\r\n        riseAboveViewNotes: state.notes.riseAboveViewNotes,\r\n        riseAboveNotes: state.notes.riseAboveNotes,\r\n        users: users,\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    openContribution,\r\n    updateCheckedNotes,\r\n    createRiseAbove,\r\n    fetchViewCommunityData\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(NoteContent);\r\n","import { createAction, createReducer } from '@reduxjs/toolkit';\r\nimport * as api from './api.js'\r\n\r\nexport const addNote = createAction('ADD_NOTE')\r\nconst initState = {\r\n\r\n}\r\n\r\nexport const riseAboveReducer = createReducer(initState, {});\r\n\r\nexport const createRiseAbove = (view, communityId, author, notes) => dispatch => {\r\n    let object = {};\r\n    let riseAboveId;\r\n    let riseAboveNoteId;\r\n    let viewId = view._id;\r\n    object.authors = author.split(',')\r\n    object.communityId = communityId;\r\n    object.permission = view.permission ? view.permission : \"public\";\r\n    object.status = \"active\"\r\n    object.title = \"riseabove:\"\r\n    object.type = \"View\"\r\n    object._groupMembers = view._groupMembers;\r\n    console.log(\"OBJECT\", object);\r\n    //CONTRIBUTE RISEABOVE VIEW\r\n    api.postContribObject(communityId, object).then(response => {\r\n        riseAboveId = response._id;\r\n        console.log(\"Response\", response);\r\n        let note = {};\r\n        note.authors = object.authors;\r\n        note.buildson = null;\r\n        note.communityId = communityId;\r\n        note.data = { body: \"\" };\r\n        note.langInNote = [];\r\n        note.permission = \"protected\";\r\n        note.status = \"unsaved\";\r\n        note.title = \"\";\r\n        note.type = \"Note\";\r\n        note._groupMembers = view._groupMembers;\r\n        console.log(\"NOTE\", note);\r\n        //CONTRIBUTE RISEABOVE NOTE\r\n        api.postContribObject(communityId, note).then(noteResponse => {\r\n            console.log(\"noteResponse\", noteResponse);\r\n            riseAboveNoteId = noteResponse._id;\r\n            noteResponse.data = {\r\n                body: \"\",\r\n                riseabove: { viewId: `${riseAboveId}` }\r\n            }\r\n            noteResponse.status = \"active\";\r\n            noteResponse.title = \"Riseabove\"\r\n            console.log(\"noteResponse noteResponse\", noteResponse);\r\n            api.putObject(noteResponse, communityId, riseAboveNoteId).then(putResponse => {\r\n                //POST API LINKS\r\n                let pos = { x: 200, y: 200 }\r\n                api.postLink(viewId, riseAboveNoteId, 'contains', pos).then(res => {\r\n                    notes.forEach(note => {\r\n                        let pos = { x: 20, y: 20 }\r\n                        api.postLink(riseAboveId, note._id, 'contains', pos).then(res => {\r\n                            //EITHER AND THEN DELETE\r\n                            api.getLinkForObj(note._id).then(linkRes => {\r\n                                let links = linkRes.data;\r\n                                let link = links.filter(obj => {\r\n                                    return obj.from.includes(viewId)\r\n                                })\r\n                                api.deleteLink(link[0]._id);\r\n                            })\r\n                        })\r\n                    });\r\n                })\r\n            })\r\n        }).catch(error => {\r\n            console.log(\"error\", error);\r\n        })\r\n\r\n    }).catch(error => {\r\n        console.log(\"Error\", error);\r\n    });\r\n\r\n}\r\n","import React, { Component } from 'react';\r\nimport { Col, Row } from 'react-bootstrap';\r\nimport { connect } from 'react-redux'\r\nimport { Form, FormGroup, Input } from 'reactstrap';\r\nimport { Button, Collapse } from 'react-bootstrap';\r\nimport ListOfNotes from '../ListOfNotes.js'\r\nimport { dateFormatOptions } from '../../../store/globalsReducer'\r\nimport { newNote, updateCheckedNotes, openContribution } from '../../../store/noteReducer'\r\nimport { Breakpoint } from 'react-socks';\r\nimport { url } from '../../../store/api'\r\nimport * as access from '../../../store/access'\r\n\r\nclass Notes extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            note: {},\r\n            showNote: false,\r\n            open: false,\r\n            riseAboveData: {},\r\n            isCheckedMobile: false,\r\n        };\r\n        this.checkNote = this.checkNote.bind(this)\r\n        this.editNote = this.editNote.bind(this);\r\n        this.buildOn = this.buildOn.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n    }\r\n\r\n    buildOn = (buildOn) => {\r\n        this.props.newNote(this.props.view, this.props.communityId, this.props.authorObj._id, buildOn);\r\n    }\r\n\r\n    editNote = (contribId, mode) => {\r\n        this.props.openContribution(contribId, mode);\r\n    }\r\n\r\n    setOpen = (value) => {\r\n        this.setState((prevState) => {\r\n            return { open: !prevState.open }\r\n        })\r\n    }\r\n\r\n    checkNote = (evt, noteId) => {\r\n        this.props.updateCheckedNotes({ noteId, checked: evt.target.checked })\r\n    }\r\n\r\n    updateNoteMobile = (e, note) => {\r\n        this.setState({\r\n            isCheckedMobile: e.target.checked\r\n        })\r\n    }\r\n\r\n    render() {\r\n        const hasChildren = this.props.children && Object.keys(this.props.children).length !== 0;;\r\n        const icon = this.state.open ? \"fa-chevron-down\" : \"fa-chevron-right\"\r\n        const formatter = new Intl.DateTimeFormat('default', dateFormatOptions)\r\n        let NoteMobile;\r\n        let data = this.props.note.data.body;\r\n        //eslint-disable-next-line\r\n        while (data.includes(\"src=\\\"\\/attachments\")) {\r\n            //eslint-disable-next-line\r\n            data = data.replace(\"src=\\\"\\/attachments\", \"src=\\\"\" + url + \"\\/attachments\");\r\n        }\r\n\r\n        let EditNoteButton;\r\n        if (access.isEditable(this.props.note, this.props.authorObj) === true) {\r\n            EditNoteButton = <Button className=\"float-right\" variant=\"outline-info\" onClick={() => this.editNote(this.props.note._id, \"write\")}>Edit Note</Button>\r\n        } else {\r\n            EditNoteButton = <Button className=\"float-right\" variant=\"outline-info\" onClick={() => this.editNote(this.props.note._id, \"read\")}>Read Note</Button>\r\n        }\r\n\r\n        if (this.state.isCheckedMobile) {\r\n            NoteMobile = <div>\r\n                <Row>\r\n                    <Col>\r\n                        <Row dangerouslySetInnerHTML={{ __html: data }}></Row>\r\n                        <Row>\r\n                            <Button className=\"float-right mrg-1-left mrg-1-right\" variant=\"outline-info\" onClick={() => this.buildOn(this.props.note._id)}>BuildOn</Button>\r\n                            {EditNoteButton}\r\n                        </Row>\r\n                    </Col>\r\n                </Row>\r\n            </div>\r\n        }\r\n\r\n        return (\r\n            <>\r\n                <Breakpoint medium up>\r\n                    <div>\r\n                        <Row>\r\n                            <Col className=\"mr-auto rounded\">\r\n                                <Row className=\"pd-05\">\r\n                                    <Col md=\"10\" className=\"primary-800 font-weight-bold\">\r\n                                        {hasChildren ?\r\n                                            <Button variant='link' onClick={() => this.setOpen(!this.open)} aria-controls=\"example-collapse-text\" aria-expanded={this.state.open}>\r\n                                                <i className={`fa ${icon}`}></i>\r\n                                            </Button>\r\n                                            : null}\r\n                                        {this.props.note.title}</Col>\r\n                                    <Col md=\"2\">\r\n                                        <Form className=\"mrg-1-min pd-2-right\">\r\n                                            <FormGroup>\r\n                                                <Input type=\"checkbox\" checked={this.props.isChecked} ref={this.props.note._id} onChange={e => this.checkNote(e, this.props.note._id)} />\r\n                                            </FormGroup>\r\n                                        </Form>\r\n                                    </Col>\r\n                                </Row>\r\n                                <Row className=\"primary-600 sz-075 pd-05\">\r\n                                    <Col><span> {this.props.author} </span>&nbsp; {formatter.format(new Date(this.props.note.created))}</Col>\r\n                                    <Col md=\"2\">\r\n                                        {/* <Button onClick={() => this.buildOn(this.props.oneHirarchy.to)}>BuildOn</Button> */}\r\n                                    </Col>\r\n                                </Row>\r\n                                {this.props.children ?\r\n                                    <Collapse in={this.state.open}>\r\n                                        <Row>\r\n                                            <Col md=\"1\"></Col>\r\n                                            <Col md=\"11\">\r\n                                                <ListOfNotes hierarchy={this.props.children}></ListOfNotes>\r\n                                            </Col>\r\n                                        </Row>\r\n                                    </Collapse>\r\n                                    : null}\r\n                            </Col>\r\n                        </Row>\r\n                    </div>\r\n                </Breakpoint>\r\n\r\n                {/* MOBILE SCREEN */}\r\n                <Breakpoint small down>\r\n                    <div>\r\n                        <Row>\r\n                            <Col className=\"mr-auto rounded\">\r\n                                <Row className=\"pd-05\">\r\n                                    <Col md=\"10\" className=\"primary-800 font-weight-bold\">\r\n                                        {hasChildren ?\r\n                                            <Button variant='link' onClick={() => this.setOpen(!this.open)} aria-controls=\"example-collapse-text\" aria-expanded={this.state.open}>\r\n                                                <i className={`fa ${icon}`}></i>\r\n                                            </Button>\r\n                                            : null}\r\n                                        {this.props.note.title}</Col>\r\n                                    <Col md=\"2\">\r\n                                        <Form className=\"mrg-1-min pd-2-right\">\r\n                                            <FormGroup>\r\n                                                <Input type=\"checkbox\" checked={this.state.isCheckedMobile} ref={this.props.note._id} onChange={e => this.updateNoteMobile(e, this.props.note)} />\r\n                                            </FormGroup>\r\n                                        </Form>\r\n                                    </Col>\r\n                                </Row>\r\n                                <Row className=\"primary-600 sz-075 pd-05\">\r\n                                    <Col><span> {this.props.author} </span>&nbsp; {formatter.format(new Date(this.props.note.created))}</Col>\r\n                                    <Col md=\"2\">\r\n                                        {/* <Button onClick={() => this.buildOn(this.props.oneHirarchy.to)}>BuildOn</Button> */}\r\n                                    </Col>\r\n                                </Row>\r\n                                {this.props.children ?\r\n                                    <Collapse in={this.state.open}>\r\n                                        <Row>\r\n                                            <Col md=\"1\"></Col>\r\n                                            <Col md=\"11\">\r\n                                                <ListOfNotes hierarchy={this.props.children}></ListOfNotes>\r\n                                            </Col>\r\n                                        </Row>\r\n                                    </Collapse>\r\n                                    : null}\r\n                            </Col>\r\n                        </Row>\r\n                        {NoteMobile}\r\n                    </div>\r\n                </Breakpoint>\r\n            </>\r\n        )\r\n    }\r\n\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    const author = state.users[ownProps.note.authors[0]]\r\n    return {\r\n        author: (author && `${author.firstName} ${author.lastName}`) || 'NA',\r\n        isChecked: state.notes.checkedNotes.includes(ownProps.note._id),\r\n        riseAboveViewNotes: state.notes.riseAboveViewNotes,\r\n        riseAboveNotes: state.notes.riseAboveNotes,\r\n        view: state.globals.view,\r\n        communityId: state.globals.communityId,\r\n        authorObj: state.globals.author,\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    updateCheckedNotes,\r\n    openContribution,\r\n    newNote,\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(Notes)\r\n","import React, { Component } from 'react';\r\nimport Notes from './Notes/Notes';\r\nimport { connect } from 'react-redux'\r\nclass ListOfNotes extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.getNotes = this.getNotes.bind(this)\r\n    }\r\n\r\n    componentDidMount() {\r\n    }\r\n\r\n    getNotes() {\r\n        const notes = []\r\n        for (let noteId in this.props.hierarchy) {\r\n            if (noteId in this.props.notes)\r\n                notes.push(this.props.notes[noteId])\r\n        }\r\n        //SORT THEM\r\n        return notes.sort((a, b) => { return new Date(b.created) - new Date(a.created) })\r\n\r\n    }\r\n\r\n    render() {\r\n        const notes = this.props.noteLinks || this.getNotes()\r\n        return (<>\r\n            {\r\n                notes.map((note, i) => {\r\n                    const children = this.props.hierarchy && this.props.hierarchy[note._id].children\r\n                    return <div key={i} className=\"shadow p-1 mb-1 rounded\">\r\n                        <Notes note={note} children={children} notes={this.props.notes} />\r\n                    </div>\r\n                })\r\n            }\r\n        </>)\r\n    }\r\n\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        notes: state.notes.viewNotes,\r\n        riseAboveNotes: state.notes.riseAboveNotes\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ListOfNotes)\r\n","import React, { Component } from 'react';\r\nimport { Row, Col } from 'react-bootstrap';\r\nimport { Form, Input, InputGroup, InputGroupAddon, InputGroupText } from 'reactstrap';\r\nimport { newNote } from '../store/noteReducer.js'\r\nimport { connect } from 'react-redux'\r\nimport NoteContent from '../components/NoteContent/NoteContent'\r\nimport ListOfNotes from './ListOfNotes/ListOfNotes'\r\nimport { Breakpoint } from 'react-socks'\r\nimport '../css/index.css';\r\nimport './View.css';\r\n\r\nclass LightView extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            showView: false,\r\n            showRiseAbove: false,\r\n            filteredData: [],\r\n        };\r\n\r\n        this.getBuildOnHierarchy = this.getBuildOnHierarchy.bind(this)\r\n        this.onCloseDialog = this.onCloseDialog.bind(this);\r\n        this.onConfirmDrawDialog = this.onConfirmDrawDialog.bind(this);\r\n        this.filterResults = this.filterResults.bind(this);\r\n    }\r\n\r\n    // GET BUILDON HIERARCHY\r\n    getBuildOnHierarchy() {\r\n        const hierarchy = {}\r\n        for (let noteId in this.props.viewNotes) {\r\n            hierarchy[noteId] = { children: {} }\r\n        }\r\n        this.props.buildsOn.forEach(note => {\r\n            const parent = note.to\r\n            const child = note.from\r\n            if (!(parent in hierarchy))\r\n                hierarchy[parent] = { children: {} }\r\n            if (!(child in hierarchy))\r\n                hierarchy[child] = { parent: parent, children: {} }\r\n            else\r\n                hierarchy[child]['parent'] = parent\r\n            hierarchy[parent]['children'][child] = hierarchy[child]\r\n        })\r\n        const final_h = {}\r\n        for (let [key, value] of Object.entries(hierarchy)) {\r\n            if (!('parent' in value))\r\n                final_h[key] = value\r\n        }\r\n        return final_h\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n    }\r\n\r\n\r\n    componentDidUpdate(prevProps, prevState) {\r\n      if(this.props.searchQuery !== prevProps.searchQuery || this.props.searchFilter !== prevProps.searchFilter){\r\n        this.filterResults(this.props.searchQuery);\r\n      }\r\n    }\r\n\r\n    newRiseAbove() {\r\n        this.setState({\r\n            showView: false,\r\n            showModel: true,\r\n        })\r\n    }\r\n\r\n    onConfirmDrawDialog(drawing) {\r\n        this.props.addDrawing(drawing);\r\n        this.props.closeDrawDialog();\r\n    }\r\n\r\n    onCloseDialog(dlg) {\r\n        this.props.removeNote(dlg.noteId);\r\n        this.props.closeDialog(dlg.id);\r\n    }\r\n\r\n    filterResults(q) {\r\n        const query = q || this.props.searchQuery;\r\n        let filteredResults = [];\r\n        const notes = Object.values(this.props.viewNotes)\r\n        if (query || this.props.searchFilter) {\r\n            switch (this.props.searchFilter) {\r\n                case \"title\":\r\n                    filteredResults = notes.filter(note => note.title.toLowerCase().includes(query.toLowerCase()));\r\n                    break;\r\n\r\n                case \"content\":\r\n                    filteredResults = notes.filter(function (obj) {\r\n                        if (obj.data && obj.data.English) {\r\n                            return obj.data.English.includes(query);\r\n                        }\r\n                        else if (obj.data && obj.data.body) {\r\n                            return obj.data.body.includes(query);\r\n                        }\r\n                        return false\r\n                    });\r\n\r\n                    break;\r\n\r\n                case \"author\":\r\n                    const authors = [];\r\n                    Object.values(this.props.authors).forEach(obj => {\r\n                        const authName = `${obj.firstName} ${obj.lastName}`.toLowerCase()\r\n                        if (authName.includes(query.toLowerCase())) {\r\n                            authors.push(obj._id);\r\n                        }\r\n                    });\r\n                    filteredResults = notes.filter(note => note.authors.some(author => authors.includes(author)))\r\n\r\n                    break;\r\n                case \"scaffold\":\r\n                    const noteIds = this.props.supports.filter(support => support.from === query).map(support => support.to)\r\n                    filteredResults = notes.filter(note => noteIds.includes(note._id))\r\n                    break;\r\n\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n        this.setState({filteredData: filteredResults});\r\n    }\r\n\r\n    buildOn = (buildOn) => {\r\n        this.props.newNote(this.props.view, this.props.communityId, this.props.author._id, buildOn);\r\n    }\r\n\r\n\r\n    render() {\r\n        const hierarchy = this.getBuildOnHierarchy()\r\n        return (\r\n            <>\r\n                {/*<TopNavBar></TopNavBar>*/}\r\n                <Breakpoint medium up>\r\n\r\n                    <div className=\"row min-width\">\r\n\r\n                        {/* NOTES */}\r\n                        <Col md=\"5\" sm=\"12\" className=\"mrg-1-top pd-2-right v-scroll\">\r\n                            {this.props.searchQuery === \"\" ?\r\n                                (<ListOfNotes hierarchy={hierarchy} />)\r\n                                :\r\n                                (<ListOfNotes noteLinks={this.state.filteredData} />)\r\n                            }\r\n                        </Col>\r\n\r\n                        {/* NOTE CONTENT */}\r\n                        {this.props.checkedNotes.length ?\r\n                            (<>\r\n                                <Col md=\"5\" sm=\"12\" className=\"mrg-1-top v-scroll\">\r\n                                    <NoteContent query={this.props.searchQuery} buildOn={this.buildOn} />\r\n                                </Col>\r\n                            </>)\r\n                            : null\r\n                        }\r\n\r\n                    </div>\r\n\r\n\r\n\r\n                </Breakpoint>\r\n\r\n                <Breakpoint small down>\r\n\r\n                    <div className=\"row min-width\">\r\n\r\n                        {/* NOTES */}\r\n                        <Col md=\"5\" sm=\"12\" className=\"mrg-05-top pd-2-right primary-bg-50\">\r\n                            <Form className=\"mrg-1-bot\">\r\n                                <Row>\r\n                                    <Col>\r\n                                        <InputGroup>\r\n                                            <InputGroupAddon addonType=\"prepend\">\r\n                                                <Input type=\"select\" name=\"filter\" id=\"filter\" onChange={this.handleFilter}>\r\n                                                    <option key=\"title\" value=\"title\">Search By Title</option>\r\n                                                    <option key=\"scaffold\" value=\"scaffold\">Search By Scaffold</option>\r\n                                                    <option key=\"content\" value=\"content\">Search By Content</option>\r\n                                                    <option key=\"author\" value=\"author\">Search By Author</option>\r\n                                                </Input>\r\n                                            </InputGroupAddon>\r\n                                            <Input\r\n                                                className=\"form-control\"\r\n                                                value={this.props.searchQuery}\r\n                                                placeholder=\"Search Your Note\"\r\n                                                onChange={this.handleInputChange}\r\n                                            />\r\n\r\n                                            <InputGroupAddon addonType=\"append\">\r\n                                                <InputGroupText>\r\n                                                    <i className=\"fa fa-search\"></i>\r\n                                                </InputGroupText>\r\n                                            </InputGroupAddon>\r\n\r\n                                            <InputGroupAddon addonType=\"append\">\r\n                                                <InputGroupText style={{ cursor: \"pointer\" }} onClick={this.clearSearch} >\r\n                                                    <i className=\"fa fa-refresh\"></i>\r\n                                                </InputGroupText>\r\n                                            </InputGroupAddon>\r\n                                        </InputGroup>\r\n                                    </Col>\r\n                                </Row>\r\n                            </Form>\r\n                            {this.props.searchQuery === \"\" ?\r\n                                (<ListOfNotes hierarchy={hierarchy} />)\r\n                                :\r\n                                (<ListOfNotes noteLinks={this.state.filteredData} />)\r\n                            }\r\n                        </Col>\r\n                    </div>\r\n                </Breakpoint>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        communityId: state.globals.communityId,\r\n        viewId: state.globals.viewId,\r\n        view: state.globals.view,\r\n        author: state.globals.author,\r\n        authors: state.users,\r\n        viewNotes: state.notes.viewNotes,\r\n        checkedNotes: state.notes.checkedNotes,\r\n        buildsOn: state.notes.buildsOn,\r\n        supports: state.notes.supports,\r\n        searchQuery: state.globals.searchQuery,\r\n        searchFilter: state.globals.searchFilter,\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    newNote\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(LightView)\r\n","import React from 'react';\r\nimport {Rnd} from 'react-rnd';\r\nimport {Card, Button} from 'react-bootstrap';\r\nimport './dialog.css';\r\nconst dialog_style = {\r\n    zIndex: 999,\r\n    display: 'flex'\r\n}\r\n\r\nconst Dialog = props => {\r\n    return (\r\n            <Rnd\r\n                id={`contrib-dialog-${props.id}`}\r\n                className={\"contrib-dialog\"}\r\n                style={{...dialog_style, ...props.style}}\r\n                default={{\r\n                    x: 400 + window.pageXOffset,\r\n                    y: 50 + window.pageYOffset,\r\n                    width: 920,\r\n                    height: 500,\r\n                }}\r\n                onClick={props.onClick}\r\n                onMouseDown={props.onMouseDown}\r\n                dragHandleClassName='dlg-card-header'\r\n                bounds='window'\r\n            >\r\n                <Card className='dlg-card'>\r\n                    <Card.Header className='dlg-card-header py-0' style={{alignItems: 'center', display: 'flex'}}>\r\n                        <span>{props.title}</span>\r\n                        <Button onClick={props.onClose} variant='link' size='sm' style={{marginLeft:'auto'}}>x</Button>\r\n                    </Card.Header>\r\n                    <Card.Body className='dlg-card-body' style={{position: 'relative'}}>\r\n                        {props.children}\r\n                    </Card.Body>\r\n                    <Card.Footer className=\"dlg-card-footer py-0\">\r\n                        <Button size='sm' className=\"dlg-button\"\r\n                            onClick={props.onConfirm}\r\n                            disabled={false ||!props.editable}\r\n                        >\r\n                            Contribute\r\n                        </Button>\r\n                        {props.buildon ?\r\n                         <Button size='sm' className=\"dlg-button\"\r\n                                 onClick={props.onBuildOnClick}>\r\n                             Build-on\r\n                         </Button>\r\n                        : ''}\r\n                    </Card.Footer>\r\n                </Card>\r\n            </Rnd>\r\n    )\r\n}\r\n\r\nexport default Dialog;\r\n","import React from 'react';\r\nimport Dialog from '../dialog/Dialog.js'\r\n\r\nclass DrawTool extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.onConfirm = this.onConfirm.bind(this);\r\n        this.onLoad = this.onLoad.bind(this);\r\n        this.getIframeRef = this.getIframeRef.bind(this);\r\n    }\r\n\r\n    onConfirm(){\r\n        var wnd1 = this.iframe_ref.contentWindow;\r\n        var bg = wnd1.svgCanvas.current_drawing_.all_layers[0];\r\n        var wnd2 = wnd1.svgCanvas.current_drawing_.all_layers[1];\r\n\r\n        var widd = wnd2[1].getBBox().width;\r\n        var heig = wnd2[1].getBBox().height;\r\n        if (widd === 0 || heig === 0){\r\n            this.props.onClose()\r\n            return;\r\n        }\r\n\r\n        wnd1.svgCanvas.current_drawing_.svgElem_.setAttribute(\"width\", widd);\r\n        wnd1.svgCanvas.current_drawing_.svgElem_.setAttribute(\"height\", heig);\r\n        bg[1].childNodes[1].setAttribute(\"width\", widd);\r\n        bg[1].childNodes[1].setAttribute(\"height\", heig);\r\n        wnd1.svgCanvas.selectAllInCurrentLayer();\r\n        wnd1.svgCanvas.groupSelectedElements();\r\n        wnd1.svgCanvas.alignSelectedElements('l', 'page');\r\n        wnd1.svgCanvas.alignSelectedElements('t', 'page');\r\n        wnd1.svgCanvas.ungroupSelectedElement();\r\n        wnd1.svgCanvas.clearSelection();\r\n        wnd1.svgCanvas.current_drawing_.svgElem_.setAttribute(\"padding\", '2em');\r\n        wnd1.svgCanvas.setResolution('fit', 100);\r\n        var svg = wnd1.svgCanvas.getSvgString();\r\n\r\n        var canvas = document.createElement(\"canvas\");\r\n\r\n        canvas.width = widd + 4;\r\n        canvas.height = heig + 4;\r\n\r\n        var ctx = canvas.getContext(\"2d\");\r\n\r\n        var img = document.createElement(\"img\");\r\n\r\n        img.setAttribute(\"src\", \"data:image/svg+xml;base64,\" + btoa(svg));\r\n\r\n        img.onload = function () {\r\n            ctx.drawImage(img, 0, 0);\r\n            var p = canvas.toDataURL(\"image/png\");\r\n            const drawing = \"<img alt='\" + svg + \"' src='\" + p + \"'/>\";\r\n\r\n            this.props.onConfirm(drawing);\r\n        }.bind(this);\r\n    }\r\n\r\n    getIframeRef(frame) {\r\n        if(!frame) {\r\n            return\r\n        }\r\n        this.iframe_ref = frame\r\n    }\r\n\r\n    onLoad(e){\r\n        const svg = this.props.svg\r\n        if (svg){\r\n            e.target.contentWindow.svgCanvas.setSvgString(svg)\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Dialog\r\n                title='DrawTool'\r\n                style={{zIndex: 3000}}\r\n                onClose={this.props.onClose}\r\n                onConfirm={this.onConfirm}\r\n                editable={true}\r\n                confirmButton='Add'>\r\n\r\n                <iframe onLoad={this.onLoad} title='DrawingTool' src='/drawing-tool/svg/index.html' ref={this.getIframeRef} width='100%' height='100%'></iframe>\r\n            </Dialog>\r\n        )\r\n    }\r\n}\r\n\r\nexport default DrawTool\r\n","import React from 'react';\r\nimport { Editor } from '@tinymce/tinymce-react';\r\n/* import './editor.css' */\r\n\r\nclass MCEditor extends React.Component {\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <Editor\r\n                    value={this.props.value}\r\n                    apiKey=\"arg05azt52qbujpnf831szuswhmyhoqute0q48btk5bqigoj\"\r\n                    init={{\r\n                        setup: (editor) => {this.props.onEditorSetup(editor)},\r\n                        content_css: '/editor.css',\r\n                        height: 300,\r\n                        menubar: false,\r\n                        statusbar: false,\r\n                        media_live_embeds: true,\r\n                        plugins: [\r\n                            'advlist autolink lists link image charmap print preview anchor',\r\n                            'searchreplace visualblocks code fullscreen',\r\n                            'insertdatetime media table paste code wordcount media help'\r\n                        ],\r\n                        external_plugins: {\r\n                            'drawingTool': '/drawing-tool/plugin.min.js'\r\n                        },\r\n                        toolbar: 'styleselect | bold italic underline strikethrough | forecolor backcolor bullist numlist | link code | ltr rtl | charmap | drawingTool media'\r\n                    }}\r\n                    onEditorChange={this.props.onEditorChange}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default MCEditor;\r\n","\r\nconst newScaffoldTag = (supportId, title, isTemplate, addHyphen) => (initText) => {\r\n\r\n    let supportContentId = new Date().getTime().toString();\r\n    var contentTagStr = '<span id=\"' + supportContentId + '\"></span>';\r\n    var text = contentTagStr + initText;\r\n    if (addHyphen) {\r\n        text = ' -&nbsp;' + text + '&nbsp;- ';\r\n    }\r\n\r\n    var tag = '';\r\n    tag = tag + '<br>';\r\n    tag = tag + '&nbsp;&nbsp;'; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportStart mceNonEditable\">';\r\n    } else {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportStart KFTemplateStart mceNonEditable\">';\r\n    }\r\n    tag = tag + createScaffoldStartTag(title, isTemplate);\r\n    tag = tag + '</span>';\r\n    if (isTemplate) {\r\n        tag = tag + '<p class=\"kfTemplateContent\">';\r\n        tag = tag + '<br><br><br><br>';\r\n    }\r\n    tag = tag + text;\r\n    if (isTemplate) {\r\n        tag = tag + '</p>';\r\n    }\r\n    if (!isTemplate) {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportEnd mceNonEditable\">';\r\n    } else {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportEnd KFTemplateEnd mceNonEditable\">';\r\n    }\r\n    tag = tag + createScaffoldEndTag(isTemplate);\r\n    tag = tag + '</span>';\r\n    tag = tag + '&nbsp;&nbsp;'; //important for mce\r\n    tag = tag + '<br>';\r\n    return {tag, supportContentId};\r\n};\r\n\r\nconst createNewScaffoldTag = function(supportId, title, text, isTemplate) {\r\n    var tag = '';\r\n    tag = tag + '<br>';\r\n    tag = tag + '&nbsp;&nbsp;'; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportStart mceNonEditable\">';\r\n    } else {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportStart KFTemplateStart mceNonEditable\">';\r\n    }\r\n    tag = tag + createScaffoldStartTag(title, isTemplate);\r\n    tag = tag + '</span>';\r\n    if (isTemplate) {\r\n        tag = tag + '<p class=\"kfTemplateContent\">';\r\n        tag = tag + '<br><br><br><br>';\r\n    }\r\n    tag = tag + text;\r\n    if (isTemplate) {\r\n        tag = tag + '</p>';\r\n    }\r\n    if (!isTemplate) {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportEnd mceNonEditable\">';\r\n    } else {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportEnd KFTemplateEnd mceNonEditable\">';\r\n    }\r\n    tag = tag + createScaffoldEndTag(isTemplate);\r\n    tag = tag + '</span>';\r\n    tag = tag + '&nbsp;&nbsp;'; //important for mce\r\n    tag = tag + '<br>';\r\n    return tag;\r\n};\r\n\r\n\r\nconst createScaffoldStartTag = function(title, isTemplate) {\r\n    var tag = '';\r\n    tag = tag + ' '; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span class=\"kfSupportStartMark\"> &nbsp; </span>';\r\n    } else {\r\n        tag = tag + '<span class=\"kfSupportStartMark kfTemplateStartMark\"> &nbsp; </span>';\r\n    }\r\n    tag = tag + ' '; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span class=\"kfSupportStartLabel\">' + title + '</span>';\r\n    } else {\r\n        tag = tag + '<span class=\"kfSupportStartLabel kfTemplateStartLabel\">' + title + '</span>';\r\n    }\r\n    tag = tag + ' '; //important for mce\r\n    return tag;\r\n};\r\n\r\nconst createScaffoldEndTag = function(isTemplate) {\r\n    var tag = '';\r\n    tag = tag + ' '; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span class=\"kfSupportEndMark\"> &nbsp; </span>';\r\n    } else {\r\n        tag = tag + '<span class=\"kfSupportEndMark kfTemplateEndMark\"> &nbsp; </span>';\r\n    }\r\n    tag = tag + ' '; //important for mce\r\n    return tag;\r\n};\r\n\r\nexport default { createNewScaffoldTag, newScaffoldTag }\r\n","import React from 'react';\r\nimport {Form, Container, Row, Col} from 'react-bootstrap';\r\nimport { connect } from 'react-redux'\r\nimport {fetchScaffolds} from '../../store/scaffoldReducer.js'\r\nimport scaffoldService from './scaffold.service'\r\nimport './scaffold.css'\r\n\r\nclass ScaffoldSelect extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {selected: props.initVal};\r\n        this.onSelectChange = this.onSelectChange.bind(this);\r\n    }\r\n\r\n\r\n    componentDidMount() {\r\n        if (!this.props.fetched){\r\n            const {communityId, contextId} = this.props;\r\n            this.props.fetchScaffolds(communityId, contextId);\r\n        }\r\n    }\r\n\r\n    onSelectChange(event) {\r\n        this.setState({selected: event.target.value});\r\n    }\r\n\r\n    scaffoldSelected = (scaffoldId, support) => {\r\n        if (this.props.returnSupport){\r\n            this.props.onScaffoldSelected(support)\r\n            return\r\n        }\r\n        const scaffold = this.props.items[scaffoldId];\r\n        let addhyphen = true;\r\n        let initialText = '';\r\n        const isTemplate = scaffold.data && scaffold.data.isTemplate\r\n        if (isTemplate) {\r\n            addhyphen = false;\r\n            initialText = '<br><br>'\r\n        }\r\n\r\n        const scaffold_text = support._to.title\r\n        const tagCreator = scaffoldService.newScaffoldTag(support.to, scaffold_text, isTemplate, addhyphen);\r\n        this.props.onScaffoldSelected(tagCreator, initialText)\r\n    }\r\n\r\n    render() {\r\n        const scaffolds = this.props.items;\r\n        const options = scaffolds.map((scaffold, i) =>\r\n            <option key={i} value={i}>{scaffold.title}</option>\r\n        );\r\n        let supports = '';\r\n        if (scaffolds.length && scaffolds[this.state.selected].supports) {\r\n            supports = scaffolds[this.state.selected].supports.map((support, i) =>\r\n                <Col className=\"mt-1 p-0\" key={i} md={12}>\r\n                    <div className='KFSupportButton' size='sm' onClick={() => this.scaffoldSelected(this.state.selected, support) }>\r\n                        {support._to.title}\r\n                    </div>\r\n                </Col>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <Container>\r\n                <Row>\r\n                    <Col className='p-0'>\r\n                        <Form>\r\n                            <Form.Group className='mb-1' controlId=\"exampleForm.ControlSelect2\">\r\n                                <Form.Control className=\"scaffold-select-input\" size='sm' as=\"select\" onChange={this.onSelectChange}>\r\n                                    {options}\r\n                                </Form.Control>\r\n                            </Form.Group>\r\n                        </Form>\r\n                    </Col>\r\n                </Row>\r\n                <Row>\r\n                    {supports}\r\n                </Row>\r\n            </Container>\r\n\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        communityId: state.globals.communityId,\r\n        contextId: state.globals.contextId,\r\n        ...state.scaffolds\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = { fetchScaffolds }\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ScaffoldSelect)\r\n","import React, {useState} from 'react';\r\nimport {useSelector} from 'react-redux'\r\nimport { Row, Col, Button} from 'react-bootstrap'\r\nimport {url as serverUrl} from '../../store/api'\r\nimport './attachArea.css'\r\n\r\nconst AttachArea = props => {\r\n\r\n    const attachments = useSelector(state => {\r\n        const atts = []\r\n        props.attachments.forEach((attId) => {\r\n            const att = state.notes.attachments[attId]\r\n            if (att){ atts.push(att) }\r\n        })\r\n        return atts;\r\n    })\r\n    const [selectedImgs, setSelectedImgs] = useState([])\r\n    const getFileNameString = (name) => {\r\n       return name\r\n    }\r\n\r\n    const getFileSizeString = (size) => {\r\n        return size\r\n    }\r\n\r\n    const addImages = () => {\r\n        const  selectedImgs = Array.from(document.getElementById(`attachbox-${props.noteId}`).getElementsByClassName(\"selected\"))\r\n        if (selectedImgs.length === 0) {\r\n            return;\r\n        }\r\n        let html = \"\";\r\n        const maxWidth = 200;\r\n        selectedImgs.forEach((img) => {\r\n            const tagName = img.tagName;\r\n            let width = img.naturalWidth;\r\n            if(width > maxWidth){\r\n                width = maxWidth;\r\n            }\r\n            if (tagName === 'IMG') {\r\n                const data_mce_src = img.getAttribute(\"src\");\r\n                let className = '';\r\n                img.classList.forEach(cls_name => {\r\n                    if (cls_name.length === 24) { //Find 24 char long classes, one of them might be MongoDB id\r\n                        className += cls_name + ' ';\r\n                    }\r\n                })\r\n                html += '<img class=\"inline-attachment ' + className + '\" src=\"' + data_mce_src + '\" width=\"' + width + 'px\" alt=\"\" data-mce-src=\"' + data_mce_src + '\">';\r\n            }\r\n\r\n        })\r\n        props.onNewInlineAttach(html)\r\n\r\n    }\r\n    const selectedImg = (attId, e) => {\r\n        if (selectedImgs.includes(attId)){\r\n            setSelectedImgs((imgs) => imgs.filter( img => img !== attId))\r\n        }else{\r\n            setSelectedImgs((imgs) => [...imgs, attId])\r\n        }\r\n    }\r\n    const deleteAttachment = (attId) => {\r\n        if (window.confirm('Are you sure to delete the attachment?')) {\r\n            props.onAttachDelete(attId)\r\n        }\r\n    }\r\n    return (\r\n        <Col>\r\n            <Row>\r\n                <Col>\r\n                    <span className=''>Insert image or file: </span>\r\n                    <Button className='attach-button mx-2' size='sm' variant='outline-dark' onClick={()=> props.onNewAttachClick(true)}>Inline</Button>\r\n                    <Button className='attach-button mx-2' size='sm' variant='outline-dark' onClick={()=>props.onNewAttachClick(false)}>As an attachment</Button>\r\n                    <Button className='attach-button mx-2' size='sm' variant='outline-dark' onClick={addImages} disabled={selectedImgs.length === 0}>Insert</Button>\r\n                </Col>\r\n            </Row>\r\n            <Row id={`attachbox-${props.noteId}`} className='attachment-box'>\r\n                {\r\n                    attachments.map((attachment) => (\r\n                            <div key={attachment._id} className=\"attachment-inner-box col-auto\">\r\n                                <div className=\"attachment-thumbnail\">\r\n                                    {\r\n                                        attachment.data.type.indexOf('image/') === 0 ?\r\n                                        <img className={attachment._id + \" \" + (selectedImgs.includes(attachment._id) ? 'selected' : '')} src={`${serverUrl}${attachment.data.url}`} onClick={(e) => selectedImg(attachment._id, e)} alt='attachment'/>\r\n                                        :\r\n                                        <a href={`${serverUrl}${(attachment.data.downloadUrl || attachment.data.url)}`} title={attachment.title} download>\r\n                                            <img className={attachment._id} src={`${serverUrl}/manual_assets/kf6images/03-toolbar-attachment.png`}\r\n                                                 title=\"{attachment.title}\" alt='attachment' />\r\n                                        </a>\r\n                                    }\r\n                                </div>\r\n                                <div className=\"attachment-buttons\">\r\n                                    <p>\r\n                                        <a href={`${serverUrl}${(attachment.data.downloadUrl || attachment.data.url)}`}\r\n                                           title={attachment.title} download>\r\n                                            <img className=\"download-attachment\" src={`${serverUrl}/manual_assets/kf6images/cloud-download-2x.png`}\r\n                                                 alt=\"Download\" height=\"15px\" />\r\n                                        </a>\r\n                                    </p>\r\n                                    <p>\r\n                                        <button className=\"delete-attachment\" onClick={() => deleteAttachment(attachment._id)}>\r\n                                            <img src={`${serverUrl}/manual_assets/kf6images/trash.png`} alt='Delete attachment' width=\"10px\" height=\"15px\"/>\r\n                                        </button>\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"attachment-info\">\r\n                                    <p title=\"{attachment.title}\">{getFileNameString(attachment.title)}</p>\r\n                                    <p>{getFileSizeString(attachment.data.size)}</p>\r\n                                </div>\r\n                            </div>\r\n                ))\r\n                }\r\n            </Row>\r\n        </Col>\r\n    )\r\n\r\n};\r\n\r\nexport default AttachArea;\r\n","import React from 'react';\r\nimport MCEditor from '../editor/MCEditor'\r\nimport AttachPanel from '../attachmentCollapse/AttachPanel.js'\r\nimport {Container, Row, Col, Form} from 'react-bootstrap'\r\nimport ScaffoldSelect from '../scaffold/ScaffoldSelect'\r\nimport AttachArea from '../attachmentArea/AttachArea.js'\r\n\r\nimport './WriteTab.css';\r\nclass WriteTab extends React.Component {\r\n\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {inlineAttach: true, attachPanel: false}\r\n        this.onScaffoldSelected = this.onScaffoldSelected.bind(this);\r\n        this.onNewAttachmentClick = this.onNewAttachmentClick.bind(this);\r\n        this.closeAttachPanel = this.closeAttachPanel.bind(this);\r\n        this.onNewInlineAttach = this.onNewInlineAttach.bind(this);\r\n        this.onAttachDelete = this.onAttachDelete.bind(this)\r\n    }\r\n\r\n    onScaffoldSelected(tagCreator, initialText){\r\n        this.props.onChange({scaffold: {tagCreator, initialText}})\r\n    }\r\n\r\n    onNewAttachmentClick(inline){\r\n        this.setState({inlineAttach: inline, attachPanel: true})\r\n    }\r\n    onNewInlineAttach(inlineAttach) {\r\n        this.props.onChange({attach: inlineAttach})\r\n    }\r\n    closeAttachPanel()  {\r\n        this.setState({attachPanel: false})\r\n    }\r\n    onAttachDelete(attachId) {\r\n        this.props.onChange({deleteAttach: attachId})\r\n    }\r\n    render() {\r\n        const {note, onChange, onEditorSetup} = this.props;\r\n        return (\r\n            <Container className='write-container p-0'>\r\n                    <Row>\r\n                        <Col>\r\n                            <Form.Group className=\"write-title-form\" controlId=\"note-title\">\r\n                                <Form.Control type=\"text\"\r\n                                              className=\"write-tab-input\"\r\n                                              size=\"sm\"\r\n                                              placeholder=\"Enter title\"\r\n                                              value={note.title}\r\n                                              onChange={(val) => {onChange({title: val.target.value})}}/>\r\n                            </Form.Group>\r\n                        </Col>\r\n                    </Row>\r\n                    <Row>\r\n                        <Col md={2} className='pr-0'>\r\n                            <ScaffoldSelect initVal={0} onScaffoldSelected={this.onScaffoldSelected}/>\r\n                        </Col>\r\n                        <Col md={10}>\r\n                            <MCEditor value={note.data.body}\r\n                                      onEditorSetup={onEditorSetup}\r\n                                      onEditorChange={(content, editor) => onChange({ data: {body: content}})}/>\r\n                            <div className='wordcount-bar text-right'>{note.wordCount} words</div>\r\n\r\n                        </Col>\r\n                    </Row>\r\n                    <Row className='mt-2'>\r\n                        <AttachPanel noteId={note._id} onClose={this.closeAttachPanel} onNewInlineAttach={this.onNewInlineAttach} {...this.state}></AttachPanel>\r\n                        <AttachArea\r\n                            noteId={note._id}\r\n                            attachments={note.attachments}\r\n                            onNewAttachClick={this.onNewAttachmentClick}\r\n                            onNewInlineAttach={this.onNewInlineAttach}\r\n                            onAttachDelete={this.onAttachDelete}\r\n                        >\r\n                        </AttachArea>\r\n                    </Row>\r\n            </Container>\r\n        )\r\n    }\r\n}\r\n\r\nexport default WriteTab;\r\n","import React from 'react';\r\n\r\nconst History = props => {\r\n\r\n    const [read, edit] = props.records.reduce(\r\n        (acc, el) => {\r\n            if (el.type === 'read') {\r\n                acc[0].push(el)\r\n            }else{\r\n                acc[1].push(el)\r\n            }\r\n            return acc\r\n        }, [[],[]])\r\n    return (\r\n        <div>\r\n            <h5>Edit logs:</h5>\r\n            <p className='mb-0'>{edit.length} edits</p>\r\n            <ul>\r\n                {edit.map((record) =>\r\n                    <li key={record._id}>{record.date}: {record.author}</li>\r\n                )}\r\n            </ul>\r\n            <h5>Read logs:</h5>\r\n            <p className='mb-0'>{read.length} reads</p>\r\n            <ul>\r\n                {read.map((record) =>\r\n                    <li key={record._id}>{record.date}: {record.author}</li>\r\n                )}\r\n            </ul>\r\n        </div>\r\n    )\r\n\r\n}\r\n\r\nexport default History\r\n","import React from 'react';\r\n\r\nconst Properties = props => {\r\n\r\n    const onPermissionChange = (evt) => {\r\n        props.onChange({permission: evt.target.value})\r\n    }\r\n    //TODO\r\n    const isTemplateChange = (evt) => {\r\n        props.onChange({data: {isTemplate: evt.target.checked}})\r\n    }\r\n\r\n    return (\r\n        <div className=\"m-2\">\r\n            <div>\r\n                <label className='mt-1 font-weight-bold'>Permission:</label>\r\n                <div>\r\n                    <table className=\"KFPermission table table-sm\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>&nbsp;</th>\r\n                                <th>Authors</th>\r\n                                <th>Group Members</th>\r\n                                <th>Others</th>\r\n                            </tr>\r\n                        </thead>\r\n                                <tbody>\r\n                                    <tr>\r\n                                        <td>\r\n                                            <form action=\"\">\r\n                                                <div className=\"form-check form-check-inline\">\r\n                                                    <input className=\"form-check-input\" type=\"radio\" name='permission' value=\"private\" id=\"contrib-permission1\"\r\n                                                           onChange={onPermissionChange} checked={props.contribution.permission === 'private'}\r\n                                                    />\r\n                                                        <label className=\"form-check-label font-weight-normal\" htmlFor=\"contrib-permission1\">\r\n        &nbsp;private\r\n                                                        </label>\r\n                                                </div>\r\n                                            </form>\r\n                                        </td>\r\n                                        <td>rw</td>\r\n                                        <td>rw</td>\r\n                                        <td>-</td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <td>\r\n                                            <form action=\"\">\r\n                                                <div className=\"form-check form-check-inline\">\r\n                                                    <input className=\"form-check-input\" type=\"radio\" value=\"protected\" id=\"contrib-permission2\" name='permission'\r\n                                                           onChange={onPermissionChange} checked={props.contribution.permission === 'protected'}\r\n                                                    />\r\n                                                        <label className=\"form-check-label font-weight-normal\" htmlFor=\"contrib-permission2\">\r\n        &nbsp;protected\r\n                                                        </label>\r\n                                                </div>\r\n                                            </form>\r\n                                        </td>\r\n                                        <td>rw</td>\r\n                                        <td>rw</td>\r\n                                        <td>r</td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <td>\r\n                                            <form action=\"\">\r\n                                                <div className=\"form-check form-check-inline\">\r\n                                                    <input className=\"form-check-input\" type=\"radio\" value=\"public\" id=\"contrib-permission3\" name='public'\r\n                                                           onChange={onPermissionChange} checked={props.contribution.permission === 'public'}\r\n                                                    />\r\n                                                        <label className=\"form-check-label font-weight-normal\" htmlFor=\"contrib-permission3\">\r\n        &nbsp;public\r\n                                                        </label>\r\n                                                </div>\r\n                                            </form>\r\n                                        </td>\r\n                                        <td>rw</td>\r\n                                        <td>rw</td>\r\n                                        <td>rw</td>\r\n                                    </tr>\r\n                                </tbody>\r\n                    </table>\r\n                </div>\r\n                <label className=\"mt-1 font-weight-bold\">Status:</label>\r\n                <div className=\"ml-2\">\r\n                    {props.contribution.status}\r\n                </div>\r\n                <label className=\"mt-2 font-weight-bold\">Template:</label>\r\n                <form className=\"ml-2\" action=\"\">\r\n                    <div className=\"form-check  form-check-inline\">\r\n                        <input className=\"form-check-input\" type=\"checkbox\" id=\"c-isTemplate\" checked={props.contribution.data.isTemplate} onChange={isTemplateChange}/>\r\n\r\n                            <label className=\"form-check-label font-weight-normal\" htmlFor=\"c-isTemplate\">\r\n                                isTemplate\r\n                            </label>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n            {/* { props.contribution.type === 'Note' &&\r\n                (<div>\r\n                <label className=\"mt-1 mr-1 font-weight-bold\">Riseabove:</label>\r\n                {\r\n                (props.contribution.type === 'Note' && props.contribution.data && props.contribution.data.riseabove && props.contribution.data.riseabove.viewId) ?\r\n\r\n                \"This note has riseabove view. Please look it at 'Read' tab.\"\r\n                :\r\n\r\n                <button type=\"submit\" className=\"btn btn-primary btn-sm\" onClick={makeRiseAbove()}>MakeRiseabove</button>\r\n                }\r\n                </div>)\r\n                } */}\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nexport default Properties\r\n","import React, {useState} from 'react';\r\nimport {Button, Row, Col} from 'react-bootstrap'\r\nimport Select from 'react-select'\r\nconst AuthorSelect = props => {\r\n    const select_options = Object.entries(props.authors).map(\r\n        (auth) => { return {value: auth[1]._id, label: `${auth[1].firstName} ${auth[1].lastName}`} })\r\n\r\n    const [selectedOption, setSelectedOption] = useState(null);\r\n    const handleChange = selected => {\r\n        setSelectedOption(selected)\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <Row>\r\n                <Col>\r\n                    <Select options={select_options} onChange={handleChange} isClearable={true}/>\r\n                </Col>\r\n                <Col md='auto'>\r\n                    <Button disabled={!selectedOption}\r\n                        onClick={() => props.onAuthorSelected(selectedOption)}>Add</Button>\r\n                </Col>\r\n            </Row>\r\n            <p>{select_options.length} possible author(s) in this community.</p>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AuthorSelect\r\n","import React from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { Button, Col, Row } from 'react-bootstrap'\r\nimport { addNotification } from '../../store/notifier.js'\r\nimport AuthorSelect from '../authorSelect/AuthorSelect'\r\nimport Select from 'react-select'\r\n\r\nconst AuthorTab = props => {\r\n    const authors = useSelector((state) => props.contrib.authors.map((auth) => state.users[auth]))\r\n    const communityAuthors = useSelector((state) => state.users)\r\n    const groups = useSelector((state) => state.globals.community.groups)\r\n    const group_options = groups.map((g) => ({value: g._id, label: g.title}))\r\n    const contribGroup = groups.find(group => group._id === props.contrib.group)\r\n    const g = contribGroup ? {value: contribGroup._id, label: contribGroup.title} : {value: null, label: 'No Group selected'}\r\n\r\n\r\n    const removeAuthor = (author, idx) => {\r\n        if (idx === 0) {\r\n            addNotification({title: 'Error!', type:'danger', message:'cannot remove the Primary Author'})\r\n            return;\r\n        }else if (idx >= 0) {\r\n            props.onChange({authors: props.contrib.authors.filter(auth => auth !== author._id)})\r\n        }\r\n    }\r\n\r\n    const addAuthor = (author) => {\r\n        if (!props.contrib.authors.includes(author.value)){\r\n            props.onChange({authors: [...props.contrib.authors, author.value]})\r\n        }\r\n    }\r\n\r\n    const selectGroup = (selected) => {\r\n        props.onChange({group: selected && selected.value})\r\n    }\r\n\r\n    //TODO\r\n    const isEditable = () => {\r\n        return true\r\n    }\r\n    return (\r\n                <div className=\"authorTab mt-2\" style={{height: '100%'}}>\r\n                    <Row>\r\n                        <Col>\r\n                            <h5>Authors:</h5>\r\n                            <ul>\r\n                                {\r\n                                    authors.map((author, idx) => (\r\n\r\n                                        <li key={author._id} style={{cursor: 'move'}}>\r\n                                            {author.firstName} {author.lastName}\r\n                                            <Button size='sm' className='ml-1'\r\n                                                    onClick={() => removeAuthor(author, idx)}>x</Button>\r\n                                        </li>\r\n\r\n                                    ))\r\n                                }\r\n                            </ul>\r\n                        </Col>\r\n                        <Col>\r\n                            <div>\r\n                                <h5>Add author:</h5>\r\n                                <AuthorSelect authors={communityAuthors} onAuthorSelected={addAuthor}/>\r\n                            </div>\r\n                        </Col>\r\n                    </Row>\r\n                    <Row>\r\n                        <Col>\r\n                            <h5>Group:</h5>\r\n                            <div>\r\n                                {\r\n                                    isEditable()?\r\n                                    <form method=\"\" id=\"\" action=\"\">\r\n                                        <Select value={g} options={group_options} onChange={selectGroup} isClearable={true}/>\r\n                                    </form>\r\n                                    :\r\n                                    <div>{g.label}</div>\r\n                                }\r\n                            </div>\r\n                        </Col>\r\n                    </Row>\r\n                </div>\r\n\r\n    )\r\n}\r\n\r\nexport default AuthorTab\r\n","/*global Annotator*/\r\n/*global $*/\r\nimport tinymce from 'tinymce/tinymce';\r\nimport ReactDOM from 'react-dom';\r\n// Default icons are required for TinyMCE 5.3 or above\r\nimport 'tinymce/icons/default';\r\n\r\n// A theme is also required\r\nimport 'tinymce/themes/silver';\r\n// Any plugins you want to use has to be imported\r\nimport 'tinymce/plugins/media';\r\nimport 'tinymce/plugins/image';\r\nimport 'tinymce/plugins/insertdatetime';\r\nimport 'tinymce/plugins/link';\r\nimport 'tinymce/plugins/code';\r\n\r\nexport const setKFPlugin = (elem, annotatorHandler, uname, scaffoldElement) => {\r\n    Annotator.Plugin.KFPlugin = function( /*element*/ ) {\r\n        return {\r\n            pluginInit: function() {\r\n                this.annotator\r\n                    .subscribe('annotationCreated', function(annotation) {\r\n                        if (annotatorHandler) {\r\n                            annotatorHandler.annotationCreated(annotation);\r\n                        }\r\n                    })\r\n                    .subscribe('annotationUpdated', function(annotation) {\r\n                        if (annotatorHandler) {\r\n                            annotatorHandler.annotationUpdated(annotation);\r\n                        }\r\n                    })\r\n                    .subscribe('annotationDeleted', function(annotation) {\r\n                        if (annotatorHandler) {\r\n                            annotatorHandler.annotationDeleted(annotation);\r\n                        }\r\n                    })\r\n                    .subscribe('annotationEditorShown', function(editor, annotation){\r\n                        if (annotatorHandler) {\r\n                            annotatorHandler.displayEditor(editor, annotation);\r\n                        }\r\n                    })\r\n                    .subscribe('annotationViewerShown', function(viewer, annotations) {\r\n                        if (annotatorHandler) {\r\n                            annotatorHandler.displayViewer(viewer, annotations);\r\n                        }\r\n                    })\r\n                    .subscribe('annotationEditorHidden', function(editor, annotation){\r\n                        if (annotatorHandler) {\r\n                            annotatorHandler.editorHidden(editor, annotation);\r\n                        }\r\n                    })\r\n\r\n                ;\r\n\r\n                if (annotatorHandler) {\r\n                    annotatorHandler.annotatorInitialized(this.annotator);\r\n                }\r\n            }\r\n        };\r\n    };\r\n\r\n\r\n    //----------------------------Rich Text Annotator Plugin: START -----------------------------\r\n    /*\r\n      Rich Text Annotator Plugin v1.0 (https://github.com/danielcebrian/richText-annotator)\r\n      Copyright (C) 2014 Daniel Cebrin Robles\r\n      License: https://github.com/danielcebrian/richText-annotator/blob/master/License.rst\r\n      This program is free software; you can redistribute it and/or\r\n      modify it under the terms of the GNU General Public License\r\n      as published by the Free Software Foundation; either version 2\r\n      of the License, or (at your option) any later version.\r\n      This program is distributed in the hope that it will be useful,\r\n      but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n      GNU General Public License for more details.\r\n      You should have received a copy of the GNU General Public License\r\n      along with this program; if not, write to the Free Software\r\n      Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n    */\r\n    // Generated by CoffeeScript 1.6.3\r\n    /* jshint ignore:start */\r\n    var _ref,\r\n        // __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\r\n        __hasProp = {}.hasOwnProperty,\r\n        __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\r\n\r\n\r\n    Annotator.Plugin.RichText = (function(_super) {\r\n        __extends(RichText, _super);\r\n\r\n\r\n        // FILE - GLOBALS -----\r\n        var editorId =\"\";\r\n\r\n        //----------------------\r\n        //Default tinymce configuration\r\n        RichText.prototype.options = {\r\n            tinymce:{\r\n                selector: \"li.annotator-item textarea\",\r\n                content_css: '/editor.css',\r\n                height:\"170px\",\r\n                statusbar: false,\r\n                plugins: \"media image insertdatetime link code\",\r\n                menubar: false,\r\n                toolbar_items_size: 'small',\r\n                extended_valid_elements : \"iframe[src|frameborder|style|scrolling|class|width|height|name|align|id]\",\r\n                toolbar: \"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | code | mysidebar\",\r\n            }\r\n        };\r\n\r\n        function RichText(element,options) {\r\n            _ref = RichText.__super__.constructor.apply(this, arguments);\r\n            return _ref;\r\n        }\r\n\r\n\r\n        RichText.prototype.pluginInit = function() {\r\n            var annotator = this.annotator,\r\n                editor = this.annotator.editor;\r\n            //Check that annotator is working\r\n            if (!Annotator.supported()) {\r\n                return;\r\n            }\r\n\r\n            //Editor Setup\r\n            annotator.editor.addField({\r\n                type: 'input',\r\n                load: this.updateEditor,\r\n            });\r\n\r\n            //Viewer setup\r\n            annotator.viewer.addField({\r\n                load: this.updateViewer,\r\n            });\r\n\r\n\r\n            annotator.subscribe(\"annotationEditorShown\", function(){\r\n                // $(annotator.editor.element).find('.mce-tinymce')[0].style.display='block';\r\n                // $(annotator.editor.element).find('.mce-container').css('z-index',3000000000);\r\n                // annotator.editor.checkOrientation();\r\n            });\r\n            annotator.subscribe(\"annotationEditorHidden\", function(){\r\n                // $(annotator.editor.element).find('.mce-tinymce')[0].style.display='none';\r\n                // $(annotator.editor.element).find(\"#annoSide\").remove();\r\n            });\r\n\r\n            //set listener for tinymce;\r\n            this.options.tinymce.setup = function(ed) {\r\n                RichText.prototype.mceditor = ed\r\n                ed.on('change', function(e) {\r\n                    //set the modification in the textarea of annotator\r\n                    $(editor.element).find('textarea')[0].value = tinymce.activeEditor.getContent();\r\n                });\r\n                ed.on('Init', function(ed){\r\n                    $('.mce-container').css('z-index','3090000000000000000');\r\n\r\n                });\r\n                ed.on('remove', function(){\r\n                    ReactDOM.unmountComponentAtNode(RichText.prototype.scaffoldSidebar)\r\n                })\r\n                ed.ui.registry.addSidebar('mysidebar', {\r\n                    tooltip: 'View Scaffold',\r\n                    icon: 'settings',\r\n                    onSetup: function (api) {\r\n                        const sidebar = api.element()\r\n                        document.sidebar = sidebar\r\n                        sidebar.style.width = \"200px\"\r\n                        sidebar.style.overflow = \"scroll\"\r\n                        sidebar.style.fontSize = \"0.7rem\"\r\n                        ReactDOM.render(scaffoldElement, sidebar, null)\r\n                        RichText.prototype.scaffoldSidebar = sidebar\r\n                    },\r\n                    onShow: function (api) {\r\n                        // var str = \"\\\"\\'components/kfutils/scaffold/scaffold.html\\'\\\"\";\r\n                        // api.element().innerHTML = \"<div id='annoSide'><div ng-include=\"+str+\"></div></div>\";\r\n                        // var scope = angular.element(document.getElementById(\"scaffoldContainer\")).scope();\r\n                        // scope.$apply(function () {\r\n                        //     scope.annotatorScaffoldInit(editorId);\r\n                        // });\r\n                    },\r\n                    onHide: function (api) {\r\n                        // api.element().innerHTML = \"\";\r\n                        // var scope = angular.element(document.getElementById(\"scaffoldContainer\")).scope();\r\n                        // scope.$apply(function () {\r\n                        //     scope.annotatorScaffoldClose();\r\n                        // });\r\n                        //console.log('Hide panel', api.element());\r\n                    }\r\n                });\r\n\r\n            };\r\n            tinymce.init(this.options.tinymce);\r\n        };\r\n\r\n        RichText.prototype.updateEditor = function(field, annotation) {\r\n            var text = typeof annotation.text!=='undefined'?annotation.text:'';\r\n            var count = tinymce.editors.length;\r\n            editorId = tinymce.editors[count-2].id;\r\n            tinymce.get(editorId).setContent(text);\r\n            //tinymce.activeEditor.setContent(text);\r\n            $(field).remove(); //this is the auto create field by annotator and it is not necessary\r\n        };\r\n\r\n        RichText.prototype.updateViewer = function(field, annotation) {\r\n            var textDiv = $(field.parentNode).find('div:first-of-type')[0];\r\n            textDiv.innerHTML =annotation.text;\r\n            $(textDiv).addClass('richText-annotation');\r\n            $(field).remove(); //this is the auto create field by annotator and it is not necessary\r\n        };\r\n\r\n        return RichText;\r\n\r\n    })(Annotator.Plugin);\r\n\r\n            /* jshint ignore:end */\r\n\r\n\r\n            //----------------------------Rich Text Annotator Plugin: END -----------------------------\r\n\r\n    elem.annotator('addPlugin', 'KFPlugin');\r\n    elem.annotator('addPlugin', 'Tags');\r\n    elem.annotator('addPlugin', 'RichText');\r\n\r\n    if (uname) {\r\n        elem.annotator('addPlugin', 'Permissions', {\r\n            user: uname,\r\n            permissions: {\r\n                read: [uname],\r\n                update: [uname],\r\n                delete: [uname],\r\n                admin: [uname]\r\n            },\r\n            showEditPermissionsCheckbox: false\r\n        });\r\n    }\r\n}\r\n\r\nexport const vm2m = (anno) => {\r\n    const isPublic = anno.permissions.read.length === 0;\r\n    if (isPublic) {\r\n        anno.permission = 'protected';\r\n    } else {\r\n        anno.permission = 'private';\r\n    }\r\n    const loc = anno.ranges[0];\r\n    if (loc.start.indexOf('/div[1]') === 0) {\r\n        loc.start = loc.start.substring(7);\r\n    }\r\n    if (loc.end.indexOf('/div[1]') === 0) {\r\n        loc.end = loc.end.substring(7);\r\n    }\r\n    return anno;\r\n};\r\n\r\nexport const m2vm = (anno) => {\r\n    const loc = Object.assign({}, anno.ranges[0]);\r\n    loc.start = '/div[1]' + loc.start;\r\n    loc.end = '/div[1]' + loc.end;\r\n    anno.ranges[0] = loc\r\n    return anno;\r\n};\r\n","import { configureStore } from '@reduxjs/toolkit';\r\nimport { globalsReducer } from './globalsReducer.js'\r\nimport { dialogReducer } from './dialogReducer.js'\r\nimport { noteReducer } from './noteReducer.js'\r\nimport { scaffoldReducer } from './scaffoldReducer.js'\r\nimport { userReducer } from './userReducer.js'\r\n\r\nexport default configureStore({\r\n  reducer: {\r\n      dialogs: dialogReducer,\r\n      notes: noteReducer,\r\n      scaffolds: scaffoldReducer,\r\n      globals: globalsReducer,\r\n      users: userReducer\r\n  },\r\n    devTools: true\r\n});\r\n","import React from 'react';\r\nimport ScaffoldSelect from '../scaffold/ScaffoldSelect'\r\nimport * as annotPlugins from './annotator.service'\r\nimport './annotator.css'\r\nimport store from '../../store/store';\r\nimport { Provider } from 'react-redux';\r\n/*global $*/\r\nclass Annotator extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        this.contentRef = React.createRef();\r\n        this.annotatorInitialized = this.annotatorInitialized.bind(this)\r\n        this.annotationCreated = this.annotationCreated.bind(this)\r\n        this.annotationUpdated = this.annotationUpdated.bind(this)\r\n        this.annotator = null\r\n\r\n        this.displayEditor = this.displayEditor.bind(this)\r\n        this.displayViewer = this.displayViewer.bind(this)\r\n        this.fixPopupLocation = this.fixPopupLocation.bind(this)\r\n        this.editorHidden = this.editorHidden.bind(this)\r\n        this.loadAnnotations = this.loadAnnotations.bind(this)\r\n        this.onScaffoldSelected = this.onScaffoldSelected.bind(this)\r\n        this.dlg = null\r\n    }\r\n\r\n    componentDidMount() {\r\n        const annotatedElem = $(this.contentRef.current)\r\n        annotatedElem.annotator()\r\n        this.scaffoldElem = (\r\n            <Provider store={store}>\r\n                <ScaffoldSelect initVal={0} onScaffoldSelected={this.onScaffoldSelected}/>\r\n            </Provider>)\r\n\r\n        annotPlugins.setKFPlugin(annotatedElem, {\r\n            annotationCreated: this.annotationCreated,\r\n            annotationUpdated: this.annotationUpdated,\r\n            annotationDeleted: this.props.onDelete,\r\n            displayEditor: this.displayEditor,\r\n            displayViewer: this.displayViewer,\r\n            annotatorInitialized: this.annotatorInitialized,\r\n            editorHidden: this.editorHidden\r\n        }, this.props.author.userName, this.scaffoldElem)\r\n        this.dlg = $(`#contrib-dialog-${this.props.containerId}`)\r\n\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.props.annotsFetched === 1 && this.props.annotsFetched !== prevProps.annotsFetched) {\r\n            this.loadAnnotations()\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        //Need to remove editor when closing dialog\r\n        if (this.annotator && this.annotator.plugins.RichText.mceditor)\r\n            this.annotator.plugins.RichText.mceditor.remove()\r\n    }\r\n    editorHidden(editor, annotation){\r\n        $(editor.element.find(\".annotator-controls\")).off()\r\n    }\r\n    loadAnnotations(){\r\n        const annotations = Object.values(this.props.annots).map((annot) => {\r\n            const anno = Object.assign({}, annot.data)\r\n            anno.ranges = [...anno.ranges]\r\n            anno.highlights = [...anno.highlights]\r\n            annotPlugins.m2vm(anno)\r\n            return anno\r\n        })\r\n        this.annotator.loadAnnotations(annotations)\r\n        this.props.onAnnotsLoaded()\r\n    }\r\n    annotatorInitialized(annotator){\r\n        this.annotator = annotator\r\n        this.loadAnnotations()\r\n\r\n        var $element = $('div.annotator-adder');\r\n        $element.attr('title', 'Annotation');\r\n        $element.addClass('tooltip1');\r\n        $element.append('<span class=\"tooltiptext\">Annotation</span>');\r\n\r\n        document.annotator = this.annotator\r\n        const adder = annotator.adder.get(0)\r\n        this.observer = new MutationObserver(function(mutationsList){\r\n            for(let mutation of mutationsList) {\r\n                if (mutation.type === 'attributes') {\r\n                    //mutation.oldValue.startsWith(\"display: none\") &&\r\n                    if( adder.style.display !== 'none'){\r\n                        this.fixPopupLocation(annotator.adder)\r\n                        this.observer.takeRecords()\r\n                        return\r\n                    }\r\n                }\r\n            }\r\n        }.bind(this));\r\n        //TODO disconnect? when?\r\n        this.observer.observe(adder, { attributes: true, attributeOldValue: true });\r\n    }\r\n    annotationCreated(annotation){\r\n        this.props.onCreate(annotPlugins.vm2m(annotation))\r\n    }\r\n    annotationUpdated(annotation){\r\n        this.props.onUpdate(annotPlugins.vm2m(annotation))\r\n    }\r\n    displayEditor(editor, annotation){\r\n        /* $(editor.element.find(\".annotator-controls\")).off()*/\r\n        if (!editor.element.hasClass(editor.classes.invert.y)) {\r\n            editor.element.addClass(editor.classes.invert.y);\r\n        }\r\n    }\r\n    fixPopupLocation(popup){\r\n        const dlgOffset = this.dlg.offset()\r\n        const ppOffset = popup.offset()\r\n        popup.offset({top: ppOffset.top - dlgOffset.top, left: ppOffset.left - dlgOffset.left})\r\n    }\r\n    displayViewer(viewer, annotation){\r\n        this.fixPopupLocation(viewer.element)\r\n        viewer.element.addClass(viewer.classes.invert.y);\r\n    }\r\n\r\n    onScaffoldSelected(tagCreator, initialText) {\r\n        const mceditor = this.annotator.plugins.RichText.mceditor\r\n        const selected = mceditor.selection.getContent();\r\n        let text = selected.length ? selected : initialText;\r\n        const {tag, supportContentId} = tagCreator(text);\r\n        mceditor.insertContent(tag)\r\n        //select text after insert\r\n        const contentTag = mceditor.dom.get(supportContentId);\r\n        if (contentTag)\r\n            mceditor.selection.setCursorLocation(contentTag)\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div ref={this.contentRef}>\r\n                <div dangerouslySetInnerHTML={{__html: this.props.content}}>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n}\r\n\r\nexport default Annotator\r\n","import React from 'react';\r\nimport { Tabs, Tab, Col, Row, Button } from 'react-bootstrap';\r\nimport WriteTab from '../writeTab/WriteTab'\r\nimport History from '../historyTab/History'\r\nimport Properties from '../propertiesTab/Properties'\r\nimport AuthorTab from '../authorsTab/AuthorTab'\r\nimport Annotator from '../annotator/Annotator'\r\nimport GraphView from '../../GraphView'\r\nimport { connect } from 'react-redux'\r\nimport {\r\n    setAnnotationsLoaded,\r\n    fetchAttachments, fetchRecords,\r\n    createAnnotation, deleteAnnotation, modifyAnnotation, deleteAttachment, openContribution\r\n} from '../../store/noteReducer.js'\r\nimport { scaffoldWordCount } from '../../store/kftag.service.js'\r\nimport { dateFormatOptions, fetchCommGroups } from '../../store/globalsReducer.js'\r\nimport './Note.css'\r\n\r\nclass Note extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            riseAboveNotes: false,\r\n            selectedTab: this.props.mode ? this.props.mode : \"write\",\r\n        }\r\n        this.onEditorSetup = this.onEditorSetup.bind(this)\r\n        this.addDrawing = this.addDrawing.bind(this)\r\n        this.onNoteChange = this.onNoteChange.bind(this)\r\n        this.wordCount = this.wordCount.bind(this)\r\n        this.onTabSelected = this.onTabSelected.bind(this)\r\n        this.onAnnotationCreated = this.onAnnotationCreated.bind(this)\r\n        this.onAnnotationDeleted = this.onAnnotationDeleted.bind(this)\r\n        this.onAnnotationUpdated = this.onAnnotationUpdated.bind(this)\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if (this.props.drawing && prevProps.drawing !== this.props.drawing) {\r\n            this.editor.insertContent(this.props.drawing)\r\n            this.props.onDrawingInserted()\r\n        }\r\n    }\r\n\r\n    onNoteChange(note) {\r\n        if (note.scaffold) {\r\n            const { tagCreator, initialText } = note.scaffold;\r\n            this.addSupport(true, initialText, tagCreator)\r\n        } else if (note.attach) {\r\n            this.editor.insertContent(note.attach)\r\n        } else if (note.deleteAttach) {\r\n            this.props.deleteAttachment(this.props.note._id, note.deleteAttach)\r\n            this.editor.dom.remove(this.editor.dom.select('.' + note.deleteAttach))\r\n        }\r\n        else {\r\n            if (note.data && note.data.body){\r\n                this.props.onNoteChange({ ...note, wordCount: this.wordCount(note.data.body) })\r\n            }else{\r\n                this.props.onNoteChange({ ...note })\r\n            }\r\n        }\r\n    }\r\n\r\n    wordCount(text) {\r\n        return this.editor.plugins.wordcount.getCount() - scaffoldWordCount(text);\r\n    }\r\n\r\n    onEditorSetup(editor) {\r\n        editor.onDrawButton = this.props.onDrawToolOpen;\r\n        this.editor = editor;\r\n    }\r\n\r\n    addDrawing(drawing) {\r\n        // Add draw to editor\r\n        this.editor.insertContent(drawing);\r\n    }\r\n\r\n    addSupport(selection, initialText, tagCreator) {\r\n        const selected = this.editor.selection.getContent();\r\n        let text = selected.length ? selected : initialText;\r\n        const { tag, supportContentId } = tagCreator(text);\r\n        this.editor.insertContent(tag)\r\n        //select text after insert\r\n        if (selection) {\r\n            const contentTag = this.editor.dom.get(supportContentId);\r\n            if (contentTag)\r\n                this.editor.selection.setCursorLocation(contentTag)\r\n        }\r\n    }\r\n\r\n    onTabSelected(tab) {\r\n        this.setState({selectedTab: tab })\r\n        if (tab === 'history') { //Refresh records\r\n            this.props.fetchRecords(this.props.note._id)\r\n        } if (tab === 'author') { //Refresh groups, and authors?\r\n            this.props.fetchCommGroups(this.props.note.communityId)\r\n        }\r\n    }\r\n\r\n    onAnnotationCreated(annotation) {\r\n        console.log(annotation)\r\n        this.props.createAnnotation(this.props.note.communityId, this.props.note._id, this.props.noteAuthor._id, annotation)\r\n    }\r\n\r\n    onAnnotationDeleted(annotation) {\r\n        if (annotation.linkId && annotation.modelId) {\r\n            this.props.deleteAnnotation(annotation.linkId, this.props.note._id, annotation.modelId);\r\n        }\r\n    }\r\n\r\n    onAnnotationUpdated(annotation) {\r\n        if (!annotation.linkId || !annotation.modelId) {\r\n            console.error('ERROR! annoVM doesn\\'t have id on update');\r\n            return;\r\n        }\r\n        const model = Object.assign({}, this.props.note.annos[annotation.modelId])\r\n        if (!model) {\r\n            console.error('ERROR! model couldn\\'t find');\r\n            return;\r\n        }\r\n        model.data = annotation;\r\n        this.props.modifyAnnotation(model, this.props.note.communityId, this.props.note._id)\r\n    }\r\n\r\n    render() {\r\n        const formatter = new Intl.DateTimeFormat('default', dateFormatOptions)\r\n        return (\r\n            <div>\r\n                <div className='contrib-info'>\r\n                    Created By: {this.props.noteAuthor.firstName} {this.props.noteAuthor.lastName} <br />\r\n                    Last modified: {formatter.format(new Date(this.props.note.modified))}\r\n                </div>\r\n                <Tabs activeKey={this.state.selectedTab} onSelect={this.onTabSelected}>\r\n                    <Tab eventKey=\"read\" title=\"read\" mountOnEnter style={{height: '100%'}}>\r\n                        <Row style={{height: '100%'}}>\r\n                                <Col>\r\n                                    <Annotator containerId={this.props.dlgId}\r\n                                        content={this.props.note.data.body}\r\n                                        annots={this.props.note.annos}\r\n                                        annotsFetched={this.props.note.annotsFetched}\r\n                                        author={this.props.noteAuthor}\r\n                                        onCreate={this.onAnnotationCreated}\r\n                                        onUpdate={this.onAnnotationUpdated}\r\n                                        onDelete={this.onAnnotationDeleted}\r\n                                        onAnnotsLoaded={() => this.props.setAnnotationsLoaded({ contribId: this.props.note._id, value: 0 })}\r\n                                    >\r\n                                    </Annotator>\r\n                                </Col>\r\n\r\n                                {this.props.note.data.riseabove && this.props.raViewLinks && this.props.raReadLinks ?\r\n                                 <Col className=\"border border-primary border-4 note-ra-col\">\r\n                                     <Row>\r\n                                         <div className=\"note-ra-text\">Riseabove View:\r\n                                             <Button className=\"sm-button\" variant=\"primary\" href={`/view/${this.props.note.data.riseabove.viewId}`} target=\"_blank\">Open in Window</Button>\r\n                                         </div>\r\n                                     </Row>\r\n                                     <Row className=\"note-ra-rowgraph\">\r\n                                         <GraphView\r\n                                             viewId={this.props.note.data.riseabove.viewId}\r\n                                             viewLinks={this.props.raViewLinks}\r\n                                             readLinks={this.props.raReadLinks}\r\n                                             onNoteClick={(noteId)=>this.props.openContribution(noteId, \"write\")}\r\n                                             onViewClick={(viewId)=> {window.open(`/view/${viewId}`, '_blank')}}\r\n                                         />\r\n                                     </Row>\r\n                                 </Col> : ''\r\n                                }\r\n                        </Row>\r\n                    </Tab>\r\n                    {\r\n                        this.props.mode !== \"read\" ?\r\n\r\n                        <Tab eventKey=\"write\" title=\"write\">\r\n                            <WriteTab\r\n                                note={this.props.note}\r\n                                onScaffoldSelected={this.scaffoldSelected}\r\n                                onChange={this.onNoteChange}\r\n                                onEditorSetup={this.onEditorSetup}\r\n                            ></WriteTab>\r\n                        </Tab>\r\n                        :\r\n                        ''\r\n                    }\r\n                    <Tab eventKey=\"author\" title=\"author(s)\">\r\n                        <AuthorTab contrib={this.props.note} onChange={this.onNoteChange} />\r\n                    </Tab>\r\n                    <Tab eventKey='history' title='history'><History records={this.props.note.records} /></Tab>\r\n                    <Tab eventKey='properties' title='properties'><Properties contribution={this.props.note} onChange={this.props.onNoteChange} /></Tab>\r\n                </Tabs>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        noteAuthor: ownProps.note && (state.users[ownProps.note.authors[0]] || 'NA'),\r\n        currentAuthor: state.globals.author,\r\n        editable: false || (ownProps.note && ownProps.note.authors.includes(state.globals.author._id)),\r\n        raViewLinks: ownProps.note?.data?.riseabove && state.notes.raViews[ownProps.note.data.riseabove.viewId]?.viewLinks,\r\n        raReadLinks: ownProps.note?.data?.riseabove && state.notes.raViews[ownProps.note.data.riseabove.viewId]?.readLinks,\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    fetchAttachments, fetchRecords,\r\n    deleteAnnotation, fetchCommGroups, createAnnotation, modifyAnnotation,\r\n    setAnnotationsLoaded, deleteAttachment, openContribution}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(Note)\r\n\r\n","import React, {useEffect, useState} from 'react'\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport Dialog from './Dialog.js'\r\nimport DrawTool from '../drawDialog/DrawTool.js'\r\nimport Note from '../note/Note.js'\r\nimport {removeNote, postContribution, buildOnNote} from '../../store/noteReducer.js'\r\nimport {closeDialog } from '../../store/dialogReducer.js'\r\n\r\nconst NoteDialog = props => {\r\n\r\n    const dialog = props.dialog\r\n    const reduxNote = useSelector(state => state.notes[dialog.contribId])\r\n    const dispatch = useDispatch();\r\n    const [note, setNote] = useState(null);//make copy of note from redux\r\n    const [drawTool, setDrawTool] = useState(false);\r\n    const [svg, setSvg] = useState(null);\r\n    const [drawing, setDrawing] = useState(null);\r\n\r\n    useEffect(()=>{\r\n        setNote(prevNote => {\r\n            if (prevNote === null) //Initialize once\r\n                return {...reduxNote}\r\n            else //Only update attachmets and records\r\n                return {...prevNote, attachments: reduxNote.attachments, records: reduxNote.records }\r\n        })\r\n    }, [reduxNote])\r\n\r\n\r\n    const onDialogClose = (dlg) => {\r\n        dispatch(closeDialog(dlg.id));\r\n        dispatch(removeNote(dlg.contribId));\r\n    }\r\n\r\n    const onDialogConfirm = () => {\r\n        dispatch(postContribution(note, dialog.id));\r\n    }\r\n\r\n    const onBuildOnClick = (noteId) => {\r\n        dispatch(buildOnNote(noteId));\r\n    }\r\n\r\n    const onNoteChange = (noteChanged) => {\r\n        setNote(prevNote => {\r\n            const newNote = {...prevNote, ...noteChanged}\r\n            newNote.data = { ...prevNote.data, ...noteChanged.data}\r\n            return newNote\r\n        })\r\n    }\r\n\r\n    const openDrawDialog = (svg) => {\r\n        if (svg) {\r\n            setSvg(svg)\r\n        }\r\n        setDrawTool(true)\r\n    }\r\n\r\n    const closeDrawDialog = () => {\r\n        setSvg(null)\r\n        setDrawTool(false);\r\n    }\r\n\r\n    const onDrawingInserted = () => { setDrawing(null)}\r\n\r\n    const onConfirmDrawDialog = (drawing) => {\r\n        setDrawing(drawing)\r\n        closeDrawDialog()\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <Dialog key={dialog.id}\r\n                    id={dialog.id}\r\n                    onMouseDown={props.onMouseDown}\r\n                    title={dialog.title}\r\n                    style={{zIndex: dialog.zIndex}}\r\n                    onClose={()=>onDialogClose(dialog)}\r\n                    onConfirm={()=> onDialogConfirm(dialog)}\r\n                    confirmButton={dialog.confirmButton}\r\n                    editable={dialog.editable}\r\n                    buildon={dialog.buildOn}\r\n                    onBuildOnClick={()=>onBuildOnClick(dialog.contribId)}\r\n            >\r\n                {note ?\r\n                 <Note\r\n                     key={dialog.contribId}\r\n                     dlgId={dialog.id}\r\n                     note={note}\r\n                     mode={dialog.editable? \"write\": \"read\"}\r\n                     drawing={drawing}\r\n                     onNoteChange={onNoteChange}\r\n                     onDrawToolOpen={openDrawDialog}\r\n                     onDrawingInserted={onDrawingInserted}\r\n                 />\r\n                : null}\r\n\r\n            </Dialog>\r\n            { drawTool ?\r\n             <DrawTool onClose={closeDrawDialog}\r\n                         onConfirm={onConfirmDrawDialog}\r\n                         svg={svg}\r\n             /> : null}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default NoteDialog;\r\n","import React, {useState} from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport History from '../historyTab/History'\r\nimport Properties from '../propertiesTab/Properties'\r\nimport AuthorTab from '../authorsTab/AuthorTab'\r\nimport { Tabs, Tab, Row, Col, Form } from 'react-bootstrap';\r\nimport { dateFormatOptions, fetchCommGroups } from '../../store/globalsReducer.js'\r\nimport {fetchRecords} from '../../store/noteReducer.js'\r\nimport {url as serverUrl} from '../../store/api'\r\n\r\nconst Attachment = (props) => {\r\n    const formatter = new Intl.DateTimeFormat('default', dateFormatOptions)\r\n    const timestamp = formatter.format(new Date(props.attachment.modified))\r\n    const attachAuthor = useSelector(state => state.users[props.attachment.authors[0]] || 'NA')\r\n    const dispatch = useDispatch();\r\n    const [selectedTab, setSelectedTab] = useState(\"read\");\r\n    const onTabSelected = (tab) => {\r\n        setSelectedTab(tab)\r\n        if (tab === 'history') { //Refresh records\r\n            dispatch(fetchRecords(props.attachment._id))\r\n        } if (tab === 'author') { //Refresh groups, and authors?\r\n            dispatch(fetchCommGroups(props.attachment.communityId))\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <div className='contrib-info'>\r\n                Created By: {attachAuthor.firstName} {attachAuthor.lastName} <br />\r\n                Last modified: {timestamp}\r\n            </div>\r\n            <Tabs activeKey={selectedTab} transition={false} onSelect={onTabSelected}>\r\n                <Tab style={{height: '100%'}} eventKey=\"read\" title=\"read\">\r\n\r\n                    <a href={`${serverUrl}${(props.attachment.data.url)}`} title={props.attachment.title} download>\r\n                        { props.attachment.data.url }\r\n                    </a>\r\n                    { props.attachment.data.type === 'application/pdf' ?\r\n                    <object data={`${serverUrl}${(props.attachment.data.url)}`} type=\"application/pdf\" width=\"100%\" height=\"100%\">\r\n\r\n                    </object> : ''}\r\n\r\n                </Tab>\r\n\r\n                {\r\n                    props.mode !== \"read\" ?\r\n                    <Tab eventKey=\"write\" title=\"write\">\r\n                        <Row>\r\n                            <Col>\r\n                                <Form.Group className=\"write-title-form\" controlId=\"note-title\">\r\n                                    <Form.Control type=\"text\"\r\n                                                  className=\"write-tab-input\"\r\n                                                  size=\"sm\"\r\n                                                  placeholder=\"Enter title\"\r\n                                                  value={props.attachment.title}\r\n                                                  onChange={(val) => {props.onChange({title: val.target.value})}}/>\r\n                                </Form.Group>\r\n                            </Col>\r\n                        </Row>\r\n                    </Tab>\r\n                    :\r\n                    ''\r\n                }\r\n\r\n                <Tab eventKey=\"author\" title=\"author(s)\">\r\n                    <AuthorTab contrib={props.attachment} onChange={props.onChange} />\r\n                </Tab>\r\n                <Tab eventKey='history' title='history'><History records={props.attachment.records} /></Tab>\r\n                <Tab eventKey='properties' title='properties'><Properties contribution={props.attachment} onChange={props.onChange} /></Tab>\r\n            </Tabs>\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nexport default Attachment\r\n","import React from 'react'\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport Dialog from './Dialog.js'\r\nimport Attachment from '../attachment/Attachment.js'\r\nimport {removeNote, postContribution, buildOnNote, editNote} from '../../store/noteReducer.js'\r\nimport {closeDialog } from '../../store/dialogReducer.js'\r\n\r\nconst AttachmentDialog = props => {\r\n\r\n    const dialog = props.dialog\r\n    const attachment = useSelector(state => state.notes[dialog.contribId])\r\n    const dispatch = useDispatch();\r\n\r\n\r\n    const onDialogClose = (dlg) => {\r\n        dispatch(closeDialog(dlg.id));\r\n        dispatch(removeNote(dlg.noteId));\r\n    }\r\n\r\n    const onDialogConfirm = () => {\r\n        dispatch(postContribution(attachment, dialog.id));\r\n    }\r\n\r\n    const onBuildOnClick = (noteId) => {\r\n        dispatch(buildOnNote(noteId));\r\n    }\r\n\r\n    const onChange = (attachmentChanged) => {\r\n        dispatch(editNote({\"_id\": attachment._id, ...attachmentChanged}));\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <Dialog key={dialog.id}\r\n                    id={dialog.id}\r\n                    onMouseDown={props.onMouseDown}\r\n                    title={dialog.title}\r\n                    style={{zIndex: dialog.zIndex}}\r\n                    onClose={()=>onDialogClose(dialog)}\r\n                    onConfirm={()=> onDialogConfirm(dialog)}\r\n                    confirmButton={dialog.confirmButton}\r\n                    editable={dialog.editable}\r\n                    buildon={dialog.buildOn}\r\n                    onBuildOnClick={()=>onBuildOnClick(dialog.contribId)}\r\n            >\r\n                {attachment ?\r\n                 <Attachment\r\n                     key={dialog.contribId}\r\n                     dlgId={dialog.id}\r\n                     attachment={attachment}\r\n                     mode={dialog.editable? \"write\": \"read\"}\r\n                     onChange={onChange}\r\n                 />\r\n                : null}\r\n\r\n            </Dialog>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AttachmentDialog;\r\n","import React, {useState} from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport Dialog from '../dialog/Dialog.js'\r\nimport History from '../historyTab/History'\r\nimport Properties from '../propertiesTab/Properties'\r\nimport AuthorTab from '../authorsTab/AuthorTab'\r\nimport { Tabs, Tab, Row, Col, Form } from 'react-bootstrap';\r\nimport {closeDialog } from '../../store/dialogReducer.js'\r\nimport {removeNote, postContribution, buildOnNote, editNote, fetchRecords} from '../../store/noteReducer.js'\r\nimport { dateFormatOptions, fetchCommGroups } from '../../store/globalsReducer.js'\r\nconst DrawDialog = props => {\r\n    const formatter = new Intl.DateTimeFormat('default', dateFormatOptions)\r\n    const dialog = props.dialog\r\n    const drawing = useSelector(state => state.notes[dialog.contribId])\r\n    const drawingAuthor = useSelector(state => state.users[drawing.authors[0]] || 'NA')\r\n    const timestamp = formatter.format(new Date(drawing.modified))\r\n    let iframe_ref;\r\n    const dispatch = useDispatch();\r\n\r\n    const [selectedTab, setSelectedTab] = useState(\"write\");\r\n\r\n    const onTabSelected = (tab) => {\r\n        setSelectedTab(tab)\r\n        if (tab === 'history') { //Refresh records\r\n            dispatch(fetchRecords(drawing._id))\r\n        } if (tab === 'author') { //Refresh groups, and authors?\r\n            dispatch(fetchCommGroups(drawing.communityId))\r\n        }\r\n    }\r\n\r\n    const onDialogConfirm = () => {\r\n        const wnd = iframe_ref.contentWindow;\r\n        wnd.svgCanvas.setResolution('fit', 100);\r\n        const bg = wnd.svgCanvas.current_drawing_.all_layers[0];\r\n        const point = wnd.svgCanvas.current_drawing_.all_layers[1];\r\n\r\n        const widd = point[1].getBBox().width;\r\n        const heig = point[1].getBBox().height;\r\n        if (widd === 0 || heig === 0){\r\n            onDialogClose()\r\n            return;\r\n        }\r\n        const rec = bg[1].children[1];\r\n        if (rec.attributes.fill.value === 'none'){\r\n            const po = wnd.svgCanvas.current_drawing_.all_layers[1];\r\n            if (po[1].childNodes.length > 1){\r\n                wnd.svgCanvas.current_drawing_.svgElem_.setAttribute(\"width\", widd + 2);\r\n                wnd.svgCanvas.current_drawing_.svgElem_.setAttribute(\"height\", heig + 2)\r\n                const p = wnd.svgCanvas.current_drawing_.all_layers[0];\r\n                p[1].childNodes[1].setAttribute(\"width\", widd);\r\n                p[1].childNodes[1].setAttribute(\"height\", heig);\r\n                wnd.svgCanvas.selectAllInCurrentLayer();\r\n                wnd.svgCanvas.groupSelectedElements();\r\n                wnd.svgCanvas.alignSelectedElements('l', 'page')\r\n                wnd.svgCanvas.alignSelectedElements('t', 'page')\r\n                wnd.svgCanvas.ungroupSelectedElement();\r\n                wnd.svgCanvas.clearSelection();\r\n            }\r\n        }\r\n        wnd.svgCanvas.setResolution('fit', 'fit')\r\n        const newDrawing = {...drawing}\r\n        newDrawing.data = {...newDrawing.data, svg: wnd.svgCanvas.svgCanvasToString()}\r\n        dispatch(postContribution(newDrawing, dialog.id))\r\n    }\r\n\r\n    const onDialogClose = (dlg) => {\r\n        dispatch(closeDialog(dlg.id));\r\n        dispatch(removeNote(dlg.noteId));\r\n    }\r\n\r\n    const getIframeRef = (frame) => {\r\n        if(!frame) {\r\n            return\r\n        }\r\n        iframe_ref = frame\r\n    }\r\n\r\n    const onLoad = (e) => {\r\n        console.log(\"on load draw\")\r\n        const svg = drawing.data.svg\r\n        if (svg){\r\n            e.target.contentWindow.svgCanvas.setSvgString(svg)\r\n            e.target.contentWindow.svgCanvas.setResolution('fit', 'fit')\r\n        }\r\n    }\r\n\r\n    const onChange = (drawingChanged) => {\r\n        dispatch(editNote({\"_id\": drawing._id, ...drawingChanged}));\r\n    }\r\n\r\n    const onBuildOnClick = (noteId) => {\r\n        dispatch(buildOnNote(noteId));\r\n    }\r\n\r\n    return (\r\n            <Dialog key={dialog.id}\r\n                    id={dialog.id}\r\n                    onMouseDown={props.onMouseDown}\r\n                    title={dialog.title}\r\n                    style={{zIndex: dialog.zIndex}}\r\n                    onClose={()=>onDialogClose(dialog)}\r\n                    onConfirm={()=> onDialogConfirm(dialog)}\r\n                    confirmButton={dialog.confirmButton}\r\n                    editable={dialog.editable}\r\n                    buildon={dialog.buildOn}\r\n                    onBuildOnClick={()=>onBuildOnClick(dialog.contribId)}\r\n            >\r\n                <div>\r\n                    <div className='contrib-info'>\r\n                        Created By: {drawingAuthor.firstName} {drawingAuthor.lastName} <br />\r\n                        Last modified: {timestamp}\r\n                    </div>\r\n                    <Tabs activeKey={selectedTab} transition={false} onSelect={onTabSelected}>\r\n                        <Tab eventKey=\"write\" title=\"write\" style={{height: '90%'}}>\r\n                            {drawing ?\r\n                             (<>\r\n                                 <Row>\r\n                                     <Col>\r\n                                         <Form.Group className=\"write-title-form\" controlId=\"note-title\">\r\n                                             <Form.Control type=\"text\"\r\n                                                           className=\"write-tab-input\"\r\n                                                           size=\"sm\"\r\n                                                           placeholder=\"Enter title\"\r\n                                                           value={drawing.title}\r\n                                                           onChange={(val) => {onChange({title: val.target.value})}}/>\r\n                                         </Form.Group>\r\n                                     </Col>\r\n                                 </Row>\r\n                                 <iframe onLoad={onLoad} title='DrawingTool' src='/drawing-tool/svg/index.html' ref={getIframeRef} width='100%' height='100%'></iframe>\r\n                             </>)\r\n                            :\r\n                             ''\r\n                            }\r\n                        </Tab>\r\n                        <Tab eventKey=\"author\" title=\"author(s)\">\r\n                            <AuthorTab contrib={drawing} onChange={onChange} />\r\n                        </Tab>\r\n                        <Tab eventKey='history' title='history'><History records={drawing.records} /></Tab>\r\n                        <Tab eventKey='properties' title='properties'><Properties contribution={drawing} onChange={onChange} /></Tab>\r\n                    </Tabs>\r\n                </div>\r\n\r\n            </Dialog>\r\n        )\r\n}\r\n\r\nexport default DrawDialog\r\n","import React, {useCallback} from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport {focusDialog } from '../../store/dialogReducer.js'\r\nimport NoteDialog from '../dialog/NoteDialog.js'\r\nimport AttachmentDialog from '../dialog/AttachmentDialog.js'\r\nimport DrawDialog from '../drawDialog/DrawDialog.js'\r\n\r\nconst DialogHandler = props => {\r\n    const dialogs = useSelector(state => state.dialogs);\r\n    const dispatch = useDispatch();\r\n\r\n    const onFocusDialog = useCallback(\r\n        (dlgId) => dispatch(focusDialog(dlgId)),\r\n        [dispatch]\r\n    );\r\n\r\n    return (\r\n        <div>{\r\n            dialogs.dialogs.map((elt, i) => {\r\n\r\n                if (elt.type === 'Note'){\r\n                    return (\r\n                        <NoteDialog\r\n                            key={elt.id}\r\n                            dialog={elt}\r\n                            onMouseDown={() => onFocusDialog(elt.id)}\r\n                        />\r\n                    )\r\n                } else if (elt.type === 'Attachment'){\r\n                    return (\r\n                        <AttachmentDialog\r\n                            key={elt.id}\r\n                            dialog={elt}\r\n                            onMouseDown={() => onFocusDialog(elt.id)}\r\n                        />\r\n                    )\r\n                } else if (elt.type === 'Drawing'){\r\n\r\n                    return (\r\n                        <DrawDialog\r\n                            key={elt.id}\r\n                            dialog={elt}\r\n                            onMouseDown={() => onFocusDialog(elt.id)}\r\n                        />\r\n                    )\r\n                } else {\r\n                    return ''\r\n                }\r\n            })\r\n        }\r\n\r\n        </div>\r\n    )\r\n\r\n}\r\nexport default DialogHandler;\r\n","import React, {useState} from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { Modal, Button, Row, Col, Form } from 'react-bootstrap';\r\nimport { newRiseAbove } from '../../store/async_actions.js'\r\n\r\nconst NewRiseAboveModal = props => {\r\n\r\n    const [title, setTitle] = useState('')\r\n    const dispatch = useDispatch();\r\n\r\n    const createRiseAbove = () => {\r\n        dispatch(newRiseAbove(title))\r\n        props.handleClose()\r\n    }\r\n\r\n\r\n    return (\r\n        <Modal show={props.show} onHide={props.handleClose}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>New RiseAbove</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Row>\r\n                    <Col>\r\n                        <Form.Group className=\"ra-title-form\" controlId=\"ra-title\">\r\n                            <Form.Control type=\"text\"\r\n                                          size=\"sm\"\r\n                                          placeholder=\"Enter title\"\r\n                                          value={title}\r\n                                          onChange={(val) => {setTitle(val.target.value)}}/>\r\n                        </Form.Group>\r\n                    </Col>\r\n                </Row>\r\n            </Modal.Body>\r\n            <Modal.Footer>\r\n                <Button variant=\"secondary\" onClick={props.handleClose}>\r\n                    Cancel\r\n                </Button>\r\n                <Button variant=\"primary\" onClick={createRiseAbove}>\r\n                    Create\r\n                </Button>\r\n            </Modal.Footer>\r\n        </Modal>\r\n  );\r\n}\r\n\r\nexport default NewRiseAboveModal;\r\n","\r\nimport React, { createContext } from  'react';\r\nimport io from 'socket.io-client';\r\nimport { WS_BASE } from './config.js'\r\nimport { useDispatch } from 'react-redux';\r\nimport {setSocketStatus } from './store/globalsReducer.js'\r\nimport { removeViewLink, removeViewNote } from './store/noteReducer.js'\r\nimport { onViewLink } from './store/async_actions'\r\nimport { url } from './store/api.js'\r\nconst WebSocketContext = createContext(null)\r\n\r\nexport { WebSocketContext }\r\n\r\nexport default (({ children }) => {\r\n    let socket;\r\n    let ws;\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const emit = (model, message) => {\r\n        socket.emit(model, message);\r\n    }\r\n\r\n\r\n    const syncUpdates = (modelName) => {\r\n        /**\r\n         * Syncs item creation/updates on 'model:save'\r\n         */\r\n        socket.on(modelName + ':save', (item) => {\r\n            if (modelName === 'link' && item.type === 'contains' && item._to.status === 'active'){\r\n                dispatch(onViewLink(item));\r\n            }\r\n        });\r\n\r\n        /**\r\n         * Syncs removed items on 'model:remove'\r\n         */\r\n        socket.on(modelName + ':remove', function(item) {\r\n            if (modelName === 'link' && item._to.status === 'active'){\r\n                dispatch(removeViewLink(item));\r\n                dispatch(removeViewNote({'_id': item.to}))\r\n            }\r\n        });\r\n    };\r\n\r\n    const subscribeToView = (viewId) => {\r\n        socket.emit('subscribe', `linkfrom:${viewId}`);\r\n        socket.emit('subscribe', `noteCount:${viewId}`);\r\n    }\r\n\r\n    const unsubscribeToView = (viewId) => {\r\n        socket.emit('unsubscribe', `linkfrom:${viewId}`);\r\n        socket.emit('unsubscribe', `noteCount:${viewId}`);\r\n    }\r\n    /**\r\n     * Removes listeners for a models updates on the socket\r\n     *\r\n     * @param modelName\r\n     */\r\n    const unsyncUpdates  = (modelName) => {\r\n        socket.removeAllListeners(modelName + ':save');\r\n        socket.removeAllListeners(modelName + ':remove');\r\n    }\r\n\r\n    const openConnection = (subscribe, sync) => {\r\n        if (!socket){\r\n            socket = io.connect(\r\n                url,\r\n                {path: WS_BASE,\r\n                 log: true,\r\n                 \"close timeout\": 60\r\n                 , \"heartbeat timeout\": 60\r\n                 , \"heartbeat interval\": 20\r\n                });\r\n            socket.on('connect', ()=>{\r\n                dispatch(setSocketStatus(true));\r\n                if (subscribe){\r\n                    subscribeToView(subscribe)\r\n                }\r\n                if (sync){\r\n                    syncUpdates(sync)\r\n                }\r\n            });\r\n            socket.on('error', function (data) {\r\n                console.log(data || 'error');\r\n                socket = null;\r\n                dispatch(setSocketStatus(false));\r\n            });\r\n\r\n            socket.on('connect_failed', function (data) {\r\n                console.log(data || 'connect_failed');\r\n                socket = null;\r\n                dispatch(setSocketStatus(false));\r\n            });\r\n\r\n            socket.on('disconnect', function(data){\r\n                socket = null;\r\n                dispatch(setSocketStatus(false));\r\n            })\r\n\r\n        }else{\r\n            if (subscribe){\r\n                subscribeToView(subscribe)\r\n            }\r\n            if (sync){\r\n                syncUpdates(sync)\r\n            }\r\n        }\r\n    }\r\n\r\n    const disconnect = () => {\r\n        if (socket)\r\n            socket.disconnect();\r\n    }\r\n\r\n    ws = {\r\n        socket: socket,\r\n        openConnection: openConnection,\r\n        emit: emit,\r\n        unsyncUpdates: unsyncUpdates,\r\n        syncUpdates: syncUpdates,\r\n        subscribeToView: subscribeToView,\r\n        unsubscribeToView: unsubscribeToView,\r\n        disconnect: disconnect\r\n    }\r\n\r\n    return (\r\n        <WebSocketContext.Provider value={ws}>\r\n            {children}\r\n        </WebSocketContext.Provider>\r\n    )\r\n\r\n})\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { Link } from \"react-router-dom\";\r\nimport { DropdownButton, Dropdown, Button, Row, Col, Modal, OverlayTrigger, Tooltip } from 'react-bootstrap';\r\nimport { Form, FormGroup, Label, Input } from 'reactstrap';\r\nimport Axios from 'axios';\r\nimport { apiUrl, getCommunity, putCommunity, postLink, getViews } from '../store/api.js';\r\nimport { setViewId, fetchViewCommunityData, fetchNewViewDifference } from '../store/globalsReducer.js'\r\nimport { setViewLinks, setBuildsOn, setReadLinks, newNote, openContribution, newDrawing } from '../store/noteReducer.js'\r\nimport { clearAuthors } from '../store/userReducer.js';\r\nimport TopNavBar from '../TopNavBar/TopNavbar';\r\nimport AttachPanel from './attachmentCollapse/AttachPanel.js'\r\nimport GraphView from '../GraphView.jsx';\r\nimport LightView from '../View/LightView.js';\r\nimport '../css/index.css';\r\nimport \"./View.css\";\r\nimport DialogHandler from './dialogHandler/DialogHandler.js'\r\nimport NewRiseAboveModal from './modals/NewRiseAboveModal.js'\r\nimport { WebSocketContext } from '../WebSocket.js'\r\n\r\nclass View extends Component {\r\n\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {\r\n            token: sessionStorage.getItem('token'),\r\n            currentView: this.props.location.state === undefined ? \"Enhanced\" : this.props.location.state.currentView,\r\n            communityTitle: this.props.location.state === undefined ? null : this.props.location.state.communityTitle,\r\n            addView: '',\r\n            showModal: false,\r\n            showView: false,\r\n            showAttachPanel: false,\r\n            showRiseAboveModal: false,\r\n        }\r\n\r\n        this.clearGraphViewProps = this.clearGraphViewProps.bind(this);\r\n        this.onViewClick = this.onViewClick.bind(this);\r\n        this.handleNewViewInput = this.handleNewViewInput.bind(this);\r\n        this.handleNewViewSubmit = this.handleNewViewSubmit.bind(this);\r\n        this.newView = this.newView.bind(this);\r\n        this.handleShow = this.handleShow.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        var viewId = this.props.viewId ? this.props.viewId : this.props.match.params.viewId;\r\n        this.context.openConnection(viewId, 'link');//Open websocket connection and subscribe to view\r\n        this.props.fetchViewCommunityData(viewId);\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.props.viewId && this.props.viewId !== prevProps.viewId) {\r\n            this.props.fetchNewViewDifference(this.props.viewId);\r\n            if (this.props.socketStatus && prevProps.viewId){//If changing view and socket connection\r\n                this.context.unsubscribeToView(prevProps.viewId);\r\n                this.context.subscribeToView(this.props.viewId);\r\n            }\r\n        }\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        if (this.props.socketStatus){\r\n            this.context.unsyncUpdates('link');\r\n            this.context.unsubscribeToView(this.props.viewId);\r\n            this.context.disconnect();\r\n        }\r\n    }\r\n\r\n    clearGraphViewProps(){\r\n      this.props.setViewLinks([]);\r\n      this.props.setBuildsOn([]);\r\n      this.props.setReadLinks([]);\r\n      this.props.clearAuthors([]);\r\n    }\r\n\r\n    onViewClick(viewId){\r\n        this.handleShow(false);\r\n        this.props.setViewId(viewId);\r\n        this.props.history.push({\r\n          pathname: `/view/${viewId}`,\r\n          state: { currentView: this.state.currentView, communityTitle: this.state.communityTitle }\r\n        });\r\n    }\r\n\r\n    newView() {\r\n        this.setState({\r\n            showView: true,\r\n            showModel: true,\r\n        })\r\n    }\r\n\r\n    // SET VALUES\r\n    handleNewViewInput = (e) => {\r\n        let target = e.target;\r\n        let name = target.name;\r\n        let value = target.value;\r\n\r\n        this.setState({\r\n            [name]: value\r\n        });\r\n    }\r\n\r\n    handleNewViewSubmit(e) {\r\n        e.preventDefault();\r\n        var config = {\r\n            headers: { Authorization: `Bearer ${this.state.token}` }\r\n        };\r\n\r\n        var addViewUrl = `${apiUrl}/contributions/${this.props.communityId}`;\r\n\r\n        var query = {\r\n            \"authors\": [this.props.author._id],\r\n            \"communityId\": this.props.communityId,\r\n            \"permission\": \"public\",\r\n            \"status\": \"active\",\r\n            \"title\": this.state.addView,\r\n            \"type\": \"View\"\r\n        }\r\n        Axios.post(addViewUrl, query, config)\r\n            .then(result => {\r\n                //get new view Id\r\n                let newViewId = result.data._id\r\n                getCommunity(this.props.communityId).then(data => {\r\n                    data.data.views.push(newViewId)\r\n                    putCommunity(data.data, this.props.communityId).then(obj => {\r\n                        getViews(this.props.communityId).then(viewsObj => {\r\n                            let pos = {\r\n                                x: 1000,\r\n                                y: 1000\r\n                            }\r\n                            postLink(this.props.viewId, newViewId, 'contains', pos).then(linkObj => {\r\n                                alert(\"View Added\")\r\n                                window.location.reload(false);\r\n                            })\r\n                        })\r\n                    })\r\n                }).catch(error => {\r\n                    console.log(error);\r\n                })\r\n            }\r\n            ).catch(\r\n                error => {\r\n                    console.log(error);\r\n\r\n                }\r\n            );\r\n    }\r\n\r\n    handleShow(value) {\r\n        this.setState({\r\n            showModel: value,\r\n        });\r\n    }\r\n\r\n    goToDashboard = () => {\r\n        this.clearGraphViewProps();\r\n        this.props.history.push(\"/dashboard\");\r\n    }\r\n\r\n    switchView = () => {\r\n      var nextView = this.state.currentView === \"Enhanced\" ? \"Light\" : \"Enhanced\";\r\n      this.setState({ currentView: nextView });\r\n    }\r\n\r\n    renderTooltip = (props) => (\r\n        <Tooltip id=\"button-tooltip\" {...props}>\r\n            {props.message}\r\n        </Tooltip>\r\n    );\r\n\r\n    render(){\r\n      let viewToRender = this.state.currentView === \"Enhanced\" ?\r\n                         <GraphView\r\n                             viewId={this.props.viewId}\r\n                             viewLinks={this.props.viewLinks}\r\n                             readLinks={this.props.readLinks}\r\n                             onViewClick={this.onViewClick}\r\n                             onNoteClick={(noteId)=>this.props.openContribution(noteId, \"write\")}\r\n                         />\r\n                      :\r\n                         <LightView/>;\r\n\r\n      return(\r\n          <div className=\"container-fluid d-flex flex-column\" id=\"container-fluid-for-view-js\">\r\n              <DialogHandler />\r\n              <AttachPanel\r\n                  attachPanel={this.state.showAttachPanel}\r\n                  viewId={this.props.viewId}\r\n                  onClose={() => this.setState({showAttachPanel: false})}\r\n              />\r\n              <NewRiseAboveModal show={this.state.showRiseAboveModal} handleClose={() => this.setState({showRiseAboveModal: false})}/>\r\n              <div className=\"row\">\r\n                  {<TopNavBar currentView={this.state.currentView} onViewClick={this.onViewClick} communityTitle={this.state.communityTitle}></TopNavBar>}\r\n              </div>\r\n\r\n              <div className=\"row flex-grow-1\">\r\n\r\n                  {/* SIDEBAR */}\r\n                  <div className=\"col-md\" id=\"sticky-sidebar\">\r\n                    <div className=\"row sidebar-list\">\r\n                      <div className=\"sidebar-list-col col-4 col-sm-4 col-md-12\">\r\n                      <DropdownButton drop=\"right\" className=\"dropdown-btn-parent\" title={<i className=\"fas fa-plus-circle\"></i>}>\r\n\r\n                          <Dropdown.Item onClick={() => this.props.newNote(this.props.view, this.props.communityId, this.props.author._id)}>\r\n                              New Note\r\n                          </Dropdown.Item>\r\n\r\n                          <Dropdown.Item onClick={() => this.newView()}>\r\n                              New View\r\n                          </Dropdown.Item>\r\n\r\n                          <Dropdown.Item onClick={() => this.setState({showAttachPanel: true})}>\r\n                              New Attachment\r\n                          </Dropdown.Item>\r\n\r\n                          <Dropdown.Item onClick={() => this.props.newDrawing(this.props.viewId, this.props.communityId, this.props.author._id)}>\r\n                              New Drawing\r\n                          </Dropdown.Item>\r\n\r\n                          <Dropdown.Item onClick={() => this.setState({showRiseAboveModal: true})}>\r\n                              New RiseAbove\r\n                          </Dropdown.Item>\r\n                      </DropdownButton>\r\n                      </div>\r\n\r\n                      <div className=\"sidebar-list-col col-4 col-sm-4 col-md-12\">\r\n                      <OverlayTrigger\r\n                          placement=\"right\"\r\n                          delay={{ show: 250, hide: 400 }}\r\n                          overlay={this.renderTooltip({ message: \"Exit Community\" })}>\r\n                          <Button onClick={this.goToDashboard} className=\"circle-button sidebar-btn\"><i className=\"fa fa-arrow-left\"></i></Button>\r\n                      </OverlayTrigger>\r\n                      </div>\r\n\r\n                      <div className=\"sidebar-list-col col-4 col-sm-4 col-md-12\">\r\n                      <OverlayTrigger\r\n                          placement=\"right\"\r\n                          delay={{ show: 250, hide: 400 }}\r\n                          overlay={this.renderTooltip({ message: \"Change View\" })}>\r\n                          <Button onClick={this.switchView} className=\"circle-button pad sidebar-btn\">\r\n                              <i className=\"fa fa-globe\"></i>\r\n                          </Button>\r\n                      </OverlayTrigger>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  {/* END SIDEBAR */}\r\n\r\n                  {/* MAIN CANVAS */}\r\n                  <div className=\"col-md\" id=\"main-canvas\">\r\n                      {viewToRender}\r\n                  </div>\r\n                  {/* END MAIN CANVAS */}\r\n\r\n              </div>\r\n\r\n              {/* MODAL */}\r\n              <Modal show={this.state.showModel} onHide={() => this.handleShow(false)}>\r\n\r\n                  {this.state.showView ? (\r\n                      <>\r\n                          <Modal.Header closeButton>\r\n                              <Modal.Title>\r\n                                  <Row>\r\n                                      <Col>Views</Col>\r\n                                  </Row>\r\n                                  <Row>\r\n                                      <Col>\r\n                                          <Row>\r\n                                              <Form onSubmit={this.handleNewViewSubmit} className=\"form\">\r\n                                                  <Col>\r\n                                                      <FormGroup>\r\n                                                          <Label htmlFor=\"addView\" style={{ fontSize: \"1rem\" }}>Add View</Label>\r\n                                                          <Input type=\"text\" id=\"addView\" placeholder=\"Enter View Name\" name=\"addView\" value={this.state.addView} onChange={this.handleNewViewInput} />\r\n                                                      </FormGroup>\r\n                                                  </Col>\r\n                                                  <Col>\r\n                                                      <Button varient=\"secondary\" type=\"submit\">Add</Button>\r\n                                                  </Col>\r\n                                              </Form>\r\n                                          </Row>\r\n                                      </Col>\r\n                                  </Row>\r\n                              </Modal.Title>\r\n                          </Modal.Header>\r\n                          <Modal.Body style={{ 'maxHeight': 'calc(100vh - 210px)', 'overflowY': 'auto' }}>\r\n                              {this.props.myViews.map((obj, i) => {\r\n                                  return <Row key={i} value={obj.title} className=\"mrg-05-top\">\r\n                                      <Col><Link onClick={() => this.onViewClick(obj._id)}> {obj.title} </Link></Col>\r\n                                  </Row>\r\n                              })}\r\n                          </Modal.Body>\r\n                      </>) : null}\r\n\r\n                  <Modal.Footer>\r\n                      <Button variant=\"secondary\" onClick={() => this.handleShow(false)}>\r\n                          Close\r\n                  </Button>\r\n                  </Modal.Footer>\r\n              </Modal>\r\n              {/* END MODAL */}\r\n\r\n          </div>\r\n      )\r\n    }\r\n}\r\nView.contextType = WebSocketContext;\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        token: state.globals.token,\r\n        currentServer: state.globals.currentServer,\r\n        communityId: state.globals.communityId,\r\n        viewId: state.globals.viewId,\r\n        view: state.globals.view,\r\n        author: state.globals.author,\r\n        myViews: state.globals.views,\r\n        socketStatus: state.globals.socketStatus,\r\n        viewLinks: state.notes.viewLinks,\r\n        readLinks: state.notes.readLinks,\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    setViewId,\r\n    setViewLinks,\r\n    setBuildsOn,\r\n    setReadLinks,\r\n    clearAuthors,\r\n    fetchViewCommunityData,\r\n    fetchNewViewDifference,\r\n    openContribution,\r\n    newNote,\r\n    newDrawing\r\n};\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(View)\r\n","import React from 'react'\r\nimport {Route, Redirect} from 'react-router-dom'\r\nimport { useSelector } from 'react-redux';\r\n\r\nconst ProtectedRoute = ({ component: Component, ...rest }) => {\r\n    const loggedIn = useSelector(state=> state.globals.isAuthenticated);\r\n    return (<Route {...rest} render={(props) => (\r\n       loggedIn ?\r\n        <Component {...props} />\r\n        : <Redirect to='/' />\r\n    )} />)\r\n}\r\nexport default ProtectedRoute;\r\n","import React from 'react';\r\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\r\nimport { useDispatch } from 'react-redux';\r\nimport ReactNotification from 'react-notifications-component';\r\nimport Login from './Login';\r\nimport Dashboard from './Dashboard';\r\nimport View from './components/View.js'\r\nimport { setGlobalToken, setCurrentServer, fetchLoggedUser } from './store/globalsReducer.js'\r\nimport { setToken, setServer } from './store/api.js'\r\nimport { getLoginData } from './helper/Login_helper.js'\r\nimport ProtectedRoute from './ProtectedRoute.jsx'\r\nimport 'react-notifications-component/dist/theme.css'\r\nfunction App() {\r\n\r\n    const dispatch = useDispatch();\r\n    //Check if user loged in, if logged in set token,server and user info in store\r\n    const [server, token, ] = getLoginData();\r\n    if (token) {\r\n        setToken(token);\r\n        setServer(server);\r\n        dispatch(setGlobalToken(token))\r\n        dispatch(setCurrentServer(server))\r\n        dispatch(fetchLoggedUser())\r\n    }\r\n\r\n    return (\r\n        <div id=\"sub-root\">\r\n            <ReactNotification />\r\n            <Router>\r\n                <Switch>\r\n                    <Route exact path=\"/\" component={Login}/>\r\n                    <ProtectedRoute exact path=\"/dashboard\" component={Dashboard}></ProtectedRoute>\r\n                    <ProtectedRoute path=\"/view/:viewId\" component={View}></ProtectedRoute>\r\n                    <ProtectedRoute component={Dashboard}></ProtectedRoute>\r\n                </Switch>\r\n            </Router>\r\n        </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport App from './App';\r\nimport { Provider } from 'react-redux';\r\nimport store from './store/store';\r\nimport WebSocketProvider from './WebSocket.js'\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <WebSocketProvider>\r\n            <App />\r\n        </WebSocketProvider>\r\n    </Provider>,\r\n    document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}