{"version":3,"sources":["assets/icon_note_blue.png","assets/icon_note_red.png","assets/icon_riseabove_blue.png","assets/icon_riseabove_red.png","assets/icon_attachment.gif","assets/icon_view.png","assets/sample_view.gif","store/api.js","store/userReducer.js","store/scaffoldReducer.js","store/globalsReducer.js","api/user.js","config.js","helper/Login_helper.js","LoginForm.jsx","SignUpForm.jsx","api/community.js","api/object.js","helper/Graph_helper.js","Graph.jsx","api/link.js","Login.jsx","helper/Dashboard_helper.js","Dashboard.jsx","store/dialogReducer.js","store/kftag.service.js","store/notifier.js","store/noteReducer.js","components/SideBar.js","components/dialog/Dialog.js","components/editor/MCEditor.js","components/attachmentCollapse/AttachPanel.js","components/scaffold/scaffold.service.js","components/scaffold/ScaffoldSelect.js","components/attachmentArea/AttachArea.js","components/writeTab/WriteTab.js","components/historyTab/History.js","components/propertiesTab/Properties.js","components/authorSelect/AuthorSelect.js","components/authorsTab/AuthorTab.js","components/annotator/annotator.service.js","store/store.js","components/annotator/Annotator.js","components/RiseAboveView/RiseAboveView.js","components/note/Note.js","components/drawDialog/DrawDialog.js","components/dialogHandler/DialogHandler.js","components/View.js","App.js","index.js"],"names":["module","exports","url","localStorage","getItem","apiUrl","setToken","token","axios","defaults","headers","common","sessionStorage","getUser","a","get","data","getCommunity","communityId","getCommunities","getGroups","getLinks","objectId","direction","type","links","filter","each","postLink","fromId","toId","post","from","to","deleteLink","linkId","delete","linksSearch","query","getObject","putObject","object","put","postAttachment","authorId","newobj","title","authors","status","permission","version","postContribObject","obj","getCommunityAuthors","getRecords","contribId","uploadFile","file","onProgress","formData","FormData","append","onUploadProgress","addUser","createAction","addAuthors","userReducer","createReducer","state","action","payload","_id","forEach","author","fetchAuthors","dispatch","api","requestScaffold","receiveScaffold","scaffoldReducer","isFetching","items","fetched","fetchScaffolds","contextId","scaffold_promise","then","res","Promise","all","scaffolds","map","scaffoldId","link","el","includes","supports","scaffold","i","setGlobalToken","setCurrentLoginForm","setCommunity","setCommunityId","setCurrentServer","setViewId","setLoggedUser","setView","setAuthor","setViews","editCommunity","setUserId","setIsAuthenticated","setCommunities","setUserCommunities","dateFormatOptions","year","month","day","hour","minute","second","hour12","initState","currentLoginForm","currentServer","viewId","user","view","views","community","userId","isAuthenticated","communities","userCommunities","servers","id","key","value","globalsReducer","server","endsWith","substring","length","setItem","rootContextId","fetchAuthor","getAuthor","getUserTokenServerPair","username","password","body","fetch","method","JSON","stringify","response","console","log","json","catch","error","postNewUser","firstname","lastname","email","postNewSingaporeUser","registrationKey","SERVERS","name","getServerName","getServerURL","extractTokenFromStorage","uname","parse","executePromises","pwd","login_form_component","promises","document","getElementById","checked","clear","userStorage","push","successfulLogin","errorMessage","serverTokenPair","undefined","message","removeItem","setState","props","history","style","display","responseHandler","LoginForm","inputChangeHandler","event","target","val","formSubmitHandler","preventDefault","openSignUpForm","$","tooltip","popover","window","width","setAttribute","className","onSubmit","this","autoComplete","placeholder","required","onChange","htmlFor","tabIndex","role","data-toggle","data-trigger","data-content","color","onClick","Component","mapDispatchToProps","compose","withRouter","connect","SignUpForm","serverSelectHandler","singaporeSelected","selected_Servers","confirmPassword","self","result","j","errorCode","openLoginForm","registrationKeyInput","isMulti","options","s","label","components","makeAnimated","classNamePrefix","getCommunityWelcomeView","getApiObjectsObjectId","handleNote","nodeData","readData","authorData","readStatus","authorName","matchAuthorId","_to","date","parseDate","created","group","kfId","classes","position","x","y","handleAttachment","si","nodes","createCytoscapeId","String","imageUrl","replace","slice","bounds","rectangle","height","locked","download","handleDrawing","doc","DOMParser","parseFromString","svg","aspect_ratio","childNodes","attributes","node_height","parseInt","encodeURIComponent","handleView","authorsInfo","firstName","lastName","has","set","Cytoscape","use","CytoscapePanZoom","CytoscapeNodeHtmlLabel","CytoscapeSupportImages","Graph","elements","edges","loadElements","bind","cy","supportimages","promise","promise1","postApiLinksCommunityIdSearch","promise2","welcomeViewId","results","getApiLinksReadStatus","promise3","ref","Map","_private","supportImages","renderer","imageCache","graph_nodes","addNodesToGraph","graph_edges","edgeData","_from","fromCount","toCount","k","source","addEdgesToGraph","concat","graph_results","cy_elements","addSupportImage","notify","zoomFactor","zoomDelay","minZoom","maxZoom","fitPadding","panSpeed","panDistance","panDragAreaSize","panMinPercentSpeed","panInactiveArea","panIndicatorMinOpacity","zoomOnly","fitSelector","animateOnFit","fitAnimationDuration","sliderHandleIcon","zoomInIcon","zoomOutIcon","resetIcon","panzoom","nodeHtmlLabel","halign","valign","halignBox","valignBox","cssClass","tpl","on","contributionId","hasClass","onViewClick","removeClass","addClass","onNoteClick","prevProps","prevState","CytoscapeComponent","normalizeElements","stylesheet","selector","unread_note_icon","read_note_icon","unread_riseabove_icon","read_riseabove_icon","attachment_icon","view_icon","layout","hideEdgesonViewport","autolock","wheelSensitivity","Login","demoToken","demoServer","demoCommunityId","demoViewId","showModal","handleShow","handleClose","getUserToken","formToRender","src","sample_view","alt","Modal","show","onHide","Header","closeButton","Title","Body","Footer","Button","variant","ownProps","globals","loadServer","dashboard_component","getUserCommunities","sort","b","compareStrings","_community","p","responses","userCommunityData","currentServerURL","updateUserCommunities","getUserInfo","alert","logout","serverCommunityData","community_options","c","updateCommunities","joinCommunity","postCommunityRegistration","joinCommunityErrorMessage","userinfo","toggleSidebar","div","toLowerCase","Dashboard","domElement","serverName","innerText","serverURL","serverTokenPairs","currentServerName","siblings","activeServerURL","handleViewChange","viewType","handleCommunityDropDownChange","selectedCommunityToJoin","serverList","communityRegistrationKey","enterCommunity","pathname","class","appendUserServers","viewToRender","href","rel","isSearchable","data-target","aria-controls","aria-expanded","aria-label","openDialog","closeDialog","openDrawDialog","closeDrawDialog","focusDialog","openAttachPanel","closeAttachPanel","dialogCounter","dialogReducer","dialogs","drawTool","focused","attachPanel","dlgs","dlg","zIndex","createScaffoldStartTag","isTemplate","tag","createScaffoldEndTag","createReferenceTag","contId","text","preProcess","toConnections","fromConnections","jq","supportStart","find","elem","startsWith","conn","innerHTML","supportEnd","references","html","postProcess","handler","endtags","supportLinksIds","supportStarts","supportEnds","toCreate","supportStartsIds","supportId","split","oldId","newId","toDeleteSupports","referenceLinksIds","kfReferences","kfreferenceIds","referenceId","toDeleteReferences","notifConfig","insert","container","animationIn","animationOut","dismiss","duration","addNotification","notif","store","addNote","removeNote","editNote","addDrawing","removeDrawing","editSvg","addAttachment","removeAttachment","setAttachments","setWordCount","setLinks","setRecords","removeContribAuthor","addContribAuthor","setAnnotation","setAnnotationsLoaded","removeAnnotation","setViewNotes","addViewNote","setCheckedNotes","updateCheckedNotes","setViewLinks","addViewLink","setBuildsOn","setSupports","setRiseAboveViewNotes","setRiseAboveNotes","setReadLinks","noteReducer","drawing","attachments","viewNotes","checkedNotes","viewLinks","buildsOn","riseAboveNotes","riseAboveViewNotes","readLinks","notes","note","Object","assign","noteId","attachment","att","attId","wordCount","wc","contrib","fromLinks","toLinks","records","auth","annos","annotation","annoId","newNote","buildson","mode","_groupMembers","newN","contextMode","content","langInNote","docId","myself","coauthors","ca","createdBy","docShared","text4search","createNote","confirmButton","editable","fetchAttachments","link_atts","attach","fetchLinks","viewLink","openContribution","getState","noteBody","buildOn","annoLinks","annLink","anno","modelId","annot","fetchBuildsOn","buildOnResult","reverse","filteredBuildOn","SideBar","useDispatch","Col","md","sm","xs","DropdownButton","drop","Dropdown","Item","dialog_style","Dialog","default","pageXOffset","pageYOffset","onMouseDown","dragHandleClassName","Card","alignItems","onClose","size","marginLeft","children","onConfirm","disabled","buildon","onBuildOnClick","MCEditor","apiKey","init","setup","editor","onEditorSetup","content_css","menubar","statusbar","media_live_embeds","plugins","external_plugins","toolbar","onEditorChange","React","AttachPanel","useSelector","useState","progress","setProgress","e","onFileSelect","fileList","files","Array","upload_promises","indexOf","_URL","URL","webkitURL","addImageProcess","createObjectURL","img","naturalWidth","naturalHeight","createAttachment","resolve","reject","createElement","onload","onerror","attachRes","uploadRes","filename","tmpFilename","newAttachment","inlineAttach","data_mce_src","serverUrl","onNewInlineAttach","progressEvent","percentCompleted","Math","round","loaded","total","Form","File","Input","FileDrop","onFrameDragEnter","onFrameDragLeave","onFrameDrop","onDragOver","onDragLeave","onDrop","ProgressBar","now","addHyphen","initText","supportContentId","Date","getTime","toString","ScaffoldSelect","scaffoldSelected","support","returnSupport","onScaffoldSelected","addhyphen","initialText","scaffold_text","tagCreator","scaffoldService","selected","initVal","onSelectChange","Container","Row","Group","controlId","Control","as","AttachArea","selectedImgs","setSelectedImgs","onNewAttachClick","getElementsByClassName","tagName","getAttribute","classList","cls_name","imgs","downloadUrl","confirm","onAttachDelete","WriteTab","onNewAttachmentClick","inline","attachId","deleteAttach","History","reduce","acc","read","edit","record","Properties","onPermissionChange","evt","contribution","AuthorSelect","select_options","entries","selectedOption","setSelectedOption","isClearable","onAuthorSelected","AuthorTab","users","communityAuthors","group_options","groups","g","setG","idx","cursor","removeAuthor","setKFPlugin","annotatorHandler","scaffoldElement","Annotator","Plugin","KFPlugin","pluginInit","annotator","subscribe","annotationCreated","annotationUpdated","annotationDeleted","displayEditor","viewer","annotations","displayViewer","editorHidden","annotatorInitialized","__hasProp","hasOwnProperty","RichText","_super","child","parent","call","ctor","constructor","prototype","__super__","__extends","editorId","element","apply","arguments","tinymce","toolbar_items_size","extended_valid_elements","supported","addField","load","updateEditor","updateViewer","ed","mceditor","activeEditor","getContent","css","ReactDOM","unmountComponentAtNode","scaffoldSidebar","ui","registry","addSidebar","icon","onSetup","sidebar","overflow","fontSize","render","onShow","field","count","editors","setContent","remove","textDiv","parentNode","permissions","update","admin","showEditPermissionsCheckbox","vm2m","isPublic","loc","ranges","start","end","configureStore","reducer","devTools","contentRef","createRef","fixPopupLocation","loadAnnotations","annotatedElem","current","scaffoldElem","annotPlugins","onDelete","userName","containerId","annotsFetched","off","values","annots","highlights","onAnnotsLoaded","$element","attr","adder","observer","MutationObserver","mutationsList","takeRecords","observe","attributeOldValue","onCreate","onUpdate","invert","popup","dlgOffset","offset","ppOffset","top","left","selection","insertContent","contentTag","dom","setCursorLocation","dangerouslySetInnerHTML","__html","RiseAboveView","riseAboveViewId","Note","selectedTab","onDrawingToolOpen","onNoteChange","onTabSelected","onAnnotationCreated","onAnnotationDeleted","onAnnotationUpdated","snapshot","addSupport","deleteAttachment","select","wordcount","getCount","labels","numwords","scaffoldWordCount","onDrawButton","editSvgDialog","tab","fetchRecords","fetchCommGroups","createAnnotation","noteAuthor","deleteAnnotation","model","modifyAnnotation","formatter","Intl","DateTimeFormat","format","modified","Tabs","activeKey","transition","onSelect","Tab","eventKey","dlgId","timestamp","ann","anno_updated","att_link","lnk","currentAuthor","DrawDialog","onLoad","getIframeRef","wnd1","iframe_ref","contentWindow","bg","svgCanvas","current_drawing_","all_layers","wnd2","widd","getBBox","heig","svgElem_","selectAllInCurrentLayer","groupSelectedElements","alignSelectedElements","ungroupSelectedElement","clearSelection","setResolution","getSvgString","canvas","ctx","getContext","btoa","drawImage","toDataURL","frame","setSvgString","DialogHandler","onDialogClose","useCallback","onDialogConfirm","dialogId","wasActive","prev_text","onFocusDialog","onCloseDrawDialog","onConfirmDrawDialog","buildOnNote","elt","View","fetchViewCommunityData","match","params","commId","App","server_data","getLoginData","exact","path","component"],"mappings":"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","file":"static/js/main.4cd3f4fb.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAACXBIWXMAAC4jAAAuIwF4pT92AAAGaGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDYtMjFUMTE6Mjc6NDYtMDU6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA5LTEyVDE2OjU4OjM1LTA1OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA5LTEyVDE2OjU4OjM1LTA1OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjEyZTJiMzk4LThjNzQtNDE1OS1iNTRiLTQxNjNhZGNiNmY4MyIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmM5Y2JkYzI3LTEwYmMtOWQ0Yy05MjFmLTg1MGRjOTBmZTAwNiIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjk3YjYxMzJlLTM1ZGItNDE3OS04MDMyLTYxMWRkMWYwNzVhYSI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OTdiNjEzMmUtMzVkYi00MTc5LTgwMzItNjExZGQxZjA3NWFhIiBzdEV2dDp3aGVuPSIyMDE4LTA2LTIxVDExOjI3OjQ2LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoxMmUyYjM5OC04Yzc0LTQxNTktYjU0Yi00MTYzYWRjYjZmODMiIHN0RXZ0OndoZW49IjIwMTgtMDktMTJUMTY6NTg6MzUtMDU6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChNYWNpbnRvc2gpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pia9hzQAAAD6SURBVFiF7dY/SgNBGIbx366LghqCf25kG1MJXsMDeAjxGFqaFCnU0kN4B1MZsDEW7sJImDVCxkkxT/OywzfwzAffzFYn149j3OJYPua4anCP3YwiMMBdjSazSEdV4z23Rcuizm0QUmRiFJkYRSZGkYlRZGIUmRhFJkaRibFNMoPU/7/PeMFyjdqPlDJPOPvLhpQyszYrDNvsYyelzGGbQ7xiv6e2wl5KmTrI0zXqp/8xTUssfql5wGgbRnuCMfnvmSnOu4+cMhOMwoVcMj860lHrH7lNEd7AKx0JZT4TCYSHPAhEVjrS0eASNzjasMy8zRpvvt+pi74NXzMDHXjf0mfDAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKp2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDYtMjFUMTE6Mjc6NDYtMDU6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA5LTEyVDE4OjA1OjUwLTA1OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA5LTEyVDE4OjA1OjUwLTA1OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmExYzgwOTQwLTIzMjYtNDc4NS05ZTA0LWE0MDJjMDdiNDI2ZCIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjcyNzMyNjhjLTE1OTEtYzA0Mi1iM2IxLWM5NjVhNzE5MzRkOCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjcwMTg5MDJiLTU5YjctNDNkNy1iODc1LTk5YmUyNTM2MWJiNCIgdGlmZjpPcmllbnRhdGlvbj0iMSIgdGlmZjpYUmVzb2x1dGlvbj0iMzAwMDAwMC8xMDAwMCIgdGlmZjpZUmVzb2x1dGlvbj0iMzAwMDAwMC8xMDAwMCIgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIgZXhpZjpDb2xvclNwYWNlPSIxIiBleGlmOlBpeGVsWERpbWVuc2lvbj0iMTg3MSIgZXhpZjpQaXhlbFlEaW1lbnNpb249IjE4NzEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjcwMTg5MDJiLTU5YjctNDNkNy1iODc1LTk5YmUyNTM2MWJiNCIgc3RFdnQ6d2hlbj0iMjAxOC0wNi0yMVQxMToyNzo0Ni0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjBiYzRiZGFkLTVkNTQtNDAzYS1iNGIwLWY0ZmViZTgyNzM0YSIgc3RFdnQ6d2hlbj0iMjAxOC0wOS0xMlQxODowMDozMi0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmMxM2M1OWI3LWE1MmItNDdkZC1hMmUwLTE3M2E1MGY3OGEyNCIgc3RFdnQ6d2hlbj0iMjAxOC0wOS0xMlQxODowNTo1MC0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmExYzgwOTQwLTIzMjYtNDc4NS05ZTA0LWE0MDJjMDdiNDI2ZCIgc3RFdnQ6d2hlbj0iMjAxOC0wOS0xMlQxODowNTo1MC0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOmMxM2M1OWI3LWE1MmItNDdkZC1hMmUwLTE3M2E1MGY3OGEyNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MDE4OTAyYi01OWI3LTQzZDctYjg3NS05OWJlMjUzNjFiYjQiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3MDE4OTAyYi01OWI3LTQzZDctYjg3NS05OWJlMjUzNjFiYjQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7C07tpAAAA+0lEQVRYhe3WMUoDQRSH8d+ui4IaguKBBNuYSvAatt5CPIaWJkUaLT2BlXcwlQEbY+EujIRZI2ScFPM1f3Z4A988eDNbvVyfjnGLY/mY46rBPXYzisAAdzWazCIdVY333BYtizq3QUiRiVFkYhSZGEUmRpGJUWRiFJkYRSbGNskMUv//PuEZyzVqP1LKPOLsLxtSyszarDBss4+dlDKHbQ7xiv2e2gp7KWXqIE/WqJ/+xzQtsfil5gGjbRjtCcbkv2emOO8+cspMMAoXcsn86EhHrX/kNkV4A690JJT5TCQQHvIgEFnpSEeDS9zgaMMy8zZrvPl+py76NnwBLFcduiEp6KQAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAJ/mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE4LTA5LTEyVDIxOjI1OjE0LTA1OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOC0wOS0xMlQyMTo1MjozNC0wNTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOC0wOS0xMlQyMTo1MjozNC0wNTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxYWYyNTA0Yy1hMDg0LTQwZDAtOTBjYi00N2VjOTM3MDk5MGIiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0NmM4MjBiYi01NGUyLTYxNDgtODE0Ny04ZGI2N2MxYjlkYzQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxZTRlNGRmMi0zYjYwLTQ0OWQtOWY1OS1hZDBlZjExMWNlMDMiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjFlNGU0ZGYyLTNiNjAtNDQ5ZC05ZjU5LWFkMGVmMTExY2UwMyIgc3RFdnQ6d2hlbj0iMjAxOC0wOS0xMlQyMToyNToxNC0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBpbWFnZS9wbmcgdG8gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6M2E4ZGZjNmQtZmVkNC00MzI4LTgzMjgtMzRmY2M2YjIyMzExIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIxOjM4OjQ1LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MjZlZDljYjYtOGJlZi00NDllLWI2NzQtNzZiYzAzNDIxYjY0IiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIxOjUyOjM0LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MWFmMjUwNGMtYTA4NC00MGQwLTkwY2ItNDdlYzkzNzA5OTBiIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIxOjUyOjM0LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MjZlZDljYjYtOGJlZi00NDllLWI2NzQtNzZiYzAzNDIxYjY0IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFlNGU0ZGYyLTNiNjAtNDQ5ZC05ZjU5LWFkMGVmMTExY2UwMyIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjFlNGU0ZGYyLTNiNjAtNDQ5ZC05ZjU5LWFkMGVmMTExY2UwMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pu/x7K8AAAkXSURBVFiFvVhpkFxVFf7OuW/r6WV6m+7ZiBIlBAOCLGICkigVBUeBKiuSgCguP4JQSgGJCEFERYkkJD9iWSWLUJRYgiAoUQqK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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAJ/mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE4LTA5LTEyVDIxOjI1OjE0LTA1OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOC0wOS0xMlQyMTo0ODoyNC0wNTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOC0wOS0xMlQyMTo0ODoyNC0wNTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowZmU3NjVjNi01NjhmLTRhY2UtYTVlMi1kMjJmMDA5NDBiNmMiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpiODQwOTQzYS1iNjliLTdhNDItODNiZS0zOTY2YWEwNmIxMDQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxZTRlNGRmMi0zYjYwLTQ0OWQtOWY1OS1hZDBlZjExMWNlMDMiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjFlNGU0ZGYyLTNiNjAtNDQ5ZC05ZjU5LWFkMGVmMTExY2UwMyIgc3RFdnQ6d2hlbj0iMjAxOC0wOS0xMlQyMToyNToxNC0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBpbWFnZS9wbmcgdG8gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6M2E4ZGZjNmQtZmVkNC00MzI4LTgzMjgtMzRmY2M2YjIyMzExIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIxOjM4OjQ1LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NTdmMzAzOWEtODMwNC00MDhlLWI2ZDQtNjRhNTczZGZlNTNiIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIxOjQ4OjI0LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MGZlNzY1YzYtNTY4Zi00YWNlLWE1ZTItZDIyZjAwOTQwYjZjIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIxOjQ4OjI0LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTdmMzAzOWEtODMwNC00MDhlLWI2ZDQtNjRhNTczZGZlNTNiIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFlNGU0ZGYyLTNiNjAtNDQ5ZC05ZjU5LWFkMGVmMTExY2UwMyIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjFlNGU0ZGYyLTNiNjAtNDQ5ZC05ZjU5LWFkMGVmMTExY2UwMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PotzvqwAAAlFSURBVFiFxVhpkF1FFf7O6b7v3vu2mSSTbTKTmYTJPkkGCISlCFjBsIiouEAoUNSSkooiGFNlJQiFSyRKAqXID1ZTilJlEbFY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\"","module.exports = \"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAArCAYAAADyijE0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAKp2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDYtMjFUMTE6Mjc6NDYtMDU6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTExLTE4VDE1OjQyOjQ3LTA2OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTExLTE4VDE1OjQyOjQ3LTA2OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmJjZmIyYjEwLWEzZmEtNDEzNC04MTRlLWFkOTk1MzY0YWI2MSIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjE4MzhiYWEzLTQ0OTEtODU0MC1hZDBkLTZlNDYxYjg1Y2FmNyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmMyZmRkYmUwLTkxNTktNDUzZi1hNTc0LTQyYWJlMjJmM2ViOCIgdGlmZjpPcmllbnRhdGlvbj0iMSIgdGlmZjpYUmVzb2x1dGlvbj0iMzAwMDAwMC8xMDAwMCIgdGlmZjpZUmVzb2x1dGlvbj0iMzAwMDAwMC8xMDAwMCIgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIgZXhpZjpDb2xvclNwYWNlPSIxIiBleGlmOlBpeGVsWERpbWVuc2lvbj0iMTg3MSIgZXhpZjpQaXhlbFlEaW1lbnNpb249IjE4NzEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmMyZmRkYmUwLTkxNTktNDUzZi1hNTc0LTQyYWJlMjJmM2ViOCIgc3RFdnQ6d2hlbj0iMjAxOC0wNi0yMVQxMToyNzo0Ni0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjRjNTVlYzUyLTNhMmItNDU4NC04ZWJmLThhNWQ5ODFmNGNhYiIgc3RFdnQ6d2hlbj0iMjAxOC0xMS0xOFQxNTozOTozOC0wNjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjQzZjE3NmNiLWFhMGYtNDZkYS1iZTk1LTczZjUyNTI2MGZkOCIgc3RFdnQ6d2hlbj0iMjAxOC0xMS0xOFQxNTo0Mjo0Ny0wNjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmJjZmIyYjEwLWEzZmEtNDEzNC04MTRlLWFkOTk1MzY0YWI2MSIgc3RFdnQ6d2hlbj0iMjAxOC0xMS0xOFQxNTo0Mjo0Ny0wNjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQzZjE3NmNiLWFhMGYtNDZkYS1iZTk1LTczZjUyNTI2MGZkOCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpjMmZkZGJlMC05MTU5LTQ1M2YtYTU3NC00MmFiZTIyZjNlYjgiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjMmZkZGJlMC05MTU5LTQ1M2YtYTU3NC00MmFiZTIyZjNlYjgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7y32vAAAADuklEQVRYhe2YTWhjVRTHf/e+jzRtMglaW1tSptC0tpShC0EQKqUutG6qojgrF8Iwiu4GcSEuFXfqTgYd7FpBMLNxNkJFunDRLrIouugH/bax9pm2JO+93DuL5MUmmYQOzWu78L+5eSfn8n7v3nPOe/cIrTUAs7Oz1EkAt4BpQAIOcA/4vd4xUCaTafbXmWQ2sSeBB8BzdfbbwCfAZ+e662PAJIA/gaeAPeCryvgC8A7wKdAPfNBuGPkI290KyDzwLHAIjALfAS9XfN4HXgobpge4Wfn9IfAD8DXwEfArkALuACil3jVNk46ODrTWKKXaB1MoFJBSjmqtkVJmDMN4TWv9PDCvtb5VcfsmmBOJRJ45OjpiZWUF0zTp6upqH8zAwAD5fF7bto3jOEe7u7v9AK7rfuF53j2lVEZKKT3Pu1YoFDAMw8hms2xtbWHbNqVS6dwwYm5u7gngY63106urq/2Li4vTsVhs3TAMXSqVBoeGhuaHh4dXFhYWXtzY2Lg+MjKS3dzcvBGNRv+dmpr6CZCWZbnn5PgH+NwEXgfei0ajXd3d3eRyOfr6+q7PzMzgOA5CiKlEIjFlWRa5XI7p6ekbk5OT5PP5a7Ztv62Uake8nAB/mMC3AL7vo5RCCAGAYRhEIhG01ggh0FoTFEjLsrBtu8Z2TnUCd03ABWwhBL7vA6C1xvM8fN9Ha12NByEESil836/6tlGuBIrBValUqt78dEC6rovrukhZjnfP89oNAlCsZpPneViWhRACKWV1VQCKxSK2bSOlrFmpdqum6AUxUB8HpmkihKiuSAhb1AjTSgFgEOBXAiZMnRnmInS1YZRSmKaJZVn/OUmJZVkopULdroZsqrwoOT4+rtpd18VxHGzbDg2kASYej9Pb28vh4SHr6+tV+87ODnt7eySTSTo7O0PLqJrPzkgkQjqdJpvNsrS0xNraGkII9vf3UUoxMTFBMpkMbasavoHHxsYQQrC8vMzBwQFQjpl0Os34+DjRaJSTk5OLgQEYHR0lFouxvb0NQE9PD4ODg0A5fsJSs6MKqVSKVCrVYA/rVQBXvc5cpv6HaaarBBNvmk1t0s/Ab8BZqmQxTJgHwCuPMyFMmF8qowSepNzvaSUZJky8MiaAFcpno2YSgAgTRpwaY2fw//4isklTPr620o/AzauQ2hngDbj8OpMBXg0uLhOmBgQuD+Z+PQiUYVqlXLt0ugLfBxqazgHM+TuDj9bphwwafk1BoFyB3wS+pNyIbqf+rowS+ItyK/etVhMeAuZkZDAeOcH2AAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAGAGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDktMTJUMjI6MDk6NDctMDU6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA5LTEyVDIyOjIxOjM5LTA1OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA5LTEyVDIyOjIxOjM5LTA1OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjYxYmMzYjk1LWE4ZDItNDFjZC1iMTFhLTFjMzY3NWYxY2IyZiIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmUxMGM5NWJkLWI1NmEtNzI0Zi1hMzJlLTJjZTk1NDRmMDljNCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjhhZDQ5Y2Q5LWMyZGEtNGMxYi1iMmJhLTBiZDZiMjJmZmM5MyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OGFkNDljZDktYzJkYS00YzFiLWIyYmEtMGJkNmIyMmZmYzkzIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIyOjA5OjQ3LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NjFiYzNiOTUtYThkMi00MWNkLWIxMWEtMWMzNjc1ZjFjYjJmIiBzdEV2dDp3aGVuPSIyMDE4LTA5LTEyVDIyOjIxOjM5LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6mqJQFAAADHklEQVRYhc2YTWhcVRSAv3Pfve/NNKbtdNKg0bQlFUOxakyVlnZR6EbQVTciFMSli26qBTei0B/cZO1OsHTjTkRcuZAKarASNG1J29CKEap2TJqQSTLv597r4iWDSnWmneFNDjzeD+ee93Huuefcc8V7z2YRKR85QbT/2Nuq8vgoNhY8RdIJJvJu6e7t5MqXE9qMHDird4+96xvL4KMCOZo4mOGn8Y3lIam+d8mLUvgsKR5kQwIDgALf8GncOxCALAFn1xTOpoj0FkYEvMtUbyn+Kbr5JAKioMilnnuk+U/d/GhTkAB0mCsUAWIzcFkewN6vwwSGiVf2Xnnj4K5nUmtrUEQMeUwQ7Pzkh1+nTn4xN04Wr8PYjKHtfXUAEwQ7CyBpyhPV/jo2BaAZwGmWhUVCbEiSZs1Mu6lWU9dgZq99ytLibx3Z6BrM4t3P+Xnmo45sdA1Gm3727fqO6W/eZKW+0FuYJDX8uZAwsPU2tZuvMjP92QPb0K0Urk5dRPvrxMm/M3P+LgJZllBWP1FfcaSZpxwpquUP+fHbSZ49dA6lgu7AlN3HlMKAsvrvrCwlYXXNkWUeJdCIHXGS8FhlitnLx4mq77DnySOdw6wlIWka41zrmrVR/DfutfmYvj5LOTnD5UvjvHj0g/8d3zpmfGelwTlPEICw2lK3pWe2lGKiUN/fMwLOepyHOHZY6/NCvK46sCOkvgL33Fu8cPSlzmEW0+Po+AaNv20GZX0enPOEYYCQoNwMoRGs9YShsH2r4c7CPkafP0up3N8SpC2Y8UMn2zI0+dUpqpWreJ975vfV13nu8Im2xrYN065EJp+W2V8GGBo9x3B1+IFtdA0mS+aZmRtj7PD5h7bRNZhtgy9TGTzQkY2uwTy1/7WObWzO/YzWOu0FgDG62cpqlNIozfzyagmqWOfuFQUSKFWpLa2UCAzYNJDq+1/nabNRx4sgOiqmdxLJ21rvINqCiBCEI+M7gsGRg3iHMmHeyKkCLlGINqA0UnqEbG76gk5vfX9a9VVqatuju12jIVDc+YwHxETYP27dSW5OTshmOrn6C2gfIpLerWS0AAAAAElFTkSuQmCC\"","module.exports = __webpack_public_path__ + \"static/media/sample_view.e92880b7.gif\";","import axios from 'axios';\r\n\r\n// export const url = 'https://kf6.ikit.org';\r\n// export const url = 'https://kf6-stage.ikit.org';\r\nexport let url = localStorage.getItem(\"server\");\r\nexport let apiUrl = `${url}/api`;\r\n\r\nexport function setServer(server) {\r\n    //SET SERVER ON SESSION STORAGE\r\n    if (server.endsWith(\"/\")){\r\n        server = server.substring(0, server.length -1);\r\n    }\r\n    localStorage.setItem(\"server\", server);\r\n    url = server;\r\n    apiUrl = `${url}/api`;\r\n    return url;\r\n}\r\n\r\nexport function setToken(token) {\r\n    axios.defaults.headers.common['Authorization'] =\r\n        `Bearer ${token}`;\r\n}\r\n\r\nexport const removeToken = () => {\r\n    delete axios.defaults.headers.common.Authorization\r\n}\r\n\r\n\r\nconst token = sessionStorage.getItem('token');\r\nif (token) {\r\n    setToken(token)\r\n}\r\n\r\n//USER\r\nexport const getUser = async () => {\r\n    return (await axios.get(`${apiUrl}/users/me`)).data\r\n}\r\n\r\n//Contribution\r\nexport const postContribution = (communityId, obj) => {\r\n    return axios.post(`${apiUrl}/contributions/${communityId}`, obj);//, {mode: 'cors'});\r\n}\r\n\r\n//Community\r\nexport const getCommunity = (communityId) => {\r\n    return axios.get(`${apiUrl}/communities/${communityId}`);//, {mode: 'cors'});\r\n}\r\n\r\nexport const getCommunities = async () => {\r\n    return (await axios.get(`${apiUrl}/communities/`)).data\r\n}\r\n\r\nexport const getUserCommunities = async () => {\r\n    return (await axios.get(`${apiUrl}/users/myRegistrations`)).data\r\n}\r\n\r\nexport const getGroups = async (communityId) => {\r\n    return (await axios.get(`${apiUrl}/communities/${communityId}/groups`)).data\r\n}\r\n\r\nexport const getCommunityViews = async (communityId) => {\r\n    return (await axios.get(`${apiUrl}/communities/${communityId}/views`)).data\r\n}\r\n\r\n//Links\r\nexport const getLinks = async (objectId, direction, type) => {\r\n    let links = await axios.get(`${apiUrl}/links/${direction}/${objectId}`);\r\n    links = links.data;\r\n    if (type) {\r\n        links = links.filter(function (each) {\r\n            return each.type === type;\r\n        });\r\n    }\r\n    return links\r\n}\r\n\r\nexport const postLink = async (fromId, toId, type, data) => {\r\n    return (await axios.post(`${apiUrl}/links`, { from: fromId, to: toId, type: type, data: data })).data\r\n}\r\n\r\nexport const deleteLink = async (linkId) => {\r\n    return (await axios.delete(`${apiUrl}/links/${linkId}`)).data\r\n}\r\n\r\nexport const linksSearch = async (communityId, query) => {\r\n    return (await axios.post(`${apiUrl}/links/${communityId}/search`, { \"query\": query })).data\r\n}\r\n\r\n//Object\r\nexport const getObject = async (objectId) => {\r\n    return (await axios.get(`${apiUrl}/objects/${objectId}`)).data\r\n}\r\n\r\nexport const putObject = async (object, communityId, objectId) => {\r\n    return (await axios.put(`${apiUrl}/objects/${communityId}/${objectId}`, object)).data\r\n}\r\n\r\n//Record\r\nexport const read = (communityId, objectId) => {\r\n    return axios.post(`${apiUrl}/records/read/${communityId}/${objectId}`)\r\n}\r\n\r\nexport const postAttachment = (communityId, authorId) => {\r\n    var newobj = {\r\n        communityId: communityId,\r\n        type: 'Attachment',\r\n        title: 'an Attachment',\r\n        authors: [authorId],\r\n        status: 'unsaved',\r\n        permission: 'protected',\r\n        data: {\r\n            version: 0\r\n        }\r\n    };\r\n    return axios.post(`${apiUrl}/contributions/${communityId}`, newobj)\r\n}\r\n\r\nexport const postContribObject = async (communityId, obj) => {\r\n    return (await axios.post(`${apiUrl}/contributions/${communityId}`, obj)).data\r\n}\r\n\r\n//Author\r\nexport const getAuthor = (communityId) => {\r\n    return axios.get(`${apiUrl}/authors/${communityId}/me`)\r\n}\r\nexport const getCommunityAuthors = async (communityId) => {\r\n    return (await axios.get(`${apiUrl}/communities/${communityId}/authors`)).data\r\n}\r\n\r\n//Records\r\nexport const getRecords = async (contribId) => {\r\n    return (await axios.get(`${apiUrl}/records/object/${contribId}`)).data\r\n}\r\n\r\nexport const uploadFile = (file, onProgress) => {\r\n    var formData = new FormData();\r\n    formData.append(\"file\", file);\r\n    return axios.post(`${apiUrl}/upload`, formData, {\r\n        headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n            // ...config.headers\r\n        },\r\n        onUploadProgress: onProgress,\r\n    })\r\n}\r\n\r\nexport const getLinkForObj = (objId) => {\r\n    return axios.get(`${apiUrl}/links/either/${objId}`)\r\n}\r\n\r\n// returns a promise that on fullfillment returns an array of the read note ids only\r\nexport function getApiLinksReadStatus(communityId, viewId){\r\n    return axios.get(`${apiUrl}/records/myreadstatusview/${communityId}/${viewId}`).then(function(result) {\r\n        const body = result.data\r\n        var results = [];\r\n        for(var i in body){\r\n            if(body[i].type === \"read\"){ results.push(body[i].to); }\r\n        }\r\n        return (results);\r\n    }).catch(function(error) {\r\n        return (\"Error:\", error);\r\n    });\r\n}\r\n\r\n// used to mark notes as read according to the given parameters\r\nexport function postReadStatus(communityId, contributionId){\r\n    return axios.post(`${apiUrl}/records/read/${communityId}/${contributionId}`).then(function(body) {\r\n        return body\r\n    }).catch(function(error) {\r\n        return (\"Error:\", error);\r\n    });\r\n}\r\n","import { createAction, createReducer } from '@reduxjs/toolkit';\r\nimport * as api from './api.js'\r\n\r\nexport const addUser = createAction('ADD_USER')\r\nexport const addAuthors = createAction('ADD_AUTHORS')\r\nconst initState = {}\r\nexport const userReducer = createReducer(initState, {\r\n    [addUser]: (state, action) => {\r\n        state[action.payload._id] = action.payload\r\n    },\r\n    [addAuthors]: (state, action) => {\r\n        action.payload.forEach((author) => state[author._id] = author )\r\n    }\r\n\r\n})\r\n\r\nexport const fetchAuthors = (communityId) => async (dispatch) => {\r\n    const authors = await api.getCommunityAuthors(communityId)\r\n    dispatch(addAuthors(authors))\r\n}\r\n","import { createAction, createReducer } from '@reduxjs/toolkit';\r\nimport * as api from './api.js'\r\n\r\nexport const requestScaffold = createAction('REQUEST_SCAFFOLD')\r\nexport const receiveScaffold= createAction('RECEIVE_SCAFFOLD')\r\n\r\nconst initState = {isFetching: false,\r\n                   items: [],\r\n                   fetched: false,\r\n                  }\r\n\r\nexport const scaffoldReducer = createReducer(initState, {\r\n    [receiveScaffold]: (state, action) => {\r\n        state.items = action.payload\r\n        state.isFetching = false\r\n        state.fetched = true\r\n    },\r\n    [requestScaffold]: (state, action) => {\r\n        state.isFetching = true\r\n    }\r\n});\r\n\r\nexport const fetchScaffolds = (communityId, contextId) => {\r\n    return dispatch => {\r\n        dispatch(requestScaffold)\r\n\r\n        let scaffold_promise = api.getCommunity(communityId).then( res => {\r\n            return Promise.all(res.data.scaffolds.map((scaffoldId) => {\r\n                return api.getObject(scaffoldId);\r\n            }));\r\n        });\r\n\r\n        return Promise.all([scaffold_promise, api.getLinks(contextId, 'from', 'uses')]).then(async res =>{\r\n            let links = res[1].map((link) => link.to);\r\n            let scaffolds = res[0].filter((el) => links.includes(el._id));\r\n            /* const scaffolds = this.state.scaffolds; */\r\n            let supports = await Promise.all(scaffolds.map((el) => api.getLinks(el._id, 'from')));\r\n            scaffolds = scaffolds.map((scaffold, i) => {\r\n                scaffold.supports = supports[i];\r\n                return scaffold;\r\n            })\r\n\r\n            dispatch(receiveScaffold(scaffolds))\r\n        });\r\n    }\r\n}\r\n","import { createAction, createReducer } from '@reduxjs/toolkit'\r\nimport { getObject, getCommunity, getGroups, getUser, getAuthor, getCommunityViews, getCommunities, getUserCommunities, setServer, setToken } from './api.js'\r\nimport { fetchAuthors } from './userReducer.js';\r\nimport { fetchScaffolds } from './scaffoldReducer.js'\r\nexport const setGlobalToken = createAction('SET_TOKEN')\r\nexport const setCurrentLoginForm = createAction('SET_CURRENT_LOGIN_FORM')\r\nexport const setCommunity = createAction('SET_COMMUNITY')\r\nexport const setCommunityId = createAction('SET_COMMUNITY_ID')\r\nexport const setCurrentServer = createAction('SET_CURRENT_SERVER')\r\nexport const setViewId = createAction('SET_VIEW_ID')\r\nexport const setLoggedUser = createAction('SET_AUTHOR')\r\nexport const setView = createAction('SET_VIEW')\r\nexport const setAuthor = createAction('SET_AUTHOR')\r\nexport const setViews = createAction('SET_VIEWS')\r\nexport const editCommunity = createAction('EDIT_COMMUNITY')\r\nexport const setUserId = createAction('SET_USERID')\r\nexport const setIsAuthenticated = createAction('SET_ISAUTHENTICATED')\r\nexport const setCommunities = createAction('SET_COMMUNITIES')\r\nexport const setUserCommunities = createAction('SET_USER_COMMUNITIES')\r\nexport const dateFormatOptions = {\r\n    year: 'numeric', month: 'numeric', day: 'numeric',\r\n    hour: 'numeric', minute: 'numeric', second: 'numeric',\r\n    hour12: true\r\n};\r\n\r\nconst initState = {\r\n    token: sessionStorage.getItem(\"token\"),\r\n    currentLoginForm: \"Login\",\r\n    communityId: null,\r\n    currentServer: null,\r\n    viewId: null,\r\n    contextId: '',\r\n    user: null,\r\n    view: null,\r\n    views: [],\r\n    community: null,\r\n    userId: '',\r\n    isAuthenticated: sessionStorage.getItem(\"token\") ? true : false,\r\n    communities: [],\r\n    userCommunities: [],\r\n    servers: [\r\n        {\r\n            id: 0,\r\n            key: \"kf6.ikit.org\",\r\n            value: \"https://kf6.ikit.org\"\r\n\r\n        },\r\n        {\r\n            id: 1,\r\n            key: \"kf6-stage.ikit.org\",\r\n            value: \"https://kf6-stage.ikit.org\"\r\n\r\n        },\r\n        {\r\n            id: 2,\r\n            key: \"kf6-stage.rit.albany.edu\",\r\n            value: \"https://kf6-stage.rit.albany.edu\"\r\n\r\n        },\r\n        {\r\n            id: 3,\r\n            key: \"kf.rdc.nie.edu.sg\",\r\n            value: \"https://kf.rdc.nie.edu.sg\"\r\n\r\n        },\r\n        {\r\n            id: 4,\r\n            key: \"kf.rit.albany.edu\",\r\n            value: \"https://kf6.rit.albany.edu\"\r\n\r\n        },\r\n        // {\r\n        //     id: 5,\r\n        //     key: \"localhost 9000\",\r\n        //     value: \"http://localhost:9000\"\r\n\r\n        // },\r\n    ]\r\n}\r\n\r\nexport const globalsReducer = createReducer(initState, {\r\n    [setGlobalToken]: (state, action) => {\r\n        state.token = action.payload\r\n        state.isAuthenticated = state.token ? true : false\r\n        setToken(action.payload)\r\n    },\r\n    [setIsAuthenticated]: (state, action) => {\r\n        state.isAuthenticated = state.token ? true : false\r\n    },\r\n    [setCurrentLoginForm]: (state, action) => {\r\n        state.currentLoginForm = action.payload\r\n    },\r\n    [setCommunityId]: (state, action) => {\r\n        state.communityId = action.payload\r\n    },\r\n    [setCurrentServer]: (state, action) => {\r\n        state.currentServer = action.payload\r\n        setServer(action.payload)\r\n    },\r\n    [setViewId]: (state, action) => {\r\n        state.viewId = action.payload\r\n    },\r\n    [setUserId]: (state, action) => {\r\n        state.userId = action.payload\r\n    },\r\n    [setLoggedUser]: (state, action) => {\r\n        state.user = action.payload\r\n    },\r\n    [setView]: (state, action) => {\r\n        state.view = action.payload\r\n    },\r\n    [setViews]: (state, action) => {\r\n        state.views = action.payload\r\n    },\r\n    [setCommunity]: (state, action) => {\r\n        state.community = action.payload\r\n        state.communityId = action.payload._id\r\n        state.contextId = action.payload.rootContextId\r\n    },\r\n    [editCommunity]: (state, action) => {\r\n        state.community = { ...state.community, ...action.payload }\r\n    },\r\n    [setCommunities]: (state, action) => {\r\n        state.communities = action.payload\r\n    },\r\n    [setUserCommunities]: (state, action) => {\r\n        state.userCommunities = action.payload\r\n    },\r\n    [setAuthor]: (state, action) => {\r\n        state.author = action.payload\r\n    },\r\n});\r\n\r\nexport const fetchAuthor = (communityId) => {\r\n    return dispatch => {\r\n        return getAuthor(communityId).then(res => {\r\n            dispatch(setAuthor(res.data));\r\n        })\r\n    }\r\n}\r\nexport const fetchCommunities = () => {\r\n    return async dispatch => {\r\n        const communities = await getCommunities()\r\n        dispatch(setCommunities(communities))\r\n    }\r\n}\r\n\r\nexport const fetchUserCommunities = () => {\r\n    return async dispatch => {\r\n        const communities = await getUserCommunities()\r\n        dispatch(setUserCommunities(communities))\r\n    }\r\n}\r\n\r\nexport const fetchView = (viewId) => {\r\n    return dispatch => {\r\n        return getObject(viewId).then(res => {\r\n            dispatch(setView(res))\r\n        })\r\n    }\r\n}\r\n\r\nexport const fetchCommunity = (communityId) => {\r\n    return dispatch => {\r\n        return getCommunity(communityId).then(res => {\r\n            dispatch(setCommunity(\r\n                { groups: [], ...res.data }\r\n            ))\r\n        })\r\n    }\r\n}\r\n\r\nexport const fetchCommGroups = (communityId) => async (dispatch) => {\r\n    const groups = await getGroups(communityId)\r\n    dispatch(editCommunity({ groups }))\r\n}\r\n\r\nexport const fetchLoggedUser = () => async (dispatch) => {\r\n    const user = await getUser()\r\n    dispatch(setUserId(user._id))\r\n    dispatch(setLoggedUser(user))\r\n}\r\n\r\nexport const fetchCommunityViews = (communityId) => async (dispatch) => {\r\n    const views = await getCommunityViews(communityId)\r\n    dispatch(setViews(views))\r\n}\r\n\r\nexport const fetchViewCommunityData = (viewId) => async (dispatch) => {\r\n\r\n    //GET LIST OF ALL COMMUNITIES\r\n    dispatch(fetchCommunities())\r\n    //GET USER'S REGISTERED COMMUNITIES\r\n    // dispatch(fetchUserCommunities())\r\n    // dispatch(setCheckedNotes([]))\r\n    const view = await getObject(viewId)\r\n    const commId = view.communityId\r\n    dispatch(setView(view))\r\n    dispatch(setViewId(view._id))\r\n    // dispatch(fetchViewNotes(view._id))\r\n    const community = (await getCommunity(commId)).data\r\n    dispatch(setCommunity(\r\n        { groups: [], ...community }\r\n    ))\r\n    // dispatch(fetchBuildsOn(commId))\r\n    dispatch(fetchAuthor(commId))\r\n    // dispatch(fetchCommunityViews(commId))\r\n    dispatch(fetchAuthors(commId))\r\n    // dispatch(fetchReadLinks(commId, view._id))\r\n    dispatch(fetchScaffolds(commId, community.rootContextId))\r\n    // dispatch(fetchSupports(commId))\r\n}\r\n","// returns a promise that on fullfillment returns the users token\r\nexport function getUserToken(username, password, server){\r\n  var body = {\r\n    'userName': username,\r\n    'password': password\r\n  };\r\n\r\n  return fetch(server + 'auth/local', {\r\n    method: \"POST\",\r\n    headers: {'Content-Type': 'application/json'},\r\n    body: JSON.stringify(body),\r\n  }).then(function(response) {\r\n      if(response.status !== 200){\r\n        console.log(\"Error: \" + server + 'auth/local');\r\n        console.log(response);\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return body;\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n\r\n}\r\n\r\n\r\n// returns a promise that on fulfillment returns an [user token, server] object pair\r\nexport function getUserTokenServerPair(username, password, server){\r\n  var body = {\r\n    'userName': username,\r\n    'password': password\r\n  };\r\n\r\n  return fetch(server + 'auth/local', {\r\n    method: \"POST\",\r\n    headers: {'Content-Type': 'application/json'},\r\n    body: JSON.stringify(body),\r\n  }).then(function(response) {\r\n      if(response.status !== 200){\r\n        console.log(\"Error: \" + server + 'auth/local');\r\n        console.log(response);\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return [body, server];\r\n  }).catch(function(error) {\r\n      console.log(\"Error: \" + server + 'auth/local');\r\n      console.log(error);\r\n      return [{error: \"Error: server unavailable\"}, server];\r\n  });\r\n}\r\n\r\n\r\n// returns a promise that on fullfillment returns the user information corresponding to the given token and server\r\nexport function getUserInfo(token, server){\r\n\r\n  return fetch(server + 'api/users/me', {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n      if(response.status !== 200 && response.status !== 304){\r\n        console.log(\"Error: \" + server + \"api/users/me\");\r\n        console.log(response);\r\n        return {error: true};\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return (body);\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n\r\n}\r\n\r\n\r\n// returns a promse that on fulfillment returns the communities a user is registered to in a given server from their token\r\nexport function getUserCommunities(token, server){\r\n  return fetch(server + 'api/users/myRegistrations', {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n    if(response.status !== 200){\r\n      console.log(\"Error: \" + server + 'api/users/myRegistrations');\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n      return (body);\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n}\r\n\r\nexport function postNewUser(server, firstname, lastname, email, username, password){\r\n  var body = {\r\n    'email': email,\r\n    'firstName': firstname,\r\n    'lastName': lastname,\r\n    'password': password,\r\n    'userName': username\r\n  };\r\n\r\n  return fetch(server + 'api/users', {\r\n    method: \"POST\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify(body),\r\n  }).then(function(response) {\r\n    if(response.status !== 200){\r\n      console.log(\"Error: \" + server + 'api/users');\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n    return [body, server];\r\n  }).catch(function(error) {\r\n    return [{error: \"Error: server unavailable\"}, server];\r\n  });\r\n}\r\n\r\nexport function postNewSingaporeUser(server, firstname, lastname, email, username, password, registrationKey){\r\n  var body = {\r\n    'email': email,\r\n    'firstName': firstname,\r\n    'lastName': lastname,\r\n    'password': password,\r\n    'registrationKey': registrationKey,\r\n    'userName': username\r\n  };\r\n\r\n  return fetch(server + 'api/users', {\r\n    method: \"POST\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify(body),\r\n  }).then(function(response) {\r\n    if(response.status !== 200){\r\n      console.log(\"Error: \" + server + 'api/users');\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n    return [body, server];\r\n  }).catch(function(error) {\r\n    return [{error: \"Error: server unavailable\"}, server];\r\n  });\r\n}\r\n","/*\r\n* EDIT AVAILABLE SERVERS HERE\r\n* {name:\"SERVER NAME\", url:\"SERVER URL\"}\r\n*/\r\nexport const SERVERS = [\r\n  {name:\"IKIT Stage\", url:\"https://kf6-stage.ikit.org/\"},\r\n  {name:\"Albany Stage\", url:\"https://kf6-stage.rit.albany.edu/\"},\r\n  {name:\"IKIT\", url:\"https://kf6.ikit.org/\"},\r\n  {name:\"Albany\", url:\"https://kf6.rit.albany.edu/\"},\r\n  {name:\"Singapore\", url:\"https://kf.rdc.nie.edu.sg/\"},\r\n  // {name:\"Local\", url:\"http://localhost:9000/\"}\r\n];\r\n\r\n// ZOOM VALUES FOR CYTOSCAPE GRAPH\r\nexport const MINZOOM = 0.75;\r\nexport const MAXZOOM = 2;\r\n\r\n// Helper function to retrieve a servers name from its URL\r\nexport function getServerName(url){\r\n  for(var i in SERVERS){\r\n    if(SERVERS[i].url === url){ return SERVERS[i].name; }\r\n  }\r\n\r\n  return \"Error: server \" + url + \" does not exist\";\r\n}\r\n\r\n\r\n// Helper function to retrieve a servers URL from its name\r\nexport function getServerURL(name){\r\n  for(var i in SERVERS){\r\n    if(SERVERS[i].name === name){ return SERVERS[i].url; }\r\n  }\r\n\r\n  return \"Error: server \" + name + \" does not exist\";\r\n}\r\n\r\n\r\n// Helper function to retrieve the current users token for a specified server\r\nexport function extractTokenFromStorage(server) {\r\n  var uname = localStorage.getItem(\"Username\");\r\n  var data = JSON.parse(localStorage.getItem(uname));\r\n\r\n  for (var i in data) {\r\n    if (data[i][0] === server) {\r\n      return data[i][1];\r\n    }\r\n  }\r\n}\r\n","/*\r\n* THIS FILE PROVIDES HELPER FUNCTIONS FOR LOGIN COMPONENT\r\n*/\r\nimport {getUserTokenServerPair} from '../api/user.js';\r\nimport {SERVERS} from '../config.js';\r\n\r\n\r\n// Executes all promises to get user token for each server at once\r\nexport function executePromises(uname, pwd, login_form_component){\r\n  const promises = [];\r\n\r\n  // if the checkbox on login page is checked clear the local storage\r\n  var firstLogin = document.getElementById(\"refreshCheckbox\").checked;\r\n  if(firstLogin){ localStorage.clear(); }\r\n\r\n  var userStorage = JSON.parse(localStorage.getItem(uname));\r\n\r\n  // If it is the first time logging in we test all servers (userStorage == null)\r\n  // else we only call the servers stored in users local storage list\r\n  if(userStorage == null){\r\n    for(let i in SERVERS){\r\n      promises.push(getUserTokenServerPair(uname, pwd, SERVERS[i].url));\r\n    }\r\n  } else {\r\n    for(let i in userStorage){\r\n      promises.push(getUserTokenServerPair(uname, pwd, userStorage[i][0]));\r\n    }\r\n  }\r\n\r\n  // execute all the login promises\r\n  Promise.all(promises).then(function(data){\r\n    responseHandler(uname, data, login_form_component);\r\n  }).catch(function(error){\r\n    console.log(error);\r\n  });\r\n}\r\n\r\n\r\n// Handles each servers response to the users credentials\r\n// If no succesful logins then displays error message to user\r\n// Otherwise redirects to next page\r\n// each item in data is [response body, server]\r\nexport function responseHandler(uname, data, login_form_component){\r\n  var successfulLogin = false;\r\n  var errorMessage = \"\";\r\n  var serverTokenPair = [];\r\n\r\n  // retrieve users server information from local storage in order to find last active server\r\n  // value will be null if its first login\r\n  var userStorage = JSON.parse(localStorage.getItem(uname));\r\n\r\n  for(var i in data){\r\n    if(data[i][0].token !== undefined) {\r\n      var token = data[i][0].token;\r\n      var server = data[i][1];\r\n\r\n      // if its the first login we set first server as the default active server\r\n\r\n      // and all other servers as inactive\r\n      if(userStorage === null && successfulLogin === false){\r\n        serverTokenPair.push([server, token, \"active\"]);\r\n      } else if(userStorage == null){\r\n        serverTokenPair.push([server, token, \"inactive\"]);\r\n      }\r\n\r\n      // if it is not the first login then we retrieve last active server from localStorage\r\n      else if(userStorage[i][2] === \"active\"){\r\n        serverTokenPair.push([server, token, \"active\"]);\r\n      } else {\r\n        serverTokenPair.push([server, token, \"inactive\"]);\r\n      }\r\n\r\n      successfulLogin = true;\r\n\r\n\r\n      // this else if case handles a user having the same username on multiple servers but with different passwords\r\n    } else if(data[i][0].message !== undefined && userStorage !== null){\r\n      var username = document.getElementById(\"uname\").value;\r\n      var password = document.getElementById(\"pwd\").value;\r\n      localStorage.removeItem(username);\r\n      executePromises(username, password, login_form_component);\r\n      break;\r\n    } else if(data[i][0].message !== undefined && errorMessage === \"\") {\r\n      errorMessage = data[i][0].message;\r\n    } else if(errorMessage === \"This userName is not registered.\" && data[i][0].message === \"This password is not correct.\") {\r\n      errorMessage = data[i][0].message;\r\n    } else if(data[i][0].error !== undefined && errorMessage === \"\") {\r\n      errorMessage = data[i][0].error;\r\n    }\r\n  }\r\n\r\n  if(!successfulLogin){\r\n    document.getElementById(\"errorMessage\").style.display = \"visible\";\r\n    login_form_component.setState({errorMessage: errorMessage});\r\n  } else {\r\n    localStorage.setItem(\"Username\", uname);\r\n    localStorage.setItem(uname, JSON.stringify(serverTokenPair));\r\n    login_form_component.setState({response: JSON.stringify(serverTokenPair)});\r\n    login_form_component.props.history.push('/dashboard');\r\n  }\r\n\r\n}\r\n\r\nexport function getLoginData(){\r\n    const uname = localStorage.getItem(\"Username\");\r\n    if (uname){\r\n        const servers = JSON.parse(localStorage.getItem(uname));\r\n        for(let server_data of servers){\r\n            if (server_data[2] === 'active'){\r\n                return server_data;\r\n            }\r\n        }\r\n    }\r\n    return [null,null,null]\r\n}\r\n","import React, {Component} from 'react';\r\nimport {withRouter} from 'react-router';\r\nimport { connect } from 'react-redux';\r\nimport { compose } from 'redux';\r\nimport { setCurrentLoginForm } from './store/globalsReducer.js'\r\nimport $ from 'jquery';\r\nimport '../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js';\r\nimport {executePromises} from './helper/Login_helper.js';\r\n\r\nimport './css/Login.css';\r\n\r\nclass LoginForm extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      uname: null,\r\n      pwd: null,\r\n      errorMessage: null,\r\n    }\r\n  }\r\n\r\n  inputChangeHandler = (event) => {\r\n    let name = event.target.name;\r\n    let val = event.target.value;\r\n\r\n    this.setState({[name] : val});\r\n  }\r\n\r\n  formSubmitHandler = (event) => {\r\n    event.preventDefault();\r\n    var uname = this.state.uname;\r\n    var pwd = this.state.pwd;\r\n    document.getElementById(\"errorMessage\").style.display = \"hidden\";\r\n    executePromises(uname, pwd, this);\r\n    return false;\r\n  }\r\n\r\n  openSignUpForm = (event) => {\r\n    this.props.setCurrentLoginForm(\"SignUp\");\r\n  }\r\n\r\n  componentDidMount(){\r\n    // enables the popover for refreshing servers on login tool tip\r\n    $('[data-toggle=\"tooltip\"]').tooltip()\r\n    $('[data-toggle=\"popover\"]').popover()\r\n    if($(window).width() <= 768) {\r\n      document.getElementById(\"popover\").setAttribute(\"data-trigger\", \"focus\");\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return(\r\n      <div className = \"row login-form-row\">\r\n        <div className = {\"col-lg-8 col-md-10 col-sm-12 login-form-wrapper\"}>\r\n          <h1>knowledgeforum.org</h1>\r\n          <form onSubmit={this.formSubmitHandler} className = \"loginForm\" id = \"loginForm\" autoComplete=\"on\">\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-user\"></i>\r\n              <input type=\"text\" id=\"uname\" name=\"uname\" placeholder=\"Username\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-lock\"></i>\r\n              <input type=\"password\" id=\"pwd\" name=\"pwd\" placeholder=\"Password\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-checkbox-wrapper\">\r\n              <input type=\"checkbox\" id=\"refreshCheckbox\" name=\"refreshCheckbox\"></input>\r\n              <label htmlFor=\"refreshCheckbox\">Refresh my servers on login?</label>\r\n              <span id=\"popover\" tabIndex=\"0\" role=\"button\" data-toggle=\"popover\"\r\n                data-trigger=\"hover\" data-content=\"Check this box if you have registered to any new knowledge forums servers since your last login.\">\r\n              <i className=\"far fa-question-circle\"></i></span>\r\n            </div>\r\n\r\n            <div>\r\n              <p style={{display:'hidden',color:'red'}} id = \"errorMessage\" name=\"errorMessage\">{this.state.errorMessage}</p>\r\n            </div>\r\n\r\n            <input className = \"login-button\" type=\"submit\" value=\"Login\"></input>\r\n\r\n          </form>\r\n\r\n          <p className=\"login-create-account-p\" onClick={this.openSignUpForm}>Don't have an account? Sign up <i className=\"far fa-arrow-alt-circle-right\"></i></p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nconst mapDispatchToProps = {\r\n    setCurrentLoginForm\r\n};\r\n\r\nexport default compose(\r\n    withRouter,\r\n    connect(null, mapDispatchToProps)\r\n)(LoginForm)\r\n","import React, {Component} from 'react';\r\nimport Select from 'react-select';\r\nimport makeAnimated from 'react-select/animated';\r\nimport {withRouter} from 'react-router';\r\nimport { connect } from 'react-redux';\r\nimport { compose } from 'redux';\r\nimport { setCurrentLoginForm } from './store/globalsReducer.js'\r\nimport '../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js';\r\nimport {SERVERS, getServerURL, getServerName} from './config.js';\r\nimport {postNewUser, postNewSingaporeUser} from './api/user.js';\r\n\r\nimport './css/Login.css';\r\nimport './css/SignUpForm.css';\r\n\r\nclass SignUpForm extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      servers: null,\r\n      firstname: null,\r\n      lastname: null,\r\n      email: null,\r\n      username: null,\r\n      password: null,\r\n      confirmPassword: null,\r\n      registrationKey: null,\r\n      errorMessage: null,\r\n      singaporeSelected: false,\r\n    }\r\n  }\r\n\r\n  inputChangeHandler = (event) => {\r\n    let name = event.target.name;\r\n    let val = event.target.value;\r\n\r\n    this.setState({[name] : val});\r\n  }\r\n\r\n  serverSelectHandler = (event) => {\r\n    if(event === null) {\r\n      this.setState({servers: null});\r\n      this.setState({singaporeSelected:  false});\r\n    } else {\r\n      var selected_Servers = [];\r\n      for(var i = 0; i < event.length; i++){\r\n        selected_Servers.push(event[i].value);\r\n      }\r\n      selected_Servers.includes(getServerURL(\"Singapore\")) ? this.setState({singaporeSelected: true}) : this.setState({singaporeSelected: false});\r\n      this.setState({servers: selected_Servers});\r\n    }\r\n  }\r\n\r\n  formSubmitHandler = (event) => {\r\n    event.preventDefault();\r\n    if(this.state.password !== this.state.confirmPassword){\r\n      this.setState({errorMessage: \"Passwords do not match.\"});\r\n      return false;\r\n    }\r\n\r\n    var servers = this.state.servers;\r\n    var promises = [];\r\n\r\n    for(var i = 0; i < servers.length; i++){\r\n      if(servers[i] === getServerURL(\"Singapore\")){\r\n        promises.push(postNewSingaporeUser(servers[i], this.state.firstname, this.state.lastname, this.state.email, this.state.username, this.state.password, this.state.registrationKey));\r\n      } else {\r\n        promises.push(postNewUser(servers[i], this.state.firstname, this.state.lastname, this.state.email, this.state.username, this.state.password));\r\n      }\r\n    }\r\n\r\n    var self = this;\r\n    Promise.all(promises).then((result) => {\r\n      var successfulLogin = false;\r\n      var serverTokenPair = [];\r\n\r\n      for(var j = 0; j < result.length; j++){\r\n          // if singapore is selected and failed we must show the error as it can fail due to the account creation key\r\n          if(getServerName(result[j][1]) === \"Singapore\" && result[j][0].errorCode !== undefined){\r\n\r\n          } else if(result[j][0].token !== undefined && !successfulLogin){\r\n            serverTokenPair.push([result[j][1], result[j][0].token, \"active\"]);\r\n            successfulLogin = true;\r\n          } else if(result[j][0].token !== undefined && successfulLogin){\r\n            serverTokenPair.push([result[j][1], result[j][0].token, \"inactive\"]);\r\n          } else if(result[j][0].message !== undefined) {\r\n            self.setState({errorMessage: result[j][0].message});\r\n          } else if(result[j][0].error !== undefined && this.state.errorMessage === \"\") {\r\n            self.setState({errorMessage: result[j][0].error});\r\n          } else if(result[j][0].errorCode !== undefined && this.state.errorMessage === \"\") {\r\n            self.setState({errorMessage: result[j][0].errorCode});\r\n          }\r\n      }\r\n\r\n      if(!successfulLogin){\r\n        document.getElementById(\"errorMessage\").style.display = \"visible\";\r\n      } else {\r\n        localStorage.setItem(\"Username\", this.state.username);\r\n        localStorage.setItem(this.state.username, JSON.stringify(serverTokenPair));\r\n        self.props.history.push('/dashboard');\r\n      }\r\n    });\r\n\r\n    return false;\r\n  }\r\n\r\n  openLoginForm = (event) => {\r\n    this.props.setCurrentLoginForm(\"Login\");\r\n  }\r\n\r\n  render() {\r\n    let registrationKeyInput;\r\n    if(this.state.singaporeSelected){\r\n      registrationKeyInput = <div className = \"login-input-wrapper\"><i className=\"fas fa-lock\"></i><input type=\"text\" id=\"registrationKey\" name=\"registrationKey\" placeholder=\"Singapore Account Creation Key\" required onChange={this.inputChangeHandler}></input></div>;\r\n    } else {\r\n      registrationKeyInput = null;\r\n    }\r\n\r\n    return(\r\n      <div className = \"row login-form-row\">\r\n        <div className = {\"col-lg-8 col-md-10 col-sm-12 login-form-wrapper\"}>\r\n          <h1>knowledgeforum.org</h1>\r\n          <form onSubmit={this.formSubmitHandler} className = \"loginForm\" id = \"loginForm\" autoComplete=\"on\">\r\n\r\n            <div className=\"login-input-wrapper signup-select-server\">\r\n              <i className=\"fas fa-server\"></i>\r\n              <div className=\"select-container\">\r\n                <Select\r\n                  isMulti\r\n                  options={SERVERS.map((s) => ({value: s.url, label: s.name}))}\r\n                  onChange = {this.serverSelectHandler}\r\n                  components={makeAnimated()}\r\n                  className=\"basic-multi-select\"\r\n                  classNamePrefix=\"select\"\r\n                />\r\n              </div>\r\n              <div className=\"clearFix\"></div>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-user\"></i>\r\n              <input type=\"text\" id=\"firstname\" name=\"firstname\" placeholder=\"First Name\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-user\"></i>\r\n              <input type=\"text\" id=\"lastname\" name=\"lastname\" placeholder=\"Last Name\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-envelope\"></i>\r\n              <input type=\"email\" id=\"email\" name=\"email\" placeholder=\"Email\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-user\"></i>\r\n              <input type=\"text\" id=\"username\" name=\"username\" placeholder=\"Username\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-lock\"></i>\r\n              <input type=\"password\" id=\"password\" name=\"password\" placeholder=\"Password\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            <div className = \"login-input-wrapper\">\r\n              <i className=\"fas fa-lock\"></i>\r\n              <input type=\"password\" id=\"confirmPassword\" name=\"confirmPassword\" placeholder=\"Confirm Password\" required onChange={this.inputChangeHandler}></input>\r\n            </div>\r\n\r\n            {registrationKeyInput}\r\n\r\n            <div>\r\n              <p style={{display:'hidden',color:'red'}} id = \"errorMessage\" name=\"errorMessage\">{this.state.errorMessage}</p>\r\n            </div>\r\n\r\n            <input className = \"login-button\" type=\"submit\" value=\"Create Account\"></input>\r\n\r\n          </form>\r\n\r\n          <p className=\"login-create-account-p\" onClick={this.openLoginForm}>Already have an account? Login <i className=\"far fa-arrow-alt-circle-right\"></i></p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    setCurrentLoginForm\r\n};\r\n\r\nexport default compose(\r\n    withRouter,\r\n    connect(null, mapDispatchToProps)\r\n)(SignUpForm)\r\n","// returns a promise that on fullfillment returns all the communities from the specified server\r\nexport function getCommunities(token, server) {\r\n  return fetch(server + 'api/communities', {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n      if(response.status !== 200){\r\n        console.log(\"Error: \" + server + 'api/communities');\r\n        console.log(response);\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return (body);\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n}\r\n\r\n\r\n// returns a promise that on fullfillment returns all the views from the specified community on the specified server\r\nexport function getCommunityViews(token, communityId, server){\r\n  return fetch(server + 'api/communities/' + communityId + '/views', {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n      if(response.status !== 200){\r\n        console.log(\"Error: \" + server + 'api/communities/' + communityId + '/views');\r\n        console.log(response);\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return (body);\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n}\r\n\r\n\r\n// returns a promise that on fullfillment returns the welcome view from the specified community on the specified server\r\nexport function getCommunityWelcomeView(token, communityId, server){\r\n  return fetch(server + 'api/communities/' + communityId + '/views', {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n      if(response.status !== 200){\r\n        console.log(\"Error: \" + server + 'api/communities/' + communityId + '/views');\r\n        console.log(response);\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return (body[0]);\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n}\r\n\r\n\r\n// returns a promise that on fullfillment returns the authors from the specified community on the specified server\r\nexport function getCommunityAuthors(token, communityId, server){\r\n  return fetch(server + 'api/communities/' + communityId + '/authors', {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n    if(response.status !== 200){\r\n      console.log(\"Error: \" + server + 'api/communities/' + communityId + '/authors');\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n    return (body);\r\n  }).catch(function(error) {\r\n    return (\"Error:\", error);\r\n  });\r\n}\r\n\r\n\r\n// registers a given user to the specified community on the specified server\r\nexport function postCommunityRegistration(token, communityId, server, userId, registrationKey){\r\n  var body = {\r\n    'communityId': communityId,\r\n    'registrationKey': registrationKey,\r\n    'userId': userId\r\n  };\r\n\r\n  return fetch(server + 'api/authors', {\r\n    method: \"POST\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n    body: JSON.stringify(body),\r\n  }).then(function(response) {\r\n      if(response.status !== 200){\r\n        console.log(\"Error: \" + server + 'api/authors');\r\n        console.log(response);\r\n      }\r\n      return response.json();\r\n  }).then(function(body) {\r\n      return (\"Success:\", [body, server]);\r\n  }).catch(function(error) {\r\n      return (\"Error:\", error);\r\n  });\r\n}\r\n","// returns a promise that on fullfillment returns the object given by objectId\r\nexport function getApiObjectsObjectId(token, server, objectId) {\r\n  return fetch(server + 'api/objects/' + objectId, {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n    if(response.status !== 200){\r\n      console.log(\"Error: \" + server + 'api/objects/' + objectId);\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n    return (body);\r\n  }).catch(function(error) {\r\n    return (\"Error:\", error);\r\n  });\r\n}\r\n","import {getApiObjectsObjectId} from '../api/object.js';\r\n\r\n// adds the notes to the cytoscape graph\r\n// parameters are token, cytoscape instance, cytoscape-supportimage instance, notes map, getApiLinksFromViewId, getApiLinksReadStatus, and getCommunityAuthors results\r\nexport function addNodesToGraph(server, token, si, nodes, nodeData, readData, authorData){\r\n  var graph_nodes = [];\r\n  for(var i = 0; i < nodeData.length; i++){\r\n    var id = createCytoscapeId(nodes, nodeData[i].to);\r\n\r\n    if(nodeData[i]._to.type === \"Note\" && nodeData[i]._to.title !== \"\" && nodeData[i]._to.status === \"active\"){\r\n      graph_nodes.push(handleNote(id, nodeData[i], readData, authorData));\r\n    } else if(nodeData[i]._to.type === \"Attachment\" && nodeData[i]._to.title !== \"\" && nodeData[i]._to.status === \"active\"){\r\n      graph_nodes.push(handleAttachment(server, token, si, nodes, nodeData[i], authorData));\r\n    } else if(nodeData[i]._to.type === \"Drawing\" && nodeData[i]._to.title !== \"\" && nodeData[i]._to.status === \"active\"){\r\n      graph_nodes.push(handleDrawing(server, token, si, nodes, nodeData[i], authorData));\r\n    } else if(nodeData[i]._to.type === \"View\" && nodeData[i]._to.title !== \"\" && nodeData[i]._to.status === \"active\"){\r\n      graph_nodes.push(handleView(nodes, nodeData[i]));\r\n    }\r\n  }\r\n\r\n  return graph_nodes;\r\n}\r\n\r\n\r\n// adds the edges to the cytoscape graph\r\n// parameters are cytoscape instance, notes map, and postApiLinksCommunityIdSearch results\r\nexport function addEdgesToGraph(nodes, edgeData){\r\n  var graph_edges = [];\r\n  for(var i = 0; i < edgeData.length; i++){\r\n    var obj = edgeData[i];\r\n\r\n    if(obj._to.type === \"Note\" && obj._to.status === \"active\" && obj._to.title !== \"\" && obj._from.type === \"Note\" && obj._from.status === \"active\" && obj._from.title !== \"\"){\r\n        var fromCount = nodes.get(obj.from);\r\n        var toCount = nodes.get(obj.to);\r\n        if(fromCount !== 'undefined' && toCount !== 'undefined'){\r\n          for(var j = 0; j < fromCount; j++){\r\n            for(var k = 0; k < toCount; k++){\r\n              graph_edges.push({\r\n                group: 'edges',\r\n                data: {\r\n                  id: obj._id + '-' + (parseInt(j) + 1) + (parseInt(k) + 1),\r\n                  source: obj.from + '-' + (parseInt(j) + 1),\r\n                  target: obj.to + '-' + (parseInt(k) + 1)\r\n                }\r\n              });\r\n            }\r\n          }\r\n        } else {\r\n          console.log(obj.from + \" fromCount: \" + fromCount + \"\\n\" + obj.to + \" toCount: \" + toCount);\r\n        }\r\n    }\r\n  }\r\n  return graph_edges;\r\n}\r\n\r\n\r\n// handles adding notes to the cytoscape instance\r\nfunction handleNote(id, nodeData, readData, authorData){\r\n  var authorName = matchAuthorId(nodeData._to.authors[0], authorData);\r\n  var date = parseDate(nodeData.created);\r\n  var readStatus, type;\r\n\r\n  // handles whether it is a note or a riseabove\r\n  if(nodeData._to.data === undefined){\r\n    readStatus = readData.includes(nodeData.to) ? 'read-note' : 'unread-note';\r\n    type = \"note\";\r\n  } else {\r\n    readStatus = readData.includes(nodeData.to) ? 'read-riseabove' : 'unread-riseabove';\r\n    type = \"riseabove\";\r\n  }\r\n\r\n  return {\r\n      group: 'nodes',\r\n      data: {\r\n        id: id,\r\n        name: nodeData._to.title,\r\n        author: authorName,\r\n        date: date,\r\n        kfId: nodeData.to,\r\n        type: type\r\n      },\r\n      classes: readStatus,\r\n      position: {\r\n        x: nodeData.data.x,\r\n        y: nodeData.data.y\r\n      }\r\n  };\r\n}\r\n\r\n\r\n// handles adding attachments to the cytoscape instance\r\nfunction handleAttachment(server, token, si, nodes, nodeData, authorData){\r\n\r\n  var authorName = matchAuthorId(nodeData._to.authors[0], authorData);\r\n  var date = parseDate(nodeData.created);\r\n  var id = createCytoscapeId(nodes, nodeData.to);\r\n\r\n  return getApiObjectsObjectId(token, server, nodeData.to).then(function(result){\r\n    if(String(result.data.type).substring(0,5) === \"image\"){\r\n      var imageUrl =  (server + String(result.data.url).substring(1,)).replace(/\\s/g,\"%20\");\r\n\r\n      if(String(result.data.type).slice(-3) === \"gif\"){\r\n        imageUrl = imageUrl.substring(0, imageUrl.length - 3) + \"mp4\";\r\n      }\r\n\r\n      var bounds = si.rectangle({\r\n        x: nodeData.data.x,\r\n        y: nodeData.data.y,\r\n        width: nodeData.data.width,\r\n        height: nodeData.data.height,\r\n      });\r\n\r\n      return {\r\n        url: imageUrl,\r\n        name: nodeData._to.title,\r\n        bounds: bounds,\r\n        locked: false,\r\n      };\r\n\r\n    } else {\r\n      return {\r\n        group: 'nodes',\r\n        data: {\r\n          id: id,\r\n          name: nodeData._to.title,\r\n          author: authorName,\r\n          date: date,\r\n          kfId: nodeData.to,\r\n          type: nodeData._to.type,\r\n          download: server + result.data.url.substring(1,)\r\n        },\r\n        classes: \"attachment\",\r\n        position: {\r\n          x: nodeData.data.x,\r\n          y: nodeData.data.y\r\n        }\r\n      };\r\n    }\r\n  });\r\n}\r\n\r\n\r\n// handles adding drawings to the cytoscape instance\r\nfunction handleDrawing(server, token, si, nodes, nodeData, authorData){\r\n\r\n  return getApiObjectsObjectId(token, server, nodeData.to).then(function(result){\r\n    var parser = new DOMParser();\r\n    var doc = parser.parseFromString(result.data.svg, \"image/svg+xml\");\r\n\r\n    // use width and height from svg tag to find the aspect ratio\r\n    var svg_width = doc.childNodes[0].attributes.width.value;\r\n    var svg_height = doc.childNodes[0].attributes.height.value;\r\n    var aspect_ratio = svg_width/svg_height;\r\n\r\n    // use the given width and known aspect ratio to calculate appropiate height for svg\r\n    var node_width = parseInt(nodeData.data.width);\r\n    var node_height = node_width/aspect_ratio;\r\n\r\n    var bounds = si.rectangle({\r\n      x: nodeData.data.x,\r\n      y: nodeData.data.y,\r\n      height: node_height,\r\n      width: parseInt(nodeData.data.width)\r\n    });\r\n\r\n    return {\r\n      url: 'data:image/svg+xml;utf8,' + encodeURIComponent('<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE svg>' + result.data.svg),\r\n      name: nodeData._to.title,\r\n      bounds: bounds,\r\n      locked: false,\r\n    };\r\n\r\n  });\r\n}\r\n\r\n\r\n// handles adding a link to another view\r\nfunction handleView(nodes, nodeData){\r\n  var id = createCytoscapeId(nodes, nodeData.to);\r\n  return {\r\n    group: 'nodes',\r\n    data: {\r\n      id: id,\r\n      name: nodeData._to.title,\r\n      kfId: nodeData.to,\r\n      type: nodeData._to.type,\r\n      communityId: nodeData.communityId,\r\n    },\r\n    classes: \"view\",\r\n    position: {\r\n      x: nodeData.data.x,\r\n      y: nodeData.data.y\r\n    }\r\n  };\r\n}\r\n\r\n\r\n// helper function to find an authors name from their author id using the getCommunityAuthors data\r\nfunction matchAuthorId(authorId, authorsInfo){\r\n    for(var i = 0; i < authorsInfo.length; i++){\r\n      if(authorId === authorsInfo[i]._id){\r\n        return authorsInfo[i].firstName + \" \" + authorsInfo[i].lastName;\r\n      }\r\n    }\r\n    return \"Author not found\";\r\n}\r\n\r\n\r\n// helper function to return formatted creation date of a note\r\nfunction parseDate(date){\r\n  var year = date.substring(0, 4);\r\n  var month = date.substring(5, 7);\r\n  var day = date.substring(8, 10);\r\n  var hour = date.substring(11, 13);\r\n  var minute = date.substring(14, 16);\r\n  var second = date.substring(17, 19);\r\n  if(hour < 12){\r\n    return(month + \"/\" + day + \"/\" + year + \", \" + hour + \":\" + minute + \":\" + second + \" AM\");\r\n  } else {\r\n    return(month + \"/\" + day + \"/\" + year + \", \" + (hour - 12) + \":\" + minute + \":\" + second + \" PM\");\r\n  }\r\n}\r\n\r\n\r\n// returns a unique cytoscape id corresponding to the given kf id\r\nfunction createCytoscapeId(nodes, kfId){\r\n  // create the notes unique id\r\n  // example id would be \"5a0497f1ad39ced746109d6e-1\"\r\n  // the number fixed on the end is the count of that id on this view\r\n  if(nodes.has(kfId)){\r\n    nodes.set(kfId, nodes.get(kfId) + 1);\r\n    return kfId + '-' + nodes.get(kfId);\r\n  } else {\r\n    nodes.set(kfId, 1);\r\n    return kfId + '-1';\r\n  }\r\n}\r\n","import React, {Component} from 'react'\r\nimport Cytoscape from 'cytoscape';\r\nimport CytoscapeComponent from 'react-cytoscapejs';\r\nimport CytoscapePanZoom from 'cytoscape-panzoom';\r\nimport CytoscapeNodeHtmlLabel from 'cytoscape-node-html-label';\r\nimport CytoscapeSupportImages from 'cytoscape-supportimages';\r\n\r\nimport {getApiLinksFromViewId, postApiLinksCommunityIdSearch, getApiLinksReadStatus, postReadStatus} from './api/link.js';\r\nimport {getCommunityAuthors} from './api/community.js';\r\nimport {addNodesToGraph, addEdgesToGraph} from './helper/Graph_helper.js';\r\nimport './css/cytoscape.js-panzoom.css';\r\nimport './css/Graph.css';\r\n\r\nimport unread_note_icon from './assets/icon_note_blue.png';\r\nimport read_note_icon from './assets/icon_note_red.png';\r\nimport unread_riseabove_icon from './assets/icon_riseabove_blue.png';\r\nimport read_riseabove_icon from './assets/icon_riseabove_red.png';\r\nimport attachment_icon from './assets/icon_attachment.gif';\r\nimport view_icon from './assets/icon_view.png';\r\n\r\nimport {MINZOOM, MAXZOOM} from './config.js';\r\n\r\nCytoscape.use(CytoscapePanZoom);\r\nCytoscape.use(CytoscapeNodeHtmlLabel);\r\nCytoscape.use(CytoscapeSupportImages);\r\n\r\nclass Graph extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n        /* token: this.props.token,\r\n         * server: this.props.server,\r\n         * communityId: this.props.communityId,\r\n         * viewId: this.props.viewId, */\r\n      elements: {nodes: [], edges: []},\r\n    };\r\n\r\n    this.loadElements = this.loadElements.bind(this);\r\n  };\r\n\r\n  loadElements() {\r\n      if (this.props.token && this.props.server && this.props.viewId && this.props.communityId){\r\n          console.log(\"loadElements\")\r\n          const cy = this.cy;\r\n          const si = cy.supportimages();\r\n          var promise = getApiLinksFromViewId(this.props.token, this.props.server, this.props.viewId);\r\n          var promise1 = postApiLinksCommunityIdSearch(this.props.token, this.props.server, this.props.communityId, {type: \"buildson\"});\r\n          var promise2 = getApiLinksReadStatus(this.props.token, this.props.server, this.props.communityId, this.props.viewId);\r\n          var promise3 = getCommunityAuthors(this.props.token, this.props.communityId, this.props.server);\r\n          var ref = this;\r\n\r\n          Promise.all([promise, promise1, promise2, promise3]).then((result) => {\r\n\r\n              // we keep a map with (key, value) of (kfId, count) in order to create duplicate notes with unique ids\r\n              // simply append the count to the end of their note id\r\n              var nodes = new Map();\r\n\r\n              // clear the support images extension\r\n              si._private.supportImages = [];\r\n              si._private.renderer.imageCache = {};\r\n\r\n              var graph_nodes = addNodesToGraph(ref.props.server, ref.props.token, si, nodes, result[0], result[2], result[3]);\r\n              var graph_edges = addEdgesToGraph(nodes, result[1]);\r\n              var self = this;\r\n\r\n              Promise.all(graph_nodes.concat(graph_edges)).then((graph_results) => {\r\n                  var cy_elements = {nodes: [], edges: []};\r\n                  for(let i = 0; i < graph_results.length; i++){\r\n                      if(graph_results[i].group === \"nodes\"){\r\n                          cy_elements.nodes.push(graph_results[i]);\r\n                      } else if(graph_results[i].group === \"edges\"){\r\n                          cy_elements.edges.push(graph_results[i]);\r\n                      } else if(graph_results[i].url){\r\n                          si.addSupportImage(graph_results[i]);\r\n                      }\r\n                  }\r\n\r\n                  si.notify({type: 'render'});\r\n                  self.setState({elements: cy_elements});\r\n              });\r\n\r\n          });\r\n      }\r\n  }\r\n\r\n  componentDidMount() {\r\n    var cy = this.cy;\r\n\r\n    // CYTOSCAPE-PANZOOM EXTENSION\r\n    // the default values of each option are outlined below:\r\n    var defaults = {\r\n      zoomFactor: 0.05, // zoom factor per zoom tick\r\n      zoomDelay: 45, // how many ms between zoom ticks\r\n      minZoom: MINZOOM, // min zoom level\r\n      maxZoom: MAXZOOM, // max zoom level\r\n      fitPadding: 50, // padding when fitting\r\n      panSpeed: 10, // how many ms in between pan ticks\r\n      panDistance: 10, // max pan distance per tick\r\n      panDragAreaSize: 75, // the length of the pan drag box in which the vector for panning is calculated (bigger = finer control of pan speed and direction)\r\n      panMinPercentSpeed: 0.25, // the slowest speed we can pan by (as a percent of panSpeed)\r\n      panInactiveArea: 8, // radius of inactive area in pan drag box\r\n      panIndicatorMinOpacity: 0.5, // min opacity of pan indicator (the draggable nib); scales from this to 1.0\r\n      zoomOnly: false, // a minimal version of the ui only with zooming (useful on systems with bad mousewheel resolution)\r\n      fitSelector: undefined, // selector of elements to fit\r\n      animateOnFit: function(){ // whether to animate on fit\r\n        return false;\r\n      },\r\n      fitAnimationDuration: 1000, // duration of animation on fit\r\n\r\n      // icon class names\r\n      sliderHandleIcon: 'fa fa-minus',\r\n      zoomInIcon: 'fa fa-plus',\r\n      zoomOutIcon: 'fa fa-minus',\r\n      resetIcon: 'fa fa-expand'\r\n    };\r\n\r\n    // add the panzoom control\r\n    cy.panzoom( defaults );\r\n\r\n    // CYTOSCAPE-NODE-HTML-LABEL EXTENSION\r\n    cy.nodeHtmlLabel([\r\n      {\r\n        query: 'node',\r\n        halign: 'center', // title horizontal position. Can be 'left',''center, 'right'\r\n        valign: 'bottom', // title vertical position. Can be 'top',''center, 'bottom'\r\n        halignBox: 'right', // title relative box horizontal position. Can be 'left',''center, 'right'\r\n        valignBox: 'bottom', // title relative box vertical position. Can be 'top',''center, 'bottom'\r\n        cssClass: 'cytoscape-label', // any classes will be as attribute of <div> container for every title\r\n        tpl: function(data){\r\n          // we only want author and creation date listed for notes\r\n          if(data.type === 'note' || data.type === 'riseabove' || data.type === 'Attachment'){\r\n            return '<div>' + data.author + '<br>' + data.date + '</div>';\r\n          } else {\r\n            return '';\r\n          }\r\n        }\r\n      },\r\n    ]);\r\n\r\n    // CYTOSCAPE SUPPORTIMAGES EXTENSION\r\n      /* var si = cy.supportimages(); */\r\n\r\n    this.loadElements();\r\n\r\n    var ref = this;\r\n    // on single click of node log its kf id and mark it as read\r\n    cy.on('tap', 'node', function(event){\r\n      var kfId = this.data('kfId');\r\n      var type = this.data('type');\r\n\r\n      if(this.hasClass(\"image\")){\r\n        console.log(\"image\");\r\n      } else if(this.hasClass(\"attachment\")){\r\n        console.log(\"attachment\");\r\n      } else if(this.hasClass(\"view\")){\r\n          ref.props.onViewClick(kfId);\r\n      } else {\r\n        if(type === \"riseabove\"){\r\n            this.removeClass(\"unread-riseabove\");\r\n            this.addClass(\"read-riseabove\");\r\n        } else if(type === \"note\"){\r\n            ref.props.onNoteClick(kfId)\r\n            this.removeClass(\"unread-note\");\r\n            this.addClass(\"read-note\");\r\n        }\r\n        postReadStatus(ref.props.token, ref.props.server, ref.props.communityId, kfId);\r\n      }\r\n    });\r\n\r\n  }\r\n\r\n\r\n    componentDidUpdate(prevProps, prevState) {\r\n        //If any prop is updated, re-load elements\r\n        if (this.props.viewId !== prevProps.viewId || this.props.communityId !== prevProps.communityId || this.props.token !== prevProps.token || this.props.server !== prevProps.server){\r\n            this.loadElements();\r\n        }\r\n    }\r\n  render() {\r\n    return(\r\n          <CytoscapeComponent\r\n          cy={(cy) => { this.cy = cy }}\r\n          style={ { width: '100%', height: '100vh' } }\r\n          elements={CytoscapeComponent.normalizeElements(this.state.elements)}\r\n          stylesheet={ [\r\n            {\r\n              selector: 'node',\r\n              style: {\r\n                'label': \"data(name)\",\r\n                'font-size': '11px',\r\n                'text-halign': 'right',\r\n                'text-valign': 'center',\r\n                'text-margin-x': '-5',\r\n                'padding': '0',\r\n                'background-opacity': '0',\r\n                'background-clip': 'none',\r\n                'background-width': '15px',\r\n                'background-height': '15px'\r\n              }\r\n            },\r\n            {\r\n              selector: 'edge',\r\n              style: {\r\n                'width': 1,\r\n                'line-color': '#29648f',\r\n                'target-arrow-color': '#29648f',\r\n                'target-arrow-shape': 'triangle',\r\n                'curve-style': 'bezier'\r\n              }\r\n            },\r\n\r\n            {selector: '.unread-note', style: {'background-image': [unread_note_icon]}},\r\n            {selector: '.read-note', style: {'background-image': [read_note_icon]}},\r\n            {selector: '.unread-riseabove', style: {'background-image': [unread_riseabove_icon]}},\r\n            {selector: '.read-riseabove', style: {'background-image': [read_riseabove_icon]}},\r\n            {selector: '.attachment', style: {'background-image': [attachment_icon]}},\r\n            {selector: '.view', style: {'background-image': [view_icon]}},\r\n            {\r\n              selector: '.image',\r\n              style: {\r\n                'label': ''\r\n              }\r\n            },\r\n            {\r\n              selector: '.drawing',\r\n              style: {\r\n                'label': ''\r\n              }\r\n            }\r\n          ] }\r\n          layout={ {name: 'grid'} }\r\n          hideEdgesonViewport={ false }\r\n          autolock={ false }\r\n          wheelSensitivity={ 0.15 }\r\n          minZoom={ MINZOOM }\r\n          maxZoom={ MAXZOOM }\r\n          />\r\n          );\r\n  }\r\n}\r\n\r\nexport default Graph;\r\n","// returns a promise that on fullfillment returns all links from the given viewId\r\nexport function getApiLinksFromViewId(token, server, viewId) {\r\n  return fetch(server + 'api/links/from/' + viewId, {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n    if(response.status !== 200){\r\n      console.log(\"Error: \" + server + 'api/links/from/' + viewId);\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n    return (body);\r\n  }).catch(function(error) {\r\n    return (\"Error:\", error);\r\n  });\r\n}\r\n\r\n\r\n// returns a promise that on fullfillment returns all links FROM ID to TO ID\r\nexport function getApiLinksViewIdToObjectId(token, server, viewId, objectId) {\r\n  return fetch(server + 'api/links/from/' + viewId + '/to/' + objectId, {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n    if(response.status !== 200){\r\n      console.log(\"Error: \" + server + 'api/links/from/' + viewId + '/to/' + objectId);\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n    return (body);\r\n  }).catch(function(error) {\r\n    return (\"Error:\", error);\r\n  });\r\n}\r\n\r\n// returns a promise that on fullfillment returns an array of the read note ids only\r\nexport function getApiLinksReadStatus(token, server, communityId, welcomeViewId){\r\n  return fetch(server + 'api/records/myreadstatusview/' + communityId + '/' + welcomeViewId, {\r\n    method: \"GET\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n    if(response.status !== 200){\r\n      console.log(\"Error: \" + server + 'api/records/myreadstatusview/' + communityId + '/' + welcomeViewId);\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n    var results = [];\r\n    for(var i in body){\r\n      if(body[i].type === \"read\"){ results.push(body[i].to); }\r\n    }\r\n    return (results);\r\n  }).catch(function(error) {\r\n    return (\"Error:\", error);\r\n  });\r\n}\r\n\r\n\r\n// used to mark notes as read according to the given parameters\r\nexport function postReadStatus(token, server, communityId, contributionId){\r\n  return fetch(server + 'api/records/read/' + communityId + '/' + contributionId, {\r\n    method: \"POST\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n  }).then(function(response) {\r\n    if(response.status !== 201){\r\n      console.log(\"Error: \" + server + 'api/records/read/' + communityId + '/' + contributionId);\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n    return body\r\n  }).catch(function(error) {\r\n    return (\"Error:\", error);\r\n  });\r\n}\r\n\r\n\r\n// returns a promise that on fullfillment returns all of the links fulfilling the query\r\nexport function postApiLinksCommunityIdSearch(token, server, communityId, query) {\r\n  var body = {\r\n    'query': query\r\n  };\r\n\r\n  return fetch(server + 'api/links/' + communityId + '/search', {\r\n    method: \"POST\",\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n    body: JSON.stringify(body),\r\n  }).then(function(response) {\r\n    if(response.status !== 200 && response.status !== 201){\r\n      console.log(\"Error: \" + server + 'api/links/' + communityId + '/search');\r\n      console.log(response);\r\n    }\r\n    return response.json();\r\n  }).then(function(body) {\r\n    return (body);\r\n  }).catch(function(error) {\r\n    return (\"Error:\", error);\r\n  });\r\n}\r\n","import React, {Component} from 'react';\r\nimport {withRouter} from 'react-router';\r\nimport { connect } from 'react-redux';\r\nimport { compose } from 'redux';\r\nimport { Modal, Button } from 'react-bootstrap';\r\nimport LoginForm from './LoginForm';\r\nimport SignUpForm from './SignUpForm';\r\nimport Graph from './Graph';\r\nimport $ from 'jquery';\r\nimport '../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js';\r\nimport {getUserToken} from './api/user.js';\r\n\r\nimport './css/Login.css';\r\nimport sample_view from './assets/sample_view.gif';\r\n\r\nclass Login extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      demoToken: null,\r\n      demoServer: \"https://kf6-stage.ikit.org/\",\r\n      demoCommunityId: \"5ea995a6cbdc04a6f53a1b5c\",\r\n      demoViewId: \"5ea995a7cbdc04a6f53a1b5f\",\r\n      showModal: false,\r\n    }\r\n\r\n    this.handleShow = this.handleShow.bind(this);\r\n    this.handleClose = this.handleClose.bind(this);\r\n  }\r\n\r\n  handleShow(){\r\n    this.setState({showModal: true});\r\n  }\r\n\r\n  handleClose(){\r\n    this.setState({showModal: false});\r\n  }\r\n\r\n  componentDidMount(){\r\n    // enables the popover for refreshing servers on login tool tip\r\n    $('[data-toggle=\"tooltip\"]').tooltip()\r\n    $('[data-toggle=\"popover\"]').popover()\r\n    if($(window).width() <= 768) {\r\n      document.getElementById(\"popover\").setAttribute(\"data-trigger\", \"focus\");\r\n    }\r\n\r\n    var ref = this;\r\n    var demoTokenPromise = getUserToken(\"demo1\", \"demo1\", this.state.demoServer);\r\n    demoTokenPromise.then(function(result) {\r\n      ref.setState({demoToken: result.token});\r\n    });\r\n  }\r\n\r\n  render() {\r\n    let formToRender;\r\n    if(this.props.currentLoginForm === \"Login\"){\r\n      formToRender = <LoginForm></LoginForm>;\r\n    } else if(this.props.currentLoginForm === \"SignUp\"){\r\n      formToRender = <SignUpForm></SignUpForm>;\r\n    }\r\n\r\n    return(\r\n      <div className='container-fluid login-main'>\r\n\r\n        <div className = \"row login-row\">\r\n\r\n            <div className = \"col-md-6 login-col login\" id = \"login\">\r\n              {formToRender}\r\n            </div>\r\n\r\n\r\n            <div className = \"col-md-6 login-about\">\r\n\r\n              <div className = \"login-about-wrapper\">\r\n                <h1>What is knowledgeforum.org?</h1>\r\n                <p>A knowledge forum is an electronic group workspace designed to support the process of knowledge building.\r\n                    There are multiple installations of knowledge forums hosted by many universities and private entities all over the world.\r\n                    Knowledgeforum.org unites all of these installations and hence the stakeholders to help confluence knowledge building research,\r\n                    widen the reach of the tool & provide a central location for all global stakeholders.</p>\r\n\r\n                  <div className=\"login-overlay-container login-demo-image\" onClick={this.handleShow} id=\"demo-image-container\">\r\n                    <img className=\"d-block w-100\" src={sample_view} alt={\"First slide\"}></img>\r\n                    <div className=\"login-overlay\">\r\n                        <div className=\"login-overlay-text\">Demo a Knowledge Forum</div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <Modal show={this.state.showModal} onHide={this.handleClose}>\r\n                    <Modal.Header closeButton>\r\n                      <Modal.Title>Knowledge Forum Demo</Modal.Title>\r\n                    </Modal.Header>\r\n                    <Modal.Body>\r\n                      <Graph style={{width: '100%', height: '100%'}} token={this.state.demoToken} server={this.state.demoServer} communityId={this.state.demoCommunityId} viewId={this.state.demoViewId}/>\r\n                    </Modal.Body>\r\n                    <Modal.Footer>\r\n                      <Button variant=\"primary\" onClick={this.handleClose}>\r\n                        Close\r\n                      </Button>\r\n                    </Modal.Footer>\r\n                </Modal>\r\n\r\n              </div>\r\n            </div>\r\n\r\n\r\n          </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        currentLoginForm: state.globals.currentLoginForm,\r\n    }\r\n}\r\n\r\nexport default compose(\r\n    withRouter,\r\n    connect(mapStateToProps, null)\r\n)(Login)\r\n","/*\r\n* THIS FILE PROVIDES HELPER FUNCTIONS FOR LOGIN COMPONENT\r\n*/\r\nimport {getServerName} from '../config.js';\r\nimport {extractTokenFromStorage} from '../config.js';\r\nimport {getUserInfo} from '../api/user.js';\r\nimport {getUserCommunities} from '../api/user.js';\r\nimport {getCommunities} from '../api/community.js';\r\nimport {getCommunityWelcomeView} from '../api/community.js';\r\nimport {postCommunityRegistration} from '../api/community.js';\r\n\r\n// adds the users servers to the side bar\r\nexport function appendUserServers(dashboard_component){\r\n  var uname = localStorage.getItem(\"Username\");\r\n  var data = JSON.parse(localStorage.getItem(uname));\r\n  var servers = [];\r\n\r\n  dashboard_component.setState({username: uname});\r\n\r\n  for(var i = 0; i < data.length; i++){\r\n    var serverName = getServerName(data[i][0]);\r\n\r\n    // set the last active server as the default\r\n    if(data[i][2] === \"active\"){\r\n      dashboard_component.setState({currentServerURL: data[i][0]});\r\n      dashboard_component.setState({currentServerName: getServerName(data[i][0])});\r\n      dashboard_component.setState({token: data[i][1]});\r\n      servers.push({\r\n        name: serverName,\r\n        class: 'active',\r\n        url: data[i][0]\r\n      });\r\n      loadServer(data[i][0], dashboard_component);\r\n    } else {\r\n      servers.push({\r\n        name: serverName,\r\n        class: '',\r\n        url: data[i][0]\r\n      });\r\n    }\r\n  }\r\n\r\n  dashboard_component.setState({serverList: servers});\r\n}\r\n\r\n\r\n// replaces the \"join community\" and \"my knowledge building communities\" sections\r\n// with the relevant information for the specified server\r\nexport function loadServer(server, dashboard_component){\r\n  var token = extractTokenFromStorage(server);\r\n\r\n  // LOAD USER COMMUNITY DATA AND UPDATE REACT STATE\r\n  var userCommunitiesData = getUserCommunities(token, server);\r\n  userCommunitiesData.then(function(result) {\r\n    result.sort((a, b) => compareStrings(a._community.title, b._community.title));\r\n    updateUserCommunities(result, server, dashboard_component);\r\n  });\r\n\r\n  // LOAD USER DATA AND UPDATE REACT STATE\r\n  var userInfo = getUserInfo(token, server);\r\n  userInfo.then(function(result) {\r\n    if(result.error === true){\r\n      tokenErrorHandler();\r\n    } else {\r\n      dashboard_component.setState({name: result.firstName + ' ' + result.lastName});\r\n      dashboard_component.setState({userId: result._id});\r\n    }\r\n\r\n  });\r\n\r\n  // LOAD SERVER COMMUNITY DATA AND UPDATE REACT STATE\r\n  var serverCommunitiesData = getCommunities(token, server);\r\n  serverCommunitiesData.then(function(result) {\r\n    result.sort((a, b) => compareStrings(a.title, b.title));\r\n    updateCommunities(result, dashboard_component);\r\n  });\r\n\r\n}\r\n\r\n// updates the server community data react state\r\nfunction updateCommunities(result, dashboard_component){\r\n  var serverCommunityData = [];\r\n  for(var i = 0; i < result.length; i++){\r\n    var title = result[i].title;\r\n    var communityId = result[i]._id;\r\n    serverCommunityData.push({title: title, communityId: communityId});\r\n  }\r\n\r\n  const community_options = serverCommunityData.map(c => ({\r\n    \"value\": c.communityId,\r\n    \"label\": c.title\r\n  }));\r\n\r\n  dashboard_component.setState({serverCommunityData: community_options});\r\n}\r\n\r\n\r\n// updates the user community data react state\r\nfunction updateUserCommunities(data, server, dashboard_component) {\r\n  var token = extractTokenFromStorage(server);\r\n  var promises = [];\r\n\r\n  // for loop to create promises to get welcome view IDs for each community\r\n  for(var i = 0; i < data.length; i++){\r\n    var id = data[i].communityId;\r\n    var p = getCommunityWelcomeView(token, id, server);\r\n    promises.push(p);\r\n  }\r\n\r\n  // execute all promises and append the users communities\r\n  Promise.all(promises).then(function(responses) {\r\n    var userCommunityData = [];\r\n    for(var i = 0; i < responses.length; i++){\r\n      if(responses[i]){\r\n        if(responses[i]._id){\r\n          userCommunityData.push({\r\n            title: data[i]._community.title,\r\n            server: dashboard_component.state.currentServerURL,\r\n            token: dashboard_component.state.token,\r\n            communityId: responses[i].communityId,\r\n            welcomeViewId: responses[i]._id,\r\n          });\r\n        }\r\n      }\r\n    }\r\n    dashboard_component.setState({userCommunityData: userCommunityData});\r\n  }).catch(function(error) {\r\n    console.log(error);\r\n  });\r\n}\r\n\r\n\r\n// registers the user for a community\r\nexport function joinCommunity(userId, server, registrationKey, communityId, dashboard_component){\r\n  var token = extractTokenFromStorage(server);\r\n  var ref = dashboard_component;\r\n  var promise = postCommunityRegistration(token, communityId, server, userId, registrationKey);\r\n  promise.then(result => {\r\n    if(result[0].error){\r\n      document.getElementById('communityKey').value = '';\r\n      ref.setState({joinCommunityErrorMessage: \"Registration key does not match or you are already registered.\"});\r\n    }\r\n    else {\r\n      document.getElementById('communityKey').value = '';\r\n      loadServer(server, ref);\r\n    }\r\n  })\r\n}\r\n\r\n\r\n// function to handle an expired/invalid user token\r\n// called if response status is 401 (might be errors other than invalid token)\r\nfunction tokenErrorHandler(){\r\n  alert(\"User authorization token expired\");\r\n  logout();\r\n}\r\n\r\n\r\n// clears local storage of the username and their user tokens and redircts to the login page\r\nexport function logout(dashboard_component){\r\n  var uname = localStorage.getItem(\"Username\");\r\n  var userinfo = JSON.parse(localStorage.getItem(uname));\r\n\r\n  if(uname === null || userinfo === null){\r\n    localStorage.clear();\r\n  } else {\r\n    for(var i in userinfo){\r\n      userinfo[i][1] = \"\";\r\n    }\r\n    localStorage.setItem(uname, JSON.stringify(userinfo));\r\n    localStorage.removeItem(\"Username\");\r\n  }\r\n\r\n  dashboard_component.props.history.push('/');\r\n}\r\n\r\n\r\n// function to add to buttons to toggle the side bar\r\nexport function toggleSidebar(){\r\n  var div = document.getElementById('wrapper');\r\n  if (div.className === \"d-flex\") {\r\n    div.className = \"d-flex toggled\";\r\n  } else {\r\n    div.className = \"d-flex\";\r\n  }\r\n}\r\n\r\n\r\n// function to return which string is higher alphabetically\r\n// 1 if a is higher, -1 if b is higher, 0 if a == b\r\nfunction compareStrings(a, b){\r\n    if(a.toLowerCase() < b.toLowerCase()) { return -1; }\r\n    if(a.toLowerCase() > b.toLowerCase()) { return 1; }\r\n    return 0;\r\n}\r\n","import React, {Component} from 'react';\r\nimport { connect } from 'react-redux'\r\nimport Select from 'react-select';\r\n\r\nimport { setGlobalToken, setCurrentServer, setCommunityId, setViewId } from './store/globalsReducer.js';\r\n\r\nimport $ from 'jquery';\r\nimport {appendUserServers, loadServer, joinCommunity, toggleSidebar, logout} from './helper/Dashboard_helper.js';\r\nimport {getServerURL} from './config.js';\r\n\r\nimport './css/Dashboard.css';\r\n\r\nclass Dashboard extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      token: null,\r\n      username: null,\r\n      name: null,\r\n      userId: null,\r\n      currentServerURL: null,\r\n      currentServerName: null,\r\n      serverList: [],\r\n      userCommunityData: [],\r\n      serverCommunityData: [],\r\n      selectedCommunityToJoin: null,\r\n      communityRegistrationKey: null,\r\n      joinCommunityErrorMessage: null,\r\n      viewType: {value: 'Classic', label: 'Classic'}\r\n    }\r\n\r\n    this.enterCommunity = this.enterCommunity.bind(this);\r\n  }\r\n\r\n  inputChangeHandler = (event) => {\r\n    let name = event.target.name;\r\n    let value = event.target.value;\r\n    this.setState({[name]: value});\r\n  }\r\n\r\n  serverSelectHandler = (event) => {\r\n    var domElement = event.target;\r\n    var serverName = event.target.innerText;\r\n    var serverURL = getServerURL(event.target.innerText);\r\n    var serverTokenPairs = JSON.parse(localStorage.getItem(this.state.username));\r\n\r\n    this.setState({currentServerURL: getServerURL(serverName)});\r\n    this.setState({currentServerName: serverName});\r\n\r\n    // handles active tag in html\r\n    $(domElement).addClass('active').siblings().removeClass('active');\r\n\r\n    // handles the active tag in local storage\r\n    var activeServerURL = getServerURL(serverName);\r\n    var serverTokenPair = [];\r\n    for(var i in serverTokenPairs){\r\n      var server = serverTokenPairs[i][0];\r\n      var token = serverTokenPairs[i][1];\r\n      var status = (server === activeServerURL) ? \"active\" : \"inactive\";\r\n      if(server === activeServerURL) { this.setState({token: serverTokenPairs[i][1]}); }\r\n      serverTokenPair.push([server, token, status]);\r\n    }\r\n    localStorage.setItem(this.state.username, JSON.stringify(serverTokenPair));\r\n\r\n    // loads the server specific data\r\n    loadServer(serverURL, this);\r\n  }\r\n\r\n  handleViewChange = (event) => {\r\n    this.setState({viewType: {value: event.value, label: event.label}});\r\n  }\r\n\r\n  handleCommunityDropDownChange = (event) => {\r\n    this.setState({selectedCommunityToJoin: {value: event.value, label: event.label}});\r\n  }\r\n\r\n  enterCommunity(c){\r\n    // localStorage.setItem(\"cToken\", c.token);\r\n    // localStorage.setItem(\"cServer\", c.server);\r\n    // localStorage.setItem(\"cCommunityId\", c.communityId);\r\n    // localStorage.setItem(\"cViewId\", c.welcomeViewId);\r\n\r\n    this.props.setGlobalToken(c.token);\r\n    this.props.setCurrentServer(c.server);\r\n    this.props.setCommunityId(c.communityId);\r\n    this.props.setViewId(c.welcomeViewId);\r\n    this.props.history.push({\r\n      pathname: `/view/${c.welcomeViewId}`,\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    appendUserServers(this);\r\n  }\r\n\r\n  render(){\r\n    let viewToRender;\r\n    if(this.state.viewType.value === \"Classic\"){\r\n      viewToRender = this.state.userCommunityData.map((c) =>\r\n      <li key={c.communityId}>\r\n        <p>{c.title}</p>\r\n        <a href={c.server + 'auth/jwt?token=' + c.token + '&redirectUrl=/view/' + c.welcomeViewId} target=\"_blank\" rel=\"noopener noreferrer\">\r\n        <button className=\"dashboard-enterButton\" type=\"button\"><i className=\"far fa-arrow-alt-circle-right\"></i></button></a>\r\n      </li>);\r\n    } else if(this.state.viewType.value === \"Enhanced\"){\r\n      viewToRender = this.state.userCommunityData.map((c) =>\r\n        <li key={c.communityId}>\r\n            <p>{c.title}</p>\r\n            <button className=\"dashboard-enterButton\" type=\"button\" onClick={() => this.enterCommunity(c)}>\r\n            <i className=\"far fa-arrow-alt-circle-right\"></i></button>\r\n        </li>);\r\n    }\r\n\r\n\r\n    return (\r\n      <div className=\"d-flex\" id=\"wrapper\">\r\n\r\n        <div className=\"sidebar-custom dashboard-sidebar-custom\" id=\"sidebar-wrapper\">\r\n          <h1 className=\"sidebar-heading dashboard-sidebar-heading\">Your Servers:</h1>\r\n          <div className=\"list-group list-group-flush\">\r\n            <ul className = \"dashboard-server-list\" id = \"server-list\">{this.state.serverList.map((s) =>\r\n                    <li key={s.name} onClick={this.serverSelectHandler} className={s.class}>{s.name}</li>)}</ul>\r\n            <div className=\"dashboard-viewDropDownContainer\">\r\n              <p>View Type:</p>\r\n              <Select isSearchable={false}\r\n                      value = {this.state.viewType}\r\n                      onChange = {this.handleViewChange}\r\n                      options={[\r\n                        { value: 'Classic', label: 'Classic' },\r\n                        { value: 'Enhanced', label: 'Enhanced' },\r\n                      ]} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div id=\"page-content-wrapper\">\r\n\r\n          <nav className=\"navbar navbar-expand-lg navbar-light bg-light border-bottom dashboard-navbar\">\r\n            <button className=\"d-none d-md-block btn btn-primary dashboard-select-server\" id=\"menu-toggle\" onClick={toggleSidebar}>Select Server</button>\r\n            <button className=\"d-md-none btn btn-primary dashboard-select-server\" id=\"menu-toggle\" onClick={toggleSidebar}><i className=\"fas fa-server\"></i></button>\r\n            <div className=\"dashboard-currentInfo\" id=\"currentInfo\">{this.state.name}<div></div>{this.state.currentServerName}</div>\r\n\r\n            <button className=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarSupportedContent\" aria-controls=\"navbarSupportedContent\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\r\n              <span className=\"navbar-toggler-icon\"></span>\r\n            </button>\r\n\r\n            <div className=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\r\n              <ul className=\"navbar-nav ml-auto mt-2 mt-lg-0\">\r\n                <li className=\"nav-item\">\r\n                  <button className=\"nav-link dashboard-nav-link btn btn-link\" href=\"\" id=\"logout\" onClick={() => logout(this)}>Logout</button>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </nav>\r\n\r\n          <div className=\"container-fluid\">\r\n            <div className = \"row\">\r\n\r\n              <div className = \"col-md-6 dashboard-mainContentCol\">\r\n                <h1>My Knowledge Building Communities</h1>\r\n                <ul className=\"dashboard-userCommunities\" id = \"userCommunities\">\r\n                  {viewToRender}\r\n                </ul>\r\n              </div>\r\n\r\n              <div className = \"col-md-6 dashboard-mainContentCol\">\r\n                <h1>Join Community</h1>\r\n                <form className=\"col-lg-8 col-md-10 col-sm-12 dashboard-joinCommunityForm\" id = \"joinCommunityForm\" autoComplete=\"off\">\r\n\r\n                  <label htmlFor=\"server\">Community:</label><br></br>\r\n                  <Select value={this.state.selectedCommunityToJoin}\r\n                          className=\"dashboard-communityChoiceDropdown\"\r\n                          id=\"communityChoiceDropdown\"\r\n                          options={this.state.serverCommunityData}\r\n                          onChange={this.handleCommunityDropDownChange}\r\n                          required>\r\n                  </Select><br></br>\r\n\r\n                  <label htmlFor=\"communityKey\">Community Registration Key:</label><br></br>\r\n                  <input className=\"dashboard-communityKeyInput\" type=\"text\" id=\"communityKey\" name=\"communityRegistrationKey\" required onChange={this.inputChangeHandler}></input><br></br>\r\n\r\n                  <div>\r\n                    <p style={{color: 'red'}} id = \"errorMessage\">{this.state.joinCommunityErrorMessage}</p>\r\n                  </div>\r\n\r\n                  <input className = \"dashboard-joinButton\" type=\"button\" value=\"Join\"\r\n                      onClick={() => joinCommunity(this.state.userId, this.state.currentServerURL, this.state.communityRegistrationKey, this.state.selectedCommunityToJoin.value, this)} id=\"joinCommunityButton\"></input>\r\n\r\n                </form>\r\n              </div>\r\n\r\n            </div>\r\n\r\n          </div>\r\n        </div>\r\n\r\n\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    setGlobalToken,\r\n    setCurrentServer,\r\n    setCommunityId,\r\n    setViewId,\r\n}\r\n\r\nexport default connect(\r\n    null,\r\n    mapDispatchToProps,\r\n)(Dashboard)\r\n","import { createAction, createReducer } from '@reduxjs/toolkit';\r\n\r\nexport const openDialog = createAction('OPEN_DIALOG');\r\nexport const closeDialog = createAction('CLOSE_DIALOG');\r\nexport const openDrawDialog = createAction('OPEN_DRAW_DIALOG')\r\nexport const closeDrawDialog = createAction('CLOSE_DRAW_DIALOG')\r\nexport const focusDialog = createAction('FOCUS_DIALOG')\r\nexport const openAttachPanel = createAction('OPEN_ATTACH_PANEL')\r\nexport const closeAttachPanel = createAction('CLOSE_ATTACH_PANEL')\r\n\r\nlet dialogCounter= 0\r\nconst defaultZIndex = 1000\r\nconst focusedZindex = 1100\r\n//Dialog content\r\n// dialog = {id, noteId, title, content, confirmButton, zIndex}\r\nconst initState = { dialogs: [], drawTool: null, focused: null, attachPanel: {}};\r\nexport const dialogReducer = createReducer(initState, {\r\n    // actionCreator.toString() will automatically be called here\r\n    [openDialog] : (state, action) => {\r\n        //Unfocus previous focused dialog\r\n        const dlgs = state.dialogs.map(dlg => {\r\n            if (dlg.id === state.focused)\r\n                dlg.zIndex = defaultZIndex\r\n            return dlg\r\n        })\r\n        //Add new dialog\r\n        state.focused = dialogCounter\r\n        state.dialogs = [...dlgs, {id: dialogCounter++, zIndex: focusedZindex, ...action.payload}]\r\n        //Update index of focused\r\n        // state.dialogs.push({id: dialogCounter++, ...action.payload});\r\n    },\r\n\r\n    // Or, you can reference the .type field:\r\n    [closeDialog] : (state, action) => {\r\n        // console.log(state.dialogs)\r\n        state.dialogs = state.dialogs.filter((dlg) => dlg.id !== action.payload)\r\n    },\r\n\r\n    [openDrawDialog]: (state, action) => {\r\n        state.drawTool = action.payload;\r\n    },\r\n\r\n    [closeDrawDialog]: (state, action) => {\r\n        state.drawTool = null;\r\n    },\r\n\r\n    [openAttachPanel]: (state, action) => {\r\n        state.attachPanel = action.payload;\r\n    },\r\n\r\n    [closeAttachPanel]: (state, action) => {\r\n        state.attachPanel = {};\r\n    },\r\n\r\n    [focusDialog]: (state, action) => {\r\n        if (state.focused !== action.payload) {\r\n            state.dialogs = state.dialogs.map( dlg => {\r\n                if (dlg.id === state.focused)\r\n                    dlg.zIndex = defaultZIndex\r\n                else if (dlg.id === action.payload)\r\n                    dlg.zIndex = focusedZindex\r\n                return dlg\r\n            })\r\n            state.focused = action.payload\r\n        }\r\n    }\r\n});\r\n\r\n","import $ from 'jquery'\r\nimport {postLink, deleteLink} from './api.js'\r\n\r\n//Count words inside scaffold labels\r\nexport const scaffoldWordCount = (text) => {\r\n    const doc = '<div>' + text + '</div>';\r\n    const jq = $(doc); //convert to jquery dom element\r\n    let labels = jq.find('.kfSupportStartLabel')\r\n    let numwords = 0;\r\n    for (let i = 0; i< labels.length; i++){\r\n        numwords += labels[i].innerHTML.split(' ').length\r\n    }\r\n    return numwords\r\n}\r\n\r\nconst createScaffoldStartTag = (title, isTemplate) => {\r\n    let tag = '';\r\n    tag = tag + ' '; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span class=\"kfSupportStartMark\"> &nbsp; </span>';\r\n    } else {\r\n        tag = tag + '<span class=\"kfSupportStartMark kfTemplateStartMark\"> &nbsp; </span>';\r\n    }\r\n    tag = tag + ' '; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span class=\"kfSupportStartLabel\">' + title + '</span>';\r\n    } else {\r\n        tag = tag + '<span class=\"kfSupportStartLabel kfTemplateStartLabel\">' + title + '</span>';\r\n    }\r\n    tag = tag + ' '; //important for mce\r\n    return tag;\r\n};\r\n\r\nconst createScaffoldEndTag = (isTemplate) => {\r\n    let tag = '';\r\n    tag = tag + ' '; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span class=\"kfSupportEndMark\"> &nbsp; </span>';\r\n    } else {\r\n        tag = tag + '<span class=\"kfSupportEndMark kfTemplateEndMark\"> &nbsp; </span>';\r\n    }\r\n    tag = tag + ' '; //important for mce\r\n    return tag;\r\n};\r\n\r\nconst createReferenceTag = (contId, title, authors, text) => {\r\n    const authorText = '(missing authors)'//TODO $community.makeAuthorStringByIds(authors);\r\n    let tag = '';\r\n    if (text && text.length > 0) {\r\n        tag = tag + '<span class=\"KFReferenceQuote\"><span>\"</span><span class=\"KFReferenceText\">' + text + '</span><span>\"</span></span>';\r\n    }\r\n    tag = tag + '<span> (<a href=\"contribution/' + contId + '\" target=\"' + contId + '\">';\r\n    tag = tag + '<img src=\"/manual_assets/kf4images/icon-note-unread-othr-.gif\">\"' + title + '\"</a>';\r\n    tag = tag + '<span class=\"KFReferenceAuthor\"> by ' + authorText + '</span>)</span>';\r\n    tag = tag + '</span>';\r\n    return tag;\r\n};\r\n\r\nexport const preProcess = (body, toConnections, fromConnections) => {\r\n    const doc = '<div>' + body + '</div>';\r\n    const jq = $(doc);\r\n\r\n    const supportStart = jq.find('.KFSupportStart')\r\n    supportStart.addClass('mceNonEditable');\r\n    for (let i = 0; i < supportStart.length; i++) {\r\n        const elem = supportStart[i]\r\n        if (!elem.id.startsWith('supportid_')) {\r\n            const isTemplate = $(elem).hasClass('KFTemplateStart');\r\n            const ref = toConnections.filter((conn) => conn._id === elem.id)\r\n            if (ref.length) {\r\n                elem.innerHTML =createScaffoldStartTag(ref[0]._from.title, isTemplate);\r\n            } else {\r\n                if(toConnections !== 'Annotation'){\r\n                    elem.innerHTML = createScaffoldStartTag('(missing link)', isTemplate);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    const supportEnd = jq.find('.KFSupportEnd')\r\n    supportEnd.addClass('mceNonEditable');\r\n    for (let i = 0; i < supportEnd.length; i++) {\r\n        const elem = supportEnd[i]\r\n        const isTemplate = $(elem).hasClass('KFTemplateEnd');\r\n        elem.innerHTML = createScaffoldEndTag(isTemplate);\r\n    }\r\n\r\n    const references = jq.find('.KFReference')\r\n    references.addClass('mceNonEditable');\r\n    for (let i = 0; i < references.length; i++) {\r\n        const elem = supportEnd[i]\r\n        let ref = fromConnections.filter((conn) => conn._id === elem.id)\r\n        if (ref.length) {\r\n            ref = ref[0]\r\n            let text = '';\r\n            if (ref.data) {\r\n                text = ref.data.text;\r\n            }\r\n            elem.innerHTML = createReferenceTag(ref.to, ref._to.title, ref._to.authors, text);\r\n        } else {\r\n            elem.innerHTML = createReferenceTag('', '(missing link)', '', '');\r\n        }\r\n    }\r\n    return jq.html();\r\n};\r\n\r\nexport const postProcess = async (text, contributionId, toConnections, fromConnections, handler) => {\r\n    const doc = '<div>' + text + '</div>';\r\n    const jq = $(doc); //convert to jquery dom element\r\n    const endtags = {};\r\n    const supportLinksIds = toConnections.filter((each) => each.type === 'supports')\r\n          .map((each) => each._id) //get only toConnections of type = supports\r\n    let supportStarts = jq.find('.KFSupportStart')\r\n    const supportEnds = jq.find('.KFSupportEnd')\r\n    const toCreate = []\r\n    const supportStartsIds = []\r\n\r\n    for (let i = 0; i < supportEnds.length; i++) {\r\n        const elem = supportEnds[i]\r\n        elem.innerHTML = '';\r\n        var id = elem.id;\r\n        endtags[id] = elem;\r\n    }\r\n    for (let i = 0; i < supportStarts.length; i++) {\r\n        const elem = supportStarts[i]\r\n        let supportId = elem.id;\r\n        elem.innerHTML = '';\r\n        if (supportId.startsWith('supportid_')) {\r\n            supportId = supportId.split('_')[1];\r\n        }\r\n        supportStartsIds.push(supportId)\r\n        if (!supportLinksIds.includes(supportId)) {//Is a new supportLink\r\n            //promise to create link\r\n            toCreate.push(postLink(supportId, contributionId, 'supports').then((link) => {\r\n                //Replace id with id of new created link\r\n                const oldId = elem.id;\r\n                const newId = link._id;\r\n                elem.id = newId;\r\n                if (endtags[oldId]) {\r\n                    endtags[oldId].id = newId;\r\n                }\r\n            }))\r\n        }\r\n    }\r\n    const toDeleteSupports = supportLinksIds.filter((each) => !supportStartsIds.includes(each))\r\n          .map((each) => deleteLink(each)) //Select toConnections that no longer appear in the tinymce text\r\n\r\n\r\n    const referenceLinksIds = fromConnections.filter((each) => each.type === 'references').map((each) => each._id) //get only ids of fromConnections of type=references\r\n    const kfReferences = jq.find('.KFReferenceText') //Get references dom elements\r\n    const kfreferenceIds = []\r\n\r\n    for (var i = 0; i < kfReferences.length; i++) {\r\n        const elem = kfReferences[i]\r\n        const data = {text:$(elem).find('.KFReferenceText').html()}\r\n        elem.innerHTML = '';\r\n        const referenceId = elem.id;\r\n        kfreferenceIds.push(referenceId)\r\n        if (!referenceLinksIds.includes(referenceId)) {//Is a new supportLink\r\n            //promise to create link\r\n            toCreate.push(postLink(contributionId, referenceId, 'references', data).then((link) => {\r\n                //Replace id with id of new created link\r\n                const oldId = elem.id;\r\n                const newId = link._id;\r\n                elem.id = newId;\r\n                if (endtags[oldId]) {\r\n                    endtags[oldId].id = newId;\r\n                }\r\n            }))\r\n        }\r\n    }\r\n\r\n    const toDeleteReferences = referenceLinksIds.filter((each) => !kfreferenceIds.includes(each)).map((each) => deleteLink(each)) //Select fromConnections that no longer appear in the tinymce text\r\n\r\n    await Promise.all(toDeleteSupports)\r\n    await Promise.all(toDeleteReferences)\r\n    await Promise.all(toCreate)\r\n    return jq\r\n}\r\n\r\n","import { store } from 'react-notifications-component';\r\n\r\nconst notifConfig = {\r\n    type: \"success\",\r\n    insert: \"top\",\r\n    container: \"top-right\",\r\n    animationIn: [\"animated\", \"fadeIn\"],\r\n    animationOut: [\"animated\", \"fadeOut\"],\r\n    dismiss: {\r\n        duration: 5000,\r\n        // onScreen: true\r\n    },\r\n}\r\nexport const addNotification = ( notif ) => {\r\n    return store.addNotification({...notifConfig, ...notif});\r\n}\r\n\r\nexport const removeNotification = (notifId) => {\r\n    store.removeNotification(notifId)\r\n}\r\n","import { createAction, createReducer } from '@reduxjs/toolkit';\r\nimport { openDialog, openDrawDialog, closeDialog } from './dialogReducer.js'\r\nimport { preProcess, postProcess } from './kftag.service.js'\r\nimport * as api from './api.js'\r\nimport { addNotification } from './notifier.js'\r\nimport { dateFormatOptions } from './globalsReducer.js'\r\n\r\nexport const addNote = createAction('ADD_NOTE')\r\nexport const removeNote = createAction('REMOVE_NOTE')\r\nexport const editNote = createAction('EDIT_NOTE')\r\nexport const addDrawing = createAction('ADD_DRAWING')\r\nexport const removeDrawing = createAction('REMOVE_DRAWING')\r\nexport const editSvg = createAction('EDIT_SVG')\r\nexport const addAttachment = createAction('ADD_ATTACHMENT')\r\nexport const removeAttachment = createAction('REMOVE_ATTACHMENT')\r\nexport const setAttachments = createAction('SET_ATTACHMENTS')\r\nexport const setWordCount = createAction('SET_WORDCOUNT')\r\nexport const setLinks = createAction('SET_CONNECTIONS')\r\nexport const setRecords = createAction('SET_RECORDS')\r\nexport const removeContribAuthor = createAction('REMOVE_CONTRIB_AUTHOR')\r\nexport const addContribAuthor = createAction('ADD_CONTRIB_AUTHOR')\r\nexport const setAnnotation = createAction('SET_ANNOTATION')\r\nexport const setAnnotationsLoaded = createAction('SET_ANNOTATIONS_LOADED')\r\nexport const removeAnnotation = createAction('REMOVE_ANNOTATION')\r\nexport const setViewNotes = createAction('SET_VIEW_NOTES')\r\nexport const addViewNote = createAction('ADD_VIEW_NOTE')\r\nexport const setCheckedNotes = createAction('SET_CHECKED_NOTES')\r\nexport const updateCheckedNotes = createAction('UPDATE_CHECKED_NOTES')\r\nexport const setViewLinks = createAction('SET_VIEW_LINKS')\r\nexport const addViewLink = createAction('ADD_VIEW_LINK')\r\nexport const setBuildsOn = createAction('SET_BUILDS_ON')\r\nexport const setSupports = createAction('SET_SUPPORTS')\r\nexport const setRiseAboveViewNotes = createAction('SET_RISEABOVE_VIEW_NOTES')\r\nexport const setRiseAboveNotes = createAction('SET_RISEABOVE_NOTES')\r\nexport const setReadLinks = createAction('SET_READ_LINKS')\r\n\r\nconst initState = { drawing: '', attachments: {}, viewNotes: {}, checkedNotes: [], viewLinks: [], buildsOn: [], supports: [], riseAboveNotes: {}, riseAboveViewNotes: {}, readLinks: []}\r\n\r\nexport const noteReducer = createReducer(initState, {\r\n    [addNote]: (notes, action) => {\r\n        notes[action.payload._id] = action.payload\r\n    },\r\n    [removeNote]: (notes, action) => {\r\n        delete notes[action.payload]\r\n    },\r\n    [editNote]: (notes, action) => {\r\n        let note = notes[action.payload._id];\r\n        notes[action.payload._id] = Object.assign({}, note, action.payload)\r\n    },\r\n    [addDrawing]: (notes, action) => {\r\n        notes.drawing = action.payload\r\n    },\r\n    [removeDrawing]: (notes, action) => {\r\n        notes.drawing = '';\r\n    },\r\n    [editSvg]: (notes, action) => {\r\n        notes[action.payload.noteId].editSvg = action.payload.svg\r\n    },\r\n    [addAttachment]: (state, action) => {\r\n        let note = state[action.payload.noteId]\r\n        note.attachments.push(action.payload.attachment._id)\r\n        state.attachments[action.payload.attachment._id] = action.payload.attachment\r\n    },\r\n    [removeAttachment]: (state, action) => {\r\n        let note = state[action.payload.noteId]\r\n        note.attachments = note.attachments.filter((att) => att !== action.payload.attId)\r\n        delete state.attachments[action.payload.attId]\r\n    },\r\n    [setAttachments]: (state, action) => {\r\n        let note = state[action.payload.contribId]\r\n        note.attachments = action.payload.attachments.map((att) => att._id)\r\n        action.payload.attachments.forEach((att) => {\r\n            state.attachments[att._id] = att\r\n        })\r\n    },\r\n    [setWordCount]: (state, action) => {\r\n        let note = state[action.payload.contribId]\r\n        note.wordCount = action.payload.wc\r\n    },\r\n    [setLinks]: (state, action) => {\r\n        let contrib = state[action.payload.contribId]\r\n        if (action.payload.direction === 'from') {\r\n            contrib.fromLinks = action.payload.links\r\n        } else {\r\n            contrib.toLinks = action.payload.links\r\n        }\r\n    },\r\n    [setRecords]: (state, action) => {\r\n        let note = state[action.payload.contribId]\r\n        note.records = action.payload.records\r\n    },\r\n    [addContribAuthor]: (state, action) => {\r\n        let contrib = state[action.payload.contribId]\r\n        contrib.authors = [...contrib.authors, action.payload.author]\r\n    },\r\n    [removeContribAuthor]: (state, action) => {\r\n        let contrib = state[action.payload.contribId]\r\n        contrib.authors = contrib.authors.filter((auth) => auth !== action.payload.author)\r\n    },\r\n    [setAnnotation]: (state, action) => {\r\n        let contrib = state[action.payload.contribId]\r\n        contrib.annos[action.payload.annotation._id] = action.payload.annotation\r\n    },\r\n    [setAnnotationsLoaded]: (state, action) => {\r\n        let contrib = state[action.payload.contribId]\r\n        contrib['annotsFetched'] = action.payload.value\r\n    },\r\n    [removeAnnotation]: (state, action) => {\r\n        let contrib = state[action.payload.contribId]\r\n        delete contrib.annos[action.payload.annoId]\r\n    },\r\n    [setViewNotes]: (state, action) => {\r\n        const viewNotes = {}\r\n        for (let i in action.payload)\r\n            viewNotes[action.payload[i]._id] = action.payload[i]\r\n        state.viewNotes = viewNotes\r\n    },\r\n    [setCheckedNotes]: (state, action) => {\r\n        state.checkedNotes = action.payload\r\n    },\r\n    [updateCheckedNotes]: (state, action) => {\r\n        if (action.payload.checked) {\r\n            state.checkedNotes.push(action.payload.noteId)\r\n        } else {\r\n            state.checkedNotes = state.checkedNotes.filter(id => id !== action.payload.noteId)\r\n        }\r\n    },\r\n    [addViewNote]: (state, action) => {\r\n        state.viewNotes[action.payload._id] = action.payload\r\n    },\r\n    [setViewLinks]: (state, action) => {\r\n        state.viewLinks = action.payload\r\n    },\r\n    [addViewLink]: (state, action) => {\r\n        const matchLink = state.viewLinks.filter((link) => link._id === action.payload._id)\r\n        if (matchLink.length === 0)\r\n            state.viewLinks.push(action.payload)\r\n    },\r\n    [setBuildsOn]: (state, action) => {\r\n        state.buildsOn = action.payload\r\n    },\r\n    [setSupports]: (state, action) => {\r\n        state.supports = action.payload\r\n    },\r\n    [setRiseAboveViewNotes]: (state, action) => {\r\n        state.riseAboveViewNotes[action.payload.noteId] = [...action.payload.notes]\r\n        // state.riseAboveViewNotes = [...state.riseAboveViewNotes, action.payload]\r\n        // console.log(\"state.riseAboveViewViewciew\", state.riseAboveViewNotes);\r\n    },\r\n    [setRiseAboveNotes]: (state, action) => {\r\n        // let viewId = action.payload.viewId\r\n        // state.riseAboveNotes[viewId] = [...action.payload.notes]\r\n        // console.log(\"state.riseAboveNotes\", state.riseAboveNotes, action.payload.notes);\r\n        action.payload.forEach(note => state.riseAboveNotes[note._id] = note)\r\n    },\r\n    [setReadLinks]: (state, action) =>{\r\n        state.readLinks = action.payload\r\n    }\r\n});\r\n\r\nconst createNote = (communityId, authorId, contextMode, fromId, content) => {\r\n    if (!content) { content = '' }\r\n    if (contextMode && !contextMode.permission) {\r\n        window.alert('invalid mode object')\r\n        return\r\n    }\r\n    let mode = {}\r\n    if (contextMode && contextMode.permission === 'private') {\r\n        mode.permission = contextMode.permission;\r\n        mode.group = contextMode.group;\r\n        mode._groupMembers = contextMode._groupMembers;\r\n    } else {\r\n        mode.permission = 'protected';\r\n        mode.group = undefined;\r\n        mode._groupMembers = [];\r\n    }\r\n    let title = contextMode && contextMode.title ? contextMode.title : '';\r\n    let status = contextMode && contextMode.status ? contextMode.status : 'unsaved';\r\n\r\n    const newobj = {\r\n        communityId: communityId,\r\n        type: 'Note',\r\n        title: title,\r\n        /* 6.6 the default title was changed to blank by Christian */\r\n        authors: [authorId],\r\n        status: status,\r\n        permission: mode.permission,\r\n        group: mode.group,\r\n        _groupMembers: mode._groupMembers,\r\n        data: {\r\n            body: contextMode && contextMode.body ? contextMode.body : ''\r\n        },\r\n        buildson: fromId,\r\n        langInNote: []\r\n\r\n    }\r\n\r\n    //save google document id, createdBy and coauthors, current doc permission granted\r\n    if (contextMode && contextMode.docId) {\r\n        newobj.docId = contextMode.docId;\r\n        var myself = newobj.authors[0];\r\n        if (contextMode.coauthors) {\r\n            var ca = contextMode.coauthors.split(',');\r\n            for (var i = 0; i < ca.length; i++) {\r\n                if (ca[i] !== myself) {\r\n                    newobj.authors.push(ca[i]);\r\n                }\r\n            }\r\n        }\r\n        if (contextMode.createdBy) {\r\n            newobj.createdBy = contextMode.createdBy;\r\n        }\r\n        newobj.docShared = [myself];\r\n        newobj.text4search = contextMode.text4search;\r\n    }\r\n\r\n    return newobj\r\n}\r\n\r\nexport const newNote = (view, communityId, authorId, buildson) => dispatch => {\r\n    const mode = { permission: view.permission, group: view.group, _groupMembers: view._groupMembers }\r\n\r\n    const newN = createNote(communityId, authorId, mode, buildson)\r\n\r\n    return api.postContribution(communityId, newN).then((res) => {\r\n        const note = {\r\n            attachments: [],\r\n            fromLinks: [],\r\n            toLinks: [],\r\n            records: [],\r\n            annos: {},\r\n            group: null,\r\n            ...res.data\r\n        }\r\n        const pos = { x: 100, y: 100 }\r\n\r\n        if (!buildson) {\r\n            api.postLink(view._id, note._id, 'contains', pos)\r\n        }\r\n        //TODO saveContainsLinktoITM x2\r\n\r\n        dispatch(addNote(note))\r\n\r\n        dispatch(openDialog({\r\n            title: 'New Note',\r\n            confirmButton: 'create',\r\n            noteId: note._id,\r\n            editable: true, // new note should open in write tab\r\n        }))\r\n    })\r\n\r\n}\r\nexport const buildOnNote = (noteId) => (dispatch, getState )=> {\r\n    const state = getState()\r\n    dispatch(newNote(state.globals.view, state.globals.communityId, state.globals.author._id, noteId))\r\n}\r\nexport const editSvgDialog = (noteId, svg) => dispatch => {\r\n    dispatch(editSvg({ noteId, svg }))\r\n    dispatch(openDrawDialog(noteId))\r\n}\r\n\r\nexport const attachmentUploaded = (noteId, attachment, inline, x, y) => dispatch => {\r\n\r\n    return api.postLink(noteId, attachment._id, 'attach').then((res) => {\r\n\r\n        // TODO dispatch(getLinksFrom(noteId))\r\n        dispatch(addAttachment({ noteId, attachment }))\r\n\r\n    });\r\n}\r\n\r\nexport const fetchAttachments = (contribId) => async dispatch => {\r\n    const link_atts = await api.getLinks(contribId, 'from', 'attach')\r\n    const attachments = await Promise.all(link_atts.map((attach) => api.getObject(attach.to)))\r\n    dispatch(setAttachments({ contribId, attachments }))\r\n}\r\n\r\nexport const postContribution = (contribId, dialogId) => async (dispatch, getState) => {\r\n    const state = getState()\r\n    let contrib = state.notes[contribId]\r\n    contrib = Object.assign({}, contrib)\r\n    contrib.data = Object.assign({}, contrib.data)\r\n    if (!contrib.title) {\r\n        addNotification({ title: 'Error Saving Note!', type: 'danger', message: 'Title is required' })\r\n        return\r\n    }\r\n    //TODO sync checking?\r\n    //TODO status.contribution = 'saving'\r\n    if (contrib.type === 'Note') {\r\n        // TODO if isGoogleDoc\r\n        // const isNewNote = contrib.status === 'unsaved'\r\n        const wasActive = contrib.status === 'active'\r\n        contrib.status = 'active'\r\n        const jq = await postProcess(contrib.data.body, contrib._id, contrib.toLinks, contrib.fromLinks)\r\n\r\n        const text = jq.html()\r\n        const prev_text = contrib.data.body\r\n        contrib.data.body = text\r\n        const newNote = await api.putObject(contrib, contrib.communityId, contrib._id)\r\n        newNote.data.body = prev_text\r\n        dispatch(editNote(newNote))\r\n        dispatch(addViewNote(newNote))\r\n\r\n        dispatch(fetchLinks(contribId, 'from'))\r\n        dispatch(fetchLinks(contribId, 'to'))\r\n        if (dialogId !== undefined)\r\n            dispatch(closeDialog(dialogId))\r\n        if (!wasActive) //To update builds on hierarchy\r\n            dispatch(fetchBuildsOn(newNote.communityId))\r\n        addNotification({ title: 'Saved!', type: 'success', message: 'Contribution updated!' })\r\n    }\r\n}\r\n\r\nexport const fetchLinks = (contribId, direction) => async (dispatch) => {\r\n    const links = await api.getLinks(contribId, direction)\r\n    dispatch(setLinks({ contribId, direction, links }))\r\n\r\n    if (direction === \"to\"){\r\n        const viewLink = links.filter((link) => link.type === \"contains\")[0];\r\n        dispatch(addViewLink(viewLink));\r\n    }\r\n}\r\n\r\nexport const fetchRecords = (contribId) => async (dispatch, getState) => {\r\n    const authors = getState().users\r\n    const records = await api.getRecords(contribId)\r\n    const formatter = new Intl.DateTimeFormat('default', dateFormatOptions)\r\n    records.forEach((record) => {\r\n        if (authors[record.authorId]) {\r\n            const author = authors[record.authorId]\r\n            record['author'] = `${author.firstName} ${author.lastName}`\r\n        } else {\r\n            record['author'] = 'NA'\r\n        }\r\n        record['date'] = formatter.format(new Date(record.timestamp))\r\n    })\r\n    dispatch(setRecords({ contribId, records }))\r\n}\r\n\r\nexport const openContribution = (contribId) => async (dispatch, getState) => {\r\n\r\n    const [contrib, fromLinks, toLinks] = await Promise.all([api.getObject(contribId),\r\n    api.getLinks(contribId, 'from'),\r\n    api.getLinks(contribId, 'to')])\r\n    const author = getState().globals.author;\r\n    const note = { attachments: [], fromLinks, toLinks, records: [], annos: {}, ...contrib }\r\n    const noteBody = preProcess(note.data.body, toLinks, fromLinks)\r\n    note.data.body = noteBody\r\n    dispatch(addNote(note))\r\n    dispatch(fetchAttachments(contribId))\r\n    dispatch(openDialog({\r\n        title: 'Edit Note',\r\n        confirmButton: 'edit',\r\n        noteId: note._id,\r\n        editable: author && (note.authors.includes(author._id) || author.role === \"manager\"), // read or write tab\r\n        buildOn: true\r\n    }))\r\n    //annotations\r\n    const annoLinks = toLinks.filter((link) => link.type === 'annotates')\r\n\r\n    const annotations = await Promise.all(\r\n        annoLinks.map((annLink) =>\r\n            api.getObject(annLink.from).then(anno => {\r\n                anno.data.linkId = annLink._id\r\n                anno.data.modelId = anno._id\r\n                return anno\r\n            })\r\n        )\r\n    )\r\n\r\n    annotations.forEach((annot) => dispatch(setAnnotation({ annotation: annot, contribId })))\r\n    dispatch(setAnnotationsLoaded({ contribId, value: 1 }))\r\n\r\n    if (note.status === 'active') {\r\n        api.read(note.communityId, note._id)\r\n    }\r\n}\r\n\r\nexport const createAnnotation = (communityId, contribId, authorId, annotation) => async (dispatch) => {\r\n    const newobj = {\r\n        communityId: communityId,\r\n        type: 'Annotation',\r\n        title: 'an Annotation',\r\n        authors: [authorId],\r\n        status: 'active',\r\n        permission: 'private',\r\n        data: annotation\r\n    };\r\n    const ann = await api.postContribObject(communityId, newobj)\r\n\r\n    const link = await api.postLink(ann._id, contribId, 'annotates')\r\n\r\n    annotation.linkId = link._id;\r\n    annotation.modelId = ann._id;\r\n    dispatch(setAnnotation({ contribId, annotation: ann }))\r\n    // TODO save in store link\r\n    // $scope.annoLinks[link._id] = link;\r\n}\r\n\r\nexport const deleteAnnotation = (linkId, contribId, annoId) => async (dispatch) => {\r\n    await api.deleteLink(linkId)\r\n    return dispatch(removeAnnotation({ contribId, annoId }))\r\n}\r\n\r\nexport const modifyAnnotation = (annotation, communityId, contribId) => async (dispatch) => {\r\n    const anno_updated = await api.putObject(annotation, communityId, annotation._id)\r\n    return dispatch(setAnnotation({ contribId, annotation: anno_updated }))\r\n}\r\n\r\nexport const fetchViewNotes = (viewId) => async (dispatch) => {\r\n    const links = (await api.getLinks(viewId, 'from'))\r\n    const noteLinks = links\r\n        .filter(obj => (obj._to.type === \"Note\" && obj._to.title !== \"\" && obj._to.status === \"active\"))\r\n\r\n    dispatch(setViewLinks(links))\r\n    const notes = await Promise.all(noteLinks.map((filteredObj) => api.getObject(filteredObj.to)))\r\n\r\n    dispatch(setViewNotes(notes))\r\n\r\n    //RISEABOVE\r\n    notes.forEach(async note => {\r\n        if (note.data && note.data.riseabove) {\r\n            //SET NOTES INTO RISEABOVE LIST\r\n            let viewId = note.data.riseabove.viewId\r\n            const riseAboveNoteIds = (await api.getLinks(viewId, 'from'))\r\n                  .filter(obj => (obj._to.type === \"Note\" && obj._to.title !== \"\" && obj._to.status === \"active\")).map(lnk => lnk.to)\r\n            const riseAboveNotes = await Promise.all(riseAboveNoteIds.map((noteId) => api.getObject(noteId)))\r\n            // let data = {\r\n            //     viewId: viewId,\r\n            //     notes: riseAboveNotes,\r\n            // }\r\n\r\n            dispatch(setRiseAboveNotes(riseAboveNotes))\r\n            dispatch(setRiseAboveViewNotes({noteId: note._id, notes: riseAboveNoteIds}))\r\n            // riseAboveNotes.forEach(note => dispatch(setRiseAboveViewNotes(note)))\r\n        }\r\n    })\r\n}\r\n\r\n\r\nexport const fetchBuildsOn = (communityId) => async (dispatch) => {\r\n    let buildOnResult = await api.linksSearch(communityId, { \"type\": \"buildson\" })\r\n    buildOnResult = buildOnResult.reverse();\r\n    const filteredBuildOn = buildOnResult.filter(\r\n        (obj) =>\r\n            (obj._to.type === \"Note\" && obj._to.status === \"active\" && obj._from.type === \"Note\" && obj._from.status === \"active\")\r\n    )\r\n    dispatch(setBuildsOn(filteredBuildOn))\r\n}\r\n\r\nexport const fetchSupports = (communityId) => async (dispatch) => {\r\n    let supports = await api.linksSearch(communityId, { \"type\": \"supports\" })\r\n    dispatch(setSupports(supports))\r\n}\r\n\r\nexport const deleteAttachment = (contribId, attId) => async (dispatch, getState) => {\r\n    const state = getState()\r\n    let contrib = state.notes[contribId]\r\n    const att_link = contrib.fromLinks.filter((lnk) => lnk.to === attId)[0]\r\n    await api.deleteLink(att_link._id)\r\n    dispatch(removeAttachment({ attId, noteId: contribId }))\r\n    dispatch(fetchLinks(contribId, 'from'))\r\n}\r\n\r\nexport const fetchReadLinks = (communityId, viewId) => async (dispatch) =>{\r\n    const readLinks = await api.getApiLinksReadStatus(communityId, viewId)\r\n    dispatch(setReadLinks(readLinks))\r\n}\r\n","import React from 'react';\r\nimport { DropdownButton, Dropdown, Col } from 'react-bootstrap';\r\nimport { useDispatch } from 'react-redux';\r\nimport { newNote } from '../store/noteReducer.js'\r\nimport \"./SideBar.css\"\r\n\r\nconst SideBar = props => {\r\n    const dispatch = useDispatch();\r\n    return(\r\n        <div className=\"row\">\r\n            <Col className=\"ml-0 pl-2\" md=\"12\" sm=\"2\" xs=\"2\">\r\n                <DropdownButton className=\"circle-button\" drop=\"right\" variant=\"outline-info\" title={<i className=\"fas fa-plus-circle\"></i>}>\r\n\r\n                    <Dropdown.Item onClick={() => dispatch(newNote(props.view, props.communityId, props.author._id))}>\r\n                        New Note\r\n                    </Dropdown.Item>\r\n\r\n                    {/* <Dropdown.Item onClick={() => console.log(\"new view\")}>\r\n                        new View\r\n                        </Dropdown.Item> */}\r\n                </DropdownButton>\r\n            </Col>\r\n        </div>\r\n    )\r\n\r\n}\r\n\r\nexport default SideBar;\r\n","import React from 'react';\r\nimport {Rnd} from 'react-rnd';\r\nimport {Card, Button} from 'react-bootstrap';\r\nimport './dialog.css';\r\nconst dialog_style = {\r\n    zIndex: 999,\r\n    display: 'flex'\r\n}\r\n\r\nconst Dialog = props => {\r\n    return (\r\n            <Rnd\r\n                id={`contrib-dialog-${props.id}`}\r\n                className={\"contrib-dialog\"}\r\n                style={{...dialog_style, ...props.style}}\r\n                default={{\r\n                    x: 400 + window.pageXOffset,\r\n                    y: 50 + window.pageYOffset,\r\n                    width: 920,\r\n                    height: 500,\r\n                }}\r\n                onClick={props.onClick}\r\n                onMouseDown={props.onMouseDown}\r\n                dragHandleClassName='dlg-card-header'\r\n                bounds='window'\r\n            >\r\n                <Card className='dlg-card'>\r\n                    <Card.Header className='dlg-card-header py-0' style={{alignItems: 'center', display: 'flex'}}>\r\n                        <span>{props.title}</span>\r\n                        <Button onClick={props.onClose} variant='link' size='sm' style={{marginLeft:'auto'}}>x</Button>\r\n                    </Card.Header>\r\n                    <Card.Body className='dlg-card-body' style={{position: 'relative'}}>\r\n                        {props.children}\r\n                    </Card.Body>\r\n                    <Card.Footer className=\"dlg-card-footer py-0\">\r\n                        <Button size='sm' className=\"dlg-button\"\r\n                            onClick={props.onConfirm}\r\n                            disabled={false ||!props.editable}\r\n                        >\r\n                            Contribute\r\n                        </Button>\r\n                        {props.buildon ?\r\n                         <Button size='sm' className=\"dlg-button\"\r\n                                 onClick={props.onBuildOnClick}>\r\n                             Build-on\r\n                         </Button>\r\n                        : ''}\r\n                    </Card.Footer>\r\n                </Card>\r\n            </Rnd>\r\n    )\r\n}\r\n\r\nexport default Dialog;\r\n","import React from 'react';\r\nimport { Editor } from '@tinymce/tinymce-react';\r\n/* import './editor.css' */\r\n\r\nclass MCEditor extends React.Component {\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <Editor\r\n                    value={this.props.value}\r\n                    apiKey=\"arg05azt52qbujpnf831szuswhmyhoqute0q48btk5bqigoj\"\r\n                    init={{\r\n                        setup: (editor) => {this.props.onEditorSetup(editor)},\r\n                        content_css: '/editor.css',\r\n                        height: 300,\r\n                        menubar: false,\r\n                        statusbar: false,\r\n                        media_live_embeds: true,\r\n                        plugins: [\r\n                            'advlist autolink lists link image charmap print preview anchor',\r\n                            'searchreplace visualblocks code fullscreen',\r\n                            'insertdatetime media table paste code wordcount media help'\r\n                        ],\r\n                        external_plugins: {\r\n                            'drawingTool': '/drawing-tool/plugin.min.js'\r\n                        },\r\n                        toolbar: 'styleselect | bold italic underline strikethrough | forecolor backcolor bullist numlist | link code | ltr rtl | charmap | drawingTool media'\r\n                    }}\r\n                    onEditorChange={this.props.onEditorChange}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default MCEditor;\r\n","import React, {useState} from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { Modal, Button, Form, ProgressBar} from 'react-bootstrap'\r\nimport { addNotification } from '../../store/notifier.js'\r\nimport { fetchAttachments, fetchLinks } from '../../store/noteReducer.js'\r\nimport { FileDrop } from 'react-file-drop';\r\nimport {url as serverUrl} from '../../store/api.js'\r\nimport './AttachPanel.css'\r\n\r\nimport {postAttachment, uploadFile, putObject, postLink} from '../../store/api.js'\r\n\r\n//TODO if dropping files is not supported\r\nconst AttachPanel = props => {\r\n    const author = useSelector(state => state.globals.author);\r\n    const dispatch = useDispatch();\r\n    const [progress, setProgress] = useState(0);\r\n\r\n    const  handleClose= (e) => {\r\n        props.onClose();\r\n    }\r\n    const onFileChange = (e) => {\r\n        onFileSelect(e.target.files);\r\n        // TODO After upload, clear input\r\n        /* e.target.value = null; */\r\n\r\n    }\r\n    const onFileSelect = async (fileList) => {\r\n        const files = Array.from(fileList)\r\n        setProgress(0)\r\n        // TODO googleOauth, googledrive\r\n        const upload_promises = []\r\n        files.forEach(async (file) => {\r\n            if (file.type.indexOf(\"image/\") >= 0){\r\n                const _URL = window.URL || window.webkitURL;\r\n                const img = await addImageProcess(_URL.createObjectURL(file))\r\n                var width  = img.naturalWidth  || img.width;\r\n                var height = img.naturalHeight || img.height;\r\n                file.width = width;\r\n                file.height = height;\r\n                upload_promises.push(createAttachment(file, 'image'))\r\n            }else if (file.type.startsWith('video')){\r\n                upload_promises.push(createAttachment(file, 'video'))\r\n            }else{\r\n                upload_promises.push(createAttachment(file, 'link'))\r\n            }\r\n        });\r\n\r\n        await Promise.all(upload_promises)\r\n        handleClose()\r\n        addNotification({title: 'Uploaded!', type:'success', message:'Attachments uploaded!'})\r\n    }\r\n    const addImageProcess = (src) => {\r\n        return new Promise((resolve, reject) => {\r\n            let img = document.createElement(\"img\")\r\n            img.onload = () => resolve(img)\r\n            img.onerror = reject\r\n            img.src = src\r\n        })\r\n    }\r\n    const createAttachment = async (file, type) => {\r\n        try {\r\n            const attachRes = await postAttachment(author.communityId, author._id)\r\n            const uploadRes = await uploadFile(file, onUploadProgress)\r\n            const attachment = attachRes.data\r\n            const data = uploadRes.data\r\n            attachment.title = data.filename;\r\n            attachment.status = 'active';\r\n            data.version = attachment.data.version + 1;\r\n            attachment.data = data;\r\n            attachment.tmpFilename = data.tmpFilename;\r\n            const newAttachment = await putObject(attachment, author.communityId, attachment._id)\r\n\r\n            newAttachment.data.width = file.width;\r\n            newAttachment.data.height = file.height;\r\n\r\n\r\n            await postLink(props.noteId, attachment._id, 'attach')\r\n            //TODO updateFromConnections\r\n            dispatch(fetchLinks(props.noteId, 'from'))\r\n            if (props.inlineAttach){\r\n                const data_mce_src = `${serverUrl}${newAttachment.data.url}`;\r\n                const title = newAttachment.title;\r\n                let html = '';\r\n                if (type==='image') {\r\n                    html = '<img class=\"inline-attachment ' + attachment._id + '\" src=\"' + data_mce_src +'\" width=\"100px\" alt=\"' + title + '\" data-mce-src=\"' + data_mce_src + '\">';\r\n                } else if (type==='video') {\r\n                    html = `<video controls=\"controls\" width=\"300\" height=\"150\"> <source src=\"${data_mce_src}\" type=\"video/mp4\" /></video>`\r\n                } else {\r\n                    html ='<a class=\"inline-attachment ' + attachment._id + '\" href=\"' + data_mce_src + '\" target=\"_blank\" download>';\r\n                    html += `<img src=\"${serverUrl}/manual_assets/kf6images/03-toolbar-attachment.png\" alt=\"` + title + '\">' + title + '</a>';\r\n                }\r\n                props.onNewInlineAttach(html)\r\n            }\r\n            dispatch(fetchAttachments(props.noteId))\r\n            //TODO googledrive\r\n            /* if(newAttachment.data.type.indexOf('video') === 0 && $community.isPluginEnabled('googledrive')){\r\n             *     $scope.save2GoogleDrive(userName, newAttachment);\r\n             * } */\r\n        } catch (err) {\r\n            console.log(err)\r\n        } finally {\r\n\r\n        }\r\n\r\n    }\r\n\r\n    const onUploadProgress = (progressEvent) => {\r\n        const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total)\r\n        setProgress(percentCompleted)\r\n    }\r\n\r\n    const styles = { width: '100%', color: 'black' };\r\n    return (\r\n        <Modal show={props.attachPanel} onHide={handleClose}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Insert Attachment File</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Form.File id=\"custom-file\">\r\n                    <Form.File.Input onChange={onFileChange}/>\r\n                </Form.File>\r\n                <div style={styles}>\r\n                    <FileDrop\r\n                        onFrameDragEnter={(event) => console.log('onFrameDragEnter', event)}\r\n                        onFrameDragLeave={(event) => console.log('onFrameDragLeave', event)}\r\n                        onFrameDrop={(event) => console.log('onFrameDrop', event)}\r\n                        onDragOver={(event) => console.log('onDragOver', event)}\r\n                        onDragLeave={(event) => console.log('onDragLeave', event)}\r\n                        onDrop={(files, event) => onFileSelect(files)}\r\n                    >\r\n                        or drop some files here!\r\n                    </FileDrop>\r\n                </div>\r\n                <ProgressBar now={progress} />\r\n            </Modal.Body>\r\n            <Modal.Footer>\r\n                <Button variant=\"primary\" onClick={handleClose}>\r\n                    Close\r\n                </Button>\r\n            </Modal.Footer>\r\n        </Modal>\r\n    )\r\n\r\n};\r\n\r\nexport default AttachPanel;\r\n","\r\nconst newScaffoldTag = (supportId, title, isTemplate, addHyphen) => (initText) => {\r\n\r\n    let supportContentId = new Date().getTime().toString();\r\n    var contentTagStr = '<span id=\"' + supportContentId + '\"></span>';\r\n    var text = contentTagStr + initText;\r\n    if (addHyphen) {\r\n        text = ' -&nbsp;' + text + '&nbsp;- ';\r\n    }\r\n\r\n    var tag = '';\r\n    tag = tag + '<br>';\r\n    tag = tag + '&nbsp;&nbsp;'; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportStart mceNonEditable\">';\r\n    } else {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportStart KFTemplateStart mceNonEditable\">';\r\n    }\r\n    tag = tag + createScaffoldStartTag(title, isTemplate);\r\n    tag = tag + '</span>';\r\n    if (isTemplate) {\r\n        tag = tag + '<p class=\"kfTemplateContent\">';\r\n        tag = tag + '<br><br><br><br>';\r\n    }\r\n    tag = tag + text;\r\n    if (isTemplate) {\r\n        tag = tag + '</p>';\r\n    }\r\n    if (!isTemplate) {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportEnd mceNonEditable\">';\r\n    } else {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportEnd KFTemplateEnd mceNonEditable\">';\r\n    }\r\n    tag = tag + createScaffoldEndTag(isTemplate);\r\n    tag = tag + '</span>';\r\n    tag = tag + '&nbsp;&nbsp;'; //important for mce\r\n    tag = tag + '<br>';\r\n    return {tag, supportContentId};\r\n};\r\n\r\nconst createNewScaffoldTag = function(supportId, title, text, isTemplate) {\r\n    var tag = '';\r\n    tag = tag + '<br>';\r\n    tag = tag + '&nbsp;&nbsp;'; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportStart mceNonEditable\">';\r\n    } else {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportStart KFTemplateStart mceNonEditable\">';\r\n    }\r\n    tag = tag + createScaffoldStartTag(title, isTemplate);\r\n    tag = tag + '</span>';\r\n    if (isTemplate) {\r\n        tag = tag + '<p class=\"kfTemplateContent\">';\r\n        tag = tag + '<br><br><br><br>';\r\n    }\r\n    tag = tag + text;\r\n    if (isTemplate) {\r\n        tag = tag + '</p>';\r\n    }\r\n    if (!isTemplate) {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportEnd mceNonEditable\">';\r\n    } else {\r\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportEnd KFTemplateEnd mceNonEditable\">';\r\n    }\r\n    tag = tag + createScaffoldEndTag(isTemplate);\r\n    tag = tag + '</span>';\r\n    tag = tag + '&nbsp;&nbsp;'; //important for mce\r\n    tag = tag + '<br>';\r\n    return tag;\r\n};\r\n\r\n\r\nconst createScaffoldStartTag = function(title, isTemplate) {\r\n    var tag = '';\r\n    tag = tag + ' '; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span class=\"kfSupportStartMark\"> &nbsp; </span>';\r\n    } else {\r\n        tag = tag + '<span class=\"kfSupportStartMark kfTemplateStartMark\"> &nbsp; </span>';\r\n    }\r\n    tag = tag + ' '; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span class=\"kfSupportStartLabel\">' + title + '</span>';\r\n    } else {\r\n        tag = tag + '<span class=\"kfSupportStartLabel kfTemplateStartLabel\">' + title + '</span>';\r\n    }\r\n    tag = tag + ' '; //important for mce\r\n    return tag;\r\n};\r\n\r\nconst createScaffoldEndTag = function(isTemplate) {\r\n    var tag = '';\r\n    tag = tag + ' '; //important for mce\r\n    if (!isTemplate) {\r\n        tag = tag + '<span class=\"kfSupportEndMark\"> &nbsp; </span>';\r\n    } else {\r\n        tag = tag + '<span class=\"kfSupportEndMark kfTemplateEndMark\"> &nbsp; </span>';\r\n    }\r\n    tag = tag + ' '; //important for mce\r\n    return tag;\r\n};\r\n\r\nexport default { createNewScaffoldTag, newScaffoldTag }\r\n","import React from 'react';\r\nimport {Form, Container, Row, Col} from 'react-bootstrap';\r\nimport { connect } from 'react-redux'\r\nimport {fetchScaffolds} from '../../store/scaffoldReducer.js'\r\nimport scaffoldService from './scaffold.service'\r\nimport './scaffold.css'\r\n\r\nclass ScaffoldSelect extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {selected: props.initVal};\r\n        this.onSelectChange = this.onSelectChange.bind(this);\r\n    }\r\n\r\n\r\n    componentDidMount() {\r\n        if (!this.props.fetched){\r\n            const {communityId, contextId} = this.props;\r\n            this.props.fetchScaffolds(communityId, contextId);\r\n        }\r\n    }\r\n\r\n    onSelectChange(event) {\r\n        this.setState({selected: event.target.value});\r\n    }\r\n\r\n    scaffoldSelected = (scaffoldId, support) => {\r\n        if (this.props.returnSupport){\r\n            this.props.onScaffoldSelected(support)\r\n            return\r\n        }\r\n        const scaffold = this.props.items[scaffoldId];\r\n        let addhyphen = true;\r\n        let initialText = '';\r\n        const isTemplate = scaffold.data && scaffold.data.isTemplate\r\n        if (isTemplate) {\r\n            addhyphen = false;\r\n            initialText = '<br><br>'\r\n        }\r\n\r\n        const scaffold_text = support._to.title\r\n        const tagCreator = scaffoldService.newScaffoldTag(support.to, scaffold_text, isTemplate, addhyphen);\r\n        this.props.onScaffoldSelected(tagCreator, initialText)\r\n    }\r\n\r\n    render() {\r\n        const scaffolds = this.props.items;\r\n        const options = scaffolds.map((scaffold, i) =>\r\n            <option key={i} value={i}>{scaffold.title}</option>\r\n        );\r\n        let supports = '';\r\n        if (scaffolds.length && scaffolds[this.state.selected].supports) {\r\n            supports = scaffolds[this.state.selected].supports.map((support, i) =>\r\n                <Col className=\"mt-1 p-0\" key={i} md={12}>\r\n                    <div className='KFSupportButton' size='sm' onClick={() => this.scaffoldSelected(this.state.selected, support) }>\r\n                        {support._to.title}\r\n                    </div>\r\n                </Col>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <Container>\r\n                <Row>\r\n                    <Col className='p-0'>\r\n                        <Form>\r\n                            <Form.Group className='mb-1' controlId=\"exampleForm.ControlSelect2\">\r\n                                <Form.Control className=\"scaffold-select-input\" size='sm' as=\"select\" onChange={this.onSelectChange}>\r\n                                    {options}\r\n                                </Form.Control>\r\n                            </Form.Group>\r\n                        </Form>\r\n                    </Col>\r\n                </Row>\r\n                <Row>\r\n                    {supports}\r\n                </Row>\r\n            </Container>\r\n\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        communityId: state.globals.communityId,\r\n        contextId: state.globals.contextId,\r\n        ...state.scaffolds\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = { fetchScaffolds }\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ScaffoldSelect)\r\n","import React, {useState} from 'react';\r\nimport {useSelector} from 'react-redux'\r\nimport { Row, Col, Button} from 'react-bootstrap'\r\nimport {url as serverUrl} from '../../store/api'\r\nimport './attachArea.css'\r\n\r\nconst AttachArea = props => {\r\n\r\n    const attachments = useSelector(state => {\r\n        return props.attachments.map((attId) => state.notes.attachments[attId])\r\n    })\r\n    const [selectedImgs, setSelectedImgs] = useState([])\r\n    const getFileNameString = (name) => {\r\n       return name\r\n    }\r\n\r\n    const getFileSizeString = (size) => {\r\n        return size\r\n    }\r\n\r\n    const addImages = () => {\r\n        console.log(\"Add images\")\r\n        const  selectedImgs = Array.from(document.getElementById(`attachbox-${props.noteId}`).getElementsByClassName(\"selected\"))\r\n        if (selectedImgs.length === 0) {\r\n            return;\r\n        }\r\n        let html = \"\";\r\n        const maxWidth = 200;\r\n        console.log(selectedImgs)\r\n        selectedImgs.forEach((img) => {\r\n            const tagName = img.tagName;\r\n            let width = img.naturalWidth;\r\n            if(width > maxWidth){\r\n                width = maxWidth;\r\n            }\r\n            if (tagName === 'IMG') {\r\n                const data_mce_src = img.getAttribute(\"src\");\r\n                let className = '';\r\n                img.classList.forEach(cls_name => {\r\n                    if (cls_name.length === 24) { //Find 24 char long classes, one of them might be MongoDB id\r\n                        className += cls_name + ' ';\r\n                    }\r\n                })\r\n                html += '<img class=\"inline-attachment ' + className + '\" src=\"' + data_mce_src + '\" width=\"' + width + 'px\" alt=\"\" data-mce-src=\"' + data_mce_src + '\">';\r\n            }\r\n\r\n        })\r\n        props.onNewInlineAttach(html)\r\n\r\n    }\r\n    const selectedImg = (attId, e) => {\r\n        if (selectedImgs.includes(attId)){\r\n            setSelectedImgs((imgs) => imgs.filter( img => img !== attId))\r\n        }else{\r\n            setSelectedImgs((imgs) => [...imgs, attId])\r\n        }\r\n    }\r\n    const deleteAttachment = (attId) => {\r\n        if (window.confirm('Are you sure to delete the attachment?')) {\r\n            props.onAttachDelete(attId)\r\n        }\r\n    }\r\n    return (\r\n        <Col>\r\n            <Row>\r\n                <Col>\r\n                    <span className=''>Insert image or file: </span>\r\n                    <Button className='attach-button mx-2' size='sm' variant='outline-dark' onClick={()=> props.onNewAttachClick(true)}>Inline</Button>\r\n                    <Button className='attach-button mx-2' size='sm' variant='outline-dark' onClick={()=>props.onNewAttachClick(false)}>As an attachment</Button>\r\n                    <Button className='attach-button mx-2' size='sm' variant='outline-dark' onClick={addImages} disabled={selectedImgs.length === 0}>Insert</Button>\r\n                </Col>\r\n            </Row>\r\n            <Row id={`attachbox-${props.noteId}`} className='attachment-box'>\r\n                {\r\n                    attachments.map((attachment) => (\r\n                            <div key={attachment._id} className=\"attachment-inner-box col-auto\">\r\n                                <div className=\"attachment-thumbnail\">\r\n                                    {\r\n                                        attachment.data.type.indexOf('image/') === 0 ?\r\n                                        <img className={attachment._id + \" \" + (selectedImgs.includes(attachment._id) ? 'selected' : '')} src={`${serverUrl}${attachment.data.url}`} onClick={(e) => selectedImg(attachment._id, e)} alt='attachment'/>\r\n                                        :\r\n                                        <a href={`${serverUrl}${(attachment.data.downloadUrl || attachment.data.url)}`} title={attachment.title} download>\r\n                                            <img className={attachment._id} src={`${serverUrl}/manual_assets/kf6images/03-toolbar-attachment.png`}\r\n                                                 title=\"{attachment.title}\" alt='attachment' />\r\n                                        </a>\r\n                                    }\r\n                                </div>\r\n                                <div className=\"attachment-buttons\">\r\n                                    <p>\r\n                                        <a href={`${serverUrl}${(attachment.data.downloadUrl || attachment.data.url)}`}\r\n                                           title={attachment.title} download>\r\n                                            <img className=\"download-attachment\" src={`${serverUrl}/manual_assets/kf6images/cloud-download-2x.png`}\r\n                                                 alt=\"Download\" height=\"15px\" />\r\n                                        </a>\r\n                                    </p>\r\n                                    <p>\r\n                                        <button className=\"delete-attachment\" onClick={() => deleteAttachment(attachment._id)}>\r\n                                            <img src={`${serverUrl}/manual_assets/kf6images/trash.png`} alt='Delete attachment' width=\"10px\" height=\"15px\"/>\r\n                                        </button>\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"attachment-info\">\r\n                                    <p title=\"{attachment.title}\">{getFileNameString(attachment.title)}</p>\r\n                                    <p>{getFileSizeString(attachment.data.size)}</p>\r\n                                </div>\r\n                            </div>\r\n                ))\r\n                }\r\n            </Row>\r\n        </Col>\r\n    )\r\n\r\n};\r\n\r\nexport default AttachArea;\r\n","import React from 'react';\r\nimport MCEditor from '../editor/MCEditor'\r\nimport AttachPanel from '../attachmentCollapse/AttachPanel.js'\r\nimport {Container, Row, Col, Form} from 'react-bootstrap'\r\nimport ScaffoldSelect from '../scaffold/ScaffoldSelect'\r\nimport AttachArea from '../attachmentArea/AttachArea.js'\r\n\r\nimport './WriteTab.css';\r\nclass WriteTab extends React.Component {\r\n\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {inlineAttach: true, attachPanel: false}\r\n        this.onScaffoldSelected = this.onScaffoldSelected.bind(this);\r\n        this.onNewAttachmentClick = this.onNewAttachmentClick.bind(this);\r\n        this.closeAttachPanel = this.closeAttachPanel.bind(this);\r\n        this.onNewInlineAttach = this.onNewInlineAttach.bind(this);\r\n        this.onAttachDelete = this.onAttachDelete.bind(this)\r\n    }\r\n\r\n    onScaffoldSelected(tagCreator, initialText){\r\n        this.props.onChange({scaffold: {tagCreator, initialText}})\r\n    }\r\n\r\n    onNewAttachmentClick(inline){\r\n        this.setState({inlineAttach: inline, attachPanel: true})\r\n    }\r\n    onNewInlineAttach(inlineAttach) {\r\n        this.props.onChange({attach: inlineAttach})\r\n    }\r\n    closeAttachPanel()  {\r\n        this.setState({attachPanel: false})\r\n    }\r\n    onAttachDelete(attachId) {\r\n        this.props.onChange({deleteAttach: attachId})\r\n    }\r\n    render() {\r\n        const {note, onChange, onEditorSetup} = this.props;\r\n        return (\r\n            <Container className='write-container p-0'>\r\n                    <Row>\r\n                        <Col>\r\n                            <Form.Group className=\"write-title-form\" controlId=\"note-title\">\r\n                                <Form.Control type=\"text\"\r\n                                              className=\"write-tab-input\"\r\n                                              size=\"sm\"\r\n                                              placeholder=\"Enter title\"\r\n                                              value={note.title}\r\n                                              onChange={(val) => {onChange({title: val.target.value})}}/>\r\n                            </Form.Group>\r\n                        </Col>\r\n                    </Row>\r\n                    <Row>\r\n                        <Col md={2} className='pr-0'>\r\n                            <ScaffoldSelect initVal={0} onScaffoldSelected={this.onScaffoldSelected}/>\r\n                        </Col>\r\n                        <Col md={10}>\r\n                            <MCEditor value={note.data.body}\r\n                                      onEditorSetup={onEditorSetup}\r\n                                      onEditorChange={(content, editor) => onChange({ data: {body: content}})}/>\r\n                            <div className='wordcount-bar text-right'>{note.wordCount} words</div>\r\n\r\n                        </Col>\r\n                    </Row>\r\n                    <Row className='mt-2'>\r\n                        <AttachPanel noteId={note._id} onClose={this.closeAttachPanel} onNewInlineAttach={this.onNewInlineAttach} {...this.state}></AttachPanel>\r\n                        <AttachArea\r\n                            noteId={note._id}\r\n                            attachments={note.attachments}\r\n                            onNewAttachClick={this.onNewAttachmentClick}\r\n                            onNewInlineAttach={this.onNewInlineAttach}\r\n                            onAttachDelete={this.onAttachDelete}\r\n                        >\r\n                        </AttachArea>\r\n                    </Row>\r\n            </Container>\r\n        )\r\n    }\r\n}\r\n\r\nexport default WriteTab;\r\n","import React from 'react';\r\n\r\nconst History = props => {\r\n\r\n    const [read, edit] = props.records.reduce(\r\n        (acc, el) => {\r\n            if (el.type === 'read') {\r\n                acc[0].push(el)\r\n            }else{\r\n                acc[1].push(el)\r\n            }\r\n            return acc\r\n        }, [[],[]])\r\n    return (\r\n        <div>\r\n            <h5>Edit logs:</h5>\r\n            <p className='mb-0'>{edit.length} edits</p>\r\n            <ul>\r\n                {edit.map((record) =>\r\n                    <li key={record._id}>{record.date}: {record.author}</li>\r\n                )}\r\n            </ul>\r\n            <h5>Read logs:</h5>\r\n            <p className='mb-0'>{read.length} reads</p>\r\n            <ul>\r\n                {read.map((record) =>\r\n                    <li key={record._id}>{record.date}: {record.author}</li>\r\n                )}\r\n            </ul>\r\n        </div>\r\n    )\r\n\r\n}\r\n\r\nexport default History\r\n","import React from 'react';\r\n\r\nconst Properties = props => {\r\n\r\n    const onPermissionChange = (evt) => {\r\n        props.onChange({permission: evt.target.value})\r\n    }\r\n    //TODO\r\n    const isTemplateChange = (evt) => {\r\n        props.onChange({data: {isTemplate: evt.target.checked}})\r\n    }\r\n\r\n    return (\r\n        <div className=\"m-2\">\r\n            <div>\r\n                <label className='mt-1 font-weight-bold'>Permission:</label>\r\n                <div>\r\n                    <table className=\"KFPermission table table-sm\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>&nbsp;</th>\r\n                                <th>Authors</th>\r\n                                <th>Group Members</th>\r\n                                <th>Others</th>\r\n                            </tr>\r\n                        </thead>\r\n                                <tbody>\r\n                                    <tr>\r\n                                        <td>\r\n                                            <form action=\"\">\r\n                                                <div className=\"form-check form-check-inline\">\r\n                                                    <input className=\"form-check-input\" type=\"radio\" name='permission' value=\"private\" id=\"contrib-permission1\"\r\n                                                           onChange={onPermissionChange} checked={props.contribution.permission === 'private'}\r\n                                                    />\r\n                                                        <label className=\"form-check-label font-weight-normal\" htmlFor=\"contrib-permission1\">\r\n        &nbsp;private\r\n                                                        </label>\r\n                                                </div>\r\n                                            </form>\r\n                                        </td>\r\n                                        <td>rw</td>\r\n                                        <td>rw</td>\r\n                                        <td>-</td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <td>\r\n                                            <form action=\"\">\r\n                                                <div className=\"form-check form-check-inline\">\r\n                                                    <input className=\"form-check-input\" type=\"radio\" value=\"protected\" id=\"contrib-permission2\" name='permission'\r\n                                                           onChange={onPermissionChange} checked={props.contribution.permission === 'protected'}\r\n                                                    />\r\n                                                        <label className=\"form-check-label font-weight-normal\" htmlFor=\"contrib-permission2\">\r\n        &nbsp;protected\r\n                                                        </label>\r\n                                                </div>\r\n                                            </form>\r\n                                        </td>\r\n                                        <td>rw</td>\r\n                                        <td>rw</td>\r\n                                        <td>r</td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <td>\r\n                                            <form action=\"\">\r\n                                                <div className=\"form-check form-check-inline\">\r\n                                                    <input className=\"form-check-input\" type=\"radio\" value=\"public\" id=\"contrib-permission3\" name='public'\r\n                                                           onChange={onPermissionChange} checked={props.contribution.permission === 'public'}\r\n                                                    />\r\n                                                        <label className=\"form-check-label font-weight-normal\" htmlFor=\"contrib-permission3\">\r\n        &nbsp;public\r\n                                                        </label>\r\n                                                </div>\r\n                                            </form>\r\n                                        </td>\r\n                                        <td>rw</td>\r\n                                        <td>rw</td>\r\n                                        <td>rw</td>\r\n                                    </tr>\r\n                                </tbody>\r\n                    </table>\r\n                </div>\r\n                <label className=\"mt-1 font-weight-bold\">Status:</label>\r\n                <div className=\"ml-2\">\r\n                    {props.contribution.status}\r\n                </div>\r\n                <label className=\"mt-2 font-weight-bold\">Template:</label>\r\n                <form className=\"ml-2\" action=\"\">\r\n                    <div className=\"form-check  form-check-inline\">\r\n                        <input className=\"form-check-input\" type=\"checkbox\" id=\"c-isTemplate\" checked={props.contribution.data.isTemplate} onChange={isTemplateChange}/>\r\n\r\n                            <label className=\"form-check-label font-weight-normal\" htmlFor=\"c-isTemplate\">\r\n                                isTemplate\r\n                            </label>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n            {/* { props.contribution.type === 'Note' &&\r\n                (<div>\r\n                <label className=\"mt-1 mr-1 font-weight-bold\">Riseabove:</label>\r\n                {\r\n                (props.contribution.type === 'Note' && props.contribution.data && props.contribution.data.riseabove && props.contribution.data.riseabove.viewId) ?\r\n\r\n                \"This note has riseabove view. Please look it at 'Read' tab.\"\r\n                :\r\n\r\n                <button type=\"submit\" className=\"btn btn-primary btn-sm\" onClick={makeRiseAbove()}>MakeRiseabove</button>\r\n                }\r\n                </div>)\r\n                } */}\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nexport default Properties\r\n","import React, {useState} from 'react';\r\nimport {Button, Row, Col} from 'react-bootstrap'\r\nimport Select from 'react-select'\r\nconst AuthorSelect = props => {\r\n    const select_options = Object.entries(props.authors).map(\r\n        (auth) => { return {value: auth[1]._id, label: `${auth[1].firstName} ${auth[1].lastName}`} })\r\n\r\n    const [selectedOption, setSelectedOption] = useState(null);\r\n    const handleChange = selected => {\r\n        setSelectedOption(selected)\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <Row>\r\n                <Col>\r\n                    <Select options={select_options} onChange={handleChange} isClearable={true}/>\r\n                </Col>\r\n                <Col md='auto'>\r\n                    <Button disabled={!selectedOption}\r\n                        onClick={() => props.onAuthorSelected(selectedOption)}>Add</Button>\r\n                </Col>\r\n            </Row>\r\n            <p>{select_options.length} possible author(s) in this community.</p>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AuthorSelect\r\n","import React, {useState} from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { Button, Col, Row } from 'react-bootstrap'\r\nimport {addContribAuthor, removeContribAuthor, editNote} from '../../store/noteReducer.js'\r\nimport { addNotification } from '../../store/notifier.js'\r\nimport AuthorSelect from '../authorSelect/AuthorSelect'\r\nimport Select from 'react-select'\r\n\r\nconst AuthorTab = props => {\r\n    const contribution = useSelector((state) => state.notes[props.contribId])\r\n    const authors = useSelector((state) => contribution.authors.map((auth) => state.users[auth]))\r\n    const communityAuthors = useSelector((state) => state.users)\r\n    const groups = useSelector((state) => state.globals.community.groups)\r\n    const group_options = groups.map((g) => ({value: g.title, label: g.title}))\r\n\r\n    const [g, setG] = useState(contribution.group)\r\n    const dispatch = useDispatch()\r\n    const removeAuthor = (author, idx) => {\r\n        if (idx === 0) {\r\n            addNotification({title: 'Error!', type:'danger', message:'cannot remove the Primary Author'})\r\n            return;\r\n        }else if (idx >= 0) {\r\n            dispatch(removeContribAuthor({contribId: props.contribId, author: author._id}))\r\n        }\r\n    }\r\n\r\n    const addAuthor = (author) => {\r\n        console.log(author)\r\n        if (!contribution.authors.includes(author.value)){\r\n            dispatch(addContribAuthor({contribId: props.contribId, author: author.value}))\r\n        }\r\n    }\r\n\r\n    const selectGroup = (selected) => {\r\n        setG(selected)\r\n        dispatch(editNote({_id: contribution._id, group: selected}))\r\n    }\r\n\r\n    //TODO\r\n    const isEditable = () => {\r\n        return true\r\n    }\r\n    return (\r\n                <div className=\"authorTab mt-2\" style={{height: '100%'}}>\r\n                    <Row>\r\n                        <Col>\r\n                            <h5>Authors:</h5>\r\n                            <ul>\r\n                                {\r\n                                    authors.map((author, idx) => (\r\n\r\n                                        <li key={author._id} style={{cursor: 'move'}}>\r\n                                            {author.firstName} {author.lastName}\r\n                                            <Button size='sm' className='ml-1'\r\n                                                    onClick={() => removeAuthor(author, idx)}>x</Button>\r\n                                        </li>\r\n\r\n                                    ))\r\n                                }\r\n                            </ul>\r\n                        </Col>\r\n                        <Col>\r\n                            <div>\r\n                                <h5>Add author:</h5>\r\n                                <AuthorSelect authors={communityAuthors} onAuthorSelected={addAuthor}/>\r\n                            </div>\r\n                        </Col>\r\n                    </Row>\r\n                    <Row>\r\n                        <Col>\r\n                            <h5>Group:</h5>\r\n                            <div>\r\n                                {\r\n                                    isEditable()?\r\n                                    <form method=\"\" id=\"\" action=\"\">\r\n                                        <Select value={g} options={group_options} onChange={selectGroup} isClearable={true}/>\r\n                                    </form>\r\n                                    :\r\n                                    <div>{contribution.group.title}</div>\r\n                                }\r\n                            </div>\r\n                        </Col>\r\n                    </Row>\r\n                </div>\r\n\r\n    )\r\n}\r\n\r\nexport default AuthorTab\r\n","/*global Annotator*/\r\n/*global $*/\r\nimport tinymce from 'tinymce/tinymce';\r\nimport ReactDOM from 'react-dom';\r\n// Default icons are required for TinyMCE 5.3 or above\r\nimport 'tinymce/icons/default';\r\n\r\n// A theme is also required\r\nimport 'tinymce/themes/silver';\r\n// Any plugins you want to use has to be imported\r\nimport 'tinymce/plugins/media';\r\nimport 'tinymce/plugins/image';\r\nimport 'tinymce/plugins/insertdatetime';\r\nimport 'tinymce/plugins/link';\r\nimport 'tinymce/plugins/code';\r\n\r\nexport const setKFPlugin = (elem, annotatorHandler, uname, scaffoldElement) => {\r\n    Annotator.Plugin.KFPlugin = function( /*element*/ ) {\r\n        return {\r\n            pluginInit: function() {\r\n                this.annotator\r\n                    .subscribe('annotationCreated', function(annotation) {\r\n                        if (annotatorHandler) {\r\n                            annotatorHandler.annotationCreated(annotation);\r\n                        }\r\n                    })\r\n                    .subscribe('annotationUpdated', function(annotation) {\r\n                        if (annotatorHandler) {\r\n                            annotatorHandler.annotationUpdated(annotation);\r\n                        }\r\n                    })\r\n                    .subscribe('annotationDeleted', function(annotation) {\r\n                        if (annotatorHandler) {\r\n                            annotatorHandler.annotationDeleted(annotation);\r\n                        }\r\n                    })\r\n                    .subscribe('annotationEditorShown', function(editor, annotation){\r\n                        if (annotatorHandler) {\r\n                            annotatorHandler.displayEditor(editor, annotation);\r\n                        }\r\n                    })\r\n                    .subscribe('annotationViewerShown', function(viewer, annotations) {\r\n                        if (annotatorHandler) {\r\n                            annotatorHandler.displayViewer(viewer, annotations);\r\n                        }\r\n                    })\r\n                    .subscribe('annotationEditorHidden', function(editor, annotation){\r\n                        if (annotatorHandler) {\r\n                            annotatorHandler.editorHidden(editor, annotation);\r\n                        }\r\n                    })\r\n\r\n                ;\r\n\r\n                if (annotatorHandler) {\r\n                    annotatorHandler.annotatorInitialized(this.annotator);\r\n                }\r\n            }\r\n        };\r\n    };\r\n\r\n\r\n    //----------------------------Rich Text Annotator Plugin: START -----------------------------\r\n    /*\r\n      Rich Text Annotator Plugin v1.0 (https://github.com/danielcebrian/richText-annotator)\r\n      Copyright (C) 2014 Daniel Cebrin Robles\r\n      License: https://github.com/danielcebrian/richText-annotator/blob/master/License.rst\r\n      This program is free software; you can redistribute it and/or\r\n      modify it under the terms of the GNU General Public License\r\n      as published by the Free Software Foundation; either version 2\r\n      of the License, or (at your option) any later version.\r\n      This program is distributed in the hope that it will be useful,\r\n      but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n      GNU General Public License for more details.\r\n      You should have received a copy of the GNU General Public License\r\n      along with this program; if not, write to the Free Software\r\n      Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n    */\r\n    // Generated by CoffeeScript 1.6.3\r\n    /* jshint ignore:start */\r\n    var _ref,\r\n        // __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\r\n        __hasProp = {}.hasOwnProperty,\r\n        __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\r\n\r\n\r\n    Annotator.Plugin.RichText = (function(_super) {\r\n        __extends(RichText, _super);\r\n\r\n\r\n        // FILE - GLOBALS -----\r\n        var editorId =\"\";\r\n\r\n        //----------------------\r\n        //Default tinymce configuration\r\n        RichText.prototype.options = {\r\n            tinymce:{\r\n                selector: \"li.annotator-item textarea\",\r\n                content_css: '/editor.css',\r\n                height:\"170px\",\r\n                statusbar: false,\r\n                plugins: \"media image insertdatetime link code\",\r\n                menubar: false,\r\n                toolbar_items_size: 'small',\r\n                extended_valid_elements : \"iframe[src|frameborder|style|scrolling|class|width|height|name|align|id]\",\r\n                toolbar: \"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | code | mysidebar\",\r\n            }\r\n        };\r\n\r\n        function RichText(element,options) {\r\n            _ref = RichText.__super__.constructor.apply(this, arguments);\r\n            return _ref;\r\n        }\r\n\r\n\r\n        RichText.prototype.pluginInit = function() {\r\n            var annotator = this.annotator,\r\n                editor = this.annotator.editor;\r\n            //Check that annotator is working\r\n            if (!Annotator.supported()) {\r\n                return;\r\n            }\r\n\r\n            //Editor Setup\r\n            annotator.editor.addField({\r\n                type: 'input',\r\n                load: this.updateEditor,\r\n            });\r\n\r\n            //Viewer setup\r\n            annotator.viewer.addField({\r\n                load: this.updateViewer,\r\n            });\r\n\r\n\r\n            annotator.subscribe(\"annotationEditorShown\", function(){\r\n                // $(annotator.editor.element).find('.mce-tinymce')[0].style.display='block';\r\n                // $(annotator.editor.element).find('.mce-container').css('z-index',3000000000);\r\n                // annotator.editor.checkOrientation();\r\n            });\r\n            annotator.subscribe(\"annotationEditorHidden\", function(){\r\n                // $(annotator.editor.element).find('.mce-tinymce')[0].style.display='none';\r\n                // $(annotator.editor.element).find(\"#annoSide\").remove();\r\n            });\r\n\r\n            //set listener for tinymce;\r\n            this.options.tinymce.setup = function(ed) {\r\n                RichText.prototype.mceditor = ed\r\n                ed.on('change', function(e) {\r\n                    //set the modification in the textarea of annotator\r\n                    $(editor.element).find('textarea')[0].value = tinymce.activeEditor.getContent();\r\n                });\r\n                ed.on('Init', function(ed){\r\n                    $('.mce-container').css('z-index','3090000000000000000');\r\n\r\n                });\r\n                ed.on('remove', function(){\r\n                    ReactDOM.unmountComponentAtNode(RichText.prototype.scaffoldSidebar)\r\n                })\r\n                ed.ui.registry.addSidebar('mysidebar', {\r\n                    tooltip: 'View Scaffold',\r\n                    icon: 'settings',\r\n                    onSetup: function (api) {\r\n                        const sidebar = api.element()\r\n                        document.sidebar = sidebar\r\n                        sidebar.style.width = \"200px\"\r\n                        sidebar.style.overflow = \"scroll\"\r\n                        sidebar.style.fontSize = \"0.7rem\"\r\n                        ReactDOM.render(scaffoldElement, sidebar, null)\r\n                        RichText.prototype.scaffoldSidebar = sidebar\r\n                    },\r\n                    onShow: function (api) {\r\n                        // var str = \"\\\"\\'components/kfutils/scaffold/scaffold.html\\'\\\"\";\r\n                        // api.element().innerHTML = \"<div id='annoSide'><div ng-include=\"+str+\"></div></div>\";\r\n                        // var scope = angular.element(document.getElementById(\"scaffoldContainer\")).scope();\r\n                        // scope.$apply(function () {\r\n                        //     scope.annotatorScaffoldInit(editorId);\r\n                        // });\r\n                    },\r\n                    onHide: function (api) {\r\n                        // api.element().innerHTML = \"\";\r\n                        // var scope = angular.element(document.getElementById(\"scaffoldContainer\")).scope();\r\n                        // scope.$apply(function () {\r\n                        //     scope.annotatorScaffoldClose();\r\n                        // });\r\n                        //console.log('Hide panel', api.element());\r\n                    }\r\n                });\r\n\r\n            };\r\n            tinymce.init(this.options.tinymce);\r\n        };\r\n\r\n        RichText.prototype.updateEditor = function(field, annotation) {\r\n            var text = typeof annotation.text!=='undefined'?annotation.text:'';\r\n            var count = tinymce.editors.length;\r\n            editorId = tinymce.editors[count-2].id;\r\n            tinymce.get(editorId).setContent(text);\r\n            //tinymce.activeEditor.setContent(text);\r\n            $(field).remove(); //this is the auto create field by annotator and it is not necessary\r\n        };\r\n\r\n        RichText.prototype.updateViewer = function(field, annotation) {\r\n            var textDiv = $(field.parentNode).find('div:first-of-type')[0];\r\n            textDiv.innerHTML =annotation.text;\r\n            $(textDiv).addClass('richText-annotation');\r\n            $(field).remove(); //this is the auto create field by annotator and it is not necessary\r\n        };\r\n\r\n        return RichText;\r\n\r\n    })(Annotator.Plugin);\r\n\r\n            /* jshint ignore:end */\r\n\r\n\r\n            //----------------------------Rich Text Annotator Plugin: END -----------------------------\r\n\r\n    elem.annotator('addPlugin', 'KFPlugin');\r\n    elem.annotator('addPlugin', 'Tags');\r\n    elem.annotator('addPlugin', 'RichText');\r\n\r\n    if (uname) {\r\n        elem.annotator('addPlugin', 'Permissions', {\r\n            user: uname,\r\n            permissions: {\r\n                read: [uname],\r\n                update: [uname],\r\n                delete: [uname],\r\n                admin: [uname]\r\n            },\r\n            showEditPermissionsCheckbox: false\r\n        });\r\n    }\r\n}\r\n\r\nexport const vm2m = (anno) => {\r\n    const isPublic = anno.permissions.read.length === 0;\r\n    if (isPublic) {\r\n        anno.permission = 'protected';\r\n    } else {\r\n        anno.permission = 'private';\r\n    }\r\n    const loc = anno.ranges[0];\r\n    if (loc.start.indexOf('/div[1]') === 0) {\r\n        loc.start = loc.start.substring(7);\r\n    }\r\n    if (loc.end.indexOf('/div[1]') === 0) {\r\n        loc.end = loc.end.substring(7);\r\n    }\r\n    return anno;\r\n};\r\n\r\nexport const m2vm = (anno) => {\r\n    const loc = Object.assign({}, anno.ranges[0]);\r\n    loc.start = '/div[1]' + loc.start;\r\n    loc.end = '/div[1]' + loc.end;\r\n    anno.ranges[0] = loc\r\n    return anno;\r\n};\r\n","import { configureStore } from '@reduxjs/toolkit';\r\nimport { globalsReducer } from './globalsReducer.js'\r\nimport { dialogReducer } from './dialogReducer.js'\r\nimport { noteReducer } from './noteReducer.js'\r\nimport { scaffoldReducer } from './scaffoldReducer.js'\r\nimport { userReducer } from './userReducer.js'\r\n\r\nexport default configureStore({\r\n  reducer: {\r\n      dialogs: dialogReducer,\r\n      notes: noteReducer,\r\n      scaffolds: scaffoldReducer,\r\n      globals: globalsReducer,\r\n      users: userReducer\r\n  },\r\n    devTools: true\r\n});\r\n","import React from 'react';\r\nimport ScaffoldSelect from '../scaffold/ScaffoldSelect'\r\nimport * as annotPlugins from './annotator.service'\r\nimport './annotator.css'\r\nimport store from '../../store/store';\r\nimport { Provider } from 'react-redux';\r\n/*global $*/\r\nclass Annotator extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        this.contentRef = React.createRef();\r\n        this.annotatorInitialized = this.annotatorInitialized.bind(this)\r\n        this.annotationCreated = this.annotationCreated.bind(this)\r\n        this.annotationUpdated = this.annotationUpdated.bind(this)\r\n        this.annotator = null\r\n\r\n        this.displayEditor = this.displayEditor.bind(this)\r\n        this.displayViewer = this.displayViewer.bind(this)\r\n        this.fixPopupLocation = this.fixPopupLocation.bind(this)\r\n        this.editorHidden = this.editorHidden.bind(this)\r\n        this.loadAnnotations = this.loadAnnotations.bind(this)\r\n        this.onScaffoldSelected = this.onScaffoldSelected.bind(this)\r\n        this.dlg = null\r\n    }\r\n\r\n    componentDidMount() {\r\n        const annotatedElem = $(this.contentRef.current)\r\n        annotatedElem.annotator()\r\n        this.scaffoldElem = (\r\n            <Provider store={store}>\r\n                <ScaffoldSelect initVal={0} onScaffoldSelected={this.onScaffoldSelected}/>\r\n            </Provider>)\r\n\r\n        annotPlugins.setKFPlugin(annotatedElem, {\r\n            annotationCreated: this.annotationCreated,\r\n            annotationUpdated: this.annotationUpdated,\r\n            annotationDeleted: this.props.onDelete,\r\n            displayEditor: this.displayEditor,\r\n            displayViewer: this.displayViewer,\r\n            annotatorInitialized: this.annotatorInitialized,\r\n            editorHidden: this.editorHidden\r\n        }, this.props.author.userName, this.scaffoldElem)\r\n        this.dlg = $(`#contrib-dialog-${this.props.containerId}`)\r\n\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.props.annotsFetched === 1 && this.props.annotsFetched !== prevProps.annotsFetched) {\r\n            this.loadAnnotations()\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        //Need to remove editor when closing dialog\r\n        if (this.annotator && this.annotator.plugins.RichText.mceditor)\r\n            this.annotator.plugins.RichText.mceditor.remove()\r\n    }\r\n    editorHidden(editor, annotation){\r\n        $(editor.element.find(\".annotator-controls\")).off()\r\n    }\r\n    loadAnnotations(){\r\n        const annotations = Object.values(this.props.annots).map((annot) => {\r\n            const anno = Object.assign({}, annot.data)\r\n            anno.ranges = [...anno.ranges]\r\n            anno.highlights = [...anno.highlights]\r\n            annotPlugins.m2vm(anno)\r\n            return anno\r\n        })\r\n        this.annotator.loadAnnotations(annotations)\r\n        this.props.onAnnotsLoaded()\r\n    }\r\n    annotatorInitialized(annotator){\r\n        this.annotator = annotator\r\n        this.loadAnnotations()\r\n\r\n        var $element = $('div.annotator-adder');\r\n        $element.attr('title', 'Annotation');\r\n        $element.addClass('tooltip1');\r\n        $element.append('<span class=\"tooltiptext\">Annotation</span>');\r\n\r\n        document.annotator = this.annotator\r\n        const adder = annotator.adder.get(0)\r\n        this.observer = new MutationObserver(function(mutationsList){\r\n            for(let mutation of mutationsList) {\r\n                if (mutation.type === 'attributes') {\r\n                    //mutation.oldValue.startsWith(\"display: none\") &&\r\n                    if( adder.style.display !== 'none'){\r\n                        this.fixPopupLocation(annotator.adder)\r\n                        this.observer.takeRecords()\r\n                        return\r\n                    }\r\n                }\r\n            }\r\n        }.bind(this));\r\n        //TODO disconnect? when?\r\n        this.observer.observe(adder, { attributes: true, attributeOldValue: true });\r\n    }\r\n    annotationCreated(annotation){\r\n        this.props.onCreate(annotPlugins.vm2m(annotation))\r\n    }\r\n    annotationUpdated(annotation){\r\n        this.props.onUpdate(annotPlugins.vm2m(annotation))\r\n    }\r\n    displayEditor(editor, annotation){\r\n        /* $(editor.element.find(\".annotator-controls\")).off()*/\r\n        if (!editor.element.hasClass(editor.classes.invert.y)) {\r\n            editor.element.addClass(editor.classes.invert.y);\r\n        }\r\n    }\r\n    fixPopupLocation(popup){\r\n        const dlgOffset = this.dlg.offset()\r\n        const ppOffset = popup.offset()\r\n        popup.offset({top: ppOffset.top - dlgOffset.top, left: ppOffset.left - dlgOffset.left})\r\n    }\r\n    displayViewer(viewer, annotation){\r\n        this.fixPopupLocation(viewer.element)\r\n        viewer.element.addClass(viewer.classes.invert.y);\r\n    }\r\n\r\n    onScaffoldSelected(tagCreator, initialText) {\r\n        const mceditor = this.annotator.plugins.RichText.mceditor\r\n        const selected = mceditor.selection.getContent();\r\n        let text = selected.length ? selected : initialText;\r\n        const {tag, supportContentId} = tagCreator(text);\r\n        mceditor.insertContent(tag)\r\n        //select text after insert\r\n        const contentTag = mceditor.dom.get(supportContentId);\r\n        if (contentTag)\r\n            mceditor.selection.setCursorLocation(contentTag)\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div ref={this.contentRef}>\r\n                <div dangerouslySetInnerHTML={{__html: this.props.content}}>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n}\r\n\r\nexport default Annotator\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Col, Row, Card, Button } from 'react-bootstrap';\r\nimport './RiseAboveView.css';\r\n\r\nclass RiseAboveView extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            riseAboveNotes: [],\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        if (this.props.riseAboveViewId) {\r\n            let notes = this.props.riseAboveViewNotes[this.props.riseAboveViewId].map((noteId) => this.props.riseAboveNotes[noteId])\r\n            this.setState({\r\n                riseAboveNotes: notes\r\n            })\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Col>\r\n                <Row>\r\n                    <Col className=\"\">\r\n                        <Card className=\"pd-05\">\r\n                            <Card.Title>RiseAbove Notes</Card.Title>\r\n                            <Card.Body className=\"mrg-05-top\">\r\n                                {this.state.riseAboveNotes ?\r\n                                    (<>\r\n                                        {this.state.riseAboveNotes.map((note, i) => {\r\n                                            return <Row key={i}><Button variant=\"light\" className=\"min-width-10 rounded-pill pd-05\" onClick={() => this.props.editNote(note._id)}>{note.title}</Button></Row>\r\n                                            // return <Row key={i}><Button variant=\"light\" onClick={() => this.editNote(note._id)}>{note.title}</Button></Row>\r\n                                        })}\r\n                                    </>)\r\n                                    : null}\r\n                            </Card.Body>\r\n                        </Card>\r\n                    </Col>\r\n                </Row>\r\n            </Col>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        riseAboveViewNotes: state.notes.riseAboveViewNotes,\r\n        riseAboveNotes: state.notes.riseAboveNotes\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(RiseAboveView)\r\n\r\n","import React from 'react';\r\nimport { Tabs, Tab, Col, Row } from 'react-bootstrap';\r\nimport WriteTab from '../writeTab/WriteTab'\r\nimport History from '../historyTab/History'\r\nimport Properties from '../propertiesTab/Properties'\r\nimport AuthorTab from '../authorsTab/AuthorTab'\r\nimport Annotator from '../annotator/Annotator'\r\nimport RiseAboveView from '../RiseAboveView/RiseAboveView'\r\nimport { connect } from 'react-redux'\r\nimport {\r\n    editNote, removeDrawing, editSvgDialog, setAnnotationsLoaded,\r\n    fetchAttachments, setWordCount, fetchRecords,\r\n    createAnnotation, deleteAnnotation, modifyAnnotation, deleteAttachment, openContribution\r\n} from '../../store/noteReducer.js'\r\nimport { openDrawDialog } from '../../store/dialogReducer.js'\r\nimport { scaffoldWordCount } from '../../store/kftag.service.js'\r\nimport { dateFormatOptions, fetchCommGroups } from '../../store/globalsReducer.js'\r\nimport './Note.css'\r\n\r\nclass Note extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            riseAboveNotes: false,\r\n            selectedTab: this.props.mode ? this.props.mode : \"write\",\r\n        }\r\n        this.onEditorSetup = this.onEditorSetup.bind(this)\r\n        this.onDrawingToolOpen = this.onDrawingToolOpen.bind(this)\r\n        this.addDrawing = this.addDrawing.bind(this)\r\n        this.onNoteChange = this.onNoteChange.bind(this)\r\n        this.wordCount = this.wordCount.bind(this)\r\n        this.onTabSelected = this.onTabSelected.bind(this)\r\n        this.onAnnotationCreated = this.onAnnotationCreated.bind(this)\r\n        this.onAnnotationDeleted = this.onAnnotationDeleted.bind(this)\r\n        this.onAnnotationUpdated = this.onAnnotationUpdated.bind(this)\r\n        this.editNote = this.editNote.bind(this)\r\n    }\r\n\r\n    componentDidMount() {\r\n        // if (this.props.riseAboveViewNotes[this.props.note._id]) {\r\n        //     this.setState({\r\n        //         // riseAboveNotes: this.props.riseAboveViewNotes[this.props.note._id].map((noteId) => this.props.riseAboveNotes[noteId])\r\n        //         riseAboveNotes: true,\r\n        //         selectedTab: \"read\"\r\n        //     })\r\n        // }\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if (this.props.drawing && prevProps.drawing !== this.props.drawing && this.props.drawTool === this.props.noteId) {\r\n            this.editor.insertContent(this.props.drawing)\r\n            this.props.removeDrawing()\r\n        }\r\n    }\r\n\r\n    onNoteChange(note) {\r\n        if (note.scaffold) {\r\n            const { tagCreator, initialText } = note.scaffold;\r\n            this.addSupport(true, initialText, tagCreator)\r\n        } else if (note.attach) {\r\n            this.editor.insertContent(note.attach)\r\n        } else if (note.deleteAttach) {\r\n            this.props.deleteAttachment(this.props.noteId, note.deleteAttach)\r\n            this.editor.dom.remove(this.editor.dom.select('.' + note.deleteAttach))\r\n        }\r\n        else {\r\n            this.props.editNote({ _id: this.props.noteId, ...note })\r\n            if (note.data && note.data.body) {\r\n                this.wordCount(note.data.body);\r\n            }\r\n        }\r\n    }\r\n\r\n    wordCount(text) {\r\n        const wordCount = this.editor.plugins.wordcount.getCount() - scaffoldWordCount(text);\r\n        this.props.setWordCount({ contribId: this.props.noteId, wc: wordCount })\r\n    }\r\n\r\n    onEditorSetup(editor) {\r\n        editor.onDrawButton = this.onDrawingToolOpen;\r\n        this.editor = editor;\r\n    }\r\n\r\n    onDrawingToolOpen(svg) {\r\n        //Create dialog\r\n        if (svg) {\r\n            this.props.editSvgDialog(this.props.noteId, svg);\r\n        } else {\r\n            this.props.openDrawDialog(this.props.noteId);\r\n        }\r\n    }\r\n\r\n    addDrawing(drawing) {\r\n        // Add draw to editor\r\n        this.editor.insertContent(drawing);\r\n    }\r\n\r\n    addSupport(selection, initialText, tagCreator) {\r\n        const selected = this.editor.selection.getContent();\r\n        let text = selected.length ? selected : initialText;\r\n        const { tag, supportContentId } = tagCreator(text);\r\n        this.editor.insertContent(tag)\r\n        //select text after insert\r\n        if (selection) {\r\n            const contentTag = this.editor.dom.get(supportContentId);\r\n            if (contentTag)\r\n                this.editor.selection.setCursorLocation(contentTag)\r\n        }\r\n    }\r\n\r\n    onTabSelected(tab) {\r\n        this.setState({selectedTab: tab })\r\n        if (tab === 'history') { //Refresh records\r\n            this.props.fetchRecords(this.props.note._id)\r\n        } if (tab === 'author') { //Refresh groups, and authors?\r\n            this.props.fetchCommGroups(this.props.note.communityId)\r\n        }\r\n    }\r\n\r\n    onAnnotationCreated(annotation) {\r\n        this.props.createAnnotation(this.props.note.communityId, this.props.note._id, this.props.noteAuthor._id, annotation)\r\n    }\r\n\r\n    onAnnotationDeleted(annotation) {\r\n        if (annotation.linkId && annotation.modelId) {\r\n            this.props.deleteAnnotation(annotation.linkId, this.props.note._id, annotation.modelId);\r\n        }\r\n    }\r\n\r\n    onAnnotationUpdated(annotation) {\r\n        if (!annotation.linkId || !annotation.modelId) {\r\n            console.error('ERROR! annoVM doesn\\'t have id on update');\r\n            return;\r\n        }\r\n        const model = Object.assign({}, this.props.note.annos[annotation.modelId])\r\n        if (!model) {\r\n            console.error('ERROR! model couldn\\'t find');\r\n            return;\r\n        }\r\n        model.data = annotation;\r\n        this.props.modifyAnnotation(model, this.props.note.communityId, this.props.note._id)\r\n    }\r\n    \r\n    editNote = (noteId) => {\r\n        this.props.openContribution(noteId)\r\n    }\r\n\r\n    render() {\r\n        const formatter = new Intl.DateTimeFormat('default', dateFormatOptions)\r\n        return (\r\n            <div>\r\n                <div className='contrib-info'>\r\n                    Created By: {this.props.noteAuthor.firstName} {this.props.noteAuthor.lastName} <br />\r\n                    Last modified: {formatter.format(new Date(this.props.note.modified))}\r\n                </div>\r\n                <Tabs activeKey={this.state.selectedTab} transition={false} onSelect={this.onTabSelected}>\r\n                    <Tab eventKey=\"read\" title=\"read\">\r\n                        <Row>\r\n                            {!this.state.riseAboveNotes ?\r\n                                <Col>\r\n                                    <Annotator containerId={this.props.dlgId}\r\n                                        content={this.props.note.data.body}\r\n                                        annots={this.props.note.annos}\r\n                                        annotsFetched={this.props.note.annotsFetched}\r\n                                        author={this.props.noteAuthor}\r\n                                        onCreate={this.onAnnotationCreated}\r\n                                        onUpdate={this.onAnnotationUpdated}\r\n                                        onDelete={this.onAnnotationDeleted}\r\n                                        onAnnotsLoaded={() => this.props.setAnnotationsLoaded({ contribId: this.props.note._id, value: 0 })}\r\n                                    >\r\n                                    </Annotator>\r\n                                </Col>\r\n                                :\r\n                                (<>\r\n                                    <Col md=\"6\">\r\n                                        <Annotator containerId={this.props.dlgId}\r\n                                            content={this.props.note.data.body}\r\n                                            annots={this.props.note.annos}\r\n                                            annotsFetched={this.props.note.annotsFetched}\r\n                                            author={this.props.noteAuthor}\r\n                                            onCreate={this.onAnnotationCreated}\r\n                                            onUpdate={this.onAnnotationUpdated}\r\n                                            onDelete={this.onAnnotationDeleted}\r\n                                            onAnnotsLoaded={() => this.props.setAnnotationsLoaded({ contribId: this.props.note._id, value: 0 })}\r\n                                        >\r\n                                        </Annotator>\r\n                                    </Col>\r\n                                    <Col md=\"5\">\r\n                                        <RiseAboveView riseAboveViewId={this.props.note._id} editNote = {this.editNote}/>\r\n                                    </Col>\r\n                                    <Col></Col>\r\n                                </>)}\r\n                        </Row>\r\n                    </Tab>\r\n                    {\r\n                        this.props.mode !== \"read\" ?\r\n\r\n                        <Tab eventKey=\"write\" title=\"write\">\r\n                            <WriteTab\r\n                                note={this.props.note}\r\n                                onScaffoldSelected={this.scaffoldSelected}\r\n                                onChange={this.onNoteChange}\r\n                                onEditorSetup={this.onEditorSetup}\r\n                            ></WriteTab>\r\n                        </Tab>\r\n                        :\r\n                        ''\r\n                    }\r\n                    <Tab eventKey=\"author\" title=\"author(s)\">\r\n                        <AuthorTab contribId={this.props.noteId} />\r\n                    </Tab>\r\n                    <Tab eventKey='history' title='history'><History records={this.props.note.records} /></Tab>\r\n                    <Tab eventKey='properties' title='properties'><Properties contribution={this.props.note} onChange={this.onNoteChange} /></Tab>\r\n                </Tabs>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    const note = state.notes[ownProps.noteId]\r\n    return {\r\n        note: note,\r\n        drawing: state.notes.drawing,\r\n        drawTool: state.dialogs.drawTool,\r\n        noteAuthor: note && (state.users[note.authors[0]] || 'NA'),\r\n        riseAboveViewNotes: state.notes.riseAboveViewNotes,\r\n        riseAboveNotes: state.notes.riseAboveNotes,\r\n        currentAuthor: state.globals.author,\r\n        editable: false || (note && note.authors.includes(state.globals.author._id))\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    editNote, openDrawDialog, setWordCount,\r\n    removeDrawing, editSvgDialog, fetchAttachments, fetchRecords,\r\n    deleteAnnotation, fetchCommGroups, createAnnotation, modifyAnnotation,\r\n    setAnnotationsLoaded, deleteAttachment, openContribution}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(Note)\r\n\r\n","import React from 'react';\r\nimport Dialog from '../dialog/Dialog.js'\r\nimport { connect } from 'react-redux'\r\n\r\nclass DrawDialog extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.onConfirm = this.onConfirm.bind(this);\r\n        this.onLoad = this.onLoad.bind(this);\r\n        this.getIframeRef = this.getIframeRef.bind(this);\r\n    }\r\n\r\n    onConfirm(){\r\n        var wnd1 = this.iframe_ref.contentWindow;\r\n        var bg = wnd1.svgCanvas.current_drawing_.all_layers[0];\r\n        var wnd2 = wnd1.svgCanvas.current_drawing_.all_layers[1];\r\n\r\n        var widd = wnd2[1].getBBox().width;\r\n        var heig = wnd2[1].getBBox().height;\r\n\r\n        wnd1.svgCanvas.current_drawing_.svgElem_.setAttribute(\"width\", widd);\r\n        wnd1.svgCanvas.current_drawing_.svgElem_.setAttribute(\"height\", heig);\r\n        bg[1].childNodes[1].setAttribute(\"width\", widd);\r\n        bg[1].childNodes[1].setAttribute(\"height\", heig);\r\n\r\n        wnd1.svgCanvas.selectAllInCurrentLayer();\r\n        wnd1.svgCanvas.groupSelectedElements();\r\n        wnd1.svgCanvas.alignSelectedElements('l', 'page');\r\n        wnd1.svgCanvas.alignSelectedElements('t', 'page');\r\n        wnd1.svgCanvas.ungroupSelectedElement();\r\n        wnd1.svgCanvas.clearSelection();\r\n\r\n        wnd1.svgCanvas.current_drawing_.svgElem_.setAttribute(\"padding\", '2em');\r\n        wnd1.svgCanvas.setResolution('fit', 100);\r\n        var svg = wnd1.svgCanvas.getSvgString();\r\n\r\n        var canvas = document.createElement(\"canvas\");\r\n\r\n        canvas.width = widd + 4;\r\n        canvas.height = heig + 4;\r\n\r\n        var ctx = canvas.getContext(\"2d\");\r\n\r\n        var img = document.createElement(\"img\");\r\n\r\n        img.setAttribute(\"src\", \"data:image/svg+xml;base64,\" + btoa(svg));\r\n\r\n        img.onload = function () {\r\n            ctx.drawImage(img, 0, 0);\r\n            var p = canvas.toDataURL(\"image/png\");\r\n            const drawing = \"<img alt='\" + svg + \"' src='\" + p + \"'/>\";\r\n\r\n            this.props.onConfirm(drawing);\r\n        }.bind(this);\r\n    }\r\n\r\n    getIframeRef(frame) {\r\n        if(!frame) {\r\n            return\r\n        }\r\n        this.iframe_ref = frame\r\n    }\r\n\r\n    onLoad(e){\r\n        const svg = this.props.note.editSvg\r\n        if (svg){\r\n            e.target.contentWindow.svgCanvas.setSvgString(svg)\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Dialog\r\n                title='DrawTool'\r\n                style={{zIndex: 3000}}\r\n                onClose={this.props.onClose}\r\n                onConfirm={this.onConfirm}\r\n                editable={true}\r\n                confirmButton='Add'>\r\n\r\n\r\n                <iframe onLoad={this.onLoad} title='DrawingTool' src='/drawing-tool/svg/index.html' ref={this.getIframeRef} width='100%' height='100%'></iframe>\r\n            </Dialog>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        note: state.notes[ownProps.noteId],\r\n    }\r\n}\r\n\r\n/* const mapDispatchToProps = { editNote, openDrawDialog, removeDrawing, editSvgDialog} */\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n)(DrawDialog)\r\n","import React, {useCallback} from 'react';\r\nimport Dialog from '../dialog/Dialog.js';\r\nimport Note from '../note/Note.js';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport {closeDialog, closeDrawDialog, focusDialog } from '../../store/dialogReducer.js'\r\nimport {removeNote, addDrawing, postContribution, buildOnNote} from '../../store/noteReducer.js'\r\nimport DrawDialog from '../drawDialog/DrawDialog.js'\r\n\r\nconst DialogHandler = props => {\r\n    const dialogs = useSelector(state => state.dialogs);\r\n    const dispatch = useDispatch();\r\n    // Close dialog and remove dialog AND note from state\r\n\r\n    const onDialogClose = useCallback(\r\n        (dlg) => {\r\n            dispatch(closeDialog(dlg.id));\r\n            dispatch(removeNote(dlg.noteId));\r\n        },\r\n        [dispatch]\r\n    )\r\n\r\n    const onDialogConfirm = useCallback(\r\n        (dlg) => {\r\n            dispatch(postContribution(dlg.noteId, dlg.id));\r\n            /* dispatch(closeDialog(dlg.id)); */\r\n        },\r\n        [dispatch]\r\n    );\r\n\r\n    const onFocusDialog = useCallback(\r\n        (dlgId) => dispatch(focusDialog(dlgId)),\r\n        [dispatch]\r\n    );\r\n\r\n    const onCloseDrawDialog = useCallback(\r\n        () => {\r\n            dispatch(closeDrawDialog())\r\n        },\r\n        [dispatch]\r\n    );\r\n\r\n    const onConfirmDrawDialog = useCallback(\r\n        (drawing) => {\r\n            dispatch(addDrawing(drawing))\r\n            dispatch(closeDrawDialog())\r\n        },\r\n        [dispatch]\r\n    );\r\n\r\n    const onBuildOnClick = useCallback(\r\n        (noteId) => {\r\n            console.log(\"build on note\" + noteId);\r\n            dispatch(buildOnNote(noteId));\r\n        },\r\n        [dispatch]\r\n    );\r\n\r\n    return (\r\n        <div>{\r\n            dialogs.dialogs.map((elt, i) =>\r\n                <Dialog key={elt.id}\r\n                        id={elt.id}\r\n                        onMouseDown={() => onFocusDialog(elt.id)}\r\n                        title={elt.title}\r\n                        style={{zIndex: elt.zIndex}}\r\n                        onClose={()=>onDialogClose(elt)}\r\n                        onConfirm={()=> onDialogConfirm(elt)}\r\n                        confirmButton={elt.confirmButton}\r\n                        editable={elt.editable}\r\n                        buildon={elt.buildOn}\r\n                        onBuildOnClick={()=>onBuildOnClick(elt.noteId)}\r\n                >\r\n\r\n                    <Note key={elt.noteId} dlgId={elt.id} noteId={elt.noteId} mode={elt.editable? \"write\": \"read\"}/>\r\n                </Dialog>\r\n            )\r\n        }\r\n\r\n            {dialogs.drawTool!== null ?\r\n             <DrawDialog onClose={onCloseDrawDialog}\r\n                         onConfirm={onConfirmDrawDialog}\r\n                         noteId={dialogs.drawTool}\r\n             /> : null}\r\n\r\n        </div>\r\n    )\r\n\r\n}\r\nexport default DialogHandler;\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { setViewId, fetchViewCommunityData } from '../store/globalsReducer.js'\r\nimport {openContribution}from '../store/noteReducer.js'\r\nimport Graph from '../Graph';\r\nimport \"./View.css\";\r\nimport SideBar from \"./SideBar.js\"\r\nimport DialogHandler from './dialogHandler/DialogHandler.js'\r\n\r\nclass View extends Component {\r\n\r\n    constructor(props){\r\n        super(props)\r\n        this.onViewClick = this.onViewClick.bind(this);\r\n    }\r\n    componentDidMount() {\r\n\r\n        if (this.props.viewId) {\r\n            this.props.fetchViewCommunityData(this.props.viewId)\r\n        }else{\r\n            const viewId = this.props.match.params.viewId //Get viewId from url param\r\n            this.props.setViewId(viewId)\r\n        }\r\n\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.props.viewId && this.props.viewId !== prevProps.viewId) {\r\n            this.props.fetchViewCommunityData(this.props.viewId)\r\n        }\r\n    }\r\n\r\n    onViewClick(viewId){\r\n        this.props.setViewId(viewId);\r\n        this.props.history.push({pathname: `/view/${viewId}`})\r\n    }\r\n\r\n    render(){\r\n      return(\r\n          <div className=\"container-fluid\">\r\n              <DialogHandler />\r\n              <div className=\"row\" >\r\n                  <div className=\"col\" id=\"sticky-sidebar\">\r\n                      <SideBar communityId={this.props.communityId}\r\n                               view={this.props.view}\r\n                          author={this.props.author}\r\n                      />\r\n                  </div>\r\n                  <div className=\"col\" id=\"main-canvas\">\r\n                      <Graph token={this.props.token}\r\n                             server={this.props.currentServer}\r\n                             communityId={this.props.communityId}\r\n                             viewId={this.props.viewId}\r\n                             onViewClick={this.onViewClick}\r\n                             onNoteClick={(noteId)=>this.props.openContribution(noteId, \"write\")}\r\n                      />\r\n                  </div>\r\n              </div>\r\n          </div>\r\n      )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        token: state.globals.token,\r\n        currentServer: state.globals.currentServer,\r\n        communityId: state.globals.communityId,\r\n        viewId: state.globals.viewId,\r\n        view: state.globals.view,\r\n        author: state.globals.author,\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    setViewId,\r\n    fetchViewCommunityData,\r\n    openContribution\r\n};\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(View)\r\n","import React from 'react';\r\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\r\nimport { useDispatch } from 'react-redux';\r\nimport ReactNotification from 'react-notifications-component';\r\nimport Login from './Login';\r\nimport Dashboard from './Dashboard';\r\nimport View from './components/View.js'\r\nimport { setGlobalToken, setCurrentServer, fetchLoggedUser } from './store/globalsReducer.js'\r\nimport { getLoginData } from './helper/Login_helper.js'\r\nimport ProtectedRoute from './ProtectedRoute.jsx'\r\nimport SignUpForm from './SignUpForm';\r\nimport 'react-notifications-component/dist/theme.css'\r\nfunction App() {\r\n\r\n    const dispatch = useDispatch();\r\n    //Check if user loged in, if logged in set token,server and user info in store\r\n    const [server, token, ] = getLoginData();\r\n    if (token) {\r\n        dispatch(setGlobalToken(token))\r\n        dispatch(setCurrentServer(server))\r\n        dispatch(fetchLoggedUser())\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <ReactNotification />\r\n            <Router>\r\n                <Switch>\r\n                    <Route exact path=\"/\" component={Login}/>\r\n                    <Route exact path=\"/signup\" component={SignUpForm}></Route>\r\n                    <Route exact path=\"/dashboard\" component={Dashboard}></Route>\r\n                    <Route path=\"/view/:viewId\" component={View}></Route>\r\n                </Switch>\r\n            </Router>\r\n        </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport App from './App';\r\nimport { Provider } from 'react-redux';\r\nimport store from './store/store';\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <App />\r\n    </Provider>,\r\n    document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}